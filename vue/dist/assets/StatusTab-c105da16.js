import{_ as k,k as f,r as p,o as v,c as y,f as n,q as d,s as b,a as g,F as C,i as D,t as V,l as a,S as w}from"./index-39d2646a.js";const E=["innerHTML"],L={__name:"StatusTab",setup(U){const x=f(""),m=f("html"),i=f(!1),u=f({1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1});async function h(){var e,t;if(i.value){a("Database download already in progress...",{type:"warning"});return}i.value=!0;try{a("Preparing database download...",{type:"info"});const r=await w.get("/download_db",{responseType:"blob",timeout:3e4}),c=new Blob([r.data],{type:"application/octet-stream"}),s=document.createElement("a");s.href=URL.createObjectURL(c),s.download="replifactory.db",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(s.href),a("Database downloaded successfully!",{type:"success"})}catch(r){console.error("Error downloading database:",r),r.code==="ECONNABORTED"||r.message.includes("timeout")?a("Database download timed out - the file might be too large",{type:"error"}):((e=r.response)==null?void 0:e.status)===404?a("Database file not found on server",{type:"error"}):((t=r.response)==null?void 0:t.status)===500?a("Server error during database download",{type:"error"}):a("Failed to download database - check connection",{type:"error"})}finally{i.value=!1}}async function $(e,t){var r,c,s;if(u.value[e]){a(`Vial ${e} export already in progress...`,{type:"warning"});return}u.value[e]=!0;try{a(`Exporting vial ${e} data as ${t.toUpperCase()}...`,{type:"info"});const l=await w.get(`/export/${e}/${t}`,{responseType:"blob",timeout:6e4}),_=new Blob([l.data],{type:"application/octet-stream"}),o=document.createElement("a");o.href=URL.createObjectURL(_),t==="html"?o.download=`vial_${e}_plot.html`:o.download=`vial_${e}_data.${t}`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href),a(`Vial ${e} ${t.toUpperCase()} exported successfully!`,{type:"success"})}catch(l){console.error(`Error exporting data for vial ${e}:`,l),l.code==="ECONNABORTED"||l.message.includes("timeout")?a(`Vial ${e} export timed out - the file might be too large`,{type:"error"}):((r=l.response)==null?void 0:r.status)===404?a(`Vial ${e} not found or no current experiment selected`,{type:"error"}):((c=l.response)==null?void 0:c.status)===400?a(`Invalid export parameters for vial ${e}`,{type:"error"}):((s=l.response)==null?void 0:s.status)===500?a(`Server error during vial ${e} export - check if experiment has data`,{type:"error"}):a(`Failed to export vial ${e} data - check connection`,{type:"error"})}finally{u.value[e]=!1}}return(e,t)=>{const r=p("v-icon"),c=p("v-btn"),s=p("v-col"),l=p("v-row"),_=p("v-select");return v(),y("div",null,[n(l,{class:"mt-3"},{default:d(()=>[n(s,{cols:"4"},{default:d(()=>[n(c,{color:"success",onClick:h,loading:i.value,disabled:i.value,size:"large"},{default:d(()=>[n(r,{size:"large"},{default:d(()=>t[1]||(t[1]=[b("mdi-cloud-download")])),_:1}),t[2]||(t[2]=b(" Download Database "))]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),n(l,{class:"mt-3",align:"center"},{default:d(()=>[n(s,{cols:"3",class:"text-right"},{default:d(()=>t[3]||(t[3]=[g("strong",null,"Export Data",-1)])),_:1}),n(s,{cols:"3"},{default:d(()=>[n(_,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=o=>m.value=o),items:["csv","html"],label:"Select Format",dense:""},null,8,["modelValue"])]),_:1}),n(s,{cols:"6"},{default:d(()=>[(v(),y(C,null,D(7,o=>n(c,{key:"vial"+o,color:"info",class:"mr-1 mb-1",onClick:R=>$(o,m.value),loading:u.value[o],disabled:i.value||u.value[o]},{default:d(()=>[b(" Vial "+V(o),1)]),_:2},1032,["onClick","loading","disabled"])),64))]),_:1})]),_:1}),g("div",{class:"mt-3",innerHTML:x.value},null,8,E)])}}},O=k(L,[["__scopeId","data-v-40aa0339"]]);export{O as default};
