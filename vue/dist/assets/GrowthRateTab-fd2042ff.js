import{_ as Q,r as m,o as i,j as B,q as l,f as e,s as r,c as d,F as J,i as ne,a,n as Y,t as F,d as b,h as L,e as te,x as P,w as ue,V as me,g as Re,B as Me,k as G,S as le,L as ce,l as X,A as Fe,m as Ce,p as Ge,C as ve}from"./index-39d2646a.js";import{P as ae}from"./plotly-afc049ba.js";class We{constructor(){this.memoryThreshold=100*1024*1024,this.gcInterval=3e4,this.gcTimer=null}monitorMemory(){if(performance.memory){const c=performance.memory.usedJSHeapSize;console.log(`Memory usage: ${(c/1024/1024).toFixed(1)}MB`),c>this.memoryThreshold&&this.forceGarbageCollection()}}forceGarbageCollection(){window.gc&&(window.gc(),console.log("Forced garbage collection")),console.clear&&Math.random()<.1&&console.clear()}startMemoryMonitoring(){this.gcTimer&&this.stopMemoryMonitoring(),this.gcTimer=setInterval(()=>{this.monitorMemory()},this.gcInterval),console.log("Performance monitoring started")}stopMemoryMonitoring(){this.gcTimer&&(clearInterval(this.gcTimer),this.gcTimer=null,console.log("Performance monitoring stopped"))}optimizeRequestData(_){const c={};for(const[n,v]of Object.entries(_))v!=null&&(Array.isArray(v)?c[n]=[...new Set(v)]:typeof v=="object"?c[n]=this.optimizeRequestData(v):c[n]=v);return c}async batchRequests(_,c=3){const n=[];for(let v=0;v<_.length;v+=c){const S=_.slice(v,v+c);try{const w=await Promise.all(S);n.push(...w),v+c<_.length&&await new Promise(k=>setTimeout(k,100))}catch(w){throw console.error("Batch request failed:",w),w}}return n}optimizeDataForPlotting(_,c=1e3){if(!Array.isArray(_)||_.length<=c)return _;const n=Math.ceil(_.length/c),v=[];for(let S=0;S<_.length;S+=n)v.push(_[S]);return v[v.length-1]!==_[_.length-1]&&v.push(_[_.length-1]),console.log(`Data optimized: ${_.length} â†’ ${v.length} points`),v}debounce(_,c){let n;return function(...S){const w=()=>{clearTimeout(n),_(...S)};clearTimeout(n),n=setTimeout(w,c)}}throttle(_,c){let n;return function(...v){n||(_.apply(this,v),n=!0,setTimeout(()=>n=!1,c))}}measurePerformance(_,c){return async(...n)=>{const v=performance.now(),S=performance.memory?performance.memory.usedJSHeapSize:0;try{const w=await c(...n),k=performance.now(),g=performance.memory?performance.memory.usedJSHeapSize:0;return console.log(`Performance [${_}]:`,{duration:`${(k-v).toFixed(2)}ms`,memoryDelta:performance.memory?`${((g-S)/1024).toFixed(1)}KB`:"N/A"}),w}catch(w){const k=performance.now();throw console.error(`Performance [${_}] failed after ${(k-v).toFixed(2)}ms:`,w),w}}}cleanup(){this.stopMemoryMonitoring(),this.forceGarbageCollection()}}const Z=new We;const ze={key:0,class:"text-grey"},De={class:"mt-2"},Ae={__name:"VialSelection",props:{selectedVials:{type:Array,required:!0},availableVials:{type:Array,required:!0},vialColors:{type:Object,required:!0}},emits:["update:selectedVials","selectAllVials","clearVialSelection"],setup(t,{emit:_}){const c=t,n=_,v=(k,g)=>{const o=g?[...c.selectedVials,k]:c.selectedVials.filter(h=>h!==k);n("update:selectedVials",o)},S=()=>{n("selectAllVials")},w=()=>{n("clearVialSelection")};return(k,g)=>{const o=m("v-icon"),h=m("v-card-title"),R=m("v-checkbox"),N=m("v-col"),U=m("v-row"),C=m("v-btn"),p=m("v-card-text"),s=m("v-card");return i(),B(s,{class:"mb-4"},{default:l(()=>[e(h,{class:"vial-selection-title"},{default:l(()=>[e(o,{class:"mr-2"},{default:l(()=>g[0]||(g[0]=[r("mdi-test-tube")])),_:1}),g[1]||(g[1]=r(" Select Vials for Analysis "))]),_:1}),e(p,null,{default:l(()=>[e(U,null,{default:l(()=>[(i(),d(J,null,ne(7,M=>e(N,{key:M,cols:"auto"},{default:l(()=>[e(R,{"model-value":t.selectedVials.includes(M),"onUpdate:modelValue":I=>v(M,I),label:`Vial ${M}`,disabled:!t.availableVials.includes(M),color:t.vialColors[M],class:"vial-checkbox"},{label:l(()=>[a("div",{class:"vial-label",style:Y({color:t.vialColors[M]})},[e(o,{color:t.vialColors[M],size:"small",class:"mr-1"},{default:l(()=>g[2]||(g[2]=[r("mdi-circle")])),_:2},1032,["color"]),r(" Vial "+F(M)+" ",1),t.availableVials.includes(M)?b("",!0):(i(),d("span",ze,"(no data)"))],4)]),_:2},1032,["model-value","onUpdate:modelValue","label","disabled","color"])]),_:2},1024)),64))]),_:1}),a("div",De,[e(C,{size:"small",variant:"outlined",onClick:S,disabled:t.availableVials.length===0,class:"mr-2"},{default:l(()=>g[3]||(g[3]=[r(" Select All ")])),_:1},8,["disabled"]),e(C,{size:"small",variant:"outlined",onClick:w},{default:l(()=>g[4]||(g[4]=[r(" Clear All ")])),_:1})])]),_:1})]),_:1})}}},$e=Q(Ae,[["__scopeId","data-v-bc4eb7cb"]]);const Oe={key:0,class:"ml-2"},Ve={class:"text-center mt-4"},Ne={key:0,class:"mt-2 text-grey"},Ue={__name:"DataFiltering",props:{enableTrimming:{type:Boolean,default:!1},enableOdTrimming:{type:Boolean,default:!1},enableOutlierRemoval:{type:Boolean,default:!1},smoothingMethod:{type:String,default:"none"},smoothingWindow:{type:Number,default:10},outlierThreshold:{type:Number,default:1},outlierWindowSize:{type:Number,default:5},dataTimeRanges:{type:Object,default:()=>({})},isLoadingTimeRanges:{type:Boolean,default:!1},sortedSelectedVials:{type:Array,default:()=>[]},vialColors:{type:Object,default:()=>({})},trimSettings:{type:Object,default:()=>({})},odTrimSettings:{type:Object,default:()=>({})},smoothingMethods:{type:Array,default:()=>[]},canGenerateFilteredData:{type:Boolean,default:!1},isGeneratingFilteredData:{type:Boolean,default:!1},filteredDataResults:{type:Object,default:()=>({})},getFilteredDataDisabledReason:{type:Function,default:()=>""}},emits:["update:enableTrimming","update:enableOdTrimming","update:enableOutlierRemoval","update:smoothingMethod","update:smoothingWindow","update:outlierThreshold","update:outlierWindowSize","update:trimSettings","update:odTrimSettings","generateFilteredData"],setup(t,{emit:_}){const c=t,n=_,v=L({get:()=>c.enableTrimming,set:g=>n("update:enableTrimming",g)}),S=L(()=>Array.isArray(c.sortedSelectedVials)?c.sortedSelectedVials:[]),w=(g,o,h)=>{const R={...c.trimSettings};R[g]={...R[g],[o]:h},n("update:trimSettings",R)},k=(g,o,h)=>{const R={...c.odTrimSettings};R[g]={...R[g],[o]:h},n("update:odTrimSettings",R)};return(g,o)=>{const h=m("v-icon"),R=m("v-card-title"),N=m("v-checkbox"),U=m("v-alert"),C=m("v-col"),p=m("v-text-field"),s=m("v-row"),M=m("v-card-text"),I=m("v-expand-transition"),q=m("v-card"),z=m("v-tooltip"),j=m("v-select"),V=m("v-btn");return i(),d(J,null,[e(q,{class:"mb-4"},{default:l(()=>[e(R,{class:"step-title"},{default:l(()=>[e(h,{class:"mr-2"},{default:l(()=>o[9]||(o[9]=[r("mdi-filter-variant")])),_:1}),o[10]||(o[10]=r(" Step 1: Data Filtering and Smoothing "))]),_:1}),e(M,null,{default:l(()=>[e(q,{class:te(["mb-3",{"border-enabled":t.enableOdTrimming,"border-disabled":!t.enableOdTrimming}]),elevation:t.enableOdTrimming?3:1},{default:l(()=>[e(R,{class:"d-flex align-center pa-3"},{default:l(()=>[e(N,{"model-value":t.enableOdTrimming,"onUpdate:modelValue":o[0]||(o[0]=x=>g.$emit("update:enableOdTrimming",x)),color:"primary","hide-details":"",class:"mr-3"},null,8,["model-value"]),e(h,{class:"mr-2",color:"primary"},{default:l(()=>o[11]||(o[11]=[r("mdi-chart-line")])),_:1}),o[12]||(o[12]=a("span",{class:"text-h6"},"OD Range Trimming",-1))]),_:1}),e(I,null,{default:l(()=>[t.enableOdTrimming?(i(),B(M,{key:0,class:"pt-0",style:{"padding-left":"16px","padding-right":"16px"}},{default:l(()=>[e(U,{type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[e(h,{class:"mr-2"},{default:l(()=>o[13]||(o[13]=[r("mdi-information")])),_:1}),o[14]||(o[14]=r(" Set the OD range for analysis. Data outside this range will be excluded. "))]),_:1}),(i(!0),d(J,null,ne(S.value,x=>(i(),d(J,{key:`od-${x}`},[x&&t.odTrimSettings&&t.odTrimSettings[x]?(i(),B(s,{key:0,class:"mt-2"},{default:l(()=>[e(C,{cols:"2",class:"d-flex align-center"},{default:l(()=>[a("span",{style:Y({color:t.vialColors[x]}),class:"font-weight-bold"}," Vial "+F(x)+": ",5)]),_:2},1024),e(C,{cols:"5"},{default:l(()=>{var T;return[e(p,{"model-value":((T=t.odTrimSettings[x])==null?void 0:T.min)||0,"onUpdate:modelValue":A=>k(x,"min",parseFloat(A)),label:"Min OD",type:"number",step:"0.01",min:"0",max:"2",density:"compact",hint:"Minimum OD value (0 will exclude OD=0 datapoints)","persistent-hint":""},null,8,["model-value","onUpdate:modelValue"])]}),_:2},1024),e(C,{cols:"5"},{default:l(()=>{var T;return[e(p,{"model-value":((T=t.odTrimSettings[x])==null?void 0:T.max)||2,"onUpdate:modelValue":A=>k(x,"max",parseFloat(A)),label:"Max OD",type:"number",step:"0.01",min:"0",max:"2",density:"compact",hint:"Maximum OD value","persistent-hint":""},null,8,["model-value","onUpdate:modelValue"])]}),_:2},1024)]),_:2},1024)):b("",!0)],64))),128))]),_:1})):b("",!0)]),_:1})]),_:1},8,["class","elevation"]),e(q,{class:te(["mb-3",{"border-enabled":t.enableTrimming,"border-disabled":!t.enableTrimming}]),elevation:t.enableTrimming?3:1},{default:l(()=>[e(R,{class:"d-flex align-center pa-3"},{default:l(()=>[e(N,{modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=x=>v.value=x),color:"primary","hide-details":"",class:"mr-3",density:"compact"},null,8,["modelValue"]),e(h,{class:"mr-2",color:"primary"},{default:l(()=>o[15]||(o[15]=[r("mdi-content-cut")])),_:1}),o[16]||(o[16]=a("span",{class:"text-h6"},"Manual Time Trimming",-1))]),_:1}),e(I,null,{default:l(()=>[t.enableTrimming?(i(),B(M,{key:0,class:"pt-0"},{default:l(()=>{var x;return[(x=t.dataTimeRanges)!=null&&x.overall?(i(),B(U,{key:0,type:"success",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[e(h,{class:"mr-2"},{default:l(()=>o[17]||(o[17]=[r("mdi-database-clock")])),_:1}),o[18]||(o[18]=a("strong",null,"Available data:",-1)),r(" "+F(t.dataTimeRanges.overall.min_datetime)+" to "+F(t.dataTimeRanges.overall.max_datetime)+" ("+F(t.dataTimeRanges.overall.duration_hours)+" hours) ",1)]),_:1})):t.isLoadingTimeRanges?(i(),B(U,{key:1,type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[e(h,{class:"mr-2"},{default:l(()=>o[19]||(o[19]=[r("mdi-loading mdi-spin")])),_:1}),o[20]||(o[20]=r(" Loading data time ranges... "))]),_:1})):(i(),B(U,{key:2,type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[e(h,{class:"mr-2"},{default:l(()=>o[21]||(o[21]=[r("mdi-information")])),_:1}),o[22]||(o[22]=r(" Time ranges are automatically set to your actual experiment data. Adjust as needed for your analysis window. "))]),_:1})),(i(!0),d(J,null,ne(S.value,T=>(i(),d(J,{key:T},[T&&t.trimSettings&&t.trimSettings[T]?(i(),B(s,{key:0,class:"mt-2"},{default:l(()=>[e(C,{cols:"2",class:"d-flex align-center"},{default:l(()=>{var A,$;return[a("span",{style:Y({color:t.vialColors[T]}),class:"font-weight-bold"}," Vial "+F(T)+": ",5),($=(A=t.dataTimeRanges)==null?void 0:A.vials)!=null&&$[T]?(i(),d("div",Oe,[e(z,{bottom:""},{activator:l(({props:K})=>[e(h,P({ref_for:!0},K,{size:"small",color:"grey"}),{default:l(()=>o[23]||(o[23]=[r("mdi-information")])),_:2},1040)]),default:l(()=>[a("div",null,[a("strong",null,"Vial "+F(T)+" data:",1),o[24]||(o[24]=a("br",null,null,-1)),r(" "+F(t.dataTimeRanges.vials[T].min_datetime)+" to",1),o[25]||(o[25]=a("br",null,null,-1)),r(" "+F(t.dataTimeRanges.vials[T].max_datetime),1),o[26]||(o[26]=a("br",null,null,-1)),r(" ("+F(t.dataTimeRanges.vials[T].data_points)+" points) ",1)])]),_:2},1024)])):b("",!0)]}),_:2},1024),e(C,{cols:"5"},{default:l(()=>{var A;return[e(p,{"model-value":((A=t.trimSettings[T])==null?void 0:A.start)||"","onUpdate:modelValue":$=>w(T,"start",$),label:"Start Time",type:"datetime-local",density:"compact",hint:"Start of analysis window",loading:t.isLoadingTimeRanges},null,8,["model-value","onUpdate:modelValue","loading"])]}),_:2},1024),e(C,{cols:"5"},{default:l(()=>{var A;return[e(p,{"model-value":((A=t.trimSettings[T])==null?void 0:A.end)||"","onUpdate:modelValue":$=>w(T,"end",$),label:"End Time",type:"datetime-local",density:"compact",hint:"End of analysis window",loading:t.isLoadingTimeRanges},null,8,["model-value","onUpdate:modelValue","loading"])]}),_:2},1024)]),_:2},1024)):b("",!0)],64))),128))]}),_:1})):b("",!0)]),_:1})]),_:1},8,["class","elevation"]),e(q,{class:te(["mb-3",{"border-enabled":t.enableOutlierRemoval,"border-disabled":!t.enableOutlierRemoval}]),elevation:t.enableOutlierRemoval?3:1},{default:l(()=>[e(R,{class:"d-flex align-center pa-3"},{default:l(()=>[e(N,{"model-value":t.enableOutlierRemoval,"onUpdate:modelValue":o[2]||(o[2]=x=>g.$emit("update:enableOutlierRemoval",x)),color:"warning","hide-details":"",class:"mr-3"},null,8,["model-value"]),e(h,{class:"mr-2",color:"warning"},{default:l(()=>o[27]||(o[27]=[r("mdi-target")])),_:1}),o[28]||(o[28]=a("span",{class:"text-h6"},"Outlier Removal",-1))]),_:1}),e(I,null,{default:l(()=>[t.enableOutlierRemoval?(i(),B(M,{key:0,class:"pt-0"},{default:l(()=>[e(s,null,{default:l(()=>[e(C,{cols:"6"},{default:l(()=>[e(p,{"model-value":t.outlierThreshold,"onUpdate:modelValue":o[3]||(o[3]=x=>g.$emit("update:outlierThreshold",parseFloat(x))),label:"Outlier Threshold (Z-score)",type:"number",min:"0.5",max:"5.0",step:"0.1",hint:"Higher values are more forgiving","persistent-hint":""},null,8,["model-value"])]),_:1}),e(C,{cols:"6"},{default:l(()=>[e(p,{"model-value":t.outlierWindowSize,"onUpdate:modelValue":o[4]||(o[4]=x=>g.$emit("update:outlierWindowSize",parseInt(x))),label:"Rolling Window Size",type:"number",min:"3",max:"20",step:"1",hint:"Number of nearby points to compare (5 = recommended)","persistent-hint":""},null,8,["model-value"])]),_:1})]),_:1}),e(U,{type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>[e(h,{class:"mr-2"},{default:l(()=>o[29]||(o[29]=[r("mdi-information")])),_:1}),o[30]||(o[30]=r(" Uses rolling window approach: compares each point to nearby points and interpolates outliers. "))]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1},8,["class","elevation"]),e(q,{class:te(["mb-3",{"border-enabled":t.smoothingMethod!=="none","border-disabled":t.smoothingMethod==="none"}]),elevation:t.smoothingMethod!=="none"?3:1},{default:l(()=>[e(R,{class:"d-flex align-center pa-3"},{default:l(()=>[e(N,{"model-value":t.smoothingMethod!=="none","onUpdate:modelValue":o[5]||(o[5]=x=>g.$emit("update:smoothingMethod",x?"median":"none")),color:"success","hide-details":"",class:"mr-3"},null,8,["model-value"]),e(h,{class:"mr-2",color:"success"},{default:l(()=>o[31]||(o[31]=[r("mdi-blur")])),_:1}),o[32]||(o[32]=a("span",{class:"text-h6"},"Data Smoothing",-1))]),_:1}),e(I,null,{default:l(()=>[t.smoothingMethod!=="none"?(i(),B(M,{key:0,class:"pt-0"},{default:l(()=>[e(s,null,{default:l(()=>[e(C,{cols:"6"},{default:l(()=>[e(j,{"model-value":t.smoothingMethod,"onUpdate:modelValue":o[6]||(o[6]=x=>g.$emit("update:smoothingMethod",x)),items:t.smoothingMethods.filter(x=>x.value!=="none"),label:"Smoothing Method","item-title":"label","item-value":"value"},null,8,["model-value","items"])]),_:1}),e(C,{cols:"6"},{default:l(()=>[e(p,{"model-value":t.smoothingWindow,"onUpdate:modelValue":o[7]||(o[7]=x=>g.$emit("update:smoothingWindow",x)),label:"Smoothing Window Size",type:"number",min:"3",max:"50",step:"2",hint:"Number of points for smoothing filter","persistent-hint":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1},8,["class","elevation"]),a("div",Ve,[e(V,{color:"primary",size:"large",onClick:o[8]||(o[8]=x=>g.$emit("generateFilteredData")),disabled:!t.canGenerateFilteredData,loading:t.isGeneratingFilteredData,class:"generate-filtered-btn"},{default:l(()=>[e(h,{class:"mr-2"},{default:l(()=>o[33]||(o[33]=[r("mdi-chart-line")])),_:1}),o[34]||(o[34]=r(" Show Processed OD Data "))]),_:1},8,["disabled","loading"]),t.canGenerateFilteredData?b("",!0):(i(),d("div",Ne,F(t.getFilteredDataDisabledReason()),1))])]),_:1})]),_:1}),t.filteredDataResults?(i(),B(q,{key:0,class:"mb-4"},{default:l(()=>[e(R,null,{default:l(()=>[e(h,{class:"mr-2"},{default:l(()=>o[35]||(o[35]=[r("mdi-chart-line")])),_:1}),o[36]||(o[36]=r(" Processed OD Data "))]),_:1}),e(M,null,{default:l(()=>o[37]||(o[37]=[a("div",{class:"plot-wrapper"},[a("div",{id:"filtered-od-plot-container",class:"plot-container-small"})],-1)])),_:1})]),_:1})):b("",!0)],64)}}},Be=Q(Ue,[["__scopeId","data-v-e9d25b08"]]);const qe={class:"ml-6 mt-2"},Ee={class:"d-flex align-center"},Ie={key:0,class:"ml-6 mt-2"},Pe={class:"ml-6 mt-2 mb-2"},je={__name:"ExponentialModelOptions",props:{modelType:{type:String,required:!0},useSlidingWindow:{type:Boolean,required:!0},analysisMethod:{type:String,required:!0},windowSize:{type:Number,required:!0},realtimeMode:{type:Boolean,required:!0}},emits:["update:useSlidingWindow","update:analysisMethod","update:windowSize","update:realtimeMode"],setup(t,{emit:_}){return(c,n)=>{const v=m("v-btn"),S=m("v-card-title"),w=m("v-card-text"),k=m("v-spacer"),g=m("v-card-actions"),o=m("v-card"),h=m("v-dialog"),R=m("v-checkbox"),N=m("v-radio"),U=m("v-text-field"),C=m("v-radio-group");return ue((i(),d("div",qe,[a("div",Ee,[e(R,{"model-value":t.useSlidingWindow,"onUpdate:modelValue":n[0]||(n[0]=p=>c.$emit("update:useSlidingWindow",p)),color:"primary",density:"compact"},{label:l(()=>[n[7]||(n[7]=a("span",null,"Use sliding window analysis",-1)),e(h,{"max-width":"400"},{activator:l(({props:p})=>[e(v,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},p,{class:"ml-1",style:{"vertical-align":"middle"}}),null,16)]),default:l(({isActive:p})=>[e(o,null,{default:l(()=>[e(S,{class:"text-h6"},{default:l(()=>n[4]||(n[4]=[r("Sliding Window Analysis")])),_:1}),e(w,null,{default:l(()=>n[5]||(n[5]=[a("p",{class:"text-body-2"}," Fits exponential curves in small overlapping windows around each timepoint to track how growth rate changes throughout the experiment. Creates a plot showing growth rate vs time. ",-1)])),_:1}),e(g,null,{default:l(()=>[e(k),e(v,{text:"",onClick:s=>p.value=!1},{default:l(()=>n[6]||(n[6]=[r("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["model-value"])]),t.useSlidingWindow?(i(),d("div",Ie,[e(C,{"model-value":t.analysisMethod,"onUpdate:modelValue":n[2]||(n[2]=p=>c.$emit("update:analysisMethod",p)),class:"mt-0",density:"compact"},{default:l(()=>[e(N,{value:"adaptive",color:"primary",density:"compact"},{label:l(()=>[n[11]||(n[11]=a("span",null,"Adaptive Window Size",-1)),e(h,{"max-width":"450"},{activator:l(({props:p})=>[e(v,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},p,{class:"ml-1",style:{"vertical-align":"middle"}}),null,16)]),default:l(({isActive:p})=>[e(o,null,{default:l(()=>[e(S,{class:"text-h6"},{default:l(()=>n[8]||(n[8]=[r("Adaptive Windowing for Growth Rate Estimation")])),_:1}),e(w,null,{default:l(()=>n[9]||(n[9]=[a("p",{class:"text-body-2 mb-3"}," This method uses a dynamically adjusted window size, based on iterative convergence to approximately Â½ the doubling time. It improves accuracy over fixed window sizes (e.g., 40 minutes), especially across a wide range of growth rates. ",-1),a("div",{class:"mb-3"},[a("h4",{class:"text-subtitle-2 mb-2",style:{color:"#d32f2f"}},"ðŸ”§ Why Fixed Windows Fall Short"),a("div",{class:"text-body-2 ml-4"},[a("p",null,"Too short during slow growth â†’ noisy, unstable estimates (not enough change in OD)."),a("p",null,"Too long during fast growth â†’ smooths over real dynamics, reducing time resolution."),a("p",null,"Fixed size doesn't adapt to changes in growth rate, leading to inaccurate measurements.")])],-1),a("div",{class:"mb-3"},[a("h4",{class:"text-subtitle-2 mb-2",style:{color:"#388e3c"}},"âœ… Why Adaptive Windowing Works Better"),a("div",{class:"text-body-2 ml-4"},[a("p",null,"Scales with growth: Window converges to ~Â½ the doubling time, matching system timescale."),a("p",null,"Balances noise and resolution: Captures meaningful change without over-smoothing."),a("p",null,"Self-tuning: Iterative algorithm adjusts window size based on current growth behavior."),a("p",null,"Robust across conditions: Handles shifts in metabolism, population structure, and stress responses.")])],-1)])),_:1}),e(g,null,{default:l(()=>[e(k),e(v,{text:"",onClick:s=>p.value=!1},{default:l(()=>n[10]||(n[10]=[r("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1}),e(N,{value:"fixed",color:"primary",density:"compact"},{label:l(()=>[n[15]||(n[15]=a("span",null,"Constant Window Size",-1)),e(h,{"max-width":"400"},{activator:l(({props:p})=>[e(v,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},p,{class:"ml-1",style:{"vertical-align":"middle"}}),null,16)]),default:l(({isActive:p})=>[e(o,null,{default:l(()=>[e(S,{class:"text-h6"},{default:l(()=>n[12]||(n[12]=[r("Constant Window Size")])),_:1}),e(w,null,{default:l(()=>n[13]||(n[13]=[a("p",{class:"text-body-2 mb-3"}," Uses a fixed window size for all timepoints. Provides consistent analysis windows but may not be optimal for all growth phases. ",-1),a("div",{class:"mb-3"},[a("h4",{class:"text-subtitle-2 mb-2",style:{color:"#1976d2"}},"ðŸ“ When to Use Fixed Windows"),a("ul",{class:"text-body-2 ml-4"},[a("li",null,[a("strong",null,"Known growth conditions:"),r(" When doubling time is expected to be stable")]),a("li",null,[a("strong",null,"Comparative analysis:"),r(" When you want identical window sizes across experiments")]),a("li",null,[a("strong",null,"Simple interpretation:"),r(" Easier to understand and explain results")])])],-1),a("div",{class:"text-body-2"},[a("strong",null,"Window Size Guidelines:"),a("ul",{class:"ml-4 mt-2"},[a("li",null,"30-60 minutes for fast growth (td ~30-60 min)"),a("li",null,"60-120 minutes for moderate growth (td ~2-4 hours)"),a("li",null,"120+ minutes for slow growth (td >4 hours)")])],-1)])),_:1}),e(g,null,{default:l(()=>[e(k),e(v,{text:"",onClick:s=>p.value=!1},{default:l(()=>n[14]||(n[14]=[r("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1}),ue(a("div",Pe,[e(U,{"model-value":t.windowSize,"onUpdate:modelValue":n[1]||(n[1]=p=>c.$emit("update:windowSize",parseInt(p))),label:"Window Size",type:"number",min:"10",max:"1440",step:"5",suffix:"minutes",density:"compact",style:{"max-width":"200px"}},null,8,["model-value"])],512),[[me,t.analysisMethod==="fixed"]])]),_:1},8,["model-value"]),e(R,{"model-value":t.realtimeMode,"onUpdate:modelValue":n[3]||(n[3]=p=>c.$emit("update:realtimeMode",p)),color:"primary",density:"compact",class:"mt-2"},{label:l(()=>[n[19]||(n[19]=a("span",null,"Real-time calculation mode",-1)),e(h,{"max-width":"450"},{activator:l(({props:p})=>[e(v,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},p,{class:"ml-1",style:{"vertical-align":"middle"}}),null,16)]),default:l(({isActive:p})=>[e(o,null,{default:l(()=>[e(S,{class:"text-h6"},{default:l(()=>n[16]||(n[16]=[r("Real-time vs Retrospective Analysis")])),_:1}),e(w,null,{default:l(()=>n[17]||(n[17]=[a("div",{class:"mb-3"},[a("h4",{class:"text-subtitle-1 mb-2",style:{color:"#1976d2"}},"Real-time Mode (Past Data Only)"),a("p",{class:"text-body-2"}," Uses only past data up to each timepoint, exactly replicating the experiment's real-time calculation. Producer noisier results. ")],-1),a("div",null,[a("h4",{class:"text-subtitle-1 mb-2",style:{color:"#388e3c"}},"Retrospective Mode (Past + Future Data)"),a("p",{class:"text-body-2"}," Uses both past and future data around each timepoint for smoother, more accurate analysis. Ideal for post-experiment analysis when the complete dataset is available. ")],-1)])),_:1}),e(g,null,{default:l(()=>[e(k),e(v,{text:"",onClick:s=>p.value=!1},{default:l(()=>n[18]||(n[18]=[r("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["model-value"])])):b("",!0)],512)),[[me,t.modelType==="exponential"]])}}},Le=Q(je,[["__scopeId","data-v-95e2647b"]]);const Ke={class:"d-flex align-center",style:{width:"300px"}},He={class:"d-flex align-center",style:{width:"300px"}},Je={class:"d-flex align-center",style:{width:"300px"}},Ze={class:"text-center mt-4"},Qe={__name:"GrowthModelSelection",props:{modelType:{type:String,required:!0},useSlidingWindow:{type:Boolean,required:!0},analysisMethod:{type:String,required:!0},windowSize:{type:Number,required:!0},realtimeMode:{type:Boolean,required:!0},canRunAnalysis:{type:Boolean,required:!0},isGeneratingGrowthRateAnalysis:{type:Boolean,required:!0}},emits:["update:modelType","update:useSlidingWindow","update:analysisMethod","update:windowSize","update:realtimeMode","generateGrowthRateAnalysis"],setup(t,{emit:_}){return(c,n)=>{const v=m("v-radio"),S=m("v-spacer"),w=m("v-btn"),k=m("v-card-title"),g=m("v-card-text"),o=m("v-card-actions"),h=m("v-card"),R=m("v-dialog"),N=m("v-radio-group"),U=m("v-col"),C=m("v-row"),p=m("v-icon");return i(),d("div",null,[e(C,null,{default:l(()=>[e(U,{cols:"6"},{default:l(()=>[n[15]||(n[15]=a("div",{class:"text-subtitle-1 font-weight-medium mb-2 px-0"},"Growth Model",-1)),e(N,{"model-value":t.modelType,"onUpdate:modelValue":n[0]||(n[0]=s=>c.$emit("update:modelType",s)),class:"mt-0"},{default:l(()=>[a("div",Ke,[e(v,{value:"exponential",label:"Exponential Model",color:"secondary",style:{flex:"0 0 auto"}}),e(S),e(R,{"max-width":"400"},{activator:l(({props:s})=>[e(w,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},s,{style:{"margin-left":"8px"}}),null,16)]),default:l(({isActive:s})=>[e(h,null,{default:l(()=>[e(k,{class:"text-h6"},{default:l(()=>n[6]||(n[6]=[r("Exponential Growth Model")])),_:1}),e(g,null,{default:l(()=>n[7]||(n[7]=[a("div",{class:"formula-display mb-3"},[a("div",{class:"text-center"},[a("div",{class:"formula-math-large"},[a("em",null,"N"),r("("),a("em",null,"t"),r(") = "),a("em",null,"N"),r("â‚€ Ã— "),a("em",null,"e"),a("sup",null,[a("em",null,"rt")])]),a("div",{class:"text-caption mt-2"},[r(" where "),a("em",null,"N"),r("â‚€ = initial OD, "),a("em",null,"r"),r(" = growth rate (/hr), "),a("em",null,"t"),r(" = time (hr) ")])])],-1),a("p",{class:"text-body-2"}," Models unlimited exponential growth. Best for early growth phases or when growth rate is constant. ",-1)])),_:1}),e(o,null,{default:l(()=>[e(S),e(w,{text:"",onClick:M=>s.value=!1},{default:l(()=>n[8]||(n[8]=[r("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),a("div",He,[e(v,{value:"logistic",label:"Logistic Model",color:"secondary",style:{flex:"0 0 auto"}}),e(S),e(R,{"max-width":"400"},{activator:l(({props:s})=>[e(w,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},s,{style:{"margin-left":"8px"}}),null,16)]),default:l(({isActive:s})=>[e(h,null,{default:l(()=>[e(k,{class:"text-h6"},{default:l(()=>n[9]||(n[9]=[r("Logistic Growth Model")])),_:1}),e(g,null,{default:l(()=>n[10]||(n[10]=[a("div",{class:"formula-display mb-3"},[a("div",{class:"text-center"},[a("div",{class:"formula-math-large"},[a("em",null,"N"),r("("),a("em",null,"t"),r(") = "),a("em",null,"K"),r(" / (1 + (("),a("em",null,"K"),r(" - "),a("em",null,"N"),r("â‚€) / "),a("em",null,"N"),r("â‚€) Ã— "),a("em",null,"e"),a("sup",null,[r("-"),a("em",null,"rt")]),r(") ")]),a("div",{class:"text-caption mt-2"},[r(" where "),a("em",null,"N"),r("â‚€ = initial OD, "),a("em",null,"K"),r(" = carrying capacity, "),a("em",null,"r"),r(" = growth rate (/hr), "),a("em",null,"t"),r(" = time (hr) ")])])],-1),a("p",{class:"text-body-2"}," S-shaped growth curve with carrying capacity. Growth rate decreases as population approaches the carrying capacity limit. ",-1)])),_:1}),e(o,null,{default:l(()=>[e(S),e(w,{text:"",onClick:M=>s.value=!1},{default:l(()=>n[11]||(n[11]=[r("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),a("div",Je,[e(v,{value:"gompertz",label:"Gompertz Model",color:"secondary",style:{flex:"0 0 auto"}}),e(S),e(R,{"max-width":"400"},{activator:l(({props:s})=>[e(w,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},s,{style:{"margin-left":"8px"}}),null,16)]),default:l(({isActive:s})=>[e(h,null,{default:l(()=>[e(k,{class:"text-h6"},{default:l(()=>n[12]||(n[12]=[r("Gompertz Growth Model")])),_:1}),e(g,null,{default:l(()=>n[13]||(n[13]=[a("div",{class:"formula-display mb-3"},[a("div",{class:"text-center"},[a("div",{class:"formula-math-large"},[a("em",null,"N"),r("("),a("em",null,"t"),r(") = "),a("em",null,"A"),r(" Ã— "),a("em",null,"e"),a("sup",null,[r("-"),a("em",null,"e"),a("sup",null,[r("-"),a("em",null,"C"),r("("),a("em",null,"t"),r("-"),a("em",null,"B"),r(")")])])]),a("div",{class:"text-caption mt-2"},[r(" where "),a("em",null,"A"),r(" = carrying capacity, "),a("em",null,"B"),r(" = inflection time (hr), "),a("em",null,"C"),r(" = growth rate (/hr), "),a("em",null,"t"),r(" = time (hr) ")])])],-1),a("p",{class:"text-body-2"}," Asymmetric S-curve with distinct lag phase and faster deceleration. Common for bacterial growth patterns. ",-1)])),_:1}),e(o,null,{default:l(()=>[e(S),e(w,{text:"",onClick:M=>s.value=!1},{default:l(()=>n[14]||(n[14]=[r("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})])]),_:1},8,["model-value"])]),_:1})]),_:1}),e(Le,{modelType:t.modelType,useSlidingWindow:t.useSlidingWindow,analysisMethod:t.analysisMethod,windowSize:t.windowSize,realtimeMode:t.realtimeMode,"onUpdate:useSlidingWindow":n[1]||(n[1]=s=>c.$emit("update:useSlidingWindow",s)),"onUpdate:analysisMethod":n[2]||(n[2]=s=>c.$emit("update:analysisMethod",s)),"onUpdate:windowSize":n[3]||(n[3]=s=>c.$emit("update:windowSize",s)),"onUpdate:realtimeMode":n[4]||(n[4]=s=>c.$emit("update:realtimeMode",s))},null,8,["modelType","useSlidingWindow","analysisMethod","windowSize","realtimeMode"]),a("div",Ze,[e(w,{color:"success",size:"x-large",onClick:n[5]||(n[5]=s=>c.$emit("generateGrowthRateAnalysis")),disabled:!t.canRunAnalysis,loading:t.isGeneratingGrowthRateAnalysis},{default:l(()=>[e(p,{class:"mr-2"},{default:l(()=>n[16]||(n[16]=[r("mdi-chart-line")])),_:1}),n[17]||(n[17]=r(" Generate Growth Rate Analysis "))]),_:1},8,["disabled","loading"])])])}}},Xe=Q(Qe,[["__scopeId","data-v-98c3bfbf"]]);const Ye={class:"results-content-container"},et={key:0,class:"selectable-header"},tt={key:1,class:"selectable-header"},lt={key:2,class:"selectable-header"},at={key:3,class:"selectable-header"},nt={key:4,class:"selectable-header"},ot={key:5,class:"selectable-header"},it={key:6,class:"selectable-header"},st={key:7,class:"selectable-header"},rt={key:8,class:"selectable-header"},dt={key:9,class:"selectable-header"},ut={key:10,class:"selectable-header"},mt={key:0},ct={key:0},vt={key:1,class:"text-error"},gt={key:2},yt={key:1},pt={key:0},ft={key:1,class:"text-error"},wt={key:2},bt={key:2},ht={key:0},xt={key:1,class:"text-error"},_t={key:2},St={key:3},Tt={key:0},kt={key:1,class:"text-error"},Rt={key:2},Mt={key:4},Ft={key:0},Ct={key:1,class:"text-error"},Gt={key:2},Wt={key:5},zt={key:0},Dt={key:1,class:"text-error"},At={key:2},$t={key:6},Ot={key:0},Vt={key:1,class:"text-error"},Nt={key:2},Ut={key:7},Bt={key:0},qt={key:1,class:"text-error"},Et={key:2},It={key:8},Pt={key:0},jt={key:1,class:"text-error"},Lt={key:2},Kt={key:9},Ht={key:1,class:"text-error"},Jt={key:2},Zt={key:10},Qt={key:0},Xt={key:1,class:"text-error"},Yt={key:2},el={class:"text-center"},tl={class:"text-subtitle-1"},ll={key:0},al={key:1},nl={key:2},ol={key:3},il={__name:"AnalysisResults",props:{analysisResults:{type:Object,default:null},modelType:{type:String,required:!0},currentlyCalculatingModel:{type:String,required:!0},useSlidingWindow:{type:Boolean,required:!0},sortedAnalysisResults:{type:Array,required:!0},vialColors:{type:Object,required:!0},isGeneratingGrowthRateAnalysis:{type:Boolean,required:!0},hasCurrentExperiment:{type:Boolean,required:!0},formatNumber:{type:Function,required:!0},formatTimestamp:{type:Function,required:!0},formatGrowthRateWithCI:{type:Function,required:!0}},setup(t){const _=c=>c==null||isNaN(c)?"#666666":c>=.99?"#8BC34A":c>=.98?"#2E7D32":c>=.97?"#FFC107":c>=.95?"#FF9800":c>=.9?"#CDDC39":c>=.8?"#FF5722":c>=.7?"#E91E63":c>=.5?"#D32F2F":"#B71C1C";return(c,n)=>{const v=m("v-icon"),S=m("v-card-title"),w=m("v-tooltip"),k=m("v-table"),g=m("v-col"),o=m("v-row"),h=m("v-progress-circular"),R=m("v-overlay"),N=m("v-card-text"),U=m("v-card"),C=m("v-alert");return i(),d("div",null,[t.analysisResults?(i(),B(U,{key:0,class:"results-display"},{default:l(()=>[e(S,null,{default:l(()=>[e(v,{class:"mr-2"},{default:l(()=>n[0]||(n[0]=[r("mdi-chart-line")])),_:1}),n[1]||(n[1]=r(" Growth Rate Analysis Results "))]),_:1}),e(N,null,{default:l(()=>[a("div",Ye,[t.analysisResults.summary?(i(),B(o,{key:0,class:"mb-4"},{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[n[4]||(n[4]=a("h4",null,"Summary Statistics",-1)),e(k,{density:"compact"},{default:l(()=>[a("thead",null,[a("tr",null,[n[2]||(n[2]=a("th",{class:"selectable-header"},"Vial",-1)),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("th",et,"Max Growth Rate (/hr)")):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("th",tt,"Min Doubling Time (hr)")):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("th",lt,"Avg Growth Rate (/hr)")):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("th",at,"Avg Doubling Time (hr)")):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("th",nt,"Max Growth Rate Time")):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("th",ot,"Growth Rate (/hr)")),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("th",it,"Doubling Time (hr)")),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("th",st,"Max Growth Rate Time")),t.modelType==="logistic"||t.modelType==="gompertz"?(i(),d("th",rt,"Carrying Capacity")):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("th",dt,"RÂ²")),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("th",ut,"RMSE")),n[3]||(n[3]=a("th",{class:"selectable-header"},"Data Points",-1))])]),a("tbody",null,[(i(!0),d(J,null,ne(t.sortedAnalysisResults,({vial:p,stats:s})=>(i(),d("tr",{key:p},[a("td",{style:Y({color:t.vialColors[p]}),class:"font-weight-bold"},F(p),5),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("td",mt,[s.model_success&&s.max_growth_rate!=null?(i(),d("span",ct,F(t.formatNumber(s.max_growth_rate)),1)):s.model_success?(i(),d("span",gt,"-")):(i(),d("span",vt," Fit Failed "))])):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("td",yt,[s.model_success&&s.max_growth_doubling_time!=null?(i(),d("span",pt,F(t.formatNumber(s.max_growth_doubling_time,2)),1)):s.model_success?(i(),d("span",wt,"-")):(i(),d("span",ft," Fit Failed "))])):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("td",bt,[s.model_success&&s.avg_growth_rate!=null?(i(),d("span",ht,F(t.formatNumber(s.avg_growth_rate)),1)):s.model_success?(i(),d("span",_t,"-")):(i(),d("span",xt," Fit Failed "))])):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("td",St,[s.model_success&&s.avg_growth_doubling_time!=null?(i(),d("span",Tt,F(t.formatNumber(s.avg_growth_doubling_time,2)),1)):s.model_success?(i(),d("span",Rt,"-")):(i(),d("span",kt," Fit Failed "))])):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(i(),d("td",Mt,[s.model_success&&s.max_growth_time!=null?(i(),d("span",Ft,F(t.formatTimestamp(s.max_growth_time)),1)):s.model_success?(i(),d("span",Gt,"-")):(i(),d("span",Ct," Fit Failed "))])):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("td",Wt,[s.model_success&&s.max_growth_rate!=null?(i(),d("span",zt,F(t.formatNumber(s.max_growth_rate)),1)):s.model_success?(i(),d("span",At,"-")):(i(),d("span",Dt," Fit Failed "))])),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("td",$t,[s.model_success&&s.model_parameters&&s.model_parameters.doubling_time?(i(),d("span",Ot,F(t.formatNumber(s.model_parameters.doubling_time,2)),1)):s.model_success?(i(),d("span",Nt,"-")):(i(),d("span",Vt," Fit Failed "))])),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("td",Ut,[s.model_success&&s.model_parameters&&s.model_parameters.max_growth_rate_time?(i(),d("span",Bt,F(t.formatTimestamp(s.model_parameters.max_growth_rate_time)),1)):s.model_success?(i(),d("span",Et,"-")):(i(),d("span",qt,[e(w,{activator:"parent",location:"bottom"},{activator:l(({props:M})=>[a("span",P({ref_for:!0},M),"Fit Failed",16)]),default:l(()=>[r(" "+F(s.model_error||"Model fitting failed"),1)]),_:2},1024)]))])),t.modelType==="logistic"||t.modelType==="gompertz"?(i(),d("td",It,[s.model_success&&s.model_parameters?(i(),d("span",Pt,F(t.formatNumber(t.modelType==="logistic"?s.model_parameters.K:s.model_parameters.A)),1)):s.model_success?(i(),d("span",Lt,"-")):(i(),d("span",jt," Fit Failed "))])):b("",!0),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("td",Kt,[s.model_success&&s.fit_quality?(i(),d("span",{key:0,style:Y({color:_(s.fit_quality.r_squared),fontWeight:"bold"})},F(t.formatNumber(s.fit_quality.r_squared,3)),5)):s.model_success?(i(),d("span",Jt,"-")):(i(),d("span",Ht," Fit Failed "))])),t.modelType==="exponential"&&t.useSlidingWindow?b("",!0):(i(),d("td",Zt,[s.model_success&&s.fit_quality?(i(),d("span",Qt,F(t.formatNumber(s.fit_quality.rmse,4)),1)):s.model_success?(i(),d("span",Yt,"-")):(i(),d("span",Xt," Fit Failed "))])),a("td",null,F(s.data_points),1)]))),128))])]),_:1})]),_:1})]),_:1})):b("",!0),n[6]||(n[6]=a("div",{class:"plot-wrapper"},[a("div",{id:"growth-rate-plot-container",class:"plot-container"})],-1)),e(R,{"model-value":t.isGeneratingGrowthRateAnalysis,contained:"",class:"d-flex align-center justify-center dark-overlay",persistent:""},{default:l(()=>[a("div",el,[e(h,{indeterminate:"",size:"80",width:"6",color:"primary",class:"mb-4"}),a("div",null,[n[5]||(n[5]=a("h3",{class:"mb-2"},"Calculating Growth Rates...",-1)),a("p",tl,[t.currentlyCalculatingModel==="logistic"?(i(),d("span",ll,"Fitting Logistic Growth Model")):t.currentlyCalculatingModel==="gompertz"?(i(),d("span",al,"Fitting Gompertz Growth Model")):t.currentlyCalculatingModel==="exponential"&&t.useSlidingWindow?(i(),d("span",nl,"Exponential Sliding Window Analysis")):(i(),d("span",ol,"Fitting Exponential Growth Model"))])])])]),_:1},8,["model-value"])])]),_:1})]),_:1})):b("",!0),t.hasCurrentExperiment?b("",!0):(i(),B(C,{key:1,type:"warning",class:"mb-4"},{default:l(()=>[e(v,{class:"mr-2"},{default:l(()=>n[7]||(n[7]=[r("mdi-alert")])),_:1}),n[8]||(n[8]=r(" No current experiment selected. Please select an experiment to use the growth rate analysis. "))]),_:1}))])}}},sl=Q(il,[["__scopeId","data-v-3881a083"]]);const rl={class:"growth-rate-tab"},dl={class:"tab-content-wrapper"},ul={__name:"GrowthRateTab",setup(t){const _=Re(),{currentExperiment:c}=Me(_),n=G([]),v=G([]),S=G("adaptive"),w=G("exponential"),k=G(40),g=G(!1),o=G(!1),h=L(()=>[...n.value].sort((u,O)=>parseInt(u)-parseInt(O))),R=L(()=>{var y;return(y=$.value)!=null&&y.summary?Object.keys($.value.summary).sort((u,O)=>parseInt(u)-parseInt(O)).map(u=>({vial:u,stats:$.value.summary[u]})):[]}),N=L(()=>{var y,u;return(u=(y=$.value)==null?void 0:y.parameters)!=null&&u.model_type?$.value.parameters.model_type:w.value}),U=G(.5),C=G("moving_average"),p=G(10),s=G(!0),M=G(1),I=G(5),q=G(!1),z=G({}),j=G(!0),V=G({}),x=G(!1),T=G(null),A=G(!1),$=G(null),K=G(null),oe=G(!1);for(let y=1;y<=7;y++)z.value[y]={start:"",end:""};const ie={1:"#6b9ac4",2:"#d4a574",3:"#7bb87b",4:"#c17a7a",5:"#b19bb8",6:"#a89a8f",7:"#d4a5c4"},ge=[{label:"None",value:"none"},{label:"Median Filter",value:"median"},{label:"Moving Average",value:"moving_average"},{label:"Savitzky-Golay",value:"savgol"},{label:"Gaussian",value:"gaussian"}],ee=L(()=>!!(c.value&&c.value.id)),re=L(()=>ee.value&&n.value.length>=1&&!x.value),de=L(()=>ee.value&&T.value&&!A.value),ye=()=>ee.value?n.value.length<1?"Please select at least 1 vial to analyze":"":"No experiment selected",pe=()=>{n.value=[...v.value]},fe=()=>{n.value=[],z.value={},V.value={}},we=y=>{n.value=[...y],y.forEach(u=>{z.value[u]||(z.value[u]={start:"",end:""}),V.value[u]||(V.value[u]={min:0,max:2})}),z.value={...z.value},V.value={...V.value}},be=(y,u=4)=>y==null||isNaN(y)?"N/A":parseFloat(y).toFixed(u),he=(y,u)=>y==null||isNaN(y)?"N/A":u==null||isNaN(u)?`${parseFloat(y).toFixed(4)} /hr`:`${parseFloat(y).toFixed(4)} Â± ${parseFloat(u).toFixed(4)} /hr`,xe=y=>y?new Date(y*1e3).toLocaleString():"N/A",_e=async()=>{var y;try{const u=await le.get("/data/vials/available");v.value=u.data.available_vials||[]}catch(u){console.error("Error loading available vials:",u),v.value=[],((y=u.response)==null?void 0:y.status)!==404&&X("Failed to load available vials",{type:"error"})}},Se=async y=>{var u;if(!y||y.length===0){K.value=null;return}oe.value=!0;try{const O=y.join(","),E=await le.get(`/growth-rate/data-time-range/${O}`);K.value=E.data,y.forEach(D=>{if(z.value[D]||(z.value[D]={start:"",end:""}),V.value[D]||(V.value[D]={min:0,max:2}),E.data.vials[D]){const W=E.data.vials[D];(!z.value[D].start||!z.value[D].end)&&(z.value[D].start=W.min_datetime_local,z.value[D].end=W.max_datetime_local)}}),z.value={...z.value},V.value={...V.value}}catch(O){console.error("Error loading data time ranges:",O),K.value=null,((u=O.response)==null?void 0:u.status)!==404&&console.warn("Could not load data time ranges for selected vials")}finally{oe.value=!1}},Te=Z.measurePerformance("generateFilteredData",async()=>{var y,u,O,E,D;if(re.value){x.value=!0;try{const W={vials:h.value,smoothing_method:C.value,smoothing_window:p.value,enable_outlier_removal:s.value,outlier_threshold:M.value,outlier_window_size:I.value,enable_trimming:q.value,trim_settings:q.value?z.value:{},enable_od_trimming:j.value,od_trim_settings:j.value?V.value:{}},f=Z.optimizeRequestData(W),se=await le.post("/growth-rate/filter-od-data",f);T.value=se.data,await ce();const H=document.getElementById("filtered-od-plot-container");H&&T.value.plot&&(await ae.newPlot(H,T.value.plot.data,T.value.plot.layout,{responsive:!0,displayModeBar:!0,displaylogo:!1,modeBarButtonsToRemove:["pan2d","lasso2d","select2d"],scrollZoom:!0}),await ae.Plots.resize(H)),X("Processed OD data generated successfully!",{type:"success"})}catch(W){console.error("Error generating processed OD data:",W);let f="Failed to generate processed OD data";((y=W.response)==null?void 0:y.status)===404?f="No data found for selected vials":((u=W.response)==null?void 0:u.status)===400?(f=((O=W.response.data)==null?void 0:O.detail)||"Invalid filtering parameters",f.includes("trimming failed")&&(f+=`

Please check your date range - it may be outside the available data period.`)):(D=(E=W.response)==null?void 0:E.data)!=null&&D.detail&&(f=W.response.data.detail),X(f,{type:"error",autoClose:8e3})}finally{x.value=!1}}}),ke=Z.measurePerformance("generateGrowthRateAnalysis",async()=>{var y,u,O,E,D;if(de.value){A.value=!0;try{const W={vials:h.value,method:o.value?S.value:"adaptive",model_type:w.value,use_sliding_window:o.value,window_size:o.value?k.value/60:null,window_step:U.value,smoothing_method:C.value,smoothing_window:p.value,enable_outlier_removal:s.value,outlier_threshold:M.value,outlier_window_size:I.value,enable_trimming:q.value,trim_settings:q.value?z.value:{},enable_od_trimming:j.value,od_trim_settings:j.value?V.value:{},use_real_time_simulation:o.value?g.value:!1,use_filtered_data:!0},f=Z.optimizeRequestData(W),se=await le.post("/growth-rate/advanced-analysis",f);$.value=se.data,await ce();const H=document.getElementById("growth-rate-plot-container");H&&$.value.plot&&(await ae.newPlot(H,$.value.plot.data,$.value.plot.layout,{responsive:!0,displayModeBar:!0,displaylogo:!1,modeBarButtonsToRemove:["pan2d","lasso2d","select2d"],scrollZoom:!0}),await ae.Plots.resize(H)),X("Growth rate analysis completed successfully!",{type:"success"})}catch(W){console.error("Error generating growth rate analysis:",W);let f="Failed to generate growth rate analysis";((y=W.response)==null?void 0:y.status)===404?f="No data found for selected vials":((u=W.response)==null?void 0:u.status)===400?f=((O=W.response.data)==null?void 0:O.detail)||"Invalid parameters":(D=(E=W.response)==null?void 0:E.data)!=null&&D.detail&&(f=W.response.data.detail),X(f,{type:"error"})}finally{A.value=!1}}});return Fe(n,async(y,u)=>{if(JSON.stringify(y)!==JSON.stringify(u)&&(T.value=null,$.value=null),y.length>0){const O=[...y].sort((E,D)=>parseInt(E)-parseInt(D));await Se(O)}else K.value=null,z.value={},V.value={}}),Ce(()=>{_e(),Z.startMemoryMonitoring()}),Ge(()=>{Z.cleanup()}),(y,u)=>{const O=m("v-icon"),E=m("v-card-title"),D=m("v-card-text"),W=m("v-card");return i(),d("div",rl,[a("div",dl,[u[16]||(u[16]=a("div",{class:"section-title"},[a("h2",null,"Growth Rate Analysis"),a("p",null,"Advanced growth rate analysis with configurable smoothing, windowing, and filtering")],-1)),e($e,{selectedVials:n.value,availableVials:v.value,vialColors:ie,"onUpdate:selectedVials":we,onSelectAllVials:pe,onClearVialSelection:fe},null,8,["selectedVials","availableVials"]),e(Be,{enableTrimming:q.value,enableOdTrimming:j.value,enableOutlierRemoval:s.value,smoothingMethod:C.value,smoothingWindow:p.value,outlierThreshold:M.value,outlierWindowSize:I.value,trimSettings:z.value,odTrimSettings:V.value,dataTimeRanges:K.value,isLoadingTimeRanges:oe.value,sortedSelectedVials:h.value,vialColors:ie,smoothingMethods:ge,canGenerateFilteredData:re.value,isGeneratingFilteredData:x.value,filteredDataResults:T.value,getFilteredDataDisabledReason:ye,"onUpdate:enableTrimming":u[0]||(u[0]=f=>q.value=f),"onUpdate:enableOdTrimming":u[1]||(u[1]=f=>j.value=f),"onUpdate:enableOutlierRemoval":u[2]||(u[2]=f=>s.value=f),"onUpdate:smoothingMethod":u[3]||(u[3]=f=>C.value=f),"onUpdate:smoothingWindow":u[4]||(u[4]=f=>p.value=f),"onUpdate:outlierThreshold":u[5]||(u[5]=f=>M.value=f),"onUpdate:outlierWindowSize":u[6]||(u[6]=f=>I.value=f),"onUpdate:trimSettings":u[7]||(u[7]=f=>z.value=f),"onUpdate:odTrimSettings":u[8]||(u[8]=f=>V.value=f),onGenerateFilteredData:ve(Te)},null,8,["enableTrimming","enableOdTrimming","enableOutlierRemoval","smoothingMethod","smoothingWindow","outlierThreshold","outlierWindowSize","trimSettings","odTrimSettings","dataTimeRanges","isLoadingTimeRanges","sortedSelectedVials","canGenerateFilteredData","isGeneratingFilteredData","filteredDataResults","onGenerateFilteredData"]),T.value?(i(),B(W,{key:0,class:"mb-4"},{default:l(()=>[e(E,{class:"step-title"},{default:l(()=>[e(O,{class:"mr-2"},{default:l(()=>u[14]||(u[14]=[r("mdi-trending-up")])),_:1}),u[15]||(u[15]=r(" Step 2: Growth Rate Calculation "))]),_:1}),e(D,null,{default:l(()=>[e(Xe,{modelType:w.value,"onUpdate:modelType":u[9]||(u[9]=f=>w.value=f),useSlidingWindow:o.value,"onUpdate:useSlidingWindow":u[10]||(u[10]=f=>o.value=f),analysisMethod:S.value,"onUpdate:analysisMethod":u[11]||(u[11]=f=>S.value=f),windowSize:k.value,"onUpdate:windowSize":u[12]||(u[12]=f=>k.value=f),realtimeMode:g.value,"onUpdate:realtimeMode":u[13]||(u[13]=f=>g.value=f),canRunAnalysis:de.value,isGeneratingGrowthRateAnalysis:A.value,onGenerateGrowthRateAnalysis:ve(ke)},null,8,["modelType","useSlidingWindow","analysisMethod","windowSize","realtimeMode","canRunAnalysis","isGeneratingGrowthRateAnalysis","onGenerateGrowthRateAnalysis"])]),_:1})]),_:1})):b("",!0),e(sl,{analysisResults:$.value,modelType:N.value,currentlyCalculatingModel:w.value,useSlidingWindow:o.value,sortedAnalysisResults:R.value,vialColors:ie,isGeneratingGrowthRateAnalysis:A.value,hasCurrentExperiment:ee.value,formatNumber:be,formatTimestamp:xe,formatGrowthRateWithCI:he},null,8,["analysisResults","modelType","currentlyCalculatingModel","useSlidingWindow","sortedAnalysisResults","isGeneratingGrowthRateAnalysis","hasCurrentExperiment"])])])}}},vl=Q(ul,[["__scopeId","data-v-f1e817ed"]]);export{vl as default};
