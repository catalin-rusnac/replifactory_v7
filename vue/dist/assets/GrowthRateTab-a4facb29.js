import{_ as J,r as m,o as s,j as U,q as l,f as e,s as d,c as r,F as H,i as ae,a,n as X,t as T,d as p,h as L,e as ee,x as P,w as de,V as re,g as Se,B as Te,k as M,A as ke,m as Re,S as te,l as Q,L as ue}from"./index-dba55fd0.js";import{P as le}from"./plotly-afc049ba.js";const Me={key:0,class:"text-grey"},Fe={class:"mt-2"},We={__name:"VialSelection",props:{selectedVials:{type:Array,required:!0},availableVials:{type:Array,required:!0},vialColors:{type:Object,required:!0}},emits:["update:selectedVials","selectAllVials","clearVialSelection"],setup(t,{emit:I}){const b=t,n=I,S=(C,v)=>{const o=v?[...b.selectedVials,C]:b.selectedVials.filter(f=>f!==C);n("update:selectedVials",o)},F=()=>{n("selectAllVials")},k=()=>{n("clearVialSelection")};return(C,v)=>{const o=m("v-icon"),f=m("v-card-title"),x=m("v-checkbox"),$=m("v-col"),N=m("v-row"),R=m("v-btn"),g=m("v-card-text"),i=m("v-card");return s(),U(i,{class:"mb-4"},{default:l(()=>[e(f,{class:"vial-selection-title"},{default:l(()=>[e(o,{class:"mr-2"},{default:l(()=>v[0]||(v[0]=[d("mdi-test-tube")])),_:1}),v[1]||(v[1]=d(" Select Vials for Analysis "))]),_:1}),e(g,null,{default:l(()=>[e(N,null,{default:l(()=>[(s(),r(H,null,ae(7,_=>e($,{key:_,cols:"auto"},{default:l(()=>[e(x,{"model-value":t.selectedVials.includes(_),"onUpdate:modelValue":E=>S(_,E),label:`Vial ${_}`,disabled:!t.availableVials.includes(_),color:t.vialColors[_],class:"vial-checkbox"},{label:l(()=>[a("div",{class:"vial-label",style:X({color:t.vialColors[_]})},[e(o,{color:t.vialColors[_],size:"small",class:"mr-1"},{default:l(()=>v[2]||(v[2]=[d("mdi-circle")])),_:2},1032,["color"]),d(" Vial "+T(_)+" ",1),t.availableVials.includes(_)?p("",!0):(s(),r("span",Me,"(no data)"))],4)]),_:2},1032,["model-value","onUpdate:modelValue","label","disabled","color"])]),_:2},1024)),64))]),_:1}),a("div",Fe,[e(R,{size:"small",variant:"outlined",onClick:F,disabled:t.availableVials.length===0,class:"mr-2"},{default:l(()=>v[3]||(v[3]=[d(" Select All ")])),_:1},8,["disabled"]),e(R,{size:"small",variant:"outlined",onClick:k},{default:l(()=>v[4]||(v[4]=[d(" Clear All ")])),_:1})])]),_:1})]),_:1})}}},Ce=J(We,[["__scopeId","data-v-bc4eb7cb"]]);const Ge={key:0,class:"ml-2"},ze={class:"text-center mt-4"},Ae={key:0,class:"mt-2 text-grey"},De={__name:"DataFiltering",props:{enableTrimming:{type:Boolean,default:!1},enableOdTrimming:{type:Boolean,default:!1},enableOutlierRemoval:{type:Boolean,default:!1},smoothingMethod:{type:String,default:"none"},smoothingWindow:{type:Number,default:10},outlierThreshold:{type:Number,default:1},outlierWindowSize:{type:Number,default:5},dataTimeRanges:{type:Object,default:()=>({})},isLoadingTimeRanges:{type:Boolean,default:!1},sortedSelectedVials:{type:Array,default:()=>[]},vialColors:{type:Object,default:()=>({})},trimSettings:{type:Object,default:()=>({})},odTrimSettings:{type:Object,default:()=>({})},smoothingMethods:{type:Array,default:()=>[]},canGenerateFilteredData:{type:Boolean,default:!1},isGeneratingFilteredData:{type:Boolean,default:!1},filteredDataResults:{type:Object,default:()=>({})},getFilteredDataDisabledReason:{type:Function,default:()=>""}},emits:["update:enableTrimming","update:enableOdTrimming","update:enableOutlierRemoval","update:smoothingMethod","update:smoothingWindow","update:outlierThreshold","update:outlierWindowSize","update:trimSettings","update:odTrimSettings","generateFilteredData"],setup(t,{emit:I}){const b=t,n=I,S=L({get:()=>b.enableTrimming,set:v=>n("update:enableTrimming",v)}),F=L(()=>Array.isArray(b.sortedSelectedVials)?b.sortedSelectedVials:[]),k=(v,o,f)=>{const x={...b.trimSettings};x[v]={...x[v],[o]:f},n("update:trimSettings",x)},C=(v,o,f)=>{const x={...b.odTrimSettings};x[v]={...x[v],[o]:f},n("update:odTrimSettings",x)};return(v,o)=>{const f=m("v-icon"),x=m("v-card-title"),$=m("v-checkbox"),N=m("v-alert"),R=m("v-col"),g=m("v-text-field"),i=m("v-row"),_=m("v-card-text"),E=m("v-expand-transition"),B=m("v-card"),G=m("v-tooltip"),j=m("v-select"),O=m("v-btn");return s(),r(H,null,[e(B,{class:"mb-4"},{default:l(()=>[e(x,{class:"step-title"},{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>o[9]||(o[9]=[d("mdi-filter-variant")])),_:1}),o[10]||(o[10]=d(" Step 1: Data Filtering and Smoothing "))]),_:1}),e(_,null,{default:l(()=>[e(B,{class:ee(["mb-3",{"border-enabled":t.enableOdTrimming,"border-disabled":!t.enableOdTrimming}]),elevation:t.enableOdTrimming?3:1},{default:l(()=>[e(x,{class:"d-flex align-center pa-3"},{default:l(()=>[e($,{"model-value":t.enableOdTrimming,"onUpdate:modelValue":o[0]||(o[0]=w=>v.$emit("update:enableOdTrimming",w)),color:"primary","hide-details":"",class:"mr-3"},null,8,["model-value"]),e(f,{class:"mr-2",color:"primary"},{default:l(()=>o[11]||(o[11]=[d("mdi-chart-line")])),_:1}),o[12]||(o[12]=a("span",{class:"text-h6"},"OD Range Trimming",-1))]),_:1}),e(E,null,{default:l(()=>[t.enableOdTrimming?(s(),U(_,{key:0,class:"pt-0",style:{"padding-left":"16px","padding-right":"16px"}},{default:l(()=>[e(N,{type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>o[13]||(o[13]=[d("mdi-information")])),_:1}),o[14]||(o[14]=d(" Set the OD range for analysis. Data outside this range will be excluded. "))]),_:1}),(s(!0),r(H,null,ae(F.value,w=>(s(),r(H,{key:`od-${w}`},[w&&t.odTrimSettings&&t.odTrimSettings[w]?(s(),U(i,{key:0,class:"mt-2"},{default:l(()=>[e(R,{cols:"2",class:"d-flex align-center"},{default:l(()=>[a("span",{style:X({color:t.vialColors[w]}),class:"font-weight-bold"}," Vial "+T(w)+": ",5)]),_:2},1024),e(R,{cols:"5"},{default:l(()=>{var h;return[e(g,{"model-value":((h=t.odTrimSettings[w])==null?void 0:h.min)||0,"onUpdate:modelValue":A=>C(w,"min",parseFloat(A)),label:"Min OD",type:"number",step:"0.01",min:"0",max:"2",density:"compact",hint:"Minimum OD value (0 will exclude OD=0 datapoints)","persistent-hint":""},null,8,["model-value","onUpdate:modelValue"])]}),_:2},1024),e(R,{cols:"5"},{default:l(()=>{var h;return[e(g,{"model-value":((h=t.odTrimSettings[w])==null?void 0:h.max)||2,"onUpdate:modelValue":A=>C(w,"max",parseFloat(A)),label:"Max OD",type:"number",step:"0.01",min:"0",max:"2",density:"compact",hint:"Maximum OD value","persistent-hint":""},null,8,["model-value","onUpdate:modelValue"])]}),_:2},1024)]),_:2},1024)):p("",!0)],64))),128))]),_:1})):p("",!0)]),_:1})]),_:1},8,["class","elevation"]),e(B,{class:ee(["mb-3",{"border-enabled":t.enableTrimming,"border-disabled":!t.enableTrimming}]),elevation:t.enableTrimming?3:1},{default:l(()=>[e(x,{class:"d-flex align-center pa-3"},{default:l(()=>[e($,{modelValue:S.value,"onUpdate:modelValue":o[1]||(o[1]=w=>S.value=w),color:"primary","hide-details":"",class:"mr-3",density:"compact"},null,8,["modelValue"]),e(f,{class:"mr-2",color:"primary"},{default:l(()=>o[15]||(o[15]=[d("mdi-content-cut")])),_:1}),o[16]||(o[16]=a("span",{class:"text-h6"},"Manual Time Trimming",-1))]),_:1}),e(E,null,{default:l(()=>[t.enableTrimming?(s(),U(_,{key:0,class:"pt-0"},{default:l(()=>{var w;return[(w=t.dataTimeRanges)!=null&&w.overall?(s(),U(N,{key:0,type:"success",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>o[17]||(o[17]=[d("mdi-database-clock")])),_:1}),o[18]||(o[18]=a("strong",null,"Available data:",-1)),d(" "+T(t.dataTimeRanges.overall.min_datetime)+" to "+T(t.dataTimeRanges.overall.max_datetime)+" ("+T(t.dataTimeRanges.overall.duration_hours)+" hours) ",1)]),_:1})):t.isLoadingTimeRanges?(s(),U(N,{key:1,type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>o[19]||(o[19]=[d("mdi-loading mdi-spin")])),_:1}),o[20]||(o[20]=d(" Loading data time ranges... "))]),_:1})):(s(),U(N,{key:2,type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>o[21]||(o[21]=[d("mdi-information")])),_:1}),o[22]||(o[22]=d(" Time ranges are automatically set to your actual experiment data. Adjust as needed for your analysis window. "))]),_:1})),(s(!0),r(H,null,ae(F.value,h=>(s(),r(H,{key:h},[h&&t.trimSettings&&t.trimSettings[h]?(s(),U(i,{key:0,class:"mt-2"},{default:l(()=>[e(R,{cols:"2",class:"d-flex align-center"},{default:l(()=>{var A,D;return[a("span",{style:X({color:t.vialColors[h]}),class:"font-weight-bold"}," Vial "+T(h)+": ",5),(D=(A=t.dataTimeRanges)==null?void 0:A.vials)!=null&&D[h]?(s(),r("div",Ge,[e(G,{bottom:""},{activator:l(({props:K})=>[e(f,P({ref_for:!0},K,{size:"small",color:"grey"}),{default:l(()=>o[23]||(o[23]=[d("mdi-information")])),_:2},1040)]),default:l(()=>[a("div",null,[a("strong",null,"Vial "+T(h)+" data:",1),o[24]||(o[24]=a("br",null,null,-1)),d(" "+T(t.dataTimeRanges.vials[h].min_datetime)+" to",1),o[25]||(o[25]=a("br",null,null,-1)),d(" "+T(t.dataTimeRanges.vials[h].max_datetime),1),o[26]||(o[26]=a("br",null,null,-1)),d(" ("+T(t.dataTimeRanges.vials[h].data_points)+" points) ",1)])]),_:2},1024)])):p("",!0)]}),_:2},1024),e(R,{cols:"5"},{default:l(()=>{var A;return[e(g,{"model-value":((A=t.trimSettings[h])==null?void 0:A.start)||"","onUpdate:modelValue":D=>k(h,"start",D),label:"Start Time",type:"datetime-local",density:"compact",hint:"Start of analysis window",loading:t.isLoadingTimeRanges},null,8,["model-value","onUpdate:modelValue","loading"])]}),_:2},1024),e(R,{cols:"5"},{default:l(()=>{var A;return[e(g,{"model-value":((A=t.trimSettings[h])==null?void 0:A.end)||"","onUpdate:modelValue":D=>k(h,"end",D),label:"End Time",type:"datetime-local",density:"compact",hint:"End of analysis window",loading:t.isLoadingTimeRanges},null,8,["model-value","onUpdate:modelValue","loading"])]}),_:2},1024)]),_:2},1024)):p("",!0)],64))),128))]}),_:1})):p("",!0)]),_:1})]),_:1},8,["class","elevation"]),e(B,{class:ee(["mb-3",{"border-enabled":t.enableOutlierRemoval,"border-disabled":!t.enableOutlierRemoval}]),elevation:t.enableOutlierRemoval?3:1},{default:l(()=>[e(x,{class:"d-flex align-center pa-3"},{default:l(()=>[e($,{"model-value":t.enableOutlierRemoval,"onUpdate:modelValue":o[2]||(o[2]=w=>v.$emit("update:enableOutlierRemoval",w)),color:"warning","hide-details":"",class:"mr-3"},null,8,["model-value"]),e(f,{class:"mr-2",color:"warning"},{default:l(()=>o[27]||(o[27]=[d("mdi-target")])),_:1}),o[28]||(o[28]=a("span",{class:"text-h6"},"Outlier Removal",-1))]),_:1}),e(E,null,{default:l(()=>[t.enableOutlierRemoval?(s(),U(_,{key:0,class:"pt-0"},{default:l(()=>[e(i,null,{default:l(()=>[e(R,{cols:"6"},{default:l(()=>[e(g,{"model-value":t.outlierThreshold,"onUpdate:modelValue":o[3]||(o[3]=w=>v.$emit("update:outlierThreshold",parseFloat(w))),label:"Outlier Threshold (Z-score)",type:"number",min:"0.5",max:"5.0",step:"0.1",hint:"Higher values are more forgiving","persistent-hint":""},null,8,["model-value"])]),_:1}),e(R,{cols:"6"},{default:l(()=>[e(g,{"model-value":t.outlierWindowSize,"onUpdate:modelValue":o[4]||(o[4]=w=>v.$emit("update:outlierWindowSize",parseInt(w))),label:"Rolling Window Size",type:"number",min:"3",max:"20",step:"1",hint:"Number of nearby points to compare (5 = recommended)","persistent-hint":""},null,8,["model-value"])]),_:1})]),_:1}),e(N,{type:"info",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>o[29]||(o[29]=[d("mdi-information")])),_:1}),o[30]||(o[30]=d(" Uses rolling window approach: compares each point to nearby points and interpolates outliers. "))]),_:1})]),_:1})):p("",!0)]),_:1})]),_:1},8,["class","elevation"]),e(B,{class:ee(["mb-3",{"border-enabled":t.smoothingMethod!=="none","border-disabled":t.smoothingMethod==="none"}]),elevation:t.smoothingMethod!=="none"?3:1},{default:l(()=>[e(x,{class:"d-flex align-center pa-3"},{default:l(()=>[e($,{"model-value":t.smoothingMethod!=="none","onUpdate:modelValue":o[5]||(o[5]=w=>v.$emit("update:smoothingMethod",w?"median":"none")),color:"success","hide-details":"",class:"mr-3"},null,8,["model-value"]),e(f,{class:"mr-2",color:"success"},{default:l(()=>o[31]||(o[31]=[d("mdi-blur")])),_:1}),o[32]||(o[32]=a("span",{class:"text-h6"},"Data Smoothing",-1))]),_:1}),e(E,null,{default:l(()=>[t.smoothingMethod!=="none"?(s(),U(_,{key:0,class:"pt-0"},{default:l(()=>[e(i,null,{default:l(()=>[e(R,{cols:"6"},{default:l(()=>[e(j,{"model-value":t.smoothingMethod,"onUpdate:modelValue":o[6]||(o[6]=w=>v.$emit("update:smoothingMethod",w)),items:t.smoothingMethods.filter(w=>w.value!=="none"),label:"Smoothing Method","item-title":"label","item-value":"value"},null,8,["model-value","items"])]),_:1}),e(R,{cols:"6"},{default:l(()=>[e(g,{"model-value":t.smoothingWindow,"onUpdate:modelValue":o[7]||(o[7]=w=>v.$emit("update:smoothingWindow",w)),label:"Smoothing Window Size",type:"number",min:"3",max:"50",step:"2",hint:"Number of points for smoothing filter","persistent-hint":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})):p("",!0)]),_:1})]),_:1},8,["class","elevation"]),a("div",ze,[e(O,{color:"primary",size:"large",onClick:o[8]||(o[8]=w=>v.$emit("generateFilteredData")),disabled:!t.canGenerateFilteredData,loading:t.isGeneratingFilteredData,class:"generate-filtered-btn"},{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>o[33]||(o[33]=[d("mdi-chart-line")])),_:1}),o[34]||(o[34]=d(" Show Processed OD Data "))]),_:1},8,["disabled","loading"]),t.canGenerateFilteredData?p("",!0):(s(),r("div",Ae,T(t.getFilteredDataDisabledReason()),1))])]),_:1})]),_:1}),t.filteredDataResults?(s(),U(B,{key:0,class:"mb-4"},{default:l(()=>[e(x,null,{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>o[35]||(o[35]=[d("mdi-chart-line")])),_:1}),o[36]||(o[36]=d(" Processed OD Data "))]),_:1}),e(_,null,{default:l(()=>o[37]||(o[37]=[a("div",{class:"plot-wrapper"},[a("div",{id:"filtered-od-plot-container",class:"plot-container-small"})],-1)])),_:1})]),_:1})):p("",!0)],64)}}},Ve=J(De,[["__scopeId","data-v-e9d25b08"]]);const Oe={class:"ml-6 mt-2"},$e={class:"d-flex align-center"},Ne={key:0,class:"ml-6 mt-2"},Ue={class:"ml-6 mt-2 mb-2"},Be={__name:"ExponentialModelOptions",props:{modelType:{type:String,required:!0},useSlidingWindow:{type:Boolean,required:!0},analysisMethod:{type:String,required:!0},windowSize:{type:Number,required:!0},realtimeMode:{type:Boolean,required:!0}},emits:["update:useSlidingWindow","update:analysisMethod","update:windowSize","update:realtimeMode"],setup(t,{emit:I}){return(b,n)=>{const S=m("v-btn"),F=m("v-card-title"),k=m("v-card-text"),C=m("v-spacer"),v=m("v-card-actions"),o=m("v-card"),f=m("v-dialog"),x=m("v-checkbox"),$=m("v-radio"),N=m("v-text-field"),R=m("v-radio-group");return de((s(),r("div",Oe,[a("div",$e,[e(x,{"model-value":t.useSlidingWindow,"onUpdate:modelValue":n[0]||(n[0]=g=>b.$emit("update:useSlidingWindow",g)),color:"primary",density:"compact"},{label:l(()=>[n[7]||(n[7]=a("span",null,"Use sliding window analysis",-1)),e(f,{"max-width":"400"},{activator:l(({props:g})=>[e(S,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},g,{class:"ml-1",style:{"vertical-align":"middle"}}),null,16)]),default:l(({isActive:g})=>[e(o,null,{default:l(()=>[e(F,{class:"text-h6"},{default:l(()=>n[4]||(n[4]=[d("Sliding Window Analysis")])),_:1}),e(k,null,{default:l(()=>n[5]||(n[5]=[a("p",{class:"text-body-2"}," Fits exponential curves in small overlapping windows around each timepoint to track how growth rate changes throughout the experiment. Creates a plot showing growth rate vs time. ",-1)])),_:1}),e(v,null,{default:l(()=>[e(C),e(S,{text:"",onClick:i=>g.value=!1},{default:l(()=>n[6]||(n[6]=[d("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["model-value"])]),t.useSlidingWindow?(s(),r("div",Ne,[e(R,{"model-value":t.analysisMethod,"onUpdate:modelValue":n[2]||(n[2]=g=>b.$emit("update:analysisMethod",g)),class:"mt-0",density:"compact"},{default:l(()=>[e($,{value:"adaptive",color:"primary",density:"compact"},{label:l(()=>[n[11]||(n[11]=a("span",null,"Adaptive Window Size",-1)),e(f,{"max-width":"450"},{activator:l(({props:g})=>[e(S,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},g,{class:"ml-1",style:{"vertical-align":"middle"}}),null,16)]),default:l(({isActive:g})=>[e(o,null,{default:l(()=>[e(F,{class:"text-h6"},{default:l(()=>n[8]||(n[8]=[d("Adaptive Windowing for Growth Rate Estimation")])),_:1}),e(k,null,{default:l(()=>n[9]||(n[9]=[a("p",{class:"text-body-2 mb-3"}," This method uses a dynamically adjusted window size, based on iterative convergence to approximately ½ the doubling time. It improves accuracy over fixed window sizes (e.g., 40 minutes), especially across a wide range of growth rates. ",-1),a("div",{class:"mb-3"},[a("h4",{class:"text-subtitle-2 mb-2",style:{color:"#d32f2f"}},"🔧 Why Fixed Windows Fall Short"),a("div",{class:"text-body-2 ml-4"},[a("p",null,"Too short during slow growth → noisy, unstable estimates (not enough change in OD)."),a("p",null,"Too long during fast growth → smooths over real dynamics, reducing time resolution."),a("p",null,"Fixed size doesn't adapt to changes in growth rate, leading to inaccurate measurements.")])],-1),a("div",{class:"mb-3"},[a("h4",{class:"text-subtitle-2 mb-2",style:{color:"#388e3c"}},"✅ Why Adaptive Windowing Works Better"),a("div",{class:"text-body-2 ml-4"},[a("p",null,"Scales with growth: Window converges to ~½ the doubling time, matching system timescale."),a("p",null,"Balances noise and resolution: Captures meaningful change without over-smoothing."),a("p",null,"Self-tuning: Iterative algorithm adjusts window size based on current growth behavior."),a("p",null,"Robust across conditions: Handles shifts in metabolism, population structure, and stress responses.")])],-1)])),_:1}),e(v,null,{default:l(()=>[e(C),e(S,{text:"",onClick:i=>g.value=!1},{default:l(()=>n[10]||(n[10]=[d("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1}),e($,{value:"fixed",color:"primary",density:"compact"},{label:l(()=>[n[15]||(n[15]=a("span",null,"Constant Window Size",-1)),e(f,{"max-width":"400"},{activator:l(({props:g})=>[e(S,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},g,{class:"ml-1",style:{"vertical-align":"middle"}}),null,16)]),default:l(({isActive:g})=>[e(o,null,{default:l(()=>[e(F,{class:"text-h6"},{default:l(()=>n[12]||(n[12]=[d("Constant Window Size")])),_:1}),e(k,null,{default:l(()=>n[13]||(n[13]=[a("p",{class:"text-body-2 mb-3"}," Uses a fixed window size for all timepoints. Provides consistent analysis windows but may not be optimal for all growth phases. ",-1),a("div",{class:"mb-3"},[a("h4",{class:"text-subtitle-2 mb-2",style:{color:"#1976d2"}},"📏 When to Use Fixed Windows"),a("ul",{class:"text-body-2 ml-4"},[a("li",null,[a("strong",null,"Known growth conditions:"),d(" When doubling time is expected to be stable")]),a("li",null,[a("strong",null,"Comparative analysis:"),d(" When you want identical window sizes across experiments")]),a("li",null,[a("strong",null,"Simple interpretation:"),d(" Easier to understand and explain results")])])],-1),a("div",{class:"text-body-2"},[a("strong",null,"Window Size Guidelines:"),a("ul",{class:"ml-4 mt-2"},[a("li",null,"30-60 minutes for fast growth (td ~30-60 min)"),a("li",null,"60-120 minutes for moderate growth (td ~2-4 hours)"),a("li",null,"120+ minutes for slow growth (td >4 hours)")])],-1)])),_:1}),e(v,null,{default:l(()=>[e(C),e(S,{text:"",onClick:i=>g.value=!1},{default:l(()=>n[14]||(n[14]=[d("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1}),de(a("div",Ue,[e(N,{"model-value":t.windowSize,"onUpdate:modelValue":n[1]||(n[1]=g=>b.$emit("update:windowSize",parseInt(g))),label:"Window Size",type:"number",min:"10",max:"1440",step:"5",suffix:"minutes",density:"compact",style:{"max-width":"200px"}},null,8,["model-value"])],512),[[re,t.analysisMethod==="fixed"]])]),_:1},8,["model-value"]),e(x,{"model-value":t.realtimeMode,"onUpdate:modelValue":n[3]||(n[3]=g=>b.$emit("update:realtimeMode",g)),color:"primary",density:"compact",class:"mt-2"},{label:l(()=>[n[19]||(n[19]=a("span",null,"Real-time calculation mode",-1)),e(f,{"max-width":"450"},{activator:l(({props:g})=>[e(S,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},g,{class:"ml-1",style:{"vertical-align":"middle"}}),null,16)]),default:l(({isActive:g})=>[e(o,null,{default:l(()=>[e(F,{class:"text-h6"},{default:l(()=>n[16]||(n[16]=[d("Real-time vs Retrospective Analysis")])),_:1}),e(k,null,{default:l(()=>n[17]||(n[17]=[a("div",{class:"mb-3"},[a("h4",{class:"text-subtitle-1 mb-2",style:{color:"#1976d2"}},"Real-time Mode (Past Data Only)"),a("p",{class:"text-body-2"}," Uses only past data up to each timepoint, exactly replicating the experiment's real-time calculation. Producer noisier results. ")],-1),a("div",null,[a("h4",{class:"text-subtitle-1 mb-2",style:{color:"#388e3c"}},"Retrospective Mode (Past + Future Data)"),a("p",{class:"text-body-2"}," Uses both past and future data around each timepoint for smoother, more accurate analysis. Ideal for post-experiment analysis when the complete dataset is available. ")],-1)])),_:1}),e(v,null,{default:l(()=>[e(C),e(S,{text:"",onClick:i=>g.value=!1},{default:l(()=>n[18]||(n[18]=[d("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["model-value"])])):p("",!0)],512)),[[re,t.modelType==="exponential"]])}}},qe=J(Be,[["__scopeId","data-v-95e2647b"]]);const Ee={class:"d-flex align-center",style:{width:"300px"}},Ie={class:"d-flex align-center",style:{width:"300px"}},Pe={class:"d-flex align-center",style:{width:"300px"}},je={class:"text-center mt-4"},Le={__name:"GrowthModelSelection",props:{modelType:{type:String,required:!0},useSlidingWindow:{type:Boolean,required:!0},analysisMethod:{type:String,required:!0},windowSize:{type:Number,required:!0},realtimeMode:{type:Boolean,required:!0},canRunAnalysis:{type:Boolean,required:!0},isGeneratingGrowthRateAnalysis:{type:Boolean,required:!0}},emits:["update:modelType","update:useSlidingWindow","update:analysisMethod","update:windowSize","update:realtimeMode","generateGrowthRateAnalysis"],setup(t,{emit:I}){return(b,n)=>{const S=m("v-radio"),F=m("v-spacer"),k=m("v-btn"),C=m("v-card-title"),v=m("v-card-text"),o=m("v-card-actions"),f=m("v-card"),x=m("v-dialog"),$=m("v-radio-group"),N=m("v-col"),R=m("v-row"),g=m("v-icon");return s(),r("div",null,[e(R,null,{default:l(()=>[e(N,{cols:"6"},{default:l(()=>[n[15]||(n[15]=a("div",{class:"text-subtitle-1 font-weight-medium mb-2 px-0"},"Growth Model",-1)),e($,{"model-value":t.modelType,"onUpdate:modelValue":n[0]||(n[0]=i=>b.$emit("update:modelType",i)),class:"mt-0"},{default:l(()=>[a("div",Ee,[e(S,{value:"exponential",label:"Exponential Model",color:"secondary",style:{flex:"0 0 auto"}}),e(F),e(x,{"max-width":"400"},{activator:l(({props:i})=>[e(k,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},i,{style:{"margin-left":"8px"}}),null,16)]),default:l(({isActive:i})=>[e(f,null,{default:l(()=>[e(C,{class:"text-h6"},{default:l(()=>n[6]||(n[6]=[d("Exponential Growth Model")])),_:1}),e(v,null,{default:l(()=>n[7]||(n[7]=[a("div",{class:"formula-display mb-3"},[a("div",{class:"text-center"},[a("div",{class:"formula-math-large"},[a("em",null,"N"),d("("),a("em",null,"t"),d(") = "),a("em",null,"N"),d("₀ × "),a("em",null,"e"),a("sup",null,[a("em",null,"rt")])]),a("div",{class:"text-caption mt-2"},[d(" where "),a("em",null,"N"),d("₀ = initial OD, "),a("em",null,"r"),d(" = growth rate (/hr), "),a("em",null,"t"),d(" = time (hr) ")])])],-1),a("p",{class:"text-body-2"}," Models unlimited exponential growth. Best for early growth phases or when growth rate is constant. ",-1)])),_:1}),e(o,null,{default:l(()=>[e(F),e(k,{text:"",onClick:_=>i.value=!1},{default:l(()=>n[8]||(n[8]=[d("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),a("div",Ie,[e(S,{value:"logistic",label:"Logistic Model",color:"secondary",style:{flex:"0 0 auto"}}),e(F),e(x,{"max-width":"400"},{activator:l(({props:i})=>[e(k,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},i,{style:{"margin-left":"8px"}}),null,16)]),default:l(({isActive:i})=>[e(f,null,{default:l(()=>[e(C,{class:"text-h6"},{default:l(()=>n[9]||(n[9]=[d("Logistic Growth Model")])),_:1}),e(v,null,{default:l(()=>n[10]||(n[10]=[a("div",{class:"formula-display mb-3"},[a("div",{class:"text-center"},[a("div",{class:"formula-math-large"},[a("em",null,"N"),d("("),a("em",null,"t"),d(") = "),a("em",null,"K"),d(" / (1 + (("),a("em",null,"K"),d(" - "),a("em",null,"N"),d("₀) / "),a("em",null,"N"),d("₀) × "),a("em",null,"e"),a("sup",null,[d("-"),a("em",null,"rt")]),d(") ")]),a("div",{class:"text-caption mt-2"},[d(" where "),a("em",null,"N"),d("₀ = initial OD, "),a("em",null,"K"),d(" = carrying capacity, "),a("em",null,"r"),d(" = growth rate (/hr), "),a("em",null,"t"),d(" = time (hr) ")])])],-1),a("p",{class:"text-body-2"}," S-shaped growth curve with carrying capacity. Growth rate decreases as population approaches the carrying capacity limit. ",-1)])),_:1}),e(o,null,{default:l(()=>[e(F),e(k,{text:"",onClick:_=>i.value=!1},{default:l(()=>n[11]||(n[11]=[d("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),a("div",Pe,[e(S,{value:"gompertz",label:"Gompertz Model",color:"secondary",style:{flex:"0 0 auto"}}),e(F),e(x,{"max-width":"400"},{activator:l(({props:i})=>[e(k,P({icon:"mdi-information-outline",variant:"text",size:"x-small",color:"grey"},i,{style:{"margin-left":"8px"}}),null,16)]),default:l(({isActive:i})=>[e(f,null,{default:l(()=>[e(C,{class:"text-h6"},{default:l(()=>n[12]||(n[12]=[d("Gompertz Growth Model")])),_:1}),e(v,null,{default:l(()=>n[13]||(n[13]=[a("div",{class:"formula-display mb-3"},[a("div",{class:"text-center"},[a("div",{class:"formula-math-large"},[a("em",null,"N"),d("("),a("em",null,"t"),d(") = "),a("em",null,"A"),d(" × "),a("em",null,"e"),a("sup",null,[d("-"),a("em",null,"e"),a("sup",null,[d("-"),a("em",null,"C"),d("("),a("em",null,"t"),d("-"),a("em",null,"B"),d(")")])])]),a("div",{class:"text-caption mt-2"},[d(" where "),a("em",null,"A"),d(" = carrying capacity, "),a("em",null,"B"),d(" = inflection time (hr), "),a("em",null,"C"),d(" = growth rate (/hr), "),a("em",null,"t"),d(" = time (hr) ")])])],-1),a("p",{class:"text-body-2"}," Asymmetric S-curve with distinct lag phase and faster deceleration. Common for bacterial growth patterns. ",-1)])),_:1}),e(o,null,{default:l(()=>[e(F),e(k,{text:"",onClick:_=>i.value=!1},{default:l(()=>n[14]||(n[14]=[d("Close")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})])]),_:1},8,["model-value"])]),_:1})]),_:1}),e(qe,{modelType:t.modelType,useSlidingWindow:t.useSlidingWindow,analysisMethod:t.analysisMethod,windowSize:t.windowSize,realtimeMode:t.realtimeMode,"onUpdate:useSlidingWindow":n[1]||(n[1]=i=>b.$emit("update:useSlidingWindow",i)),"onUpdate:analysisMethod":n[2]||(n[2]=i=>b.$emit("update:analysisMethod",i)),"onUpdate:windowSize":n[3]||(n[3]=i=>b.$emit("update:windowSize",i)),"onUpdate:realtimeMode":n[4]||(n[4]=i=>b.$emit("update:realtimeMode",i))},null,8,["modelType","useSlidingWindow","analysisMethod","windowSize","realtimeMode"]),a("div",je,[e(k,{color:"success",size:"x-large",onClick:n[5]||(n[5]=i=>b.$emit("generateGrowthRateAnalysis")),disabled:!t.canRunAnalysis,loading:t.isGeneratingGrowthRateAnalysis},{default:l(()=>[e(g,{class:"mr-2"},{default:l(()=>n[16]||(n[16]=[d("mdi-chart-line")])),_:1}),n[17]||(n[17]=d(" Generate Growth Rate Analysis "))]),_:1},8,["disabled","loading"])])])}}},Ke=J(Le,[["__scopeId","data-v-98c3bfbf"]]);const Ze={class:"results-content-container"},He={key:0,class:"selectable-header"},Je={key:1,class:"selectable-header"},Qe={key:2,class:"selectable-header"},Xe={key:3,class:"selectable-header"},Ye={key:4,class:"selectable-header"},et={key:5,class:"selectable-header"},tt={key:6,class:"selectable-header"},lt={key:7,class:"selectable-header"},at={key:8,class:"selectable-header"},nt={key:9,class:"selectable-header"},ot={key:10,class:"selectable-header"},it={key:0},st={key:0},dt={key:1,class:"text-error"},rt={key:2},ut={key:1},mt={key:0},ct={key:1,class:"text-error"},vt={key:2},gt={key:2},yt={key:0},pt={key:1,class:"text-error"},ft={key:2},wt={key:3},bt={key:0},ht={key:1,class:"text-error"},xt={key:2},_t={key:4},St={key:0},Tt={key:1,class:"text-error"},kt={key:2},Rt={key:5},Mt={key:0},Ft={key:1,class:"text-error"},Wt={key:2},Ct={key:6},Gt={key:0},zt={key:1,class:"text-error"},At={key:2},Dt={key:7},Vt={key:0},Ot={key:1,class:"text-error"},$t={key:2},Nt={key:8},Ut={key:0},Bt={key:1,class:"text-error"},qt={key:2},Et={key:9},It={key:1,class:"text-error"},Pt={key:2},jt={key:10},Lt={key:0},Kt={key:1,class:"text-error"},Zt={key:2},Ht={class:"text-center"},Jt={class:"text-subtitle-1"},Qt={key:0},Xt={key:1},Yt={key:2},el={__name:"AnalysisResults",props:{analysisResults:{type:Object,default:null},modelType:{type:String,required:!0},useSlidingWindow:{type:Boolean,required:!0},sortedAnalysisResults:{type:Array,required:!0},vialColors:{type:Object,required:!0},isGeneratingGrowthRateAnalysis:{type:Boolean,required:!0},hasCurrentExperiment:{type:Boolean,required:!0},formatNumber:{type:Function,required:!0},formatTimestamp:{type:Function,required:!0},formatGrowthRateWithCI:{type:Function,required:!0}},setup(t){const I=b=>b==null||isNaN(b)?"#666666":b>=.99?"#8BC34A":b>=.98?"#2E7D32":b>=.97?"#FFC107":b>=.95?"#FF9800":b>=.9?"#CDDC39":b>=.8?"#FF5722":b>=.7?"#E91E63":b>=.5?"#D32F2F":"#B71C1C";return(b,n)=>{const S=m("v-icon"),F=m("v-card-title"),k=m("v-tooltip"),C=m("v-table"),v=m("v-col"),o=m("v-row"),f=m("v-progress-circular"),x=m("v-overlay"),$=m("v-card-text"),N=m("v-card"),R=m("v-alert");return s(),r("div",null,[t.analysisResults?(s(),U(N,{key:0,class:"results-display"},{default:l(()=>[e(F,null,{default:l(()=>[e(S,{class:"mr-2"},{default:l(()=>n[0]||(n[0]=[d("mdi-chart-line")])),_:1}),n[1]||(n[1]=d(" Growth Rate Analysis Results "))]),_:1}),e($,null,{default:l(()=>[a("div",Ze,[t.analysisResults.summary?(s(),U(o,{key:0,class:"mb-4"},{default:l(()=>[e(v,{cols:"12"},{default:l(()=>[n[4]||(n[4]=a("h4",null,"Summary Statistics",-1)),e(C,{density:"compact"},{default:l(()=>[a("thead",null,[a("tr",null,[n[2]||(n[2]=a("th",{class:"selectable-header"},"Vial",-1)),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("th",He,"Max Growth Rate (/hr)")):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("th",Je,"Min Doubling Time (hr)")):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("th",Qe,"Avg Growth Rate (/hr)")):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("th",Xe,"Avg Doubling Time (hr)")):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("th",Ye,"Max Growth Rate Time")):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("th",et,"Growth Rate (/hr)")),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("th",tt,"Doubling Time (hr)")),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("th",lt,"Max Growth Rate Time")),t.modelType==="logistic"||t.modelType==="gompertz"?(s(),r("th",at,"Carrying Capacity")):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("th",nt,"R²")),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("th",ot,"RMSE")),n[3]||(n[3]=a("th",{class:"selectable-header"},"Data Points",-1))])]),a("tbody",null,[(s(!0),r(H,null,ae(t.sortedAnalysisResults,({vial:g,stats:i})=>(s(),r("tr",{key:g},[a("td",{style:X({color:t.vialColors[g]}),class:"font-weight-bold"},T(g),5),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("td",it,[i.model_success&&i.max_growth_rate!=null?(s(),r("span",st,T(t.formatNumber(i.max_growth_rate)),1)):i.model_success?(s(),r("span",rt,"-")):(s(),r("span",dt," Fit Failed "))])):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("td",ut,[i.model_success&&i.max_growth_doubling_time!=null?(s(),r("span",mt,T(t.formatNumber(i.max_growth_doubling_time,2)),1)):i.model_success?(s(),r("span",vt,"-")):(s(),r("span",ct," Fit Failed "))])):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("td",gt,[i.model_success&&i.avg_growth_rate!=null?(s(),r("span",yt,T(t.formatNumber(i.avg_growth_rate)),1)):i.model_success?(s(),r("span",ft,"-")):(s(),r("span",pt," Fit Failed "))])):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("td",wt,[i.model_success&&i.avg_growth_doubling_time!=null?(s(),r("span",bt,T(t.formatNumber(i.avg_growth_doubling_time,2)),1)):i.model_success?(s(),r("span",xt,"-")):(s(),r("span",ht," Fit Failed "))])):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?(s(),r("td",_t,[i.model_success&&i.max_growth_time!=null?(s(),r("span",St,T(t.formatTimestamp(i.max_growth_time)),1)):i.model_success?(s(),r("span",kt,"-")):(s(),r("span",Tt," Fit Failed "))])):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("td",Rt,[i.model_success&&i.max_growth_rate!=null?(s(),r("span",Mt,T(t.formatNumber(i.max_growth_rate)),1)):i.model_success?(s(),r("span",Wt,"-")):(s(),r("span",Ft," Fit Failed "))])),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("td",Ct,[i.model_success&&i.model_parameters&&i.model_parameters.doubling_time?(s(),r("span",Gt,T(t.formatNumber(i.model_parameters.doubling_time,2)),1)):i.model_success?(s(),r("span",At,"-")):(s(),r("span",zt," Fit Failed "))])),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("td",Dt,[i.model_success&&i.model_parameters&&i.model_parameters.max_growth_rate_time?(s(),r("span",Vt,T(t.formatTimestamp(i.model_parameters.max_growth_rate_time)),1)):i.model_success?(s(),r("span",$t,"-")):(s(),r("span",Ot,[e(k,{activator:"parent",location:"bottom"},{activator:l(({props:_})=>[a("span",P({ref_for:!0},_),"Fit Failed",16)]),default:l(()=>[d(" "+T(i.model_error||"Model fitting failed"),1)]),_:2},1024)]))])),t.modelType==="logistic"||t.modelType==="gompertz"?(s(),r("td",Nt,[i.model_success&&i.model_parameters?(s(),r("span",Ut,T(t.formatNumber(t.modelType==="logistic"?i.model_parameters.K:i.model_parameters.A)),1)):i.model_success?(s(),r("span",qt,"-")):(s(),r("span",Bt," Fit Failed "))])):p("",!0),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("td",Et,[i.model_success&&i.fit_quality?(s(),r("span",{key:0,style:X({color:I(i.fit_quality.r_squared),fontWeight:"bold"})},T(t.formatNumber(i.fit_quality.r_squared,3)),5)):i.model_success?(s(),r("span",Pt,"-")):(s(),r("span",It," Fit Failed "))])),t.modelType==="exponential"&&t.useSlidingWindow?p("",!0):(s(),r("td",jt,[i.model_success&&i.fit_quality?(s(),r("span",Lt,T(t.formatNumber(i.fit_quality.rmse,4)),1)):i.model_success?(s(),r("span",Zt,"-")):(s(),r("span",Kt," Fit Failed "))])),a("td",null,T(i.data_points),1)]))),128))])]),_:1})]),_:1})]),_:1})):p("",!0),n[6]||(n[6]=a("div",{class:"plot-wrapper"},[a("div",{id:"growth-rate-plot-container",class:"plot-container"})],-1)),e(x,{"model-value":t.isGeneratingGrowthRateAnalysis,contained:"",class:"d-flex align-center justify-center dark-overlay",persistent:""},{default:l(()=>[a("div",Ht,[e(f,{indeterminate:"",size:"80",width:"6",color:"primary",class:"mb-4"}),a("div",null,[n[5]||(n[5]=a("h3",{class:"mb-2"},"Calculating Growth Rates...",-1)),a("p",Jt,[t.modelType==="logistic"?(s(),r("span",Qt,"Fitting Logistic Growth Model")):t.modelType==="gompertz"?(s(),r("span",Xt,"Fitting Gompertz Growth Model")):(s(),r("span",Yt,"Analyzing Growth Rate Data"))])])])]),_:1},8,["model-value"])])]),_:1})]),_:1})):p("",!0),t.hasCurrentExperiment?p("",!0):(s(),U(R,{key:1,type:"warning",class:"mb-4"},{default:l(()=>[e(S,{class:"mr-2"},{default:l(()=>n[7]||(n[7]=[d("mdi-alert")])),_:1}),n[8]||(n[8]=d(" No current experiment selected. Please select an experiment to use the growth rate analysis. "))]),_:1}))])}}},tl=J(el,[["__scopeId","data-v-f8817847"]]);const ll={class:"growth-rate-tab"},al={class:"tab-content-wrapper"},nl={__name:"GrowthRateTab",setup(t){const I=Se(),{currentExperiment:b}=Te(I),n=M([]),S=M([]),F=M("adaptive"),k=M("exponential"),C=M(40),v=M(!1),o=M(!1),f=L(()=>[...n.value].sort((u,V)=>parseInt(u)-parseInt(V))),x=L(()=>{var c;return(c=D.value)!=null&&c.summary?Object.keys(D.value.summary).sort((u,V)=>parseInt(u)-parseInt(V)).map(u=>({vial:u,stats:D.value.summary[u]})):[]}),$=L(()=>{var c,u;return(u=(c=D.value)==null?void 0:c.parameters)!=null&&u.model_type?D.value.parameters.model_type:k.value}),N=M(.5),R=M("moving_average"),g=M(10),i=M(!0),_=M(1),E=M(5),B=M(!1),G=M({}),j=M(!0),O=M({}),w=M(!1),h=M(null),A=M(!1),D=M(null),K=M(null),ne=M(!1);for(let c=1;c<=7;c++)G.value[c]={start:"",end:""};const oe={1:"#6b9ac4",2:"#d4a574",3:"#7bb87b",4:"#c17a7a",5:"#b19bb8",6:"#a89a8f",7:"#d4a5c4"},me=[{label:"None",value:"none"},{label:"Median Filter",value:"median"},{label:"Moving Average",value:"moving_average"},{label:"Savitzky-Golay",value:"savgol"},{label:"Gaussian",value:"gaussian"}],Y=L(()=>!!(b.value&&b.value.id)),ie=L(()=>Y.value&&n.value.length>=1&&!w.value),se=L(()=>Y.value&&h.value&&!A.value),ce=()=>Y.value?n.value.length<1?"Please select at least 1 vial to analyze":"":"No experiment selected",ve=()=>{n.value=[...S.value]},ge=()=>{n.value=[],G.value={},O.value={}},ye=c=>{n.value=[...c],c.forEach(u=>{G.value[u]||(G.value[u]={start:"",end:""}),O.value[u]||(O.value[u]={min:0,max:2})}),G.value={...G.value},O.value={...O.value}},pe=(c,u=4)=>c==null||isNaN(c)?"N/A":parseFloat(c).toFixed(u),fe=(c,u)=>c==null||isNaN(c)?"N/A":u==null||isNaN(u)?`${parseFloat(c).toFixed(4)} /hr`:`${parseFloat(c).toFixed(4)} ± ${parseFloat(u).toFixed(4)} /hr`,we=c=>c?new Date(c*1e3).toLocaleString():"N/A",be=async()=>{var c;try{const u=await te.get("/data/vials/available");S.value=u.data.available_vials||[]}catch(u){console.error("Error loading available vials:",u),S.value=[],((c=u.response)==null?void 0:c.status)!==404&&Q("Failed to load available vials",{type:"error"})}},he=async c=>{var u;if(!c||c.length===0){K.value=null;return}ne.value=!0;try{const V=c.join(","),q=await te.get(`/growth-rate/data-time-range/${V}`);K.value=q.data,c.forEach(z=>{if(G.value[z]||(G.value[z]={start:"",end:""}),O.value[z]||(O.value[z]={min:0,max:2}),q.data.vials[z]){const W=q.data.vials[z];(!G.value[z].start||!G.value[z].end)&&(G.value[z].start=W.min_datetime_local,G.value[z].end=W.max_datetime_local)}}),G.value={...G.value},O.value={...O.value}}catch(V){console.error("Error loading data time ranges:",V),K.value=null,((u=V.response)==null?void 0:u.status)!==404&&console.warn("Could not load data time ranges for selected vials")}finally{ne.value=!1}},xe=async()=>{var c,u,V,q,z;if(ie.value){w.value=!0;try{const W={vials:f.value,smoothing_method:R.value,smoothing_window:g.value,enable_outlier_removal:i.value,outlier_threshold:_.value,outlier_window_size:E.value,enable_trimming:B.value,trim_settings:B.value?G.value:{},enable_od_trimming:j.value,od_trim_settings:j.value?O.value:{}},y=await te.post("/growth-rate/filter-od-data",W);h.value=y.data,await ue();const Z=document.getElementById("filtered-od-plot-container");Z&&h.value.plot&&(await le.newPlot(Z,h.value.plot.data,h.value.plot.layout,{responsive:!0,displayModeBar:!0,displaylogo:!1,modeBarButtonsToRemove:["pan2d","lasso2d","select2d"],scrollZoom:!0}),await le.Plots.resize(Z)),Q("Processed OD data generated successfully!",{type:"success"})}catch(W){console.error("Error generating processed OD data:",W);let y="Failed to generate processed OD data";((c=W.response)==null?void 0:c.status)===404?y="No data found for selected vials":((u=W.response)==null?void 0:u.status)===400?(y=((V=W.response.data)==null?void 0:V.detail)||"Invalid filtering parameters",y.includes("trimming failed")&&(y+=`

Please check your date range - it may be outside the available data period.`)):(z=(q=W.response)==null?void 0:q.data)!=null&&z.detail&&(y=W.response.data.detail),Q(y,{type:"error",autoClose:8e3})}finally{w.value=!1}}},_e=async()=>{var c,u,V,q,z;if(se.value){A.value=!0;try{const W={vials:f.value,method:o.value?F.value:"adaptive",model_type:k.value,use_sliding_window:o.value,window_size:o.value?C.value/60:null,window_step:N.value,smoothing_method:R.value,smoothing_window:g.value,enable_outlier_removal:i.value,outlier_threshold:_.value,outlier_window_size:E.value,enable_trimming:B.value,trim_settings:B.value?G.value:{},enable_od_trimming:j.value,od_trim_settings:j.value?O.value:{},use_real_time_simulation:o.value?v.value:!1,use_filtered_data:!0},y=await te.post("/growth-rate/advanced-analysis",W);D.value=y.data,await ue();const Z=document.getElementById("growth-rate-plot-container");Z&&D.value.plot&&(await le.newPlot(Z,D.value.plot.data,D.value.plot.layout,{responsive:!0,displayModeBar:!0,displaylogo:!1,modeBarButtonsToRemove:["pan2d","lasso2d","select2d"],scrollZoom:!0}),await le.Plots.resize(Z)),Q("Growth rate analysis completed successfully!",{type:"success"})}catch(W){console.error("Error generating growth rate analysis:",W);let y="Failed to generate growth rate analysis";((c=W.response)==null?void 0:c.status)===404?y="No data found for selected vials":((u=W.response)==null?void 0:u.status)===400?y=((V=W.response.data)==null?void 0:V.detail)||"Invalid parameters":(z=(q=W.response)==null?void 0:q.data)!=null&&z.detail&&(y=W.response.data.detail),Q(y,{type:"error"})}finally{A.value=!1}}};return ke(n,async(c,u)=>{if(JSON.stringify(c)!==JSON.stringify(u)&&(h.value=null,D.value=null),c.length>0){const V=[...c].sort((q,z)=>parseInt(q)-parseInt(z));await he(V)}else K.value=null,G.value={},O.value={}}),Re(()=>{be()}),(c,u)=>{const V=m("v-icon"),q=m("v-card-title"),z=m("v-card-text"),W=m("v-card");return s(),r("div",ll,[a("div",al,[u[16]||(u[16]=a("div",{class:"section-title"},[a("h2",null,"Growth Rate Analysis"),a("p",null,"Advanced growth rate analysis with configurable smoothing, windowing, and filtering")],-1)),e(Ce,{selectedVials:n.value,availableVials:S.value,vialColors:oe,"onUpdate:selectedVials":ye,onSelectAllVials:ve,onClearVialSelection:ge},null,8,["selectedVials","availableVials"]),e(Ve,{enableTrimming:B.value,enableOdTrimming:j.value,enableOutlierRemoval:i.value,smoothingMethod:R.value,smoothingWindow:g.value,outlierThreshold:_.value,outlierWindowSize:E.value,trimSettings:G.value,odTrimSettings:O.value,dataTimeRanges:K.value,isLoadingTimeRanges:ne.value,sortedSelectedVials:f.value,vialColors:oe,smoothingMethods:me,canGenerateFilteredData:ie.value,isGeneratingFilteredData:w.value,filteredDataResults:h.value,getFilteredDataDisabledReason:ce,"onUpdate:enableTrimming":u[0]||(u[0]=y=>B.value=y),"onUpdate:enableOdTrimming":u[1]||(u[1]=y=>j.value=y),"onUpdate:enableOutlierRemoval":u[2]||(u[2]=y=>i.value=y),"onUpdate:smoothingMethod":u[3]||(u[3]=y=>R.value=y),"onUpdate:smoothingWindow":u[4]||(u[4]=y=>g.value=y),"onUpdate:outlierThreshold":u[5]||(u[5]=y=>_.value=y),"onUpdate:outlierWindowSize":u[6]||(u[6]=y=>E.value=y),"onUpdate:trimSettings":u[7]||(u[7]=y=>G.value=y),"onUpdate:odTrimSettings":u[8]||(u[8]=y=>O.value=y),onGenerateFilteredData:xe},null,8,["enableTrimming","enableOdTrimming","enableOutlierRemoval","smoothingMethod","smoothingWindow","outlierThreshold","outlierWindowSize","trimSettings","odTrimSettings","dataTimeRanges","isLoadingTimeRanges","sortedSelectedVials","canGenerateFilteredData","isGeneratingFilteredData","filteredDataResults"]),h.value?(s(),U(W,{key:0,class:"mb-4"},{default:l(()=>[e(q,{class:"step-title"},{default:l(()=>[e(V,{class:"mr-2"},{default:l(()=>u[14]||(u[14]=[d("mdi-trending-up")])),_:1}),u[15]||(u[15]=d(" Step 2: Growth Rate Calculation "))]),_:1}),e(z,null,{default:l(()=>[e(Ke,{modelType:k.value,"onUpdate:modelType":u[9]||(u[9]=y=>k.value=y),useSlidingWindow:o.value,"onUpdate:useSlidingWindow":u[10]||(u[10]=y=>o.value=y),analysisMethod:F.value,"onUpdate:analysisMethod":u[11]||(u[11]=y=>F.value=y),windowSize:C.value,"onUpdate:windowSize":u[12]||(u[12]=y=>C.value=y),realtimeMode:v.value,"onUpdate:realtimeMode":u[13]||(u[13]=y=>v.value=y),canRunAnalysis:se.value,isGeneratingGrowthRateAnalysis:A.value,onGenerateGrowthRateAnalysis:_e},null,8,["modelType","useSlidingWindow","analysisMethod","windowSize","realtimeMode","canRunAnalysis","isGeneratingGrowthRateAnalysis"])]),_:1})]),_:1})):p("",!0),e(tl,{analysisResults:D.value,modelType:$.value,useSlidingWindow:o.value,sortedAnalysisResults:x.value,vialColors:oe,isGeneratingGrowthRateAnalysis:A.value,hasCurrentExperiment:Y.value,formatNumber:pe,formatTimestamp:we,formatGrowthRateWithCI:fe},null,8,["analysisResults","modelType","useSlidingWindow","sortedAnalysisResults","isGeneratingGrowthRateAnalysis","hasCurrentExperiment"])])])}}},sl=J(nl,[["__scopeId","data-v-2ca2c0f9"]]);export{sl as default};
