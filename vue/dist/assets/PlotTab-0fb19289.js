import{_ as J,g as K,B as Q,k as b,h as M,m as W,r as c,o as m,c as g,a as f,f as l,q as t,s,F as $,i as D,n as X,t as k,d as w,j as A,S as F,l as N,L as Y}from"./index-626bd695.js";import{P as Z}from"./plotly-afc049ba.js";const h={class:"plot-tab"},ee={key:0,class:"text-grey"},te={class:"mt-2"},le={key:0,class:"mt-2 text-grey"},ae={__name:"PlotTab",setup(se){const R=K(),{currentExperiment:T}=Q(R),d=b([]),u=b("od"),p=b([]),x=b(!1),y=b(null),S={1:"#1f77b4",2:"#ff7f0e",3:"#2ca02c",4:"#d62728",5:"#9467bd",6:"#8c564b",7:"#e377c2"},z=[{key:"od",name:"Optical Density",icon:"mdi-circle-opacity"},{key:"growth_rate",name:"Growth Rate",icon:"mdi-trending-up"},{key:"concentration",name:"Drug Concentration",icon:"mdi-beaker"},{key:"generation",name:"Generation",icon:"mdi-dna"},{key:"rpm",name:"Stirrer RPM",icon:"mdi-rotate-3d-variant"}],B=M(()=>T.value&&T.value.id),E=M(()=>B.value&&d.value.length>=2&&u.value&&!x.value),j=()=>B.value?d.value.length<2?"Please select at least 2 vials to compare":u.value?"":"Please select a metric to plot":"No experiment selected",I=()=>{const r=z.find(o=>o.key===u.value),e=d.value.sort().join(", ");return`${(r==null?void 0:r.name)||"Unknown"} Comparison - Vials: ${e}`},L=()=>{d.value=[...p.value]},U=()=>{d.value=[]},q=async()=>{var r;try{const e=await F.get("/data/vials/available");p.value=e.data.available_vials||[]}catch(e){console.error("Error loading available vials:",e),p.value=[],((r=e.response)==null?void 0:r.status)!==404&&N("Failed to load available vials",{type:"error"})}},O=async()=>{var r,e,o,_,C;if(E.value){x.value=!0;try{const n=d.value.sort().join(","),i=await F.get(`/plot/compare/${n}/${u.value}`);y.value=i.data,await Y();const v=document.getElementById("plotly-container");v&&y.value&&await Z.newPlot(v,y.value.data,y.value.layout,{responsive:!0,displayModeBar:!0}),N("Plot generated successfully!",{type:"success"})}catch(n){console.error("Error generating plot:",n);let i="Failed to generate plot";((r=n.response)==null?void 0:r.status)===404?i="No data found for selected vials":((e=n.response)==null?void 0:e.status)===400?i=((o=n.response.data)==null?void 0:o.detail)||"Invalid parameters":(C=(_=n.response)==null?void 0:_.data)!=null&&C.detail&&(i=n.response.data.detail),N(i,{type:"error"})}finally{x.value=!1}}};return W(()=>{q()}),(r,e)=>{const o=c("v-icon"),_=c("v-card-title"),C=c("v-checkbox"),n=c("v-col"),i=c("v-row"),v=c("v-btn"),V=c("v-card-text"),P=c("v-card"),H=c("v-alert");return m(),g("div",h,[e[14]||(e[14]=f("div",{class:"section-title"},[f("h2",null,"Compare Vials"),f("p",null,"Select vials and a metric to compare across your experiment")],-1)),l(P,{class:"mb-4"},{default:t(()=>[l(_,{class:"vial-selection-title"},{default:t(()=>[l(o,{class:"mr-2"},{default:t(()=>e[1]||(e[1]=[s("mdi-test-tube")])),_:1}),e[2]||(e[2]=s(" Select Vials to Compare "))]),_:1}),l(V,null,{default:t(()=>[l(i,null,{default:t(()=>[(m(),g($,null,D(7,a=>l(n,{key:a,cols:"auto"},{default:t(()=>[l(C,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=G=>d.value=G),value:a,label:`Vial ${a}`,disabled:!p.value.includes(a),color:S[a],class:"vial-checkbox"},{label:t(()=>[f("div",{class:"vial-label",style:X({color:S[a]})},[l(o,{color:S[a],size:"small",class:"mr-1"},{default:t(()=>e[3]||(e[3]=[s("mdi-circle")])),_:2},1032,["color"]),s(" Vial "+k(a)+" ",1),p.value.includes(a)?w("",!0):(m(),g("span",ee,"(no data)"))],4)]),_:2},1032,["modelValue","value","label","disabled","color"])]),_:2},1024)),64))]),_:1}),f("div",te,[l(v,{size:"small",variant:"outlined",onClick:L,disabled:p.value.length===0,class:"mr-2"},{default:t(()=>e[4]||(e[4]=[s(" Select All ")])),_:1},8,["disabled"]),l(v,{size:"small",variant:"outlined",onClick:U},{default:t(()=>e[5]||(e[5]=[s(" Clear All ")])),_:1})])]),_:1})]),_:1}),l(P,{class:"mb-4"},{default:t(()=>[l(_,{class:"metric-selection-title"},{default:t(()=>[l(o,{class:"mr-2"},{default:t(()=>e[6]||(e[6]=[s("mdi-chart-line")])),_:1}),e[7]||(e[7]=s(" Select Metric to Compare "))]),_:1}),l(V,null,{default:t(()=>[l(i,{class:"mt-4"},{default:t(()=>[(m(),g($,null,D(z,a=>l(n,{key:a.key,cols:"12",sm:"6",md:"4"},{default:t(()=>[l(v,{color:u.value===a.key?"primary":"default",variant:u.value===a.key?"flat":"outlined",block:"",size:"large",onClick:G=>u.value=a.key,class:"metric-button"},{default:t(()=>[l(o,{class:"mr-2"},{default:t(()=>[s(k(a.icon),1)]),_:2},1024),s(" "+k(a.name),1)]),_:2},1032,["color","variant","onClick"])]),_:2},1024)),64))]),_:1})]),_:1})]),_:1}),l(P,{class:"mb-4"},{default:t(()=>[l(V,{class:"text-center"},{default:t(()=>[l(v,{color:"success",size:"x-large",onClick:O,disabled:!E.value,loading:x.value,class:"generate-plot-btn"},{default:t(()=>[l(o,{class:"mr-2"},{default:t(()=>e[8]||(e[8]=[s("mdi-chart-bell-curve-cumulative")])),_:1}),e[9]||(e[9]=s(" Generate Comparison Plot "))]),_:1},8,["disabled","loading"]),E.value?w("",!0):(m(),g("div",le,k(j()),1))]),_:1})]),_:1}),y.value?(m(),A(P,{key:0,class:"plot-display"},{default:t(()=>[l(_,null,{default:t(()=>[l(o,{class:"mr-2"},{default:t(()=>e[10]||(e[10]=[s("mdi-chart-line")])),_:1}),s(" "+k(I()),1)]),_:1}),l(V,null,{default:t(()=>e[11]||(e[11]=[f("div",{id:"plotly-container",class:"plot-container"},null,-1)])),_:1})]),_:1})):w("",!0),B.value?w("",!0):(m(),A(H,{key:1,type:"warning",class:"mb-4"},{default:t(()=>[l(o,{class:"mr-2"},{default:t(()=>e[12]||(e[12]=[s("mdi-alert")])),_:1}),e[13]||(e[13]=s(" No current experiment selected. Please select an experiment to use the comparison features. "))]),_:1}))])}}},re=J(ae,[["__scopeId","data-v-dd639591"]]);export{re as default};
