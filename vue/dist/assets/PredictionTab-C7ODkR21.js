import{_ as Fb,o as Do,c as Ah,t as cF,f as $b,b as bo,m as y1,a as S1,r as iu,e as xS,g as Fp,w as hF,h as dF}from"./index-DO46mX6s.js";import{c as U_,V as fF}from"./VialPlot-BRN29hED.js";var z_={},ec,Y_;function dn(){if(Y_)return ec;Y_=1;var t=function(e){return e&&e.Math===Math&&e};return ec=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof U_=="object"&&U_)||t(typeof ec=="object"&&ec)||function(){return this}()||Function("return this")(),ec}var $p={},Vp,G_;function En(){return G_||(G_=1,Vp=function(t){try{return!!t()}catch{return!0}}),Vp}var Wp,q_;function zr(){if(q_)return Wp;q_=1;var t=En();return Wp=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Wp}var Bp,K_;function Am(){if(K_)return Bp;K_=1;var t=En();return Bp=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Bp}var jp,X_;function Fn(){if(X_)return jp;X_=1;var t=Am(),e=Function.prototype.call;return jp=t?e.bind(e):function(){return e.apply(e,arguments)},jp}var Up={},Z_;function gF(){if(Z_)return Up;Z_=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return Up.f=n?function(i){var s=e(this,i);return!!s&&s.enumerable}:t,Up}var zp,Q_;function Hm(){return Q_||(Q_=1,zp=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),zp}var Yp,J_;function Zt(){if(J_)return Yp;J_=1;var t=Am(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return Yp=t?r:function(i){return function(){return n.apply(i,arguments)}},Yp}var Gp,eM;function hl(){if(eM)return Gp;eM=1;var t=Zt(),e=t({}.toString),n=t("".slice);return Gp=function(r){return n(e(r),8,-1)},Gp}var qp,tM;function mF(){if(tM)return qp;tM=1;var t=Zt(),e=En(),n=hl(),r=Object,i=t("".split);return qp=e(function(){return!r("z").propertyIsEnumerable(0)})?function(s){return n(s)==="String"?i(s,""):r(s)}:r,qp}var Kp,nM;function Nm(){return nM||(nM=1,Kp=function(t){return t==null}),Kp}var Xp,rM;function ed(){if(rM)return Xp;rM=1;var t=Nm(),e=TypeError;return Xp=function(n){if(t(n))throw new e("Can't call method on "+n);return n},Xp}var Zp,iM;function td(){if(iM)return Zp;iM=1;var t=mF(),e=ed();return Zp=function(n){return t(e(n))},Zp}var Qp,sM;function sn(){if(sM)return Qp;sM=1;var t=typeof document=="object"&&document.all;return Qp=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},Qp}var Jp,oM;function bi(){if(oM)return Jp;oM=1;var t=sn();return Jp=function(e){return typeof e=="object"?e!==null:t(e)},Jp}var ew,aM;function Du(){if(aM)return ew;aM=1;var t=dn(),e=sn(),n=function(r){return e(r)?r:void 0};return ew=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},ew}var tw,lM;function nd(){if(lM)return tw;lM=1;var t=Zt();return tw=t({}.isPrototypeOf),tw}var nw,uM;function Dm(){if(uM)return nw;uM=1;var t=dn(),e=t.navigator,n=e&&e.userAgent;return nw=n?String(n):"",nw}var rw,cM;function pF(){if(cM)return rw;cM=1;var t=dn(),e=Dm(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,s=i&&i.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),rw=a,rw}var iw,hM;function Vb(){if(hM)return iw;hM=1;var t=pF(),e=En(),n=dn(),r=n.String;return iw=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),iw}var sw,dM;function b1(){if(dM)return sw;dM=1;var t=Vb();return sw=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",sw}var ow,fM;function Wb(){if(fM)return ow;fM=1;var t=Du(),e=sn(),n=nd(),r=b1(),i=Object;return ow=r?function(s){return typeof s=="symbol"}:function(s){var o=t("Symbol");return e(o)&&n(o.prototype,i(s))},ow}var aw,gM;function Lm(){if(gM)return aw;gM=1;var t=String;return aw=function(e){try{return t(e)}catch{return"Object"}},aw}var lw,mM;function dr(){if(mM)return lw;mM=1;var t=sn(),e=Lm(),n=TypeError;return lw=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},lw}var uw,pM;function rd(){if(pM)return uw;pM=1;var t=dr(),e=Nm();return uw=function(n,r){var i=n[r];return e(i)?void 0:t(i)},uw}var cw,wM;function wF(){if(wM)return cw;wM=1;var t=Fn(),e=sn(),n=bi(),r=TypeError;return cw=function(i,s){var o,a;if(s==="string"&&e(o=i.toString)&&!n(a=t(o,i))||e(o=i.valueOf)&&!n(a=t(o,i))||s!=="string"&&e(o=i.toString)&&!n(a=t(o,i)))return a;throw new r("Can't convert object to primitive value")},cw}var hw={exports:{}},dw,CM;function Qo(){return CM||(CM=1,dw=!1),dw}var fw,vM;function Bb(){if(vM)return fw;vM=1;var t=dn(),e=Object.defineProperty;return fw=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},fw}var yM;function jb(){if(yM)return hw.exports;yM=1;var t=Qo(),e=dn(),n=Bb(),r="__core-js_shared__",i=hw.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.40.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"}),hw.exports}var gw,SM;function R1(){if(SM)return gw;SM=1;var t=jb();return gw=function(e,n){return t[e]||(t[e]=n||{})},gw}var mw,bM;function Lu(){if(bM)return mw;bM=1;var t=ed(),e=Object;return mw=function(n){return e(t(n))},mw}var pw,RM;function Yr(){if(RM)return pw;RM=1;var t=Zt(),e=Lu(),n=t({}.hasOwnProperty);return pw=Object.hasOwn||function(i,s){return n(e(i),s)},pw}var ww,EM;function E1(){if(EM)return ww;EM=1;var t=Zt(),e=0,n=Math.random(),r=t(1 .toString);return ww=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},ww}var Cw,TM;function Ri(){if(TM)return Cw;TM=1;var t=dn(),e=R1(),n=Yr(),r=E1(),i=Vb(),s=b1(),o=t.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||r;return Cw=function(u){return n(a,u)||(a[u]=i&&n(o,u)?o[u]:l("Symbol."+u)),a[u]},Cw}var vw,_M;function CF(){if(_M)return vw;_M=1;var t=Fn(),e=bi(),n=Wb(),r=rd(),i=wF(),s=Ri(),o=TypeError,a=s("toPrimitive");return vw=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new o("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},vw}var yw,MM;function T1(){if(MM)return yw;MM=1;var t=CF(),e=Wb();return yw=function(n){var r=t(n,"string");return e(r)?r:r+""},yw}var Sw,IM;function Ub(){if(IM)return Sw;IM=1;var t=dn(),e=bi(),n=t.document,r=e(n)&&e(n.createElement);return Sw=function(i){return r?n.createElement(i):{}},Sw}var bw,PM;function _1(){if(PM)return bw;PM=1;var t=zr(),e=En(),n=Ub();return bw=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),bw}var OM;function M1(){if(OM)return $p;OM=1;var t=zr(),e=Fn(),n=gF(),r=Hm(),i=td(),s=T1(),o=Yr(),a=_1(),l=Object.getOwnPropertyDescriptor;return $p.f=t?l:function(c,h){if(c=i(c),h=s(h),a)try{return l(c,h)}catch{}if(o(c,h))return r(!e(n.f,c,h),c[h])},$p}var Rw={},Ew,xM;function I1(){if(xM)return Ew;xM=1;var t=zr(),e=En();return Ew=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Ew}var Tw,AM;function on(){if(AM)return Tw;AM=1;var t=bi(),e=String,n=TypeError;return Tw=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},Tw}var HM;function Jo(){if(HM)return Rw;HM=1;var t=zr(),e=_1(),n=I1(),r=on(),i=T1(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Rw.f=t?n?function(d,f,m){if(r(d),f=i(f),r(m),typeof d=="function"&&f==="prototype"&&"value"in m&&c in m&&!m[c]){var v=a(d,f);v&&v[c]&&(d[f]=m.value,m={configurable:u in m?m[u]:v[u],enumerable:l in m?m[l]:v[l],writable:!1})}return o(d,f,m)}:o:function(d,f,m){if(r(d),f=i(f),r(m),e)try{return o(d,f,m)}catch{}if("get"in m||"set"in m)throw new s("Accessors not supported");return"value"in m&&(d[f]=m.value),d},Rw}var _w,NM;function ku(){if(NM)return _w;NM=1;var t=zr(),e=Jo(),n=Hm();return _w=t?function(r,i,s){return e.f(r,i,n(1,s))}:function(r,i,s){return r[i]=s,r},_w}var Mw={exports:{}},Iw,DM;function vF(){if(DM)return Iw;DM=1;var t=zr(),e=Yr(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),s=i&&(function(){}).name==="something",o=i&&(!t||t&&r(n,"name").configurable);return Iw={EXISTS:i,PROPER:s,CONFIGURABLE:o},Iw}var Pw,LM;function yF(){if(LM)return Pw;LM=1;var t=Zt(),e=sn(),n=jb(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),Pw=n.inspectSource,Pw}var Ow,kM;function SF(){if(kM)return Ow;kM=1;var t=dn(),e=sn(),n=t.WeakMap;return Ow=e(n)&&/native code/.test(String(n)),Ow}var xw,FM;function zb(){if(FM)return xw;FM=1;var t=R1(),e=E1(),n=t("keys");return xw=function(r){return n[r]||(n[r]=e(r))},xw}var Aw,$M;function Yb(){return $M||($M=1,Aw={}),Aw}var Hw,VM;function P1(){if(VM)return Hw;VM=1;var t=SF(),e=dn(),n=bi(),r=ku(),i=Yr(),s=jb(),o=zb(),a=Yb(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,m=function(R){return f(R)?d(R):h(R,{})},v=function(R){return function(P){var O;if(!n(P)||(O=d(P)).type!==R)throw new u("Incompatible receiver, "+R+" required");return O}};if(t||s.state){var w=s.state||(s.state=new c);w.get=w.get,w.has=w.has,w.set=w.set,h=function(R,P){if(w.has(R))throw new u(l);return P.facade=R,w.set(R,P),P},d=function(R){return w.get(R)||{}},f=function(R){return w.has(R)}}else{var b=o("state");a[b]=!0,h=function(R,P){if(i(R,b))throw new u(l);return P.facade=R,r(R,b,P),P},d=function(R){return i(R,b)?R[b]:{}},f=function(R){return i(R,b)}}return Hw={set:h,get:d,has:f,enforce:m,getterFor:v},Hw}var WM;function O1(){if(WM)return Mw.exports;WM=1;var t=Zt(),e=En(),n=sn(),r=Yr(),i=zr(),s=vF().CONFIGURABLE,o=yF(),a=P1(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),m=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),w=String(String).split("String"),b=Mw.exports=function(R,P,O){d(c(P),0,7)==="Symbol("&&(P="["+f(c(P),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),O&&O.getter&&(P="get "+P),O&&O.setter&&(P="set "+P),(!r(R,"name")||s&&R.name!==P)&&(i?h(R,"name",{value:P,configurable:!0}):R.name=P),v&&O&&r(O,"arity")&&R.length!==O.arity&&h(R,"length",{value:O.arity});try{O&&r(O,"constructor")&&O.constructor?i&&h(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var D=l(R);return r(D,"source")||(D.source=m(w,typeof P=="string"?P:"")),R};return Function.prototype.toString=b(function(){return n(this)&&u(this).source||o(this)},"toString"),Mw.exports}var Nw,BM;function Gb(){if(BM)return Nw;BM=1;var t=sn(),e=Jo(),n=O1(),r=Bb();return Nw=function(i,s,o,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:s;if(t(o)&&n(o,u,a),a.global)l?i[s]=o:r(s,o);else{try{a.unsafe?i[s]&&(l=!0):delete i[s]}catch{}l?i[s]=o:e.f(i,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Nw}var Dw={},Lw,jM;function bF(){if(jM)return Lw;jM=1;var t=Math.ceil,e=Math.floor;return Lw=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},Lw}var kw,UM;function id(){if(UM)return kw;UM=1;var t=bF();return kw=function(e){var n=+e;return n!==n||n===0?0:t(n)},kw}var Fw,zM;function RF(){if(zM)return Fw;zM=1;var t=id(),e=Math.max,n=Math.min;return Fw=function(r,i){var s=t(r);return s<0?e(s+i,0):n(s,i)},Fw}var $w,YM;function EF(){if(YM)return $w;YM=1;var t=id(),e=Math.min;return $w=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},$w}var Vw,GM;function Fu(){if(GM)return Vw;GM=1;var t=EF();return Vw=function(e){return t(e.length)},Vw}var Ww,qM;function TF(){if(qM)return Ww;qM=1;var t=td(),e=RF(),n=Fu(),r=function(i){return function(s,o,a){var l=t(s),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&o!==o){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===o)return i||c||0;return!i&&-1}};return Ww={includes:r(!0),indexOf:r(!1)},Ww}var Bw,KM;function x1(){if(KM)return Bw;KM=1;var t=Zt(),e=Yr(),n=td(),r=TF().indexOf,i=Yb(),s=t([].push);return Bw=function(o,a){var l=n(o),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&s(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||s(c,h));return c},Bw}var jw,XM;function qb(){return XM||(XM=1,jw=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),jw}var ZM;function _F(){if(ZM)return Dw;ZM=1;var t=x1(),e=qb(),n=e.concat("length","prototype");return Dw.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Dw}var Uw={},QM;function MF(){return QM||(QM=1,Uw.f=Object.getOwnPropertySymbols),Uw}var zw,JM;function IF(){if(JM)return zw;JM=1;var t=Du(),e=Zt(),n=_F(),r=MF(),i=on(),s=e([].concat);return zw=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?s(l,u(a)):l},zw}var Yw,e0;function A1(){if(e0)return Yw;e0=1;var t=Yr(),e=IF(),n=M1(),r=Jo();return Yw=function(i,s,o){for(var a=e(s),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(o&&t(o,h))&&l(i,h,u(s,h))}},Yw}var Gw,t0;function PF(){if(t0)return Gw;t0=1;var t=En(),e=sn(),n=/#|\.prototype\./,r=function(l,u){var c=s[i(l)];return c===a?!0:c===o?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},s=r.data={},o=r.NATIVE="N",a=r.POLYFILL="P";return Gw=r,Gw}var qw,n0;function gt(){if(n0)return qw;n0=1;var t=dn(),e=M1().f,n=ku(),r=Gb(),i=Bb(),s=A1(),o=PF();return qw=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,m,v,w,b;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(m in l){if(w=l[m],a.dontCallGetSet?(b=e(f,m),v=b&&b.value):v=f[m],d=o(c?m:u+(h?".":"#")+m,a.forced),!d&&v!==void 0){if(typeof w==typeof v)continue;s(w,v)}(a.sham||v&&v.sham)&&n(w,"sham",!0),r(f,m,w,a)}},qw}var Kw,r0;function km(){if(r0)return Kw;r0=1;var t=Am(),e=Function.prototype,n=e.apply,r=e.call;return Kw=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),Kw}var Xw,i0;function H1(){if(i0)return Xw;i0=1;var t=Zt(),e=dr();return Xw=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},Xw}var Zw,s0;function OF(){if(s0)return Zw;s0=1;var t=bi();return Zw=function(e){return t(e)||e===null},Zw}var Qw,o0;function xF(){if(o0)return Qw;o0=1;var t=OF(),e=String,n=TypeError;return Qw=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},Qw}var Jw,a0;function N1(){if(a0)return Jw;a0=1;var t=H1(),e=bi(),n=ed(),r=xF();return Jw=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,s={},o;try{o=t(Object.prototype,"__proto__","set"),o(s,[]),i=s instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?o(l,u):l.__proto__=u),l}}():void 0),Jw}var eC,l0;function AF(){if(l0)return eC;l0=1;var t=Jo().f;return eC=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},eC}var tC,u0;function HF(){if(u0)return tC;u0=1;var t=sn(),e=bi(),n=N1();return tC=function(r,i,s){var o,a;return n&&t(o=i.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&n(r,a),r},tC}var nC,c0;function NF(){if(c0)return nC;c0=1;var t=Ri(),e=t("toStringTag"),n={};return n[e]="z",nC=String(n)==="[object z]",nC}var rC,h0;function D1(){if(h0)return rC;h0=1;var t=NF(),e=sn(),n=hl(),r=Ri(),i=r("toStringTag"),s=Object,o=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return rC=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=s(l),i))=="string"?c:o?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},rC}var iC,d0;function Fm(){if(d0)return iC;d0=1;var t=D1(),e=String;return iC=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},iC}var sC,f0;function DF(){if(f0)return sC;f0=1;var t=Fm();return sC=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},sC}var oC,g0;function LF(){if(g0)return oC;g0=1;var t=bi(),e=ku();return oC=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},oC}var aC,m0;function kF(){if(m0)return aC;m0=1;var t=Zt(),e=Error,n=t("".replace),r=function(o){return String(new e(o).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,s=i.test(r);return aC=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=n(o,i,"");return o},aC}var lC,p0;function FF(){if(p0)return lC;p0=1;var t=En(),e=Hm();return lC=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),lC}var uC,w0;function $F(){if(w0)return uC;w0=1;var t=ku(),e=kF(),n=FF(),r=Error.captureStackTrace;return uC=function(i,s,o,a){n&&(r?r(i,s):t(i,"stack",e(o,a)))},uC}var cC,C0;function VF(){if(C0)return cC;C0=1;var t=Du(),e=Yr(),n=ku(),r=nd(),i=N1(),s=A1(),o=AF(),a=HF(),l=DF(),u=LF(),c=$F(),h=zr(),d=Qo();return cC=function(f,m,v,w){var b="stackTraceLimit",R=w?2:1,P=f.split("."),O=P[P.length-1],D=t.apply(null,P);if(D){var M=D.prototype;if(!d&&e(M,"cause")&&delete M.cause,!v)return D;var A=t("Error"),j=m(function(X,U){var Z=l(w?U:X,void 0),J=w?new D(X):new D;return Z!==void 0&&n(J,"message",Z),c(J,j,J.stack,2),this&&r(M,this)&&a(J,this,j),arguments.length>R&&u(J,arguments[R]),J});if(j.prototype=M,O!=="Error"?i?i(j,A):s(j,A,{name:!0}):h&&b in D&&(o(j,D,b),o(j,D,"prepareStackTrace")),s(j,D),!d)try{M.name!==O&&n(M,"name",O),M.constructor=j}catch{}return j}},cC}var v0;function WF(){if(v0)return z_;v0=1;var t=gt(),e=dn(),n=km(),r=VF(),i="WebAssembly",s=e[i],o=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,o),t({global:!0,constructor:!0,arity:1,forced:o},h)},l=function(u,c){if(s&&s[u]){var h={};h[u]=r(i+"."+u,c,o),t({target:i,stat:!0,constructor:!0,arity:1,forced:o},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),z_}WF();var y0={},hC,S0;function L1(){if(S0)return hC;S0=1;var t=hl();return hC=Array.isArray||function(n){return t(n)==="Array"},hC}var dC,b0;function k1(){if(b0)return dC;b0=1;var t=zr(),e=L1(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}();return dC=i?function(s,o){if(e(s)&&!r(s,"length").writable)throw new n("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},dC}var fC,R0;function F1(){if(R0)return fC;R0=1;var t=TypeError,e=9007199254740991;return fC=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},fC}var E0;function BF(){if(E0)return y0;E0=1;var t=gt(),e=Lu(),n=Fu(),r=k1(),i=F1(),s=En(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var m=0;m<f;m++)h[d]=arguments[m],d++;return r(h,d),d}}),y0}BF();var T0={},gC,_0;function cs(){if(_0)return gC;_0=1;var t=Zt(),e=Set.prototype;return gC={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},gC}var mC,M0;function dl(){if(M0)return mC;M0=1;var t=cs().has;return mC=function(e){return t(e),e},mC}var pC,I0;function fl(){if(I0)return pC;I0=1;var t=Fn();return pC=function(e,n,r){for(var i=r?e:e.iterator,s=e.next,o,a;!(o=t(s,i)).done;)if(a=n(o.value),a!==void 0)return a},pC}var wC,P0;function sd(){if(P0)return wC;P0=1;var t=Zt(),e=fl(),n=cs(),r=n.Set,i=n.proto,s=t(i.forEach),o=t(i.keys),a=o(new r).next;return wC=function(l,u,c){return c?e({iterator:o(l),next:a},u):s(l,u)},wC}var CC,O0;function Kb(){if(O0)return CC;O0=1;var t=cs(),e=sd(),n=t.Set,r=t.add;return CC=function(i){var s=new n;return e(i,function(o){r(s,o)}),s},CC}var vC,x0;function od(){if(x0)return vC;x0=1;var t=H1(),e=cs();return vC=t(e.proto,"size","get")||function(n){return n.size},vC}var yC,A0;function hs(){return A0||(A0=1,yC=function(t){return{iterator:t,next:t.next,done:!1}}),yC}var SC,H0;function gl(){if(H0)return SC;H0=1;var t=dr(),e=on(),n=Fn(),r=id(),i=hs(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},SC=function(c){e(c);var h=+c.size;if(h!==h)throw new a(s);var d=r(h);if(d<0)throw new o(s);return new u(c,d)},SC}var bC,N0;function jF(){if(N0)return bC;N0=1;var t=dl(),e=cs(),n=Kb(),r=od(),i=gl(),s=sd(),o=fl(),a=e.has,l=e.remove;return bC=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?s(h,function(m){d.includes(m)&&l(f,m)}):o(d.getIterator(),function(m){a(h,m)&&l(f,m)}),f},bC}var RC,D0;function ml(){if(D0)return RC;D0=1;var t=Du(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return RC=function(r,i){var s=t("Set");try{new s()[r](e(0));try{return new s()[r](e(-1)),!1}catch{if(!i)return!0;try{return new s()[r](n(-1/0)),!1}catch{var o=new s;return o.add(1),o.add(2),i(o[r](n(1/0)))}}}catch{return!1}},RC}var L0;function UF(){if(L0)return T0;L0=1;var t=gt(),e=jF(),n=ml(),r=!n("difference",function(i){return i.size===0});return t({target:"Set",proto:!0,real:!0,forced:r},{difference:e}),T0}UF();var k0={},EC,F0;function zF(){if(F0)return EC;F0=1;var t=dl(),e=cs(),n=od(),r=gl(),i=sd(),s=fl(),o=e.Set,a=e.add,l=e.has;return EC=function(c){var h=t(this),d=r(c),f=new o;return n(h)>d.size?s(d.getIterator(),function(m){l(h,m)&&a(f,m)}):i(h,function(m){d.includes(m)&&a(f,m)}),f},EC}var $0;function YF(){if($0)return k0;$0=1;var t=gt(),e=En(),n=zF(),r=ml(),i=!r("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),k0}YF();var V0={},TC,W0;function $u(){if(W0)return TC;W0=1;var t=Fn(),e=on(),n=rd();return TC=function(r,i,s){var o,a;e(r);try{if(o=n(r,"return"),!o){if(i==="throw")throw s;return s}o=t(o,r)}catch(l){a=!0,o=l}if(i==="throw")throw s;if(a)throw o;return e(o),s},TC}var _C,B0;function GF(){if(B0)return _C;B0=1;var t=dl(),e=cs().has,n=od(),r=gl(),i=sd(),s=fl(),o=$u();return _C=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return s(h,function(d){if(e(u,d))return o(h,"normal",!1)})!==!1},_C}var j0;function qF(){if(j0)return V0;j0=1;var t=gt(),e=GF(),n=ml(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),V0}qF();var U0={},MC,z0;function KF(){if(z0)return MC;z0=1;var t=dl(),e=od(),n=sd(),r=gl();return MC=function(s){var o=t(this),a=r(s);return e(o)>a.size?!1:n(o,function(l){if(!a.includes(l))return!1},!0)!==!1},MC}var Y0;function XF(){if(Y0)return U0;Y0=1;var t=gt(),e=KF(),n=ml(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),U0}XF();var G0={},IC,q0;function ZF(){if(q0)return IC;q0=1;var t=dl(),e=cs().has,n=od(),r=gl(),i=fl(),s=$u();return IC=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return s(c,"normal",!1)})!==!1},IC}var K0;function QF(){if(K0)return G0;K0=1;var t=gt(),e=ZF(),n=ml(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),G0}QF();var X0={},PC,Z0;function JF(){if(Z0)return PC;Z0=1;var t=dl(),e=cs(),n=Kb(),r=gl(),i=fl(),s=e.add,o=e.has,a=e.remove;return PC=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){o(c,f)?a(d,f):s(d,f)}),d},PC}var Q0;function e$(){if(Q0)return X0;Q0=1;var t=gt(),e=JF(),n=ml();return t({target:"Set",proto:!0,real:!0,forced:!n("symmetricDifference")},{symmetricDifference:e}),X0}e$();var J0={},OC,eI;function t$(){if(eI)return OC;eI=1;var t=dl(),e=cs().add,n=Kb(),r=gl(),i=fl();return OC=function(o){var a=t(this),l=r(o).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},OC}var tI;function n$(){if(tI)return J0;tI=1;var t=gt(),e=t$(),n=ml();return t({target:"Set",proto:!0,real:!0,forced:!n("union")},{union:e}),J0}n$();var nI={},rI={},xC,iI;function r$(){if(iI)return xC;iI=1;var t=nd(),e=TypeError;return xC=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},xC}var AC,sI;function i$(){if(sI)return AC;sI=1;var t=En();return AC=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),AC}var HC,oI;function $1(){if(oI)return HC;oI=1;var t=Yr(),e=sn(),n=Lu(),r=zb(),i=i$(),s=r("IE_PROTO"),o=Object,a=o.prototype;return HC=i?o.getPrototypeOf:function(l){var u=n(l);if(t(u,s))return u[s];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof o?a:null},HC}var NC,aI;function s$(){if(aI)return NC;aI=1;var t=O1(),e=Jo();return NC=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},NC}var DC,lI;function V1(){if(lI)return DC;lI=1;var t=zr(),e=Jo(),n=Hm();return DC=function(r,i,s){t?e.f(r,i,n(0,s)):r[i]=s},DC}var LC={},kC,uI;function o$(){if(uI)return kC;uI=1;var t=x1(),e=qb();return kC=Object.keys||function(r){return t(r,e)},kC}var cI;function a$(){if(cI)return LC;cI=1;var t=zr(),e=I1(),n=Jo(),r=on(),i=td(),s=o$();return LC.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=s(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},LC}var FC,hI;function W1(){if(hI)return FC;hI=1;var t=Du();return FC=t("document","documentElement"),FC}var $C,dI;function Xb(){if(dI)return $C;dI=1;var t=on(),e=a$(),n=qb(),r=Yb(),i=W1(),s=Ub(),o=zb(),a=">",l="<",u="prototype",c="script",h=o("IE_PROTO"),d=function(){},f=function(R){return l+c+a+R+l+"/"+c+a},m=function(R){R.write(f("")),R.close();var P=R.parentWindow.Object;return R=null,P},v=function(){var R=s("iframe"),P="java"+c+":",O;return R.style.display="none",i.appendChild(R),R.src=String(P),O=R.contentWindow.document,O.open(),O.write(f("document.F=Object")),O.close(),O.F},w,b=function(){try{w=new ActiveXObject("htmlfile")}catch{}b=typeof document<"u"?document.domain&&w?m(w):v():m(w);for(var R=n.length;R--;)delete b[u][n[R]];return b()};return r[h]=!0,$C=Object.create||function(P,O){var D;return P!==null?(d[u]=t(P),D=new d,d[u]=null,D[h]=P):D=b(),O===void 0?D:e.f(D,O)},$C}var VC,fI;function B1(){if(fI)return VC;fI=1;var t=En(),e=sn(),n=bi(),r=Xb(),i=$1(),s=Gb(),o=Ri(),a=Qo(),l=o("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var m={};return c[l].call(m)!==m});return f?c={}:a&&(c=r(c)),e(c[l])||s(c,l,function(){return this}),VC={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},VC}var gI;function l$(){if(gI)return rI;gI=1;var t=gt(),e=dn(),n=r$(),r=on(),i=sn(),s=$1(),o=s$(),a=V1(),l=En(),u=Yr(),c=Ri(),h=B1().IteratorPrototype,d=zr(),f=Qo(),m="constructor",v="Iterator",w=c("toStringTag"),b=TypeError,R=e[v],P=f||!i(R)||R.prototype!==h||!l(function(){R({})}),O=function(){if(n(this,h),s(this)===h)throw new b("Abstract class Iterator not directly constructable")},D=function(M,A){d?o(h,M,{configurable:!0,get:function(){return A},set:function(j){if(r(this),this===h)throw new b("You can't redefine this property");u(this,M)?this[M]=j:a(this,M,j)}}):h[M]=A};return u(h,w)||D(w,v),(P||!u(h,m)||h[m]===Object)&&D(m,O),O.prototype=h,t({global:!0,constructor:!0,forced:P},{Iterator:O}),rI}var mI;function u$(){return mI||(mI=1,l$()),nI}u$();var pI={},wI={},WC,CI;function c$(){if(CI)return WC;CI=1;var t=Gb();return WC=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},WC}var BC,vI;function h$(){return vI||(vI=1,BC=function(t,e){return{value:t,done:e}}),BC}var jC,yI;function Zb(){if(yI)return jC;yI=1;var t=Fn(),e=Xb(),n=ku(),r=c$(),i=Ri(),s=P1(),o=rd(),a=B1().IteratorPrototype,l=h$(),u=$u(),c=i("toStringTag"),h="IteratorHelper",d="WrapForValidIterator",f=s.set,m=function(b){var R=s.getterFor(b?d:h);return r(e(a),{next:function(){var O=R(this);if(b)return O.nextHandler();if(O.done)return l(void 0,!0);try{var D=O.nextHandler();return O.returnHandlerResult?D:l(D,O.done)}catch(M){throw O.done=!0,M}},return:function(){var P=R(this),O=P.iterator;if(P.done=!0,b){var D=o(O,"return");return D?t(D,O):l(void 0,!0)}if(P.inner)try{u(P.inner.iterator,"normal")}catch(M){return u(O,"throw",M)}return O&&u(O,"normal"),l(void 0,!0)}})},v=m(!0),w=m(!1);return n(w,c,"Iterator Helper"),jC=function(b,R,P){var O=function(M,A){A?(A.iterator=M.iterator,A.next=M.next):A=M,A.type=R?d:h,A.returnHandlerResult=!!P,A.nextHandler=b,A.counter=0,A.done=!1,f(this,A)};return O.prototype=R?v:w,O},jC}var UC,SI;function j1(){if(SI)return UC;SI=1;var t=on(),e=$u();return UC=function(n,r,i,s){try{return s?r(t(i)[0],i[1]):r(i)}catch(o){e(n,"throw",o)}},UC}var bI;function d$(){if(bI)return wI;bI=1;var t=gt(),e=Fn(),n=dr(),r=on(),i=hs(),s=Zb(),o=j1(),a=Qo(),l=s(function(){for(var u=this.iterator,c=this.predicate,h=this.next,d,f,m;;){if(d=r(e(h,u)),f=this.done=!!d.done,f)return;if(m=d.value,o(u,c,[m,this.counter++],!0))return m}});return t({target:"Iterator",proto:!0,real:!0,forced:a},{filter:function(c){return r(this),n(c),new l(i(this),{predicate:c})}}),wI}var RI;function f$(){return RI||(RI=1,d$()),pI}f$();var EI={},TI={},zC,_I;function g$(){if(_I)return zC;_I=1;var t=hl(),e=Zt();return zC=function(n){if(t(n)==="Function")return e(n)},zC}var YC,MI;function U1(){if(MI)return YC;MI=1;var t=g$(),e=dr(),n=Am(),r=t(t.bind);return YC=function(i,s){return e(i),s===void 0?i:n?r(i,s):function(){return i.apply(s,arguments)}},YC}var GC,II;function z1(){return II||(II=1,GC={}),GC}var qC,PI;function m$(){if(PI)return qC;PI=1;var t=Ri(),e=z1(),n=t("iterator"),r=Array.prototype;return qC=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},qC}var KC,OI;function Qb(){if(OI)return KC;OI=1;var t=D1(),e=rd(),n=Nm(),r=z1(),i=Ri(),s=i("iterator");return KC=function(o){if(!n(o))return e(o,s)||e(o,"@@iterator")||r[t(o)]},KC}var XC,xI;function p$(){if(xI)return XC;xI=1;var t=Fn(),e=dr(),n=on(),r=Lm(),i=Qb(),s=TypeError;return XC=function(o,a){var l=arguments.length<2?i(o):a;if(e(l))return n(t(l,o));throw new s(r(o)+" is not iterable")},XC}var ZC,AI;function Vu(){if(AI)return ZC;AI=1;var t=U1(),e=Fn(),n=on(),r=Lm(),i=m$(),s=Fu(),o=nd(),a=p$(),l=Qb(),u=$u(),c=TypeError,h=function(f,m){this.stopped=f,this.result=m},d=h.prototype;return ZC=function(f,m,v){var w=v&&v.that,b=!!(v&&v.AS_ENTRIES),R=!!(v&&v.IS_RECORD),P=!!(v&&v.IS_ITERATOR),O=!!(v&&v.INTERRUPTED),D=t(m,w),M,A,j,X,U,Z,J,ae=function(fe){return M&&u(M,"normal",fe),new h(!0,fe)},ne=function(fe){return b?(n(fe),O?D(fe[0],fe[1],ae):D(fe[0],fe[1])):O?D(fe,ae):D(fe)};if(R)M=f.iterator;else if(P)M=f;else{if(A=l(f),!A)throw new c(r(f)+" is not iterable");if(i(A)){for(j=0,X=s(f);X>j;j++)if(U=ne(f[j]),U&&o(d,U))return U;return new h(!1)}M=a(f,A)}for(Z=R?f.next:M.next;!(J=e(Z,M)).done;){try{U=ne(J.value)}catch(fe){u(M,"throw",fe)}if(typeof U=="object"&&U&&o(d,U))return U}return new h(!1)},ZC}var HI;function w$(){if(HI)return TI;HI=1;var t=gt(),e=Vu(),n=dr(),r=on(),i=hs();return t({target:"Iterator",proto:!0,real:!0},{forEach:function(o){r(this),n(o);var a=i(this),l=0;e(a,function(u){o(u,l++)},{IS_RECORD:!0})}}),TI}var NI;function C$(){return NI||(NI=1,w$()),EI}C$();var DI={},LI={},QC,kI;function v$(){if(kI)return QC;kI=1;var t=Fn(),e=dr(),n=on(),r=hs(),i=Zb(),s=j1(),o=i(function(){var a=this.iterator,l=n(t(this.next,a)),u=this.done=!!l.done;if(!u)return s(a,this.mapper,[l.value,this.counter++],!0)});return QC=function(l){return n(this),e(l),new o(r(this),{mapper:l})},QC}var FI;function y$(){if(FI)return LI;FI=1;var t=gt(),e=v$(),n=Qo();return t({target:"Iterator",proto:!0,real:!0,forced:n},{map:e}),LI}var $I;function S$(){return $I||($I=1,y$()),DI}S$();var VI={},WI={},JC,BI;function Jb(){if(BI)return JC;BI=1;var t=Zt();return JC=t([].slice),JC}var ev,jI;function Y1(){if(jI)return ev;jI=1;var t=TypeError;return ev=function(e,n){if(e<n)throw new t("Not enough arguments");return e},ev}var tv,UI;function b$(){if(UI)return tv;UI=1;var t=Dm();return tv=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),tv}var nv,zI;function G1(){if(zI)return nv;zI=1;var t=dn(),e=Dm(),n=hl(),r=function(i){return e.slice(0,i.length)===i};return nv=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),nv}var rv,YI;function R$(){if(YI)return rv;YI=1;var t=G1();return rv=t==="NODE",rv}var iv,GI;function q1(){if(GI)return iv;GI=1;var t=dn(),e=km(),n=U1(),r=sn(),i=Yr(),s=En(),o=W1(),a=Jb(),l=Ub(),u=Y1(),c=b$(),h=R$(),d=t.setImmediate,f=t.clearImmediate,m=t.process,v=t.Dispatch,w=t.Function,b=t.MessageChannel,R=t.String,P=0,O={},D="onreadystatechange",M,A,j,X;s(function(){M=t.location});var U=function(ne){if(i(O,ne)){var fe=O[ne];delete O[ne],fe()}},Z=function(ne){return function(){U(ne)}},J=function(ne){U(ne.data)},ae=function(ne){t.postMessage(R(ne),M.protocol+"//"+M.host)};return(!d||!f)&&(d=function(fe){u(arguments.length,1);var mt=r(fe)?fe:w(fe),Te=a(arguments,1);return O[++P]=function(){e(mt,void 0,Te)},A(P),P},f=function(fe){delete O[fe]},h?A=function(ne){m.nextTick(Z(ne))}:v&&v.now?A=function(ne){v.now(Z(ne))}:b&&!c?(j=new b,X=j.port2,j.port1.onmessage=J,A=n(X.postMessage,X)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&M&&M.protocol!=="file:"&&!s(ae)?(A=ae,t.addEventListener("message",J,!1)):D in l("script")?A=function(ne){o.appendChild(l("script"))[D]=function(){o.removeChild(this),U(ne)}}:A=function(ne){setTimeout(Z(ne),0)}),iv={set:d,clear:f},iv}var qI;function E$(){if(qI)return WI;qI=1;var t=gt(),e=dn(),n=q1().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),WI}var KI={},sv,XI;function T$(){if(XI)return sv;XI=1;var t=dn(),e=km(),n=sn(),r=G1(),i=Dm(),s=Jb(),o=Y1(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return sv=function(u,c){var h=c?2:1;return l?function(d,f){var m=o(arguments.length,1)>h,v=n(d)?d:a(d),w=m?s(arguments,h):[],b=m?function(){e(v,this,w)}:v;return c?u(b,f):u(b)}:u},sv}var ZI;function _$(){if(ZI)return KI;ZI=1;var t=gt(),e=dn(),n=q1().set,r=T$(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),KI}var QI;function M$(){return QI||(QI=1,E$(),_$()),VI}M$();/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */const{entries:K1,setPrototypeOf:JI,isFrozen:I$,getPrototypeOf:P$,getOwnPropertyDescriptor:O$}=Object;let{freeze:Kn,seal:jr,create:X1}=Object,{apply:AS,construct:HS}=typeof Reflect<"u"&&Reflect;Kn||(Kn=function(e){return e});jr||(jr=function(e){return e});AS||(AS=function(e,n,r){return e.apply(n,r)});HS||(HS=function(e,n){return new e(...n)});const Hd=Er(Array.prototype.forEach),eP=Er(Array.prototype.pop),tc=Er(Array.prototype.push),gg=Er(String.prototype.toLowerCase),ov=Er(String.prototype.toString),tP=Er(String.prototype.match),nc=Er(String.prototype.replace),x$=Er(String.prototype.indexOf),A$=Er(String.prototype.trim),ai=Er(Object.prototype.hasOwnProperty),Vn=Er(RegExp.prototype.test),rc=H$(TypeError);function Er(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return AS(t,e,r)}}function H$(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return HS(t,n)}}function We(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gg;JI&&JI(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=n(i);s!==i&&(I$(e)||(e[r]=s),i=s)}t[i]=!0}return t}function N$(t){for(let e=0;e<t.length;e++)ai(t,e)||(t[e]=null);return t}function Ba(t){const e=X1(null);for(const[n,r]of K1(t))ai(t,n)&&(Array.isArray(r)?e[n]=N$(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Ba(r):e[n]=r);return e}function ic(t,e){for(;t!==null;){const r=O$(t,e);if(r){if(r.get)return Er(r.get);if(typeof r.value=="function")return Er(r.value)}t=P$(t)}function n(){return null}return n}const nP=Kn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),av=Kn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lv=Kn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D$=Kn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uv=Kn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),L$=Kn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),rP=Kn(["#text"]),iP=Kn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),cv=Kn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sP=Kn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Nd=Kn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),k$=jr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),F$=jr(/<%[\w\W]*|[\w\W]*%>/gm),$$=jr(/\$\{[\w\W]*}/gm),V$=jr(/^data-[\-\w.\u00B7-\uFFFF]+$/),W$=jr(/^aria-[\-\w]+$/),Z1=jr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),B$=jr(/^(?:\w+script|data):/i),j$=jr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q1=jr(/^html$/i),U$=jr(/^[a-z][.\w]*(-[.\w]+)+$/i);var oP=Object.freeze({__proto__:null,ARIA_ATTR:W$,ATTR_WHITESPACE:j$,CUSTOM_ELEMENT:U$,DATA_ATTR:V$,DOCTYPE_NAME:Q1,ERB_EXPR:F$,IS_ALLOWED_URI:Z1,IS_SCRIPT_OR_DATA:B$,MUSTACHE_EXPR:k$,TMPLIT_EXPR:$$});const sc={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},z$=function(){return typeof window>"u"?null:window},Y$=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},aP=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function J1(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:z$();const e=Se=>J1(Se);if(e.version="3.2.3",e.removed=[],!t||!t.document||t.document.nodeType!==sc.document)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,m=l.prototype,v=ic(m,"cloneNode"),w=ic(m,"remove"),b=ic(m,"nextSibling"),R=ic(m,"childNodes"),P=ic(m,"parentNode");if(typeof o=="function"){const Se=n.createElement("template");Se.content&&Se.content.ownerDocument&&(n=Se.content.ownerDocument)}let O,D="";const{implementation:M,createNodeIterator:A,createDocumentFragment:j,getElementsByTagName:X}=n,{importNode:U}=r;let Z=aP();e.isSupported=typeof K1=="function"&&typeof P=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:J,ERB_EXPR:ae,TMPLIT_EXPR:ne,DATA_ATTR:fe,ARIA_ATTR:mt,IS_SCRIPT_OR_DATA:Te,ATTR_WHITESPACE:$e,CUSTOM_ELEMENT:Et}=oP;let{IS_ALLOWED_URI:en}=oP,g=null;const p=We({},[...nP,...av,...lv,...uv,...rP]);let y=null;const E=We({},[...iP,...cv,...sP,...Nd]);let H=Object.seal(X1(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),W=null,q=null,G=!0,le=!0,C=!1,S=!0,T=!1,F=!0,I=!1,k=!1,B=!1,x=!1,L=!1,$=!1,V=!0,z=!1;const se="user-content-";let ue=!0,Re=!1,Be={},Ge=null;const Ee=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Oe=null;const $t=We({},["audio","video","img","source","image","track"]);let Xr=null;const Mi=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fn="http://www.w3.org/1998/Math/MathML",tn="http://www.w3.org/2000/svg",Vt="http://www.w3.org/1999/xhtml";let wt=Vt,nt=!1,Ve=null;const Od=We({},[fn,tn,Vt],ov);let ra=We({},["mi","mo","mn","ms","mtext"]),xd=We({},["annotation-xml"]);const iF=We({},["title","style","font","a","script"]);let Qu=null;const sF=["application/xhtml+xml","text/html"],oF="text/html";let gn=null,Sl=null;const aF=n.createElement("form"),A_=function(N){return N instanceof RegExp||N instanceof Function},Lp=function(){let N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Sl&&Sl===N)){if((!N||typeof N!="object")&&(N={}),N=Ba(N),Qu=sF.indexOf(N.PARSER_MEDIA_TYPE)===-1?oF:N.PARSER_MEDIA_TYPE,gn=Qu==="application/xhtml+xml"?ov:gg,g=ai(N,"ALLOWED_TAGS")?We({},N.ALLOWED_TAGS,gn):p,y=ai(N,"ALLOWED_ATTR")?We({},N.ALLOWED_ATTR,gn):E,Ve=ai(N,"ALLOWED_NAMESPACES")?We({},N.ALLOWED_NAMESPACES,ov):Od,Xr=ai(N,"ADD_URI_SAFE_ATTR")?We(Ba(Mi),N.ADD_URI_SAFE_ATTR,gn):Mi,Oe=ai(N,"ADD_DATA_URI_TAGS")?We(Ba($t),N.ADD_DATA_URI_TAGS,gn):$t,Ge=ai(N,"FORBID_CONTENTS")?We({},N.FORBID_CONTENTS,gn):Ee,W=ai(N,"FORBID_TAGS")?We({},N.FORBID_TAGS,gn):{},q=ai(N,"FORBID_ATTR")?We({},N.FORBID_ATTR,gn):{},Be=ai(N,"USE_PROFILES")?N.USE_PROFILES:!1,G=N.ALLOW_ARIA_ATTR!==!1,le=N.ALLOW_DATA_ATTR!==!1,C=N.ALLOW_UNKNOWN_PROTOCOLS||!1,S=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,T=N.SAFE_FOR_TEMPLATES||!1,F=N.SAFE_FOR_XML!==!1,I=N.WHOLE_DOCUMENT||!1,x=N.RETURN_DOM||!1,L=N.RETURN_DOM_FRAGMENT||!1,$=N.RETURN_TRUSTED_TYPE||!1,B=N.FORCE_BODY||!1,V=N.SANITIZE_DOM!==!1,z=N.SANITIZE_NAMED_PROPS||!1,ue=N.KEEP_CONTENT!==!1,Re=N.IN_PLACE||!1,en=N.ALLOWED_URI_REGEXP||Z1,wt=N.NAMESPACE||Vt,ra=N.MATHML_TEXT_INTEGRATION_POINTS||ra,xd=N.HTML_INTEGRATION_POINTS||xd,H=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&A_(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&A_(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(H.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),T&&(le=!1),L&&(x=!0),Be&&(g=We({},rP),y=[],Be.html===!0&&(We(g,nP),We(y,iP)),Be.svg===!0&&(We(g,av),We(y,cv),We(y,Nd)),Be.svgFilters===!0&&(We(g,lv),We(y,cv),We(y,Nd)),Be.mathMl===!0&&(We(g,uv),We(y,sP),We(y,Nd))),N.ADD_TAGS&&(g===p&&(g=Ba(g)),We(g,N.ADD_TAGS,gn)),N.ADD_ATTR&&(y===E&&(y=Ba(y)),We(y,N.ADD_ATTR,gn)),N.ADD_URI_SAFE_ATTR&&We(Xr,N.ADD_URI_SAFE_ATTR,gn),N.FORBID_CONTENTS&&(Ge===Ee&&(Ge=Ba(Ge)),We(Ge,N.FORBID_CONTENTS,gn)),ue&&(g["#text"]=!0),I&&We(g,["html","head","body"]),g.table&&(We(g,["tbody"]),delete W.tbody),N.TRUSTED_TYPES_POLICY){if(typeof N.TRUSTED_TYPES_POLICY.createHTML!="function")throw rc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof N.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw rc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');O=N.TRUSTED_TYPES_POLICY,D=O.createHTML("")}else O===void 0&&(O=Y$(f,i)),O!==null&&typeof D=="string"&&(D=O.createHTML(""));Kn&&Kn(N),Sl=N}},H_=We({},[...av,...lv,...D$]),N_=We({},[...uv,...L$]),lF=function(N){let ee=P(N);(!ee||!ee.tagName)&&(ee={namespaceURI:wt,tagName:"template"});const we=gg(N.tagName),Tt=gg(ee.tagName);return Ve[N.namespaceURI]?N.namespaceURI===tn?ee.namespaceURI===Vt?we==="svg":ee.namespaceURI===fn?we==="svg"&&(Tt==="annotation-xml"||ra[Tt]):!!H_[we]:N.namespaceURI===fn?ee.namespaceURI===Vt?we==="math":ee.namespaceURI===tn?we==="math"&&xd[Tt]:!!N_[we]:N.namespaceURI===Vt?ee.namespaceURI===tn&&!xd[Tt]||ee.namespaceURI===fn&&!ra[Tt]?!1:!N_[we]&&(iF[we]||!H_[we]):!!(Qu==="application/xhtml+xml"&&Ve[N.namespaceURI]):!1},Ii=function(N){tc(e.removed,{element:N});try{P(N).removeChild(N)}catch{w(N)}},Ad=function(N,ee){try{tc(e.removed,{attribute:ee.getAttributeNode(N),from:ee})}catch{tc(e.removed,{attribute:null,from:ee})}if(ee.removeAttribute(N),N==="is")if(x||L)try{Ii(ee)}catch{}else try{ee.setAttribute(N,"")}catch{}},D_=function(N){let ee=null,we=null;if(B)N="<remove></remove>"+N;else{const Sn=tP(N,/^[\r\n\t ]+/);we=Sn&&Sn[0]}Qu==="application/xhtml+xml"&&wt===Vt&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");const Tt=O?O.createHTML(N):N;if(wt===Vt)try{ee=new d().parseFromString(Tt,Qu)}catch{}if(!ee||!ee.documentElement){ee=M.createDocument(wt,"template",null);try{ee.documentElement.innerHTML=nt?D:Tt}catch{}}const _n=ee.body||ee.documentElement;return N&&we&&_n.insertBefore(n.createTextNode(we),_n.childNodes[0]||null),wt===Vt?X.call(ee,I?"html":"body")[0]:I?ee.documentElement:_n},L_=function(N){return A.call(N.ownerDocument||N,N,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},kp=function(N){return N instanceof h&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},k_=function(N){return typeof a=="function"&&N instanceof a};function ps(Se,N,ee){Hd(Se,we=>{we.call(e,N,ee,Sl)})}const F_=function(N){let ee=null;if(ps(Z.beforeSanitizeElements,N,null),kp(N))return Ii(N),!0;const we=gn(N.nodeName);if(ps(Z.uponSanitizeElement,N,{tagName:we,allowedTags:g}),N.hasChildNodes()&&!k_(N.firstElementChild)&&Vn(/<[/\w]/g,N.innerHTML)&&Vn(/<[/\w]/g,N.textContent)||N.nodeType===sc.progressingInstruction||F&&N.nodeType===sc.comment&&Vn(/<[/\w]/g,N.data))return Ii(N),!0;if(!g[we]||W[we]){if(!W[we]&&V_(we)&&(H.tagNameCheck instanceof RegExp&&Vn(H.tagNameCheck,we)||H.tagNameCheck instanceof Function&&H.tagNameCheck(we)))return!1;if(ue&&!Ge[we]){const Tt=P(N)||N.parentNode,_n=R(N)||N.childNodes;if(_n&&Tt){const Sn=_n.length;for(let Zn=Sn-1;Zn>=0;--Zn){const Pi=v(_n[Zn],!0);Pi.__removalCount=(N.__removalCount||0)+1,Tt.insertBefore(Pi,b(N))}}}return Ii(N),!0}return N instanceof l&&!lF(N)||(we==="noscript"||we==="noembed"||we==="noframes")&&Vn(/<\/no(script|embed|frames)/i,N.innerHTML)?(Ii(N),!0):(T&&N.nodeType===sc.text&&(ee=N.textContent,Hd([J,ae,ne],Tt=>{ee=nc(ee,Tt," ")}),N.textContent!==ee&&(tc(e.removed,{element:N.cloneNode()}),N.textContent=ee)),ps(Z.afterSanitizeElements,N,null),!1)},$_=function(N,ee,we){if(V&&(ee==="id"||ee==="name")&&(we in n||we in aF))return!1;if(!(le&&!q[ee]&&Vn(fe,ee))){if(!(G&&Vn(mt,ee))){if(!y[ee]||q[ee]){if(!(V_(N)&&(H.tagNameCheck instanceof RegExp&&Vn(H.tagNameCheck,N)||H.tagNameCheck instanceof Function&&H.tagNameCheck(N))&&(H.attributeNameCheck instanceof RegExp&&Vn(H.attributeNameCheck,ee)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(ee))||ee==="is"&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&Vn(H.tagNameCheck,we)||H.tagNameCheck instanceof Function&&H.tagNameCheck(we))))return!1}else if(!Xr[ee]){if(!Vn(en,nc(we,$e,""))){if(!((ee==="src"||ee==="xlink:href"||ee==="href")&&N!=="script"&&x$(we,"data:")===0&&Oe[N])){if(!(C&&!Vn(Te,nc(we,$e,"")))){if(we)return!1}}}}}}return!0},V_=function(N){return N!=="annotation-xml"&&tP(N,Et)},W_=function(N){ps(Z.beforeSanitizeAttributes,N,null);const{attributes:ee}=N;if(!ee||kp(N))return;const we={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:y,forceKeepAttr:void 0};let Tt=ee.length;for(;Tt--;){const _n=ee[Tt],{name:Sn,namespaceURI:Zn,value:Pi}=_n,Ju=gn(Sn);let $n=Sn==="value"?Pi:A$(Pi);if(we.attrName=Ju,we.attrValue=$n,we.keepAttr=!0,we.forceKeepAttr=void 0,ps(Z.uponSanitizeAttribute,N,we),$n=we.attrValue,z&&(Ju==="id"||Ju==="name")&&(Ad(Sn,N),$n=se+$n),F&&Vn(/((--!?|])>)|<\/(style|title)/i,$n)){Ad(Sn,N);continue}if(we.forceKeepAttr||(Ad(Sn,N),!we.keepAttr))continue;if(!S&&Vn(/\/>/i,$n)){Ad(Sn,N);continue}T&&Hd([J,ae,ne],j_=>{$n=nc($n,j_," ")});const B_=gn(N.nodeName);if($_(B_,Ju,$n)){if(O&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Zn)switch(f.getAttributeType(B_,Ju)){case"TrustedHTML":{$n=O.createHTML($n);break}case"TrustedScriptURL":{$n=O.createScriptURL($n);break}}try{Zn?N.setAttributeNS(Zn,Sn,$n):N.setAttribute(Sn,$n),kp(N)?Ii(N):eP(e.removed)}catch{}}}ps(Z.afterSanitizeAttributes,N,null)},uF=function Se(N){let ee=null;const we=L_(N);for(ps(Z.beforeSanitizeShadowDOM,N,null);ee=we.nextNode();)ps(Z.uponSanitizeShadowNode,ee,null),F_(ee),W_(ee),ee.content instanceof s&&Se(ee.content);ps(Z.afterSanitizeShadowDOM,N,null)};return e.sanitize=function(Se){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee=null,we=null,Tt=null,_n=null;if(nt=!Se,nt&&(Se="<!-->"),typeof Se!="string"&&!k_(Se))if(typeof Se.toString=="function"){if(Se=Se.toString(),typeof Se!="string")throw rc("dirty is not a string, aborting")}else throw rc("toString is not a function");if(!e.isSupported)return Se;if(k||Lp(N),e.removed=[],typeof Se=="string"&&(Re=!1),Re){if(Se.nodeName){const Pi=gn(Se.nodeName);if(!g[Pi]||W[Pi])throw rc("root node is forbidden and cannot be sanitized in-place")}}else if(Se instanceof a)ee=D_("<!---->"),we=ee.ownerDocument.importNode(Se,!0),we.nodeType===sc.element&&we.nodeName==="BODY"||we.nodeName==="HTML"?ee=we:ee.appendChild(we);else{if(!x&&!T&&!I&&Se.indexOf("<")===-1)return O&&$?O.createHTML(Se):Se;if(ee=D_(Se),!ee)return x?null:$?D:""}ee&&B&&Ii(ee.firstChild);const Sn=L_(Re?Se:ee);for(;Tt=Sn.nextNode();)F_(Tt),W_(Tt),Tt.content instanceof s&&uF(Tt.content);if(Re)return Se;if(x){if(L)for(_n=j.call(ee.ownerDocument);ee.firstChild;)_n.appendChild(ee.firstChild);else _n=ee;return(y.shadowroot||y.shadowrootmode)&&(_n=U.call(r,_n,!0)),_n}let Zn=I?ee.outerHTML:ee.innerHTML;return I&&g["!doctype"]&&ee.ownerDocument&&ee.ownerDocument.doctype&&ee.ownerDocument.doctype.name&&Vn(Q1,ee.ownerDocument.doctype.name)&&(Zn="<!DOCTYPE "+ee.ownerDocument.doctype.name+`>
`+Zn),T&&Hd([J,ae,ne],Pi=>{Zn=nc(Zn,Pi," ")}),O&&$?O.createHTML(Zn):Zn},e.setConfig=function(){let Se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lp(Se),k=!0},e.clearConfig=function(){Sl=null,k=!1},e.isValidAttribute=function(Se,N,ee){Sl||Lp({});const we=gn(Se),Tt=gn(N);return $_(we,Tt,ee)},e.addHook=function(Se,N){typeof N=="function"&&tc(Z[Se],N)},e.removeHook=function(Se){return eP(Z[Se])},e.removeHooks=function(Se){Z[Se]=[]},e.removeAllHooks=function(){Z=aP()},e}var G$=J1();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var eH;function K(){return eH.apply(null,arguments)}function q$(t){eH=t}function Ci(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function tl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function eR(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ze(t,e))return!1;return!0}function ir(t){return t===void 0}function Zs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function ad(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function tH(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Lo(t,e){for(var n in e)Ze(e,n)&&(t[n]=e[n]);return Ze(e,"toString")&&(t.toString=e.toString),Ze(e,"valueOf")&&(t.valueOf=e.valueOf),t}function ds(t,e,n,r){return EH(t,e,n,r,!0).utc()}function K$(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function xe(t){return t._pf==null&&(t._pf=K$()),t._pf}var NS;Array.prototype.some?NS=Array.prototype.some:NS=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function tR(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=xe(t),n=NS.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function $m(t){var e=ds(NaN);return t!=null?Lo(xe(e),t):xe(e).userInvalidated=!0,e}var lP=K.momentProperties=[],hv=!1;function nR(t,e){var n,r,i,s=lP.length;if(ir(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ir(e._i)||(t._i=e._i),ir(e._f)||(t._f=e._f),ir(e._l)||(t._l=e._l),ir(e._strict)||(t._strict=e._strict),ir(e._tzm)||(t._tzm=e._tzm),ir(e._isUTC)||(t._isUTC=e._isUTC),ir(e._offset)||(t._offset=e._offset),ir(e._pf)||(t._pf=xe(e)),ir(e._locale)||(t._locale=e._locale),s>0)for(n=0;n<s;n++)r=lP[n],i=e[r],ir(i)||(t[r]=i);return t}function ld(t){nR(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),hv===!1&&(hv=!0,K.updateOffset(this),hv=!1)}function vi(t){return t instanceof ld||t!=null&&t._isAMomentObject!=null}function nH(t){K.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Gr(t,e){var n=!0;return Lo(function(){if(K.deprecationHandler!=null&&K.deprecationHandler(null,t),n){var r=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Ze(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];r.push(i)}nH(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var uP={};function rH(t,e){K.deprecationHandler!=null&&K.deprecationHandler(t,e),uP[t]||(nH(e),uP[t]=!0)}K.suppressDeprecationWarnings=!1;K.deprecationHandler=null;function fs(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function X$(t){var e,n;for(n in t)Ze(t,n)&&(e=t[n],fs(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function DS(t,e){var n=Lo({},t),r;for(r in e)Ze(e,r)&&(tl(t[r])&&tl(e[r])?(n[r]={},Lo(n[r],t[r]),Lo(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)Ze(t,r)&&!Ze(e,r)&&tl(t[r])&&(n[r]=Lo({},n[r]));return n}function rR(t){t!=null&&this.set(t)}var LS;Object.keys?LS=Object.keys:LS=function(t){var e,n=[];for(e in t)Ze(t,e)&&n.push(e);return n};var Z$={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Q$(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return fs(r)?r.call(e,n):r}function us(t,e,n){var r=""+Math.abs(t),i=e-r.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var iR=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Dd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,dv={},vu={};function ve(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(vu[t]=i),e&&(vu[e[0]]=function(){return us(i.apply(this,arguments),e[1],e[2])}),n&&(vu[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function J$(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function eV(t){var e=t.match(iR),n,r;for(n=0,r=e.length;n<r;n++)vu[e[n]]?e[n]=vu[e[n]]:e[n]=J$(e[n]);return function(i){var s="",o;for(o=0;o<r;o++)s+=fs(e[o])?e[o].call(i,t):e[o];return s}}function mg(t,e){return t.isValid()?(e=iH(e,t.localeData()),dv[e]=dv[e]||eV(e),dv[e](t)):t.localeData().invalidDate()}function iH(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Dd.lastIndex=0;n>=0&&Dd.test(t);)t=t.replace(Dd,r),Dd.lastIndex=0,n-=1;return t}var tV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function nV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(iR).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var rV="Invalid date";function iV(){return this._invalidDate}var sV="%d",oV=/\d{1,2}/;function aV(t){return this._ordinal.replace("%d",t)}var lV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function uV(t,e,n,r){var i=this._relativeTime[n];return fs(i)?i(t,e,n,r):i.replace(/%d/i,t)}function cV(t,e){var n=this._relativeTime[t>0?"future":"past"];return fs(n)?n(e):n.replace(/%s/i,e)}var cP={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function qr(t){return typeof t=="string"?cP[t]||cP[t.toLowerCase()]:void 0}function sR(t){var e={},n,r;for(r in t)Ze(t,r)&&(n=qr(r),n&&(e[n]=t[r]));return e}var hV={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function dV(t){var e=[],n;for(n in t)Ze(t,n)&&e.push({unit:n,priority:hV[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var sH=/\d/,Tr=/\d\d/,oH=/\d{3}/,oR=/\d{4}/,Vm=/[+-]?\d{6}/,Rt=/\d\d?/,aH=/\d\d\d\d?/,lH=/\d\d\d\d\d\d?/,Wm=/\d{1,3}/,aR=/\d{1,4}/,Bm=/[+-]?\d{1,6}/,Wu=/\d+/,jm=/[+-]?\d+/,fV=/Z|[+-]\d\d:?\d\d/gi,Um=/Z|[+-]\d\d(?::?\d\d)?/gi,gV=/[+-]?\d+(\.\d{1,3})?/,ud=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Bu=/^[1-9]\d?/,lR=/^([1-9]\d|\d)/,Lg;Lg={};function he(t,e,n){Lg[t]=fs(e)?e:function(r,i){return r&&n?n:e}}function mV(t,e){return Ze(Lg,t)?Lg[t](e._strict,e._locale):new RegExp(pV(t))}function pV(t){return Ks(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,s){return n||r||i||s}))}function Ks(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function $r(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ze(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=$r(e)),n}var kS={};function ht(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Zs(e)&&(r=function(s,o){o[e]=ze(s)}),i=t.length,n=0;n<i;n++)kS[t[n]]=r}function cd(t,e){ht(t,function(n,r,i,s){i._w=i._w||{},e(n,i._w,i,s)})}function wV(t,e,n){e!=null&&Ze(kS,t)&&kS[t](e,n._a,n,t)}function zm(t){return t%4===0&&t%100!==0||t%400===0}var Dn=0,Bs=1,rs=2,hn=3,mi=4,js=5,qa=6,CV=7,vV=8;ve("Y",0,0,function(){var t=this.year();return t<=9999?us(t,4):"+"+t});ve(0,["YY",2],0,function(){return this.year()%100});ve(0,["YYYY",4],0,"year");ve(0,["YYYYY",5],0,"year");ve(0,["YYYYYY",6,!0],0,"year");he("Y",jm);he("YY",Rt,Tr);he("YYYY",aR,oR);he("YYYYY",Bm,Vm);he("YYYYYY",Bm,Vm);ht(["YYYYY","YYYYYY"],Dn);ht("YYYY",function(t,e){e[Dn]=t.length===2?K.parseTwoDigitYear(t):ze(t)});ht("YY",function(t,e){e[Dn]=K.parseTwoDigitYear(t)});ht("Y",function(t,e){e[Dn]=parseInt(t,10)});function ch(t){return zm(t)?366:365}K.parseTwoDigitYear=function(t){return ze(t)+(ze(t)>68?1900:2e3)};var uH=ju("FullYear",!0);function yV(){return zm(this.year())}function ju(t,e){return function(n){return n!=null?(cH(this,t,n),K.updateOffset(this,e),this):Hh(this,t)}}function Hh(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function cH(t,e,n){var r,i,s,o,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}s=n,o=t.month(),a=t.date(),a=a===29&&o===1&&!zm(s)?28:a,i?r.setUTCFullYear(s,o,a):r.setFullYear(s,o,a)}}function SV(t){return t=qr(t),fs(this[t])?this[t]():this}function bV(t,e){if(typeof t=="object"){t=sR(t);var n=dV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=qr(t),fs(this[t]))return this[t](e);return this}function RV(t,e){return(t%e+e)%e}var qt;Array.prototype.indexOf?qt=Array.prototype.indexOf:qt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function uR(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=RV(e,12);return t+=(e-n)/12,n===1?zm(t)?29:28:31-n%7%2}ve("M",["MM",2],"Mo",function(){return this.month()+1});ve("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ve("MMMM",0,0,function(t){return this.localeData().months(this,t)});he("M",Rt,Bu);he("MM",Rt,Tr);he("MMM",function(t,e){return e.monthsShortRegex(t)});he("MMMM",function(t,e){return e.monthsRegex(t)});ht(["M","MM"],function(t,e){e[Bs]=ze(t)-1});ht(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Bs]=i:xe(n).invalidMonth=t});var EV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),hH="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),dH=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,TV=ud,_V=ud;function MV(t,e){return t?Ci(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||dH).test(e)?"format":"standalone"][t.month()]:Ci(this._months)?this._months:this._months.standalone}function IV(t,e){return t?Ci(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[dH.test(e)?"format":"standalone"][t.month()]:Ci(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function PV(t,e,n){var r,i,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=ds([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return n?e==="MMM"?(i=qt.call(this._shortMonthsParse,o),i!==-1?i:null):(i=qt.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=qt.call(this._shortMonthsParse,o),i!==-1?i:(i=qt.call(this._longMonthsParse,o),i!==-1?i:null)):(i=qt.call(this._longMonthsParse,o),i!==-1?i:(i=qt.call(this._shortMonthsParse,o),i!==-1?i:null))}function OV(t,e,n){var r,i,s;if(this._monthsParseExact)return PV.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=ds([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function fH(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ze(e);else if(e=t.localeData().monthsParse(e),!Zs(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,uR(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function gH(t){return t!=null?(fH(this,t),K.updateOffset(this,!0),this):Hh(this,"Month")}function xV(){return uR(this.year(),this.month())}function AV(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||mH.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ze(this,"_monthsShortRegex")||(this._monthsShortRegex=TV),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function HV(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||mH.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ze(this,"_monthsRegex")||(this._monthsRegex=_V),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function mH(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,s,o,a;for(i=0;i<12;i++)s=ds([2e3,i]),o=Ks(this.monthsShort(s,"")),a=Ks(this.months(s,"")),e.push(o),n.push(a),r.push(a),r.push(o);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function NV(t,e,n,r,i,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,s,o),a}function Nh(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function kg(t,e,n){var r=7+e-n,i=(7+Nh(t,0,r).getUTCDay()-e)%7;return-i+r-1}function pH(t,e,n,r,i){var s=(7+n-r)%7,o=kg(t,r,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=t-1,u=ch(l)+a):a>ch(t)?(l=t+1,u=a-ch(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Dh(t,e,n){var r=kg(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,s,o;return i<1?(o=t.year()-1,s=i+Xs(o,e,n)):i>Xs(t.year(),e,n)?(s=i-Xs(t.year(),e,n),o=t.year()+1):(o=t.year(),s=i),{week:s,year:o}}function Xs(t,e,n){var r=kg(t,e,n),i=kg(t+1,e,n);return(ch(t)-r+i)/7}ve("w",["ww",2],"wo","week");ve("W",["WW",2],"Wo","isoWeek");he("w",Rt,Bu);he("ww",Rt,Tr);he("W",Rt,Bu);he("WW",Rt,Tr);cd(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=ze(t)});function DV(t){return Dh(t,this._week.dow,this._week.doy).week}var LV={dow:0,doy:6};function kV(){return this._week.dow}function FV(){return this._week.doy}function $V(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function VV(t){var e=Dh(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}ve("d",0,"do","day");ve("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ve("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ve("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ve("e",0,0,"weekday");ve("E",0,0,"isoWeekday");he("d",Rt);he("e",Rt);he("E",Rt);he("dd",function(t,e){return e.weekdaysMinRegex(t)});he("ddd",function(t,e){return e.weekdaysShortRegex(t)});he("dddd",function(t,e){return e.weekdaysRegex(t)});cd(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:xe(n).invalidWeekday=t});cd(["d","e","E"],function(t,e,n,r){e[r]=ze(t)});function WV(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function BV(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function cR(t,e){return t.slice(e,7).concat(t.slice(0,e))}var jV="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),wH="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),UV="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),zV=ud,YV=ud,GV=ud;function qV(t,e){var n=Ci(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?cR(n,this._week.dow):t?n[t.day()]:n}function KV(t){return t===!0?cR(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function XV(t){return t===!0?cR(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function ZV(t,e,n){var r,i,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=ds([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return n?e==="dddd"?(i=qt.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=qt.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=qt.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=qt.call(this._weekdaysParse,o),i!==-1||(i=qt.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=qt.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=qt.call(this._shortWeekdaysParse,o),i!==-1||(i=qt.call(this._weekdaysParse,o),i!==-1)?i:(i=qt.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=qt.call(this._minWeekdaysParse,o),i!==-1||(i=qt.call(this._weekdaysParse,o),i!==-1)?i:(i=qt.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function QV(t,e,n){var r,i,s;if(this._weekdaysParseExact)return ZV.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=ds([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function JV(t){if(!this.isValid())return t!=null?this:NaN;var e=Hh(this,"Day");return t!=null?(t=WV(t,this.localeData()),this.add(t-e,"d")):e}function eW(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function tW(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=BV(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function nW(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||hR.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ze(this,"_weekdaysRegex")||(this._weekdaysRegex=zV),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function rW(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||hR.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ze(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=YV),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function iW(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||hR.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ze(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=GV),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function hR(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=ds([2e3,1]).day(s),a=Ks(this.weekdaysMin(o,"")),l=Ks(this.weekdaysShort(o,"")),u=Ks(this.weekdays(o,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function dR(){return this.hours()%12||12}function sW(){return this.hours()||24}ve("H",["HH",2],0,"hour");ve("h",["hh",2],0,dR);ve("k",["kk",2],0,sW);ve("hmm",0,0,function(){return""+dR.apply(this)+us(this.minutes(),2)});ve("hmmss",0,0,function(){return""+dR.apply(this)+us(this.minutes(),2)+us(this.seconds(),2)});ve("Hmm",0,0,function(){return""+this.hours()+us(this.minutes(),2)});ve("Hmmss",0,0,function(){return""+this.hours()+us(this.minutes(),2)+us(this.seconds(),2)});function CH(t,e){ve(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}CH("a",!0);CH("A",!1);function vH(t,e){return e._meridiemParse}he("a",vH);he("A",vH);he("H",Rt,lR);he("h",Rt,Bu);he("k",Rt,Bu);he("HH",Rt,Tr);he("hh",Rt,Tr);he("kk",Rt,Tr);he("hmm",aH);he("hmmss",lH);he("Hmm",aH);he("Hmmss",lH);ht(["H","HH"],hn);ht(["k","kk"],function(t,e,n){var r=ze(t);e[hn]=r===24?0:r});ht(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});ht(["h","hh"],function(t,e,n){e[hn]=ze(t),xe(n).bigHour=!0});ht("hmm",function(t,e,n){var r=t.length-2;e[hn]=ze(t.substr(0,r)),e[mi]=ze(t.substr(r)),xe(n).bigHour=!0});ht("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[hn]=ze(t.substr(0,r)),e[mi]=ze(t.substr(r,2)),e[js]=ze(t.substr(i)),xe(n).bigHour=!0});ht("Hmm",function(t,e,n){var r=t.length-2;e[hn]=ze(t.substr(0,r)),e[mi]=ze(t.substr(r))});ht("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[hn]=ze(t.substr(0,r)),e[mi]=ze(t.substr(r,2)),e[js]=ze(t.substr(i))});function oW(t){return(t+"").toLowerCase().charAt(0)==="p"}var aW=/[ap]\.?m?\.?/i,lW=ju("Hours",!0);function uW(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var yH={calendar:Z$,longDateFormat:tV,invalidDate:rV,ordinal:sV,dayOfMonthOrdinalParse:oV,relativeTime:lV,months:EV,monthsShort:hH,week:LV,weekdays:jV,weekdaysMin:UV,weekdaysShort:wH,meridiemParse:aW},Mt={},oc={},Lh;function cW(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function hP(t){return t&&t.toLowerCase().replace("_","-")}function hW(t){for(var e=0,n,r,i,s;e<t.length;){for(s=hP(t[e]).split("-"),n=s.length,r=hP(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Ym(s.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&cW(s,r)>=n-1)break;n--}e++}return Lh}function dW(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Ym(t){var e=null,n;if(Mt[t]===void 0&&typeof module<"u"&&module&&module.exports&&dW(t))try{e=Lh._abbr,n=require,n("./locale/"+t),Bo(e)}catch{Mt[t]=null}return Mt[t]}function Bo(t,e){var n;return t&&(ir(e)?n=no(t):n=fR(t,e),n?Lh=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Lh._abbr}function fR(t,e){if(e!==null){var n,r=yH;if(e.abbr=t,Mt[t]!=null)rH("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Mt[t]._config;else if(e.parentLocale!=null)if(Mt[e.parentLocale]!=null)r=Mt[e.parentLocale]._config;else if(n=Ym(e.parentLocale),n!=null)r=n._config;else return oc[e.parentLocale]||(oc[e.parentLocale]=[]),oc[e.parentLocale].push({name:t,config:e}),null;return Mt[t]=new rR(DS(r,e)),oc[t]&&oc[t].forEach(function(i){fR(i.name,i.config)}),Bo(t),Mt[t]}else return delete Mt[t],null}function fW(t,e){if(e!=null){var n,r,i=yH;Mt[t]!=null&&Mt[t].parentLocale!=null?Mt[t].set(DS(Mt[t]._config,e)):(r=Ym(t),r!=null&&(i=r._config),e=DS(i,e),r==null&&(e.abbr=t),n=new rR(e),n.parentLocale=Mt[t],Mt[t]=n),Bo(t)}else Mt[t]!=null&&(Mt[t].parentLocale!=null?(Mt[t]=Mt[t].parentLocale,t===Bo()&&Bo(t)):Mt[t]!=null&&delete Mt[t]);return Mt[t]}function no(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Lh;if(!Ci(t)){if(e=Ym(t),e)return e;t=[t]}return hW(t)}function gW(){return LS(Mt)}function gR(t){var e,n=t._a;return n&&xe(t).overflow===-2&&(e=n[Bs]<0||n[Bs]>11?Bs:n[rs]<1||n[rs]>uR(n[Dn],n[Bs])?rs:n[hn]<0||n[hn]>24||n[hn]===24&&(n[mi]!==0||n[js]!==0||n[qa]!==0)?hn:n[mi]<0||n[mi]>59?mi:n[js]<0||n[js]>59?js:n[qa]<0||n[qa]>999?qa:-1,xe(t)._overflowDayOfYear&&(e<Dn||e>rs)&&(e=rs),xe(t)._overflowWeeks&&e===-1&&(e=CV),xe(t)._overflowWeekday&&e===-1&&(e=vV),xe(t).overflow=e),t}var mW=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pW=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wW=/Z|[+-]\d\d(?::?\d\d)?/,Ld=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],fv=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],CW=/^\/?Date\((-?\d+)/i,vW=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yW={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function SH(t){var e,n,r=t._i,i=mW.exec(r)||pW.exec(r),s,o,a,l,u=Ld.length,c=fv.length;if(i){for(xe(t).iso=!0,e=0,n=u;e<n;e++)if(Ld[e][1].exec(i[1])){o=Ld[e][0],s=Ld[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(fv[e][1].exec(i[3])){a=(i[2]||" ")+fv[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(i[4])if(wW.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),pR(t)}else t._isValid=!1}function SW(t,e,n,r,i,s){var o=[bW(t),hH.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function bW(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function RW(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function EW(t,e,n){if(t){var r=wH.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return xe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function TW(t,e,n){if(t)return yW[t];if(e)return 0;var r=parseInt(n,10),i=r%100,s=(r-i)/100;return s*60+i}function bH(t){var e=vW.exec(RW(t._i)),n;if(e){if(n=SW(e[4],e[3],e[2],e[5],e[6],e[7]),!EW(e[1],n,t))return;t._a=n,t._tzm=TW(e[8],e[9],e[10]),t._d=Nh.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),xe(t).rfc2822=!0}else t._isValid=!1}function _W(t){var e=CW.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(SH(t),t._isValid===!1)delete t._isValid;else return;if(bH(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:K.createFromInputFallback(t)}K.createFromInputFallback=Gr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function su(t,e,n){return t??e??n}function MW(t){var e=new Date(K.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function mR(t){var e,n,r=[],i,s,o;if(!t._d){for(i=MW(t),t._w&&t._a[rs]==null&&t._a[Bs]==null&&IW(t),t._dayOfYear!=null&&(o=su(t._a[Dn],i[Dn]),(t._dayOfYear>ch(o)||t._dayOfYear===0)&&(xe(t)._overflowDayOfYear=!0),n=Nh(o,0,t._dayOfYear),t._a[Bs]=n.getUTCMonth(),t._a[rs]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[hn]===24&&t._a[mi]===0&&t._a[js]===0&&t._a[qa]===0&&(t._nextDay=!0,t._a[hn]=0),t._d=(t._useUTC?Nh:NV).apply(null,r),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[hn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(xe(t).weekdayMismatch=!0)}}function IW(t){var e,n,r,i,s,o,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,n=su(e.GG,t._a[Dn],Dh(bt(),1,4).year),r=su(e.W,1),i=su(e.E,1),(i<1||i>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,u=Dh(bt(),s,o),n=su(e.gg,t._a[Dn],u.year),r=su(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),r<1||r>Xs(n,s,o)?xe(t)._overflowWeeks=!0:l!=null?xe(t)._overflowWeekday=!0:(a=pH(n,r,i,s,o),t._a[Dn]=a.year,t._dayOfYear=a.dayOfYear)}K.ISO_8601=function(){};K.RFC_2822=function(){};function pR(t){if(t._f===K.ISO_8601){SH(t);return}if(t._f===K.RFC_2822){bH(t);return}t._a=[],xe(t).empty=!0;var e=""+t._i,n,r,i,s,o,a=e.length,l=0,u,c;for(i=iH(t._f,t._locale).match(iR)||[],c=i.length,n=0;n<c;n++)s=i[n],r=(e.match(mV(s,t))||[])[0],r&&(o=e.substr(0,e.indexOf(r)),o.length>0&&xe(t).unusedInput.push(o),e=e.slice(e.indexOf(r)+r.length),l+=r.length),vu[s]?(r?xe(t).empty=!1:xe(t).unusedTokens.push(s),wV(s,r,t)):t._strict&&!r&&xe(t).unusedTokens.push(s);xe(t).charsLeftOver=a-l,e.length>0&&xe(t).unusedInput.push(e),t._a[hn]<=12&&xe(t).bigHour===!0&&t._a[hn]>0&&(xe(t).bigHour=void 0),xe(t).parsedDateParts=t._a.slice(0),xe(t).meridiem=t._meridiem,t._a[hn]=PW(t._locale,t._a[hn],t._meridiem),u=xe(t).era,u!==null&&(t._a[Dn]=t._locale.erasConvertYear(u,t._a[Dn])),mR(t),gR(t)}function PW(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function OW(t){var e,n,r,i,s,o,a=!1,l=t._f.length;if(l===0){xe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=nR({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],pR(e),tR(e)&&(o=!0),s+=xe(e).charsLeftOver,s+=xe(e).unusedTokens.length*10,xe(e).score=s,a?s<r&&(r=s,n=e):(r==null||s<r||o)&&(r=s,n=e,o&&(a=!0));Lo(t,n||e)}function xW(t){if(!t._d){var e=sR(t._i),n=e.day===void 0?e.date:e.day;t._a=tH([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),mR(t)}}function AW(t){var e=new ld(gR(RH(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function RH(t){var e=t._i,n=t._f;return t._locale=t._locale||no(t._l),e===null||n===void 0&&e===""?$m({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),vi(e)?new ld(gR(e)):(ad(e)?t._d=e:Ci(n)?OW(t):n?pR(t):HW(t),tR(t)||(t._d=null),t))}function HW(t){var e=t._i;ir(e)?t._d=new Date(K.now()):ad(e)?t._d=new Date(e.valueOf()):typeof e=="string"?_W(t):Ci(e)?(t._a=tH(e.slice(0),function(n){return parseInt(n,10)}),mR(t)):tl(e)?xW(t):Zs(e)?t._d=new Date(e):K.createFromInputFallback(t)}function EH(t,e,n,r,i){var s={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(tl(t)&&eR(t)||Ci(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=t,s._f=e,s._strict=r,AW(s)}function bt(t,e,n,r){return EH(t,e,n,r,!1)}var NW=Gr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=bt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:$m()}),DW=Gr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=bt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:$m()});function TH(t,e){var n,r;if(e.length===1&&Ci(e[0])&&(e=e[0]),!e.length)return bt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function LW(){var t=[].slice.call(arguments,0);return TH("isBefore",t)}function kW(){var t=[].slice.call(arguments,0);return TH("isAfter",t)}var FW=function(){return Date.now?Date.now():+new Date},ac=["year","quarter","month","week","day","hour","minute","second","millisecond"];function $W(t){var e,n=!1,r,i=ac.length;for(e in t)if(Ze(t,e)&&!(qt.call(ac,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[ac[r]]){if(n)return!1;parseFloat(t[ac[r]])!==ze(t[ac[r]])&&(n=!0)}return!0}function VW(){return this._isValid}function WW(){return Ei(NaN)}function Gm(t){var e=sR(t),n=e.year||0,r=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=$W(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+r*3+n*12,this._data={},this._locale=no(),this._bubble()}function pg(t){return t instanceof Gm}function FS(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function BW(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,o;for(o=0;o<r;o++)ze(t[o])!==ze(e[o])&&s++;return s+i}function _H(t,e){ve(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+us(~~(n/60),2)+e+us(~~n%60,2)})}_H("Z",":");_H("ZZ","");he("Z",Um);he("ZZ",Um);ht(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=wR(Um,t)});var jW=/([\+\-]|\d\d)/gi;function wR(t,e){var n=(e||"").match(t),r,i,s;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(jW)||["-",0,0],s=+(i[1]*60)+ze(i[2]),s===0?0:i[0]==="+"?s:-s)}function CR(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(vi(t)||ad(t)?t.valueOf():bt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),K.updateOffset(n,!1),n):bt(t).local()}function $S(t){return-Math.round(t._d.getTimezoneOffset())}K.updateOffset=function(){};function UW(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=wR(Um,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=$S(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?PH(this,Ei(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,K.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:$S(this)}function zW(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function YW(t){return this.utcOffset(0,t)}function GW(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract($S(this),"m")),this}function qW(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=wR(fV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function KW(t){return this.isValid()?(t=t?bt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function XW(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function ZW(){if(!ir(this._isDSTShifted))return this._isDSTShifted;var t={},e;return nR(t,this),t=RH(t),t._a?(e=t._isUTC?ds(t._a):bt(t._a),this._isDSTShifted=this.isValid()&&BW(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function QW(){return this.isValid()?!this._isUTC:!1}function JW(){return this.isValid()?this._isUTC:!1}function MH(){return this.isValid()?this._isUTC&&this._offset===0:!1}var eB=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,tB=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ei(t,e){var n=t,r=null,i,s,o;return pg(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Zs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=eB.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:ze(r[rs])*i,h:ze(r[hn])*i,m:ze(r[mi])*i,s:ze(r[js])*i,ms:ze(FS(r[qa]*1e3))*i}):(r=tB.exec(t))?(i=r[1]==="-"?-1:1,n={y:ia(r[2],i),M:ia(r[3],i),w:ia(r[4],i),d:ia(r[5],i),h:ia(r[6],i),m:ia(r[7],i),s:ia(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=nB(bt(n.from),bt(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new Gm(n),pg(t)&&Ze(t,"_locale")&&(s._locale=t._locale),pg(t)&&Ze(t,"_isValid")&&(s._isValid=t._isValid),s}Ei.fn=Gm.prototype;Ei.invalid=WW;function ia(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function dP(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function nB(t,e){var n;return t.isValid()&&e.isValid()?(e=CR(e,t),t.isBefore(e)?n=dP(t,e):(n=dP(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function IH(t,e){return function(n,r){var i,s;return r!==null&&!isNaN(+r)&&(rH(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=r,r=s),i=Ei(n,r),PH(this,i,t),this}}function PH(t,e,n,r){var i=e._milliseconds,s=FS(e._days),o=FS(e._months);t.isValid()&&(r=r??!0,o&&fH(t,Hh(t,"Month")+o*n),s&&cH(t,"Date",Hh(t,"Date")+s*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&K.updateOffset(t,s||o))}var rB=IH(1,"add"),iB=IH(-1,"subtract");function OH(t){return typeof t=="string"||t instanceof String}function sB(t){return vi(t)||ad(t)||OH(t)||Zs(t)||aB(t)||oB(t)||t===null||t===void 0}function oB(t){var e=tl(t)&&!eR(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=r.length;for(i=0;i<o;i+=1)s=r[i],n=n||Ze(t,s);return e&&n}function aB(t){var e=Ci(t),n=!1;return e&&(n=t.filter(function(r){return!Zs(r)&&OH(t)}).length===0),e&&n}function lB(t){var e=tl(t)&&!eR(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<r.length;i+=1)s=r[i],n=n||Ze(t,s);return e&&n}function uB(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function cB(t,e){arguments.length===1&&(arguments[0]?sB(arguments[0])?(t=arguments[0],e=void 0):lB(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||bt(),r=CR(n,this).startOf("day"),i=K.calendarFormat(this,r)||"sameElse",s=e&&(fs(e[i])?e[i].call(this,n):e[i]);return this.format(s||this.localeData().calendar(i,this,bt(n)))}function hB(){return new ld(this)}function dB(t,e){var n=vi(t)?t:bt(t);return this.isValid()&&n.isValid()?(e=qr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function fB(t,e){var n=vi(t)?t:bt(t);return this.isValid()&&n.isValid()?(e=qr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function gB(t,e,n,r){var i=vi(t)?t:bt(t),s=vi(e)?e:bt(e);return this.isValid()&&i.isValid()&&s.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(s,n):!this.isAfter(s,n))):!1}function mB(t,e){var n=vi(t)?t:bt(t),r;return this.isValid()&&n.isValid()?(e=qr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function pB(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function wB(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function CB(t,e,n){var r,i,s;if(!this.isValid())return NaN;if(r=CR(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=qr(e),e){case"year":s=wg(this,r)/12;break;case"month":s=wg(this,r);break;case"quarter":s=wg(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-i)/864e5;break;case"week":s=(this-r-i)/6048e5;break;default:s=this-r}return n?s:$r(s)}function wg(t,e){if(t.date()<e.date())return-wg(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,s;return e-r<0?(i=t.clone().add(n-1,"months"),s=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),s=(e-r)/(i-r)),-(n+s)||0}K.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";K.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function vB(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function yB(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?mg(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):fs(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",mg(n,"Z")):mg(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function SB(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(n+r+i+s)}function bB(t){t||(t=this.isUtc()?K.defaultFormatUtc:K.defaultFormat);var e=mg(this,t);return this.localeData().postformat(e)}function RB(t,e){return this.isValid()&&(vi(t)&&t.isValid()||bt(t).isValid())?Ei({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function EB(t){return this.from(bt(),t)}function TB(t,e){return this.isValid()&&(vi(t)&&t.isValid()||bt(t).isValid())?Ei({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function _B(t){return this.to(bt(),t)}function xH(t){var e;return t===void 0?this._locale._abbr:(e=no(t),e!=null&&(this._locale=e),this)}var AH=Gr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function HH(){return this._locale}var Fg=1e3,yu=60*Fg,$g=60*yu,NH=(365*400+97)*24*$g;function Su(t,e){return(t%e+e)%e}function DH(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-NH:new Date(t,e,n).valueOf()}function LH(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-NH:Date.UTC(t,e,n)}function MB(t){var e,n;if(t=qr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?LH:DH,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Su(e+(this._isUTC?0:this.utcOffset()*yu),$g);break;case"minute":e=this._d.valueOf(),e-=Su(e,yu);break;case"second":e=this._d.valueOf(),e-=Su(e,Fg);break}return this._d.setTime(e),K.updateOffset(this,!0),this}function IB(t){var e,n;if(t=qr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?LH:DH,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=$g-Su(e+(this._isUTC?0:this.utcOffset()*yu),$g)-1;break;case"minute":e=this._d.valueOf(),e+=yu-Su(e,yu)-1;break;case"second":e=this._d.valueOf(),e+=Fg-Su(e,Fg)-1;break}return this._d.setTime(e),K.updateOffset(this,!0),this}function PB(){return this._d.valueOf()-(this._offset||0)*6e4}function OB(){return Math.floor(this.valueOf()/1e3)}function xB(){return new Date(this.valueOf())}function AB(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function HB(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function NB(){return this.isValid()?this.toISOString():null}function DB(){return tR(this)}function LB(){return Lo({},xe(this))}function kB(){return xe(this).overflow}function FB(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ve("N",0,0,"eraAbbr");ve("NN",0,0,"eraAbbr");ve("NNN",0,0,"eraAbbr");ve("NNNN",0,0,"eraName");ve("NNNNN",0,0,"eraNarrow");ve("y",["y",1],"yo","eraYear");ve("y",["yy",2],0,"eraYear");ve("y",["yyy",3],0,"eraYear");ve("y",["yyyy",4],0,"eraYear");he("N",vR);he("NN",vR);he("NNN",vR);he("NNNN",KB);he("NNNNN",XB);ht(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?xe(n).era=i:xe(n).invalidEra=t});he("y",Wu);he("yy",Wu);he("yyy",Wu);he("yyyy",Wu);he("yo",ZB);ht(["y","yy","yyy","yyyy"],Dn);ht(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Dn]=n._locale.eraYearOrdinalParse(t,i):e[Dn]=parseInt(t,10)});function $B(t,e){var n,r,i,s=this._eras||no("en")._eras;for(n=0,r=s.length;n<r;++n){switch(typeof s[n].since){case"string":i=K(s[n].since).startOf("day"),s[n].since=i.valueOf();break}switch(typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":i=K(s[n].until).startOf("day").valueOf(),s[n].until=i.valueOf();break}}return s}function VB(t,e,n){var r,i,s=this.eras(),o,a,l;for(t=t.toUpperCase(),r=0,i=s.length;r<i;++r)if(o=s[r].name.toUpperCase(),a=s[r].abbr.toUpperCase(),l=s[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[r];break;case"NNNN":if(o===t)return s[r];break;case"NNNNN":if(l===t)return s[r];break}else if([o,a,l].indexOf(t)>=0)return s[r]}function WB(t,e){var n=t.since<=t.until?1:-1;return e===void 0?K(t.since).year():K(t.since).year()+(e-t.offset)*n}function BB(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function jB(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function UB(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function zB(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-K(i[t].since).year())*n+i[t].offset;return this.year()}function YB(t){return Ze(this,"_erasNameRegex")||yR.call(this),t?this._erasNameRegex:this._erasRegex}function GB(t){return Ze(this,"_erasAbbrRegex")||yR.call(this),t?this._erasAbbrRegex:this._erasRegex}function qB(t){return Ze(this,"_erasNarrowRegex")||yR.call(this),t?this._erasNarrowRegex:this._erasRegex}function vR(t,e){return e.erasAbbrRegex(t)}function KB(t,e){return e.erasNameRegex(t)}function XB(t,e){return e.erasNarrowRegex(t)}function ZB(t,e){return e._eraYearOrdinalRegex||Wu}function yR(){var t=[],e=[],n=[],r=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=Ks(u[i].name),a=Ks(u[i].abbr),l=Ks(u[i].narrow),e.push(o),t.push(a),n.push(l),r.push(o),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}ve(0,["gg",2],0,function(){return this.weekYear()%100});ve(0,["GG",2],0,function(){return this.isoWeekYear()%100});function qm(t,e){ve(0,[t,t.length],0,e)}qm("gggg","weekYear");qm("ggggg","weekYear");qm("GGGG","isoWeekYear");qm("GGGGG","isoWeekYear");he("G",jm);he("g",jm);he("GG",Rt,Tr);he("gg",Rt,Tr);he("GGGG",aR,oR);he("gggg",aR,oR);he("GGGGG",Bm,Vm);he("ggggg",Bm,Vm);cd(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=ze(t)});cd(["gg","GG"],function(t,e,n,r){e[r]=K.parseTwoDigitYear(t)});function QB(t){return kH.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function JB(t){return kH.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function ej(){return Xs(this.year(),1,4)}function tj(){return Xs(this.isoWeekYear(),1,4)}function nj(){var t=this.localeData()._week;return Xs(this.year(),t.dow,t.doy)}function rj(){var t=this.localeData()._week;return Xs(this.weekYear(),t.dow,t.doy)}function kH(t,e,n,r,i){var s;return t==null?Dh(this,r,i).year:(s=Xs(t,r,i),e>s&&(e=s),ij.call(this,t,e,n,r,i))}function ij(t,e,n,r,i){var s=pH(t,e,n,r,i),o=Nh(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}ve("Q",0,"Qo","quarter");he("Q",sH);ht("Q",function(t,e){e[Bs]=(ze(t)-1)*3});function sj(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ve("D",["DD",2],"Do","date");he("D",Rt,Bu);he("DD",Rt,Tr);he("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ht(["D","DD"],rs);ht("Do",function(t,e){e[rs]=ze(t.match(Rt)[0])});var FH=ju("Date",!0);ve("DDD",["DDDD",3],"DDDo","dayOfYear");he("DDD",Wm);he("DDDD",oH);ht(["DDD","DDDD"],function(t,e,n){n._dayOfYear=ze(t)});function oj(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}ve("m",["mm",2],0,"minute");he("m",Rt,lR);he("mm",Rt,Tr);ht(["m","mm"],mi);var aj=ju("Minutes",!1);ve("s",["ss",2],0,"second");he("s",Rt,lR);he("ss",Rt,Tr);ht(["s","ss"],js);var lj=ju("Seconds",!1);ve("S",0,0,function(){return~~(this.millisecond()/100)});ve(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ve(0,["SSS",3],0,"millisecond");ve(0,["SSSS",4],0,function(){return this.millisecond()*10});ve(0,["SSSSS",5],0,function(){return this.millisecond()*100});ve(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ve(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ve(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ve(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});he("S",Wm,sH);he("SS",Wm,Tr);he("SSS",Wm,oH);var ko,$H;for(ko="SSSS";ko.length<=9;ko+="S")he(ko,Wu);function uj(t,e){e[qa]=ze(("0."+t)*1e3)}for(ko="S";ko.length<=9;ko+="S")ht(ko,uj);$H=ju("Milliseconds",!1);ve("z",0,0,"zoneAbbr");ve("zz",0,0,"zoneName");function cj(){return this._isUTC?"UTC":""}function hj(){return this._isUTC?"Coordinated Universal Time":""}var Q=ld.prototype;Q.add=rB;Q.calendar=cB;Q.clone=hB;Q.diff=CB;Q.endOf=IB;Q.format=bB;Q.from=RB;Q.fromNow=EB;Q.to=TB;Q.toNow=_B;Q.get=SV;Q.invalidAt=kB;Q.isAfter=dB;Q.isBefore=fB;Q.isBetween=gB;Q.isSame=mB;Q.isSameOrAfter=pB;Q.isSameOrBefore=wB;Q.isValid=DB;Q.lang=AH;Q.locale=xH;Q.localeData=HH;Q.max=DW;Q.min=NW;Q.parsingFlags=LB;Q.set=bV;Q.startOf=MB;Q.subtract=iB;Q.toArray=AB;Q.toObject=HB;Q.toDate=xB;Q.toISOString=yB;Q.inspect=SB;typeof Symbol<"u"&&Symbol.for!=null&&(Q[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Q.toJSON=NB;Q.toString=vB;Q.unix=OB;Q.valueOf=PB;Q.creationData=FB;Q.eraName=BB;Q.eraNarrow=jB;Q.eraAbbr=UB;Q.eraYear=zB;Q.year=uH;Q.isLeapYear=yV;Q.weekYear=QB;Q.isoWeekYear=JB;Q.quarter=Q.quarters=sj;Q.month=gH;Q.daysInMonth=xV;Q.week=Q.weeks=$V;Q.isoWeek=Q.isoWeeks=VV;Q.weeksInYear=nj;Q.weeksInWeekYear=rj;Q.isoWeeksInYear=ej;Q.isoWeeksInISOWeekYear=tj;Q.date=FH;Q.day=Q.days=JV;Q.weekday=eW;Q.isoWeekday=tW;Q.dayOfYear=oj;Q.hour=Q.hours=lW;Q.minute=Q.minutes=aj;Q.second=Q.seconds=lj;Q.millisecond=Q.milliseconds=$H;Q.utcOffset=UW;Q.utc=YW;Q.local=GW;Q.parseZone=qW;Q.hasAlignedHourOffset=KW;Q.isDST=XW;Q.isLocal=QW;Q.isUtcOffset=JW;Q.isUtc=MH;Q.isUTC=MH;Q.zoneAbbr=cj;Q.zoneName=hj;Q.dates=Gr("dates accessor is deprecated. Use date instead.",FH);Q.months=Gr("months accessor is deprecated. Use month instead",gH);Q.years=Gr("years accessor is deprecated. Use year instead",uH);Q.zone=Gr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",zW);Q.isDSTShifted=Gr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",ZW);function dj(t){return bt(t*1e3)}function fj(){return bt.apply(null,arguments).parseZone()}function VH(t){return t}var Qe=rR.prototype;Qe.calendar=Q$;Qe.longDateFormat=nV;Qe.invalidDate=iV;Qe.ordinal=aV;Qe.preparse=VH;Qe.postformat=VH;Qe.relativeTime=uV;Qe.pastFuture=cV;Qe.set=X$;Qe.eras=$B;Qe.erasParse=VB;Qe.erasConvertYear=WB;Qe.erasAbbrRegex=GB;Qe.erasNameRegex=YB;Qe.erasNarrowRegex=qB;Qe.months=MV;Qe.monthsShort=IV;Qe.monthsParse=OV;Qe.monthsRegex=HV;Qe.monthsShortRegex=AV;Qe.week=DV;Qe.firstDayOfYear=FV;Qe.firstDayOfWeek=kV;Qe.weekdays=qV;Qe.weekdaysMin=XV;Qe.weekdaysShort=KV;Qe.weekdaysParse=QV;Qe.weekdaysRegex=nW;Qe.weekdaysShortRegex=rW;Qe.weekdaysMinRegex=iW;Qe.isPM=oW;Qe.meridiem=uW;function Vg(t,e,n,r){var i=no(),s=ds().set(r,e);return i[n](s,t)}function WH(t,e,n){if(Zs(t)&&(e=t,t=void 0),t=t||"",e!=null)return Vg(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Vg(t,r,n,"month");return i}function SR(t,e,n,r){typeof t=="boolean"?(Zs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Zs(e)&&(n=e,e=void 0),e=e||"");var i=no(),s=t?i._week.dow:0,o,a=[];if(n!=null)return Vg(e,(n+s)%7,r,"day");for(o=0;o<7;o++)a[o]=Vg(e,(o+s)%7,r,"day");return a}function gj(t,e){return WH(t,e,"months")}function mj(t,e){return WH(t,e,"monthsShort")}function pj(t,e,n){return SR(t,e,n,"weekdays")}function wj(t,e,n){return SR(t,e,n,"weekdaysShort")}function Cj(t,e,n){return SR(t,e,n,"weekdaysMin")}Bo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=ze(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});K.lang=Gr("moment.lang is deprecated. Use moment.locale instead.",Bo);K.langData=Gr("moment.langData is deprecated. Use moment.localeData instead.",no);var ws=Math.abs;function vj(){var t=this._data;return this._milliseconds=ws(this._milliseconds),this._days=ws(this._days),this._months=ws(this._months),t.milliseconds=ws(t.milliseconds),t.seconds=ws(t.seconds),t.minutes=ws(t.minutes),t.hours=ws(t.hours),t.months=ws(t.months),t.years=ws(t.years),this}function BH(t,e,n,r){var i=Ei(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function yj(t,e){return BH(this,t,e,1)}function Sj(t,e){return BH(this,t,e,-1)}function fP(t){return t<0?Math.floor(t):Math.ceil(t)}function bj(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,s,o,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=fP(VS(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=$r(t/1e3),r.seconds=i%60,s=$r(i/60),r.minutes=s%60,o=$r(s/60),r.hours=o%24,e+=$r(o/24),l=$r(jH(e)),n+=l,e-=fP(VS(l)),a=$r(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function jH(t){return t*4800/146097}function VS(t){return t*146097/4800}function Rj(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=qr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+jH(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(VS(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function ro(t){return function(){return this.as(t)}}var UH=ro("ms"),Ej=ro("s"),Tj=ro("m"),_j=ro("h"),Mj=ro("d"),Ij=ro("w"),Pj=ro("M"),Oj=ro("Q"),xj=ro("y"),Aj=UH;function Hj(){return Ei(this)}function Nj(t){return t=qr(t),this.isValid()?this[t+"s"]():NaN}function pl(t){return function(){return this.isValid()?this._data[t]:NaN}}var Dj=pl("milliseconds"),Lj=pl("seconds"),kj=pl("minutes"),Fj=pl("hours"),$j=pl("days"),Vj=pl("months"),Wj=pl("years");function Bj(){return $r(this.days()/7)}var Ds=Math.round,fu={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function jj(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function Uj(t,e,n,r){var i=Ei(t).abs(),s=Ds(i.as("s")),o=Ds(i.as("m")),a=Ds(i.as("h")),l=Ds(i.as("d")),u=Ds(i.as("M")),c=Ds(i.as("w")),h=Ds(i.as("y")),d=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||o<=1&&["m"]||o<n.m&&["mm",o]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,jj.apply(null,d)}function zj(t){return t===void 0?Ds:typeof t=="function"?(Ds=t,!0):!1}function Yj(t,e){return fu[t]===void 0?!1:e===void 0?fu[t]:(fu[t]=e,t==="s"&&(fu.ss=e-1),!0)}function Gj(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=fu,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},fu,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),s=Uj(this,!n,r,i),n&&(s=i.pastFuture(+this,s)),i.postformat(s)}var gv=Math.abs;function bl(t){return(t>0)-(t<0)||+t}function Km(){if(!this.isValid())return this.localeData().invalidDate();var t=gv(this._milliseconds)/1e3,e=gv(this._days),n=gv(this._months),r,i,s,o,a=this.asSeconds(),l,u,c,h;return a?(r=$r(t/60),i=$r(r/60),t%=60,r%=60,s=$r(n/12),n%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=bl(this._months)!==bl(a)?"-":"",c=bl(this._days)!==bl(a)?"-":"",h=bl(this._milliseconds)!==bl(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+o+"S":"")):"P0D"}var Xe=Gm.prototype;Xe.isValid=VW;Xe.abs=vj;Xe.add=yj;Xe.subtract=Sj;Xe.as=Rj;Xe.asMilliseconds=UH;Xe.asSeconds=Ej;Xe.asMinutes=Tj;Xe.asHours=_j;Xe.asDays=Mj;Xe.asWeeks=Ij;Xe.asMonths=Pj;Xe.asQuarters=Oj;Xe.asYears=xj;Xe.valueOf=Aj;Xe._bubble=bj;Xe.clone=Hj;Xe.get=Nj;Xe.milliseconds=Dj;Xe.seconds=Lj;Xe.minutes=kj;Xe.hours=Fj;Xe.days=$j;Xe.weeks=Bj;Xe.months=Vj;Xe.years=Wj;Xe.humanize=Gj;Xe.toISOString=Km;Xe.toString=Km;Xe.toJSON=Km;Xe.locale=xH;Xe.localeData=HH;Xe.toIsoString=Gr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Km);Xe.lang=AH;ve("X",0,0,"unix");ve("x",0,0,"valueOf");he("x",jm);he("X",gV);ht("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});ht("x",function(t,e,n){n._d=new Date(ze(t))});//! moment.js
K.version="2.30.1";q$(bt);K.fn=Q;K.min=LW;K.max=kW;K.now=FW;K.utc=ds;K.unix=dj;K.months=gj;K.isDate=ad;K.locale=Bo;K.invalid=$m;K.duration=Ei;K.isMoment=vi;K.weekdays=pj;K.parseZone=fj;K.localeData=no;K.isDuration=pg;K.monthsShort=mj;K.weekdaysMin=Cj;K.defineLocale=fR;K.updateLocale=fW;K.locales=gW;K.weekdaysShort=wj;K.normalizeUnits=qr;K.relativeTimeRounding=zj;K.relativeTimeThreshold=Yj;K.calendarFormat=uB;K.prototype=Q;K.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function zH(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function WS(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function hh(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let s=0;s<r;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function Qt(t,e,n,r){let i=-1,s=t,o=n;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(r&&a&&(i+=1,o=s[i]),i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Qs(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,s=[];let o=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(o+=1,s[o]=a),n+=1}return s}function Fe(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,s=[];let o=-1;for(;n<i;){const a=r[n];o+=1,s[o]=e(a,n,r),n+=1}return s}function _(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function YH(t){return Qt(t,(e,n)=>e+n,0)}function qj(t){return Qt(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function Kj(t){return Qt(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function Xj(t){return t.length?YH(t)/t.length:0}function GH(t){return Qt(t,(e,n)=>e.concat(Array.isArray(n)?GH(n):n),[])}function bR(t){const e=[];return _(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function BS(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let s=r;return _(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function Zj(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let s=r;return _(i,o=>{s=s.filter(a=>o.includes(a))}),s}function Qj(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],s=new Set(r);return _(i,o=>{_(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function jS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const Jj=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Xj,arrayEach:_,arrayFilter:Qs,arrayFlatten:GH,arrayMap:Fe,arrayMax:qj,arrayMin:Kj,arrayReduce:Qt,arraySum:YH,arrayUnique:bR,extendArray:WS,getDifferenceOfArrays:BS,getIntersectionOfArrays:Zj,getUnionOfArrays:Qj,pivot:hh,stringToArray:jS,to2dArray:zH},Symbol.toStringTag,{value:"Module"}));function it(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Qt(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return s+l+u},"").trim()}function Dt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ce(t){return typeof t<"u"}function St(t){return typeof t>"u"}function Lt(t){return t===null||t===""||St(t)}function qH(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const nh="length",dh=t=>parseInt(t,16),gP=t=>parseInt(t,10),Wg=(t,e,n)=>t.substr(e,n),fh=t=>t.codePointAt(0)-65,US=t=>`${t}`.replace(/\-/g,""),eU=t=>dh(Wg(US(t),dh("12"),fh("F")))/(dh(Wg(US(t),fh("B"),~~![][nh]))||9),tU=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let mP=!1;const pP={invalid:()=>it`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return it`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>it`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},wP={invalid:()=>it`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return it`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>it`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function KH(t,e){const n=!Lt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.0.0";let s,o="invalid",a="invalid";t=US(t||"");const l=nU(t);if(n||r||l)if(l){const u=K("16/12/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=eU(t);s=K((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else r?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(tU()&&(o="valid",a="valid"),!mP&&o!=="valid"&&(pP[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](pP[o]({keyValidityDate:s,hotVersion:i})),mP=!0),a!=="valid"&&e.parentNode&&wP[a]({keyValidityDate:s,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=wP[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function nU(t){let e=[][nh],n=e;if(t[nh]!==fh("Z"))return!1;for(let r="",i="B<H4P+".split(""),s=fh(i.shift());s;s=fh(i.shift()||"A"))--s<""[nh]?n=n|(gP(`${gP(dh(r)+(dh(Wg(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Wg(t,s,s?i[nh]===1?9:8:6);return n===e}const rU=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:KH,isDefined:ce,isEmpty:Lt,isRegExp:qH,isUndefined:St,stringify:Dt},Symbol.toStringTag,{value:"Module"}));function Ln(t){return t[0].toUpperCase()+t.substr(1)}function iU(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const s=Dt(n[i]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function RR(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function ER(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function TR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function zS(t){return Xm(`${t}`,{ALLOWED_TAGS:[]})}function Xm(t,e){return G$.sanitize(t,e)}const sU=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:iU,isPercentValue:ER,randomString:RR,sanitize:Xm,stripTags:zS,substitute:TR,toUpperCaseFirst:Ln},Symbol.toStringTag,{value:"Module"})),Uu=t=>["tabindex",t],oU=()=>["role","treegrid"],as=()=>["role","presentation"],aU=()=>["role","gridcell"],lU=()=>["role","rowheader"],XH=()=>["role","rowgroup"],uU=()=>["role","columnheader"],YS=()=>["role","row"],cU=()=>["role","menu"],hU=()=>["role","menuitem"],dU=()=>["role","menuitemcheckbox"],fU=()=>["role","combobox"],ZH=()=>["role","listbox"],gU=()=>["role","option"],mU=()=>["role","checkbox"],pU=()=>["scope","col"],wU=()=>["scope","row"],CU=()=>["type","text"],Bg=t=>["aria-label",t],ea=()=>["aria-hidden","true"],vU=()=>["aria-disabled","true"],yU=()=>["aria-multiselectable","true"],QH=t=>["aria-haspopup",t],JH=t=>["aria-rowcount",t],Zm=t=>["aria-colcount",t],eN=t=>["aria-rowindex",t],_R=t=>["aria-colindex",t],Br=t=>["aria-expanded",t],SU=t=>["aria-sort",t],CP=()=>["aria-readonly","true"],vP=()=>["aria-invalid","true"],tN=t=>["aria-checked",t],MR=()=>["aria-selected","true"],bU=()=>["aria-autocomplete","list"],RU=t=>["aria-controls",t],EU=t=>["aria-activedescendant",t],TU=t=>["aria-live",t],_U=t=>["aria-relevant",t],MU=t=>["aria-setsize",t],IU=t=>["aria-posinset",t];function nN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function rN(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function iN(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function nl(t){return iN(t)&&t.parent}function PU(t){return!!Object.getPrototypeOf(t.parent)}function Go(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==n;){const{nodeType:o,nodeName:a}=s;if(o===r&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function rh(t,e,n){const r=[];let i=t;for(;i&&(i=Go(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=r.length;return s?r[s-1]:null}function sN(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(s=>e.test(s));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function jo(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function oN(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Ro(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function aN(t){return!t||!t.length?[]:t.filter(e=>!!e)}function lN(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&n.push(i),!s})),{regexFree:r,regexes:n}}function ye(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Y(t,e){typeof e=="string"&&(e=e.split(" ")),e=aN(e),e.length>0&&t.classList.add(...e)}function Ce(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=lN(e,!0);n=aN(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function be(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function wl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=lN(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function IR(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)IR(e[n])}}function yi(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const uN=/(<(.*)>|&(.*);)/;function Cl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;uN.test(e)?t.innerHTML=n?Xm(e):e:qo(t,e)}function qo(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(yi(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function rl(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return rl(r.host.impl);if(r.host)return rl(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function cn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=n.pageXOffset||r.scrollLeft,o+=n.pageYOffset||r.scrollTop),{left:s,top:o}}function PR(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Qm(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Jm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?PR(e):t.scrollTop}function OR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Qm(e):t.scrollLeft}function kh(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=n.getComputedStyle(i),r.includes(s)||r.includes(o)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(s))||i.clientWidth<=i.scrollWidth+1&&(r.includes(o)||r.includes(s)))return i;i=i.parentNode}return n}function cN(t){return t.scrollHeight-t.clientHeight}function hN(t){return t.scrollWidth-t.clientWidth}function il(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return r;r=r.parentNode}return n}function Fh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function OU(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Yt(t){return t.offsetWidth}function kt(t){return t.offsetHeight}function bu(t){return t.clientHeight||t.innerHeight}function xR(t){return t.clientWidth||t.innerWidth}function xU(t,e,n){t.addEventListener(e,n,!1)}function AU(t,e,n){t.removeEventListener(e,n,!1)}function AR(t){return t.selectionStart?t.selectionStart:0}function dN(t){return t.selectionEnd?t.selectionEnd:0}function HU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function GS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function hd(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=s}}}let mv;function NU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function yn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return mv===void 0&&(mv=NU(t)),mv}function fN(t){return t.offsetWidth!==t.clientWidth}function gN(t){return t.offsetHeight!==t.clientHeight}function ep(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function DU(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function dd(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function gh(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function tp(t){return gh(t)&&t.hasAttribute("data-hot-input")===!1}function LU(t){const e=t.ownerDocument.activeElement;tp(e)||t.select()}function HR(t){return!t.parentNode}function mN(t,e){new IntersectionObserver((r,i)=>{r.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function NR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),s=r.defaultView.getSelection();be(t,"contenteditable",!0),n&&be(t,...ea()),e&&Y(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function DR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Ce(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function pN(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;NR(t,n),e(),DR(t,n)}const kU=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:uN,addClass:Y,addEvent:xU,clearTextSelection:GS,closest:Go,closestDown:rh,empty:yi,fastInnerHTML:Cl,fastInnerText:qo,findFirstParentWithClass:sN,getCaretPosition:AR,getCssTransform:DU,getFrameElement:iN,getMaximumScrollLeft:hN,getMaximumScrollTop:cN,getParent:nN,getParentWindow:nl,getScrollLeft:OR,getScrollTop:Jm,getScrollableElement:kh,getScrollbarWidth:yn,getSelectionEndPosition:dN,getSelectionText:HU,getStyle:Fh,getTrimmingContainer:il,getWindowScrollLeft:Qm,getWindowScrollTop:PR,hasAccessToParentWindow:PU,hasClass:ye,hasHorizontalScrollbar:gN,hasVerticalScrollbar:fN,index:oN,innerHeight:bu,innerWidth:xR,isChildOf:jo,isDetached:HR,isInput:gh,isOutsideInput:tp,isThisHotChild:rN,isVisible:rl,makeElementContentEditableAndSelectItsContent:NR,matchesCSSRules:OU,observeVisibilityChangeOnce:mN,offset:cn,outerHeight:kt,outerWidth:Yt,overlayContainsElement:Ro,removeAttribute:wl,removeClass:Ce,removeContentEditableFromElementAndDeselect:DR,removeEvent:AU,removeTextNodes:IR,resetCssTransform:dd,runWithSelectedContendEditableElement:pN,selectElementIfAllowed:LU,setAttribute:be,setCaretPosition:hd,setOverlayPosition:ep},Symbol.toStringTag,{value:"Module"}));function dt(t){return typeof t=="function"}function wN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return s}function FU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=wN(t,e);let i=n;function s(){i=n}function o(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return o.clearHits=s,o}function np(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,o)},e),r}return i}function $U(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return Qt(i,(u,c)=>c(u),r.apply(this,a))}}function LR(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,n.concat(o))}}function CN(t){const e=t.length;function n(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function VU(t){const e=t.length;function n(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function jg(t,e,n,r,i,s,o,a){return ce(a)?t.call(e,n,r,i,s,o,a):ce(o)?t.call(e,n,r,i,s,o):ce(s)?t.call(e,n,r,i,s):ce(i)?t.call(e,n,r,i):ce(r)?t.call(e,n,r):ce(n)?t.call(e,n):t.call(e)}const WU=Object.freeze(Object.defineProperty({__proto__:null,curry:CN,curryRight:VU,debounce:np,fastCall:jg,isFunction:dt,partial:LR,pipe:$U,throttle:wN,throttleAfterHits:FU},Symbol.toStringTag,{value:"Module"}));var yP={},pv,SP;function BU(){if(SP)return pv;SP=1;var t=Zt(),e=L1(),n=sn(),r=hl(),i=Fm(),s=t([].push);return pv=function(o){if(n(o))return o;if(e(o)){for(var a=o.length,l=[],u=0;u<a;u++){var c=o[u];typeof c=="string"?s(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&s(l,i(c))}var h=l.length,d=!0;return function(f,m){if(d)return d=!1,m;if(e(this))return m;for(var v=0;v<h;v++)if(l[v]===f)return m}}},pv}var bP;function jU(){if(bP)return yP;bP=1;var t=gt(),e=Du(),n=km(),r=Fn(),i=Zt(),s=En(),o=sn(),a=Wb(),l=Jb(),u=BU(),c=Vb(),h=String,d=e("JSON","stringify"),f=i(/./.exec),m=i("".charAt),v=i("".charCodeAt),w=i("".replace),b=i(1 .toString),R=/[\uD800-\uDFFF]/g,P=/^[\uD800-\uDBFF]$/,O=/^[\uDC00-\uDFFF]$/,D=!c||s(function(){var X=e("Symbol")("stringify detection");return d([X])!=="[null]"||d({a:X})!=="{}"||d(Object(X))!=="{}"}),M=s(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),A=function(X,U){var Z=l(arguments),J=u(U);if(!(!o(J)&&(X===void 0||a(X))))return Z[1]=function(ae,ne){if(o(J)&&(ne=r(J,this,h(ae),ne)),!a(ne))return ne},n(d,null,Z)},j=function(X,U,Z){var J=m(Z,U-1),ae=m(Z,U+1);return f(P,X)&&!f(O,ae)||f(O,X)&&!f(P,J)?"\\u"+b(v(X,0),16):X};return d&&t({target:"JSON",stat:!0,arity:3,forced:D||M},{stringify:function(U,Z,J){var ae=l(arguments),ne=n(D?A:d,null,ae);return M&&typeof ne=="string"?w(ne,R,j):ne}}),yP}jU();function Pu(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ne(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Pu(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Pu(n[0])]:e[r]=[]:e[r]=null)})),e}function Ti(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Xt(t,e,n){const r=Array.isArray(n);return Ne(e,(i,s)=>{(r===!1||n.includes(s))&&(t[s]=i)}),t}function fd(t,e){Ne(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),fd(t[r],e[r])):t[r]=e[r]})}function kn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Si(t){const e={};return Ne(t,(n,r)=>{e[r]=n}),e}function st(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ne(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(c,h){const d=`_${c}`,f=m=>{let v=m;return(Array.isArray(v)||He(v))&&(v=kn(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function rp(t,e){return JSON.stringify(t)===JSON.stringify(e)}function He(t){return Object.prototype.toString.call(t)==="[object Object]"}function gs(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ne(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function vN(t,e){const n=e.split(".");let r=t;return Ne(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Cg(t,e,n){const r=e.split(".");let i=t;r.forEach((s,o)=>{o!==r.length-1?(Kt(i,s)||(i[s]={}),i=i[s]):i[s]=n})}function ip(t){if(!He(t))return 0;const e=function(n){let r=0;return He(n)?Ne(n,(i,s)=>{s!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Kt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const UU=Object.freeze(Object.defineProperty({__proto__:null,clone:Si,createObjectPropListener:hr,deepClone:kn,deepExtend:fd,deepObjectSize:ip,defineGetter:gs,duckSchema:Pu,extend:Xt,getProperty:vN,hasOwnProperty:Kt,inherit:Ti,isObject:He,isObjectEqual:rp,mixin:st,objectEach:Ne,setProperty:Cg},Symbol.toStringTag,{value:"Module"}));function $h(t){return window.requestAnimationFrame(t)}function Vh(t){window.cancelAnimationFrame(t)}function kR(){return"ontouchstart"in window}function yN(){return typeof window<"u"}let Rl;function SN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Rl||(typeof Intl=="object"?Rl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Rl=(n,r)=>`${n}`.localeCompare(r):Rl=(n,r)=>n===r?0:n>r?-1:1,Rl)}const zU=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Vh,getComparisonFunction:SN,isCSR:yN,isTouchSupported:kR,requestAnimationFrame:$h},Symbol.toStringTag,{value:"Module"})),Dr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},io={chrome:Dr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Dr(t=>/CriOS/.test(t)),edge:Dr(t=>/Edge/.test(t)),edgeWebKit:Dr(t=>/EdgiOS/.test(t)),firefox:Dr(t=>/Firefox/.test(t)),firefoxWebKit:Dr(t=>/FxiOS/.test(t)),mobile:Dr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Dr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},zu={mac:Dr(t=>/^Mac/.test(t)),win:Dr(t=>/^Win/.test(t)),linux:Dr(t=>/^Linux/.test(t)),ios:Dr(t=>/iPhone|iPad|iPod/i.test(t))};function bN(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ne(io,n=>{let{test:r}=n;return void r(t,e)})}function RN(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ne(zu,e=>{let{test:n}=e;return void n(t)})}yN()&&(bN(),RN());function FR(){return io.chrome.value}function EN(){return io.chromeWebKit.value}function vg(){return io.firefox.value}function TN(){return io.firefoxWebKit.value}function $R(){return io.safari.value}function _N(){return io.edge.value}function YU(){return io.edgeWebKit.value}function Us(){return io.mobile.value}function VR(){return zu.ios.value}function WR(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&zu.mac.value}function qS(){return zu.win.value}function Ug(){return zu.mac.value}function GU(){return zu.linux.value}const qU=Object.freeze(Object.defineProperty({__proto__:null,isChrome:FR,isChromeWebKit:EN,isEdge:_N,isEdgeWebKit:YU,isFirefox:vg,isFirefoxWebKit:TN,isIOS:VR,isIpadOS:WR,isLinuxOS:GU,isMacOS:Ug,isMobileBrowser:Us,isSafari:$R,isWindowsOS:qS,setBrowserMeta:bN,setPlatformMeta:RN},Symbol.toStringTag,{value:"Module"})),ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:vg()?182:174,AUDIO_MUTE:vg()?181:173,AUDIO_UP:vg()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},KU=[ge.ALT,ge.ARROW_DOWN,ge.ARROW_LEFT,ge.ARROW_RIGHT,ge.ARROW_UP,ge.AUDIO_DOWN,ge.AUDIO_MUTE,ge.AUDIO_UP,ge.BACKSPACE,ge.CAPS_LOCK,ge.DELETE,ge.END,ge.ENTER,ge.ESCAPE,ge.F1,ge.F2,ge.F3,ge.F4,ge.F5,ge.F6,ge.F7,ge.F8,ge.F9,ge.F10,ge.F11,ge.F12,ge.F13,ge.F14,ge.F15,ge.F16,ge.F17,ge.F18,ge.F19,ge.HOME,ge.INSERT,ge.MEDIA_NEXT,ge.MEDIA_PLAY_PAUSE,ge.MEDIA_PREV,ge.MEDIA_STOP,ge.NULL,ge.NUM_LOCK,ge.PAGE_DOWN,ge.PAGE_UP,ge.PAUSE,ge.SCROLL_LOCK,ge.SHIFT,ge.TAB];function MN(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function BR(t){return KU.includes(t)}function XU(t){const e=[];return Ug()?e.push(ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX):e.push(ge.CONTROL),e.includes(t)}function IN(t){return[ge.CONTROL,ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX].includes(t)}function Yu(t,e){const n=e.split("|");let r=!1;return _(n,i=>{if(t===ge[i])return r=!0,!1}),r}const ZU=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ge,isCtrlKey:XU,isCtrlMetaKey:IN,isFunctionKey:BR,isKey:Yu,isPrintableChar:MN},Symbol.toStringTag,{value:"Module"}));function Kr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function xo(t){return t.isImmediatePropagationEnabled===!1}function Ko(t){return t.button===2}function sp(t){return t.button===0}function PN(t){return t instanceof TouchEvent}function ON(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const QU=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:xo,isLeftClick:sp,isRightClick:Ko,isTouchEvent:PN,offsetRelativeTo:ON,stopImmediatePropagation:Kr},Symbol.toStringTag,{value:"Module"}));function tt(){ce(console)&&console.warn(...arguments)}function jR(){ce(console)&&console.error(...arguments)}const Ya=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],wv=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Cv=new Map([[]]);var RP={},vv,EP;function JU(){if(EP)return vv;EP=1;var t=Fu();return vv=function(e,n,r){for(var i=0,s=arguments.length>2?r:t(n),o=new e(s);s>i;)o[i]=n[i++];return o},vv}var yv,TP;function ez(){if(TP)return yv;TP=1;var t=dn();return yv=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},yv}var Sv,_P;function op(){if(_P)return Sv;_P=1;var t=Ri(),e=Xb(),n=Jo().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),Sv=function(s){i[r][s]=!0},Sv}var MP;function tz(){if(MP)return RP;MP=1;var t=gt(),e=Zt(),n=dr(),r=td(),i=JU(),s=ez(),o=op(),a=Array,l=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),o("toSorted"),RP}tz();var IP={},PP={},OP;function nz(){if(OP)return PP;OP=1;var t=gt(),e=Vu(),n=dr(),r=on(),i=hs();return t({target:"Iterator",proto:!0,real:!0},{find:function(o){r(this),n(o);var a=i(this),l=0;return e(a,function(u,c){if(o(u,l++))return c(u)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),PP}var xP;function rz(){return xP||(xP=1,nz()),IP}rz();function iz(t,e){xN(t,e),e.add(t)}function bv(t,e,n){xN(t,e),e.set(t,n)}function xN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AP(t,e,n){return t.set(zg(t,e),n),n}function Rn(t,e){return t.get(zg(t,e))}function zg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sz=100;var pr=new WeakMap,ou=new WeakMap,Rv=new WeakMap,Ev=new WeakSet;class HP{constructor(){iz(this,Ev),bv(this,pr,new Map),bv(this,ou,new Map),bv(this,Rv,new Set),Ya.forEach(e=>zg(Ev,this,NP).call(this,e))}getHooks(e){var n;return(n=Rn(pr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Rn(pr,this).has(e)||(zg(Ev,this,NP).call(this,e),Ya.push(e));const i=Rn(pr,this).get(e);if(i.find(u=>u.callback===n))return;const s=Number.isInteger(r.orderIndex)?r.orderIndex:0,o=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:s,runOnce:o,initialHook:a,skip:!1});let u=Rn(Rv,this).has(e);!u&&s!==0&&(u=!0,Rn(Rv,this).add(e)),u&&i.length>1&&Rn(pr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Rn(pr,this).has(e)&&Rn(pr,this).get(e).length>0}remove(e,n){if(!Rn(pr,this).has(e))return!1;const r=Rn(pr,this).get(e),i=r.find(s=>s.callback===n);if(i){let s=Rn(ou,this).get(e);return i.skip=!0,s+=1,s>sz&&(Rn(pr,this).set(e,r.filter(o=>!o.skip)),s=0),Rn(ou,this).set(e,s),!0}return!1}destroy(){Rn(pr,this).clear(),Rn(ou,this).clear(),AP(pr,this,null),AP(ou,this,null)}}function NP(t){Rn(pr,this).set(t,[]),Rn(ou,this).set(t,0)}function oz(t,e,n){return(e=az(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function az(t){var e=lz(t,"string");return typeof e=="symbol"?e:e+""}function lz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uz=it`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class oe{constructor(){oz(this,"globalBucket",new HP)}static getSingleton(){return hz()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new HP),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,s=>this.add(e,s,r)):(wv.has(e)&&tt(TR(uz,{hookName:e,removedInVersion:wv.get(e)})),Cv.has(e)&&tt(Cv.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,s=>this.once(e,s,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?_(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,s,o,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=jg(u[h].callback,e,r,i,s,o,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=jg(u[h].callback,e,r,i,s,o,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Ya.push(e)}deregister(e){this.isRegistered(e)&&Ya.splice(Ya.indexOf(e),1)}isDeprecated(e){return Cv.has(e)||wv.has(e)}isRegistered(e){return Ya.indexOf(e)>=0}getRegistered(){return Ya}}const cz=new oe;function hz(){return cz}const Tv=new Map;function _i(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Tv.has(t)||Tv.set(t,new Map);const e=Tv.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:s,getValues:o}}const KS=new WeakMap,{register:dz,getItem:AN,hasItem:HN,getNames:fz,getValues:rae}=_i("editors");function gz(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},oe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function NN(t,e){let n;if(typeof t=="function")KS.get(t)||sr(null,t),n=KS.get(t);else if(typeof t=="string")n=AN(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Yg(t){if(typeof t=="function")return t;if(!HN(t))throw Error(`No registered editor found under "${t}" name`);return AN(t).getConstructor()}function sr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new gz(e);typeof t=="string"&&dz(t,n),KS.set(e,n)}function mz(t,e,n){return(e=pz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pz(t){var e=wz(t,"string");return typeof e=="symbol"?e:e+""}function wz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let yg=0;class Ur{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;mz(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){r.call(this,Cz(o))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(n,s,i),yg+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===n&&o.element===e){if(r&&r!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),yg-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),yg-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const s={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;r.createEvent?(o=r.createEvent("MouseEvents"),o.initMouseEvent(n,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,r.body.parentNode)):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${n}`,o)}}function Cz(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Kr(this)},t}function vz(){return yg}function yz(t,e){Sz(t,e),e.add(t)}function Sz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sa(t,e,n){return(e=bz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bz(t){var e=Rz(t,"string");return typeof e=="symbol"?e:e+""}function Rz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DP(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _v=new WeakSet;class XS{constructor(e,n,r){yz(this,_v),sa(this,"hot",void 0),sa(this,"tableMeta",void 0),sa(this,"selection",void 0),sa(this,"eventManager",void 0),sa(this,"destroyed",!1),sa(this,"activeEditor",void 0),sa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Ur(e),this.hot.addHook("afterDocumentKeyDown",i=>DP(_v,this,Ez).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>DP(_v,this,Tz).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,s=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let o=r,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=NN(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(r))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Ez(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||xo(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!BR(n)&&!IN(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function Tz(t,e){e.isCell()&&this.openEditor(null,t,!0)}const LP=new WeakMap;XS.getInstance=function(t,e,n){let r=LP.get(t);return r||(r=new XS(t,e,n),LP.set(t,r)),r};function _z(t,e){DN(t,e),e.add(t)}function lc(t,e,n){DN(t,e),e.set(t,n)}function DN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _t(t,e){return t.get(Vs(t,e))}function uc(t,e,n){return t.set(Vs(t,e),n),n}function Vs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ru=Object.freeze({CELL:"cell",MIXED:"mixed"});var Cn=new WeakMap,kd=new WeakMap,Fd=new WeakMap,$d=new WeakMap,Vd=new WeakMap,_o=new WeakSet;class Mz{constructor(e){var n=this;_z(this,_o),lc(this,Cn,void 0),lc(this,kd,void 0),lc(this,Fd,1),lc(this,$d,null),lc(this,Vd,new Map);const r=e.getSettings();uc(Cn,this,e),uc(kd,this,r.imeFastEdit?Ru.MIXED:Ru.CELL),_t(Cn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Vs(_o,n,Pz).call(n,...s)}),_t(Cn,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Vs(_o,n,kP).call(n,...s)}),_t(Cn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Vs(_o,n,kP).call(n,...s)}),_t(Cn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Vs(_o,n,Iz).call(n,...s)})}getFocusMode(){return _t(kd,this)}setFocusMode(e){Object.values(Ru).includes(e)?uc(kd,this,e):tt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return _t(Fd,this)}setRefocusDelay(e){uc(Fd,this,e)}setRefocusElementGetter(e){uc($d,this,e)}getRefocusElement(){var e;return typeof _t($d,this)=="function"?_t($d,this).call(this):(e=_t(Cn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,s;const o=(i=_t(Cn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=_t(Cn,this).runHooks("modifyFocusedElement",o.row,o.col,r);a instanceof HTMLElement||(a=r),a&&!((s=_t(Cn,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Vs(_o,this,UR).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_t(Fd,this);_t(Cn,this).getSettings().imeFastEdit&&!((e=_t(Cn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&(_t(Vd,this).has(n)||_t(Vd,this).set(n,np(()=>{var r;(r=this.getRefocusElement())===null||r===void 0||r.select()},n)),_t(Vd,this).get(n)())}}function UR(t){var e;const n=(e=_t(Cn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!_t(Cn,this).selection.isCellVisible(n)){t(null);return}const r=_t(Cn,this).getCell(n.row,n.col,!0);r===null?_t(Cn,this).addHookOnce("afterScroll",()=>{t(_t(Cn,this).getCell(n.row,n.col,!0))}):t(r)}function kP(){Vs(_o,this,UR).call(this,t=>{const{activeElement:e}=_t(Cn,this).rootDocument;e&&tp(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Iz(){Vs(_o,this,UR).call(this,t=>{this.getFocusMode()===Ru.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function Pz(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Ru.MIXED:Ru.CELL)}var FP={},Mv,$P;function Oz(){if($P)return Mv;$P=1;var t=bi(),e=hl(),n=Ri(),r=n("match");return Mv=function(i){var s;return t(i)&&((s=i[r])!==void 0?!!s:e(i)==="RegExp")},Mv}var Iv,VP;function xz(){if(VP)return Iv;VP=1;var t=on();return Iv=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},Iv}var Pv,WP;function Az(){if(WP)return Pv;WP=1;var t=Fn(),e=Yr(),n=nd(),r=xz(),i=RegExp.prototype;return Pv=function(s){var o=s.flags;return o===void 0&&!("flags"in i)&&!e(s,"flags")&&n(i,s)?t(r,s):o},Pv}var Ov,BP;function Hz(){if(BP)return Ov;BP=1;var t=Zt(),e=Lu(),n=Math.floor,r=t("".charAt),i=t("".replace),s=t("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return Ov=function(l,u,c,h,d,f){var m=c+l.length,v=h.length,w=a;return d!==void 0&&(d=e(d),w=o),i(f,w,function(b,R){var P;switch(r(R,0)){case"$":return"$";case"&":return l;case"`":return s(u,0,c);case"'":return s(u,m);case"<":P=d[s(R,1,-1)];break;default:var O=+R;if(O===0)return b;if(O>v){var D=n(O/10);return D===0?b:D<=v?h[D-1]===void 0?r(R,1):h[D-1]+r(R,1):b}P=h[O-1]}return P===void 0?"":P})},Ov}var jP;function Nz(){if(jP)return FP;jP=1;var t=gt(),e=Fn(),n=Zt(),r=ed(),i=sn(),s=Nm(),o=Oz(),a=Fm(),l=rd(),u=Az(),c=Hz(),h=Ri(),d=Qo(),f=h("replace"),m=TypeError,v=n("".indexOf),w=n("".replace),b=n("".slice),R=Math.max;return t({target:"String",proto:!0},{replaceAll:function(O,D){var M=r(this),A,j,X,U,Z,J,ae,ne,fe,mt,Te=0,$e="";if(!s(O)){if(A=o(O),A&&(j=a(r(u(O))),!~v(j,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(X=l(O,f),X)return e(X,O,M,D);if(d&&A)return w(a(M),O,D)}for(U=a(M),Z=a(O),J=i(D),J||(D=a(D)),ae=Z.length,ne=R(1,ae),fe=v(U,Z);fe!==-1;)mt=J?a(D(Z,fe,U)):c(Z,U,fe,[],void 0,D),$e+=b(U,Te,fe)+mt,Te=fe+ae,fe=fe+ne>U.length?-1:v(U,Z,fe+ne);return Te<U.length&&($e+=b(U,Te)),$e}}),FP}Nz();var UP={},zP={},YP;function Dz(){if(YP)return zP;YP=1;var t=gt(),e=Vu(),n=dr(),r=on(),i=hs(),s=TypeError;return t({target:"Iterator",proto:!0,real:!0},{reduce:function(a){r(this),n(a);var l=i(this),u=arguments.length<2,c=u?void 0:arguments[1],h=0;if(e(l,function(d){u?(u=!1,c=d):c=a(c,d,h),h++},{IS_RECORD:!0}),u)throw new s("Reduce of empty iterator with no initial value");return c}}),zP}var GP;function Lz(){return GP||(GP=1,Dz()),UP}Lz();const LN={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},kz=new RegExp(Object.keys(LN).map(t=>`(${t})`).join("|"),"gi");function Fz(t){return(t&&t.nodeName||"")==="TABLE"}function ZS(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let w=0;w<o;w+=1){const b=!f&&n&&w===0;let R="";if(f)R=`<th>${t.getColHeader(w-c)}</th>`;else if(b)R=`<th>${t.getRowHeader(d-h)}</th>`;else{const P=i[d][w],{hidden:O,rowspan:D,colspan:M}=t.getCellMeta(d-h,w-c);if(!O){const A=[];if(D&&A.push(`rowspan="${D}"`),M&&A.push(`colspan="${M}"`),Lt(P))R=`<td ${A.join(" ")}></td>`;else{const j=P.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${A.join(" ")}>${j}</td>`}}}m.push(R)}const v=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function QS(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],s=i.length,o=[];r===0&&n.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=Lt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}n.push("<tr>",...o,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function kN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let s=t;if(typeof s=="string"){const P=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,O=>{const D=O.match(/<td\b[^>]*?>/g)[0],M=/<p.*?>/g,A=O.substring(D.length,O.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(M,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${D}${A}</td>`});i.insertAdjacentHTML("afterbegin",`${P}`),s=i.querySelector("table")}if(!s||!Fz(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((P,O)=>P+O.colSpan,0)-(a?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(s.tHead){const P=Array.from(s.tHead.rows).filter(O=>{const D=O.querySelector("td")!==null;return D&&h.push(O),!D});f=P.length,d=f>0,f>1?n.nestedHeaders=Array.from(P).reduce((O,D)=>{const M=Array.from(D.cells).reduce((A,j,X)=>{if(a&&X===0)return A;const{colSpan:U,innerHTML:Z}=j,J=U>1?{label:Z,colspan:U}:Z;return A.push(J),A},[]);return O.push(M),O},[]):d&&(n.colHeaders=Array.from(P[0].children).reduce((O,D,M)=>(a&&M===0||O.push(D.innerHTML),O),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(s.tBodies).reduce((P,O)=>(P.push(...Array.from(O.rows)),P),[]),...c];m=v.length;const w=new Array(m);for(let P=0;P<m;P++)w[P]=new Array(u);const b=[],R=[];for(let P=0;P<m;P++){const O=v[P],D=Array.from(O.cells),M=D.length;for(let A=0;A<M;A++){const j=D[A],{nodeName:X,innerHTML:U,rowSpan:Z,colSpan:J}=j,ae=w[P].findIndex(ne=>ne===void 0);if(X==="TD"){if(Z>1||J>1){for(let Te=P;Te<P+Z;Te++)if(Te<m)for(let $e=ae;$e<ae+J;$e++)w[Te][$e]=null;const fe=j.getAttribute("style");fe&&fe.includes("mso-ignore:colspan")||b.push({col:ae,row:P,rowspan:Z,colspan:J})}let ne="";o&&/excel/gi.test(o.content)?ne=U.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ne=U.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),w[P][ae]=ne.replace(kz,fe=>LN[fe])}else R.push(U)}}return b.length&&(n.mergeCells=b),R.length&&(n.rowHeaders=R),w.length&&(n.data=w),n}const $z=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:QS,htmlToGridSettings:kN,instanceToHTML:ZS},Symbol.toStringTag,{value:"Module"}));function Hn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function FN(t){return Hn(t,[","])}function me(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function JS(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function zR(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function je(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const Vz=Object.freeze(Object.defineProperty({__proto__:null,clamp:je,isNumeric:Hn,isNumericLike:FN,rangeEach:me,rangeEachReverse:JS,valueAccordingPercent:zR},Symbol.toStringTag,{value:"Module"})),eb="asc",Wz="desc",qP=new Map([[eb,[-1,1]],[Wz,[1,-1]]]),Bz=t=>`The priority '${t}' is already declared in a map.`,jz=t=>`The priority '${t}' is not a number.`;function Uz(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=dt(t)?t:Bz,e=dt(e)?e:jz;function r(s,o){if(!Hn(s))throw new Error(e(s));if(n.has(s))throw new Error(t(s));n.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eb;const[o,a]=qP.get(s)||qP.get(eb);return[...n].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:r,getItems:i}}const zz=t=>`The id '${t}' is already declared in a map.`;function ap(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=dt(t)?t:zz;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function s(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:r}}const Yz=t=>`'${t}' value is already declared in a unique set.`;function Gz(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=dt(t)?t:Yz;function n(s){if(e.has(s))throw new Error(t(s));e.add(s)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const YR=t=>`There is already registered "${t}" plugin.`,qz=t=>`There is already registered plugin on priority "${t}".`,Kz=t=>`The priority "${t}" is not a number.`,$N=Uz({errorPriorityExists:qz,errorPriorityNaN:Kz}),VN=Gz({errorItemExists:YR}),tb=ap({errorIdExists:YR});function GR(){return[...$N.getItems(),...VN.getItems()]}function gd(t){const e=Ln(t);return tb.getItem(e)}function Xz(t){return!!gd(t)}function Ye(t,e,n){[t,e,n]=Qz(t,e,n),gd(t)===void 0&&Zz(t,e,n)}function Zz(t,e,n){const r=Ln(t);if(tb.hasItem(r))throw new Error(YR(r));n===void 0?VN.addItem(r):$N.addItem(n,r),tb.addItem(r,e)}function Qz(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Jz,getItem:eY,hasItem:WN,getNames:tY,getValues:iae}=_i("renderers");function Gg(t){if(typeof t=="function")return t;if(!WN(t))throw Error(`No registered renderer found under "${t}" name`);return eY(t)}function Cr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Jz(t,e)}const{register:nY,getItem:rY,hasItem:BN,getNames:iY,getValues:sae}=_i("validators");function qR(t){if(typeof t=="function")return t;if(!BN(t))throw Error(`No registered validator found under "${t}" name`);return rY(t)}function Ga(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),nY(t,e)}var KP={},XP;function sY(){if(XP)return KP;XP=1;var t=gt(),e=Lu(),n=Fu(),r=id(),i=op();return t({target:"Array",proto:!0},{at:function(o){var a=e(this),l=n(a),u=r(o),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),KP}sY();var ZP={},QP;function oY(){if(QP)return ZP;QP=1;var t=gt(),e=Zt(),n=ed(),r=id(),i=Fm(),s=En(),o=e("".charAt),a=s(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:o(c,f)}}),ZP}oY();function cc(t,e,n){return(e=aY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aY(t){var e=lY(t,"string");return typeof e=="symbol"?e:e+""}function lY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uY{constructor(){cc(this,"count",0),cc(this,"startColumn",null),cc(this,"endColumn",null),cc(this,"startPosition",null),cc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=n,a=i>0?s+1:s;r>=i&&r+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function hc(t,e,n){return(e=cY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cY(t){var e=hY(t,"string");return typeof e=="symbol"?e:e+""}function hY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dY{constructor(){hc(this,"count",0),hc(this,"startRow",null),hc(this,"endRow",null),hc(this,"startPosition",null),hc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=n;r>=i&&r+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-s&&(this.startRow-=1),d>=i-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function dc(t,e,n){return(e=fY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fY(t){var e=gY(t,"string");return typeof e=="symbol"?e:e+""}function gY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jN{constructor(){dc(this,"count",0),dc(this,"startColumn",null),dc(this,"endColumn",null),dc(this,"startPosition",null),dc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s}=n;r<=i&&(this.startColumn=e);const o=i>0?s+1:s;r>=i&&r<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?i+1:i;r+i-h<-1*s||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function fc(t,e,n){return(e=mY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mY(t){var e=pY(t,"string");return typeof e=="symbol"?e:e+""}function pY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UN{constructor(){fc(this,"count",0),fc(this,"startRow",null),fc(this,"endRow",null),fc(this,"startPosition",null),fc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s}=n;r<=i&&(this.startRow=e),r>=i&&r<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-s<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function gc(t,e,n){return(e=wY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wY(t){var e=CY(t,"string");return typeof e=="symbol"?e:e+""}function CY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vY{constructor(){gc(this,"count",0),gc(this,"startColumn",0),gc(this,"endColumn",0),gc(this,"startPosition",0),gc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function mc(t,e,n){return(e=yY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yY(t){var e=SY(t,"string");return typeof e=="symbol"?e:e+""}function SY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bY{constructor(){mc(this,"count",0),mc(this,"startRow",0),mc(this,"endRow",0),mc(this,"startPosition",0),mc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function JP(t,e,n){return(e=RY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RY(t){var e=EY(t,"string");return typeof e=="symbol"?e:e+""}function EY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TY extends jN{constructor(){super(...arguments),JP(this,"columnStartOffset",0),JP(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof r=="function"){const o=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=s[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function eO(t,e,n){return(e=_Y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Y(t){var e=MY(t,"string");return typeof e=="symbol"?e:e+""}function MY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IY extends UN{constructor(){super(...arguments),eO(this,"rowStartOffset",0),eO(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof r=="function"){const o=this.startRow,a=this.endRow;r(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=s[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function tO(t,e,n){return(e=PY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PY(t){var e=OY(t,"string");return typeof e=="symbol"?e:e+""}function OY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zN{constructor(e){tO(this,"calculationTypes",[]),tO(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Zr(t,e,n){return(e=xY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xY(t){var e=AY(t,"string");return typeof e=="symbol"?e:e+""}function AY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ou=50;class HY extends zN{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(n),Zr(this,"viewportWidth",0),Zr(this,"scrollOffset",0),Zr(this,"zeroBasedScrollOffset",0),Zr(this,"totalColumns",0),Zr(this,"columnWidthFn",null),Zr(this,"columnWidth",0),Zr(this,"overrideFn",null),Zr(this,"inlineStartOffset",0),Zr(this,"totalCalculatedWidth",0),Zr(this,"startPositions",[]),Zr(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Ou:n}}function _r(t,e,n){return(e=NY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NY(t){var e=DY(t,"string");return typeof e=="symbol"?e:e+""}function DY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LY extends zN{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),_r(this,"viewportHeight",0),_r(this,"scrollOffset",0),_r(this,"zeroBasedScrollOffset",0),_r(this,"totalRows",0),_r(this,"rowHeightFn",null),_r(this,"rowHeight",0),_r(this,"overrideFn",null),_r(this,"horizontalScrollbarHeight",0),_r(this,"innerViewportHeight",0),_r(this,"totalCalculatedHeight",0),_r(this,"startPositions",[]),_r(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function kY(t,e,n){FY(t,e),e.set(t,n)}function FY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nO(t,e,n){return(e=$Y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Y(t){var e=VY(t,"string");return typeof e=="symbol"?e:e+""}function VY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function El(t,e){return t.get(YN(t,e))}function rO(t,e,n){return t.set(YN(t,e),n),n}function YN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cs=new WeakMap;class sl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;nO(this,"row",null),nO(this,"col",null),kY(this,Cs,!1),rO(Cs,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return El(Cs,this)}isSouthEastOf(e){return this.row>=e.row&&(El(Cs,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(El(Cs,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(El(Cs,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(El(Cs,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof sl&&rO(Cs,this,e.isRtl()),this}clone(){return new sl(this.row,this.col,El(Cs,this))}toObject(){return{row:this.row,col:this.col}}}function WY(t,e,n){BY(t,e),e.set(t,n)}function BY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xv(t,e,n){return(e=jY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jY(t){var e=UY(t,"string");return typeof e=="symbol"?e:e+""}function UY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mr(t,e){return t.get(GN(t,e))}function zY(t,e,n){return t.set(GN(t,e),n),n}function GN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qn=new WeakMap;class md{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;xv(this,"highlight",null),xv(this,"from",null),xv(this,"to",null),WY(this,Qn,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),zY(Qn,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=n&&s.row>=n&&i.col<=r&&s.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,o.row),u=Math.min(r.col,o.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(s),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Mr(Qn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Mr(Qn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Mr(Qn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Mr(Qn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Mr(Qn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Mr(Qn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Mr(Qn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Mr(Qn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof sl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Mr(Qn,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Mr(Qn,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let s=e.col;s<=n.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&r.push(this._createCellCoords(i,s));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let s=e.col;s<=n.col;s++)e.row===i&&e.col===s?r.push(e):n.row===i&&n.col===s?r.push(n):r.push(this._createCellCoords(i,s));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let s=n.col;s<=r.col;s++)if(e(i,s)===!1)return}clone(){return new md(this.highlight,this.from,this.to,Mr(Qn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new sl(e,n,Mr(Qn,this))}}function Oi(t,e,n){YY(t,e),e.set(t,n)}function YY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pe(t,e){return t.get(qN(t,e))}function ao(t,e,n){return t.set(qN(t,e),n),n}function qN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ir=new WeakMap,Av=new WeakMap,mn=new WeakMap,Tl=new WeakMap,Wd=new WeakMap,Qr=new WeakMap,Hv=new WeakMap,pc=new WeakMap,oa=new WeakMap,xi=new WeakMap;let KN=class{constructor(e,n,r,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Oi(this,Ir,void 0),Oi(this,Av,void 0),Oi(this,mn,void 0),Oi(this,Tl,void 0),Oi(this,Wd,void 0),Oi(this,Qr,void 0),Oi(this,Hv,void 0),Oi(this,pc,void 0),Oi(this,oa,[null,null]),Oi(this,xi,[null,null]),ao(Ir,this,r),ao(Av,this,n),ao(mn,this,s),ao(Tl,this,o),ao(Wd,this,a),ao(Qr,this,i),ao(Hv,this,e),this.registerEvents()}registerEvents(){pe(Qr,this).addEventListener(pe(mn,this).holder,"contextmenu",r=>this.onContextMenu(r)),pe(Qr,this).addEventListener(pe(mn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),pe(Qr,this).addEventListener(pe(mn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{pe(Qr,this).addEventListener(pe(mn,this).holder,"touchstart",r=>this.onTouchStart(r)),pe(Qr,this).addEventListener(pe(mn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),pe(Qr,this).addEventListener(pe(mn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||pe(Ir,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,pe(Ir,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{pe(Qr,this).addEventListener(pe(mn,this).holder,"mouseup",r=>this.onMouseUp(r)),pe(Qr,this).addEventListener(pe(mn,this).holder,"mousedown",r=>this.onMouseDown(r))};Us()?e():(kR()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(pe(pc,this)&&r){const[i,s]=[r.row,pe(pc,this).from.row],[o,a]=[r.col,pe(pc,this).from.col];return i===s&&o===a}return!1}parentCell(e){const n={},r=pe(mn,this).TABLE,i=rh(e,["TD","TH"],r);return i?(n.coords=pe(mn,this).getCoords(i),n.TD=i):ye(e,"wtBorder")&&ye(e,"current")?(n.coords=pe(Tl,this).getFocusSelection().cellRange.highlight,n.TD=pe(mn,this).getCell(n.coords)):ye(e,"wtBorder")&&ye(e,"area")&&pe(Tl,this).getAreaSelection().cellRange&&(n.coords=pe(Tl,this).getAreaSelection().cellRange.to,n.TD=pe(mn,this).getCell(n.coords)),n}onMouseDown(e){const n=pe(Av,this).rootDocument.activeElement,r=LR(nN,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const s=this.parentCell(i);ye(i,"corner")?pe(Ir,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&pe(Ir,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(pe(xi,this)[0]=s.TD,clearTimeout(pe(oa,this)[0]),pe(oa,this)[0]=setTimeout(()=>{pe(xi,this)[0]=null},1e3))}onContextMenu(e){if(pe(Ir,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!pe(Ir,this).has("onCellMouseOver"))return;const n=pe(mn,this).TABLE,r=rh(e.target,["TD","TH"],n),i=pe(Wd,this)||this;r&&r!==i.lastMouseOver&&jo(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,pe(mn,this).getCoords(r),r))}onMouseOut(e){if(!pe(Ir,this).has("onCellMouseOut"))return;const n=pe(mn,this).TABLE,r=rh(e.target,["TD","TH"],n),i=rh(e.relatedTarget,["TD","TH"],n),s=pe(Wd,this)||this;r&&r!==i&&jo(r,n)&&(this.callListener("onCellMouseOut",e,pe(mn,this).getCoords(r),r),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&pe(Ir,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===pe(xi,this)[0]&&n.TD===pe(xi,this)[1]?(ye(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),pe(xi,this)[0]=null,pe(xi,this)[1]=null):n.TD===pe(xi,this)[0]&&(pe(xi,this)[1]=n.TD,clearTimeout(pe(oa,this)[1]),pe(oa,this)[1]=setTimeout(()=>{pe(xi,this)[1]=null},500)))}onTouchStart(e){ao(pc,this,pe(Tl,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,s=ce(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&pe(Ir,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];VR()&&(EN()||TN())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const s=pe(Ir,this).getSettingPure(e);s&&s(n,r,i,pe(Hv,this).call(this))}destroy(){clearTimeout(pe(oa,this)[0]),clearTimeout(pe(oa,this)[1]),pe(Qr,this).destroy()}};function Nv(t,e,n){return(e=GY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GY(t){var e=qY(t,"string");return typeof e=="symbol"?e:e+""}function qY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KY{constructor(e,n,r){Nv(this,"offset",void 0),Nv(this,"total",void 0),Nv(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Dv(t,e,n){return(e=XY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XY(t){var e=ZY(t,"string");return typeof e=="symbol"?e:e+""}function ZY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QY{constructor(e,n,r){Dv(this,"offset",void 0),Dv(this,"total",void 0),Dv(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const JY=0,qg=1,Kg=2;function Bd(t,e,n){return(e=eG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eG(t){var e=tG(t,"string");return typeof e=="symbol"?e:e+""}function tG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iO{constructor(){Bd(this,"currentSize",0),Bd(this,"nextSize",0),Bd(this,"currentOffset",0),Bd(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Lv(t,e,n){return(e=nG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nG(t){var e=rG(t,"string");return typeof e=="symbol"?e:e+""}function rG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iG{constructor(){Lv(this,"size",new iO),Lv(this,"workingSpace",JY),Lv(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof iO}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=qg,e.workingSpace=Kg,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Kg,e.workingSpace=qg,this.sharedSize=e.getViewSize()}}function _l(t,e,n){return(e=sG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sG(t){var e=oG(t,"string");return typeof e=="symbol"?e:e+""}function oG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XN{constructor(e,n,r){_l(this,"rootNode",void 0),_l(this,"nodesPool",void 0),_l(this,"sizeSet",new iG),_l(this,"childNodeType",void 0),_l(this,"visualIndex",0),_l(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(qg))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Kg)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=r&&n.isPlaceOn(qg);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Kg)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class ZN extends XN{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function aG(t,e,n){return(e=lG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lG(t){var e=uG(t,"string");return typeof e=="symbol"?e:e+""}function uG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cG{constructor(e){aG(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function wc(t,e,n){return(e=hG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hG(t){var e=dG(t,"string");return typeof e=="symbol"?e:e+""}function dG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pd{constructor(e,n){wc(this,"nodesPool",null),wc(this,"nodeType",void 0),wc(this,"rootNode",void 0),wc(this,"table",null),wc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new cG(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function sO(t,e,n){return(e=fG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fG(t){var e=gG(t,"string");return typeof e=="symbol"?e:e+""}function gG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mG extends pd{constructor(){super("TH"),sO(this,"orderViews",new WeakMap),sO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new ZN(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=s.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),wl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(d,[lU(),wU(),_R(h+1),Uu(-1)]),n[h](a,d,h)}u.end()}}}class pG extends pd{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<s;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)r.removeChild(r.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&yi(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&be(this.rootNode,[XH()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&be(o,[YS(),eN(n+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),wl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&be(u,[_R(a+1+this.table.rowHeadersCount),Uu(-1),uU(),...a>=0?[pU()]:[YS()]]),r[n](l,u,n)}}}}let oO=!1;class wG extends pd{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!oO&&e>1e3&&(oO=!0,tt(it`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+n].style.width=`${o}px`}const r=this.rootNode.firstChild;r&&Y(r,"rowHeader")}}function CG(t,e,n){return(e=vG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vG(t){var e=yG(t,"string");return typeof e=="symbol"?e:e+""}function yG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jd={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let aO=!1;class SG extends pd{constructor(e){super("TR",e),CG(this,"orderView",void 0),this.orderView=new XN(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!aO&&e>1e3&&(aO=!0,tt(it`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&be(this.rootNode,[XH()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;be(s,[YS(),eN(o+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}Ce(s,[jd.rowEven,jd.rowOdd]),(o+1)%2===0?Y(s,jd.rowEven):Y(s,jd.rowOdd)}this.orderView.end()}}function lO(t,e,n){return(e=bG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bG(t){var e=RG(t,"string");return typeof e=="symbol"?e:e+""}function RG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EG extends pd{constructor(){super("TD"),lO(this,"orderViews",new WeakMap),lO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new ZN(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){c.render();const f=c.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(ye(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),wl(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,f),this.table.isAriaEnabled()){var s,o;be(f,[...f.hasAttribute("role")?[]:[aU()],Uu(-1),_R(m+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}c.end()}}}function nn(t,e,n){return(e=TG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TG(t){var e=_G(t,"string");return typeof e=="symbol"?e:e+""}function _G(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MG{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};nn(this,"rootNode",void 0),nn(this,"rootDocument",void 0),nn(this,"rowHeaders",null),nn(this,"columnHeaders",null),nn(this,"colGroup",null),nn(this,"rows",null),nn(this,"cells",null),nn(this,"rowFilter",null),nn(this,"columnFilter",null),nn(this,"rowUtils",null),nn(this,"columnUtils",null),nn(this,"rowsToRender",0),nn(this,"columnsToRender",0),nn(this,"rowHeaderFunctions",[]),nn(this,"rowHeadersCount",0),nn(this,"columnHeaderFunctions",[]),nn(this,"columnHeadersCount",0),nn(this,"cellRenderer",void 0),nn(this,"activeOverlayName",void 0),nn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),s=this.rowUtils;if(i.firstChild){const o=this.renderedRowToSource(r),a=s.getHeightByOverlayName(o,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class IG{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new MG(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new mG,columnHeaders:new pG(n),colGroup:new wG(r),rows:new SG(i),cells:new EG}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function kv(t,e,n){return(e=PG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PG(t){var e=OG(t,"string");return typeof e=="symbol"?e:e+""}function OG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xG{constructor(e,n){kv(this,"dataAccessObject",void 0),kv(this,"wtSettings",void 0),kv(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<r;s++){let o=Array.isArray(n)?n[s]:n;o=o??i,this.headerWidths.set(s,o)}}}}function uO(t,e,n){return(e=AG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AG(t){var e=HG(t,"string");return typeof e=="symbol"?e:e+""}function HG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NG{constructor(e,n){uO(this,"dataAccessObject",void 0),uO(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function Ai(t,e,n){return(e=DG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DG(t){var e=LG(t,"string");return typeof e=="symbol"?e:e+""}function LG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gu{constructor(e,n,r,i,s){Ai(this,"wtSettings",null),Ai(this,"domBindings",void 0),Ai(this,"TBODY",null),Ai(this,"THEAD",null),Ai(this,"COLGROUP",null),Ai(this,"hasTableHeight",!0),Ai(this,"hasTableWidth",!0),Ai(this,"isTableVisible",!1),Ai(this,"tableOffset",0),Ai(this,"holderOffset",0),this.domBindings=r,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,IR(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new NG(this.dataAccessObject,this.wtSettings),this.columnUtils=new xG(this.dataAccessObject,this.wtSettings),this.tableRenderer=new IG({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&be(r,[as()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[as()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&be(r.parentNode,[as()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&be(r,[as()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,s=n.getSetting("totalRows"),o=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=cn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=cn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=s>0?this.getFirstRenderedRow():0,m=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new QY(f,s,c),this.columnFilter=new KY(m,o,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const w={};this.wtSettings.getSetting("beforeDraw",!0,w),v=w.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(is)||this.is(Uo))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(is))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(is)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,s=this.getColumnHeaderHeight(r),o=this.getColumnHeader(n,r),o&&(a=bu(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(r[s]){if(!n[s]||n[s].childNodes.length===0)return;n[s].childNodes[0].style.height=`${r[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(is))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const s=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[s]&&(n.oversizedRows[s]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var s;n=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[r];s&&n.push(s)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&n.push(o)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Go(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let s=oN(r),o=n.cellIndex;Ro(ll,n,this.wtRootElement)||Ro(ol,n,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Ro(Uo,n,this.wtRootElement)||Ro(is,n,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),Ro(ll,n,this.wtRootElement)||Ro(al,n,this.wtRootElement)||Ro(Uo,n,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o);const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=bu(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),s=i?kt:bu,o=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=s(d):u=s(h)-o,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Yt(this.TABLE)}getHeight(){return kt(this.TABLE)}getTotalWidth(){const e=Yt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=kt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return rl(this.TABLE)}_modifyRowHeaderWidth(e){let n=dt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const kG="stickyRowsBottom",KR={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};gs(KR,"MIXIN_NAME",kG,{writable:!1,enumerable:!1});const FG="stickyColumnsStart",lp={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};gs(lp,"MIXIN_NAME",FG,{writable:!1,enumerable:!1});class XR extends Gu{constructor(e,n,r,i){super(e,n,r,i,Uo)}}st(XR,KR);st(XR,lp);const ol="top",is="bottom",al="inline_start",ll="top_inline_start_corner",Uo="bottom_inline_start_corner",QN=[ol,is,al,ll,Uo],$G=new Map([[ol,`ht_clone_${ol}`],[is,`ht_clone_${is}`],[al,`ht_clone_${al} ht_clone_left`],[ll,`ht_clone_${ll} ht_clone_top_left_corner`],[Uo,`ht_clone_${Uo} ht_clone_bottom_left_corner`]]);function VG(t,e){WG(t,e),e.add(t)}function WG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BG(t,e,n){return(e=jG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jG(t){var e=UG(t,"string");return typeof e=="symbol"?e:e+""}function UG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ud(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cc=new WeakSet;class zG{constructor(e){VG(this,Cc),BG(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),s=this.scrollViewportVertically(e.row,r);return i||s}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const s=hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;n=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<o)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const s=hr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;n=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-o-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Ud(Cc,this,hO).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Ud(Cc,this,hO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Ud(Cc,this,cO).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Ud(Cc,this,cO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function cO(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(n.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=cn(r.wtRootElement).left;const u=Math.abs(OR(o,o));if(l>u){const c=xR(o);let h=i.getRowHeaderWidth();for(let d=1;d<=s;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function hO(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=cn(n.wtRootElement),a=Jm(s,s);if(o.top>a){const l=bu(s);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),o.top+u-a>=l){t=c-2;break}}}return t}function Pr(t,e,n){return(e=YG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YG(t){var e=GG(t,"string");return typeof e=="symbol"?e:e+""}function GG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZR{get eventManager(){return new Ur(this)}constructor(e,n){Pr(this,"wtTable",void 0),Pr(this,"wtScroll",void 0),Pr(this,"wtViewport",void 0),Pr(this,"wtOverlays",void 0),Pr(this,"selectionManager",void 0),Pr(this,"wtEvent",void 0),Pr(this,"guid",`wt_${RR()}`),Pr(this,"drawInterrupted",!1),Pr(this,"drawn",!1),Pr(this,"activeOverlayName","master"),Pr(this,"domBindings",void 0),Pr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new zG(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){qo(r,e[n])}])}}createCellCoords(e,n){return new sl(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new md(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=r-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function dO(t,e,n){return(e=qG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qG(t){var e=KG(t,"string");return typeof e=="symbol"?e:e+""}function KG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XG extends ZR{constructor(e,n,r){super(e,n),dO(this,"cloneSource",void 0),dO(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new KN(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function ZG(t,e,n){return(e=QG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QG(t){var e=JG(t,"string");return typeof e=="symbol"?e:e+""}function JG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wd{constructor(e,n,r,i,s){ZG(this,"wtSettings",null),gs(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=n,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=il(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=il(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=kh(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){tt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=r<this.wtSettings.getSetting("fixedColumnsStart"),o=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,s,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!n)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+yn())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:r.start+o,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=o.horizontal-s.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(QN.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=r.createElement("div"),o=r.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${$G.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,n.getSetting("ariaTags")&&be(s,[as()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===ol||u==="vertical"&&this.type===al?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=kh(e.TABLE),new XG(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,s=e.parentNode.style;[r,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class e2 extends wd{constructor(e,n,r,i,s,o){super(e,n,Uo,r,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new XR(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${s}px`,n.style.bottom=`${o}px`}else dd(n),this.repositionOverlay();let r=kt(this.clone.wtTable.TABLE);const i=Yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=yn(r)),i.style.bottom=`${s}px`}}const t2="calculatedColumns",up={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};gs(up,"MIXIN_NAME",t2,{writable:!1,enumerable:!1});class QR extends Gu{constructor(e,n,r,i){super(e,n,r,i,is)}}st(QR,KR);st(QR,up);function n2(t,e,n){return(e=r2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r2(t){var e=i2(t,"string");return typeof e=="symbol"?e:e+""}function i2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s2 extends wd{constructor(e,n,r,i){super(e,n,is,r,i),n2(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new QR(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=yn(r)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Qm(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,s=i.getDefaultRowHeight();let o=e,a=0;for(;o<n;){const l=r.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=yn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=kt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;n&&s.offsetHeight!==s.clientHeight&&(o=yn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Jm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((r||n===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=ye(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Y(o,"innerBorderBottom"),s=!a):(Ce(o,"innerBorderBottom"),s=a)}return s}}const o2="calculatedRows",JR={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};gs(JR,"MIXIN_NAME",o2,{writable:!1,enumerable:!1});class eE extends Gu{constructor(e,n,r,i){super(e,n,r,i,al)}}st(eE,JR);st(eE,lp);const a2="localHooks",Tn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)jg(this._localHooks[t][l],this,e,n,r,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};gs(Tn,"MIXIN_NAME",a2,{writable:!1,enumerable:!1});let JN=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};st(JN,Tn);const eD="active-header",tE="header",nE="area",Xg="focus",l2="fill",u2="row",c2="column",h2="custom-selection",rE=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var fO={},gO;function d2(){if(gO)return fO;gO=1;var t=op();return t("flat"),fO}d2();function f2(t,e){tD(t,e),e.add(t)}function mO(t,e,n){tD(t,e),e.set(t,n)}function tD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(t,e){return t.get(mh(t,e))}function pO(t,e,n){return t.set(mh(t,e),n),n}function mh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var si=new WeakMap,On=new WeakMap,zd=new WeakSet;class g2{constructor(){f2(this,zd),mO(this,si,void 0),mO(this,On,void 0)}setActiveOverlay(e){return pO(On,this,e),this}setActiveSelection(e){return pO(si,this,e),this}scan(){const e=xt(si,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,s]=xt(si,this).getCorners(),{wtTable:o}=xt(On,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let c=-o.getRowHeadersCount();c<a;c++){const h=o.columnFilter.renderedToSource(c);if(!(h<r||h>s)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let m=o.getColumnHeader(h,f);const v=xt(On,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:xt(si,this).settings.selectionType,columnCursor:u,selectionWidth:s-r+1});v!==null&&(v!==h&&(m=o.getColumnHeader(v,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,s]=xt(si,this).getCorners(),{wtTable:o}=xt(On,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const h=o.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>s)continue;const f=d+l;let m=o.getRowHeader(h,f);const v=xt(On,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:xt(si,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(m=o.getRowHeader(v,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:n}=xt(On,this);mh(zd,this,m2).call(this,(r,i)=>{const s=n.getCell(xt(On,this).createCellCoords(r,i)),o=xt(On,this).getSetting("onAfterDrawSelection",r,i,xt(si,this).settings.layerLevel);typeof o=="string"&&Y(s,o),e(s)})}scanRowsInCellsRange(e){const[n,,r]=xt(si,this).getCorners(),{wtTable:i}=xt(On,this);mh(zd,this,wO).call(this,(s,o)=>{if(s>=n&&s<=r){const a=i.getCell(xt(On,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=xt(si,this).getCorners(),{wtTable:i}=xt(On,this);mh(zd,this,wO).call(this,(s,o)=>{if(o>=n&&o<=r){const a=i.getCell(xt(On,this).createCellCoords(s,o));e(a)}})}}function m2(t){let[e,n,r,i]=xt(si,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:s}=xt(On,this),o=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),o){if(n=Math.max(n,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),r=Math.min(r,s.getLastRenderedRow()),i<n||r<e)return}else if(!(s.getCell(xt(On,this).createCellCoords(e,n))instanceof HTMLElement))return;for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function wO(t){const{wtTable:e}=xt(On,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<r;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class CO{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=rE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Kr(e);const r=this,i=this.wot.rootDocument.body,s=n.getBoundingClientRect();n.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Us()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=n.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ne(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ne(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),v=parseInt(c.width,10),w=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const R=Math.min(parseInt(i+s,10),w-m-f*2),P=Math.min(parseInt(i+s-v/4,10),w-v-f*2);h[l]=`${R}px`,d[l]=`${P}px`;const O=Math.min(parseInt(r+o,10),b-m-f*2),D=Math.min(parseInt(r+o-v/4,10),b-v-f*2);h.top=`${O}px`,d.top=`${D}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,s]=e;if(n<0&&i<0||r<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==s,c=o.getFirstRenderedRow(),h=o.getLastRenderedRow(),d=o.getFirstRenderedColumn(),f=o.getLastRenderedColumn();let m;if(u){if(r=Math.max(r,d),s=Math.min(s,f),n=Math.max(n,c),i=Math.min(i,h),s<r||i<n){this.disappear();return}m=o.getCell(this.wot.createCellCoords(n,r))}else if(m=o.getCell(this.wot.createCellCoords(n,r)),!(m instanceof HTMLElement)){this.disappear();return}const v=u?o.getCell(this.wot.createCellCoords(i,s)):m,w=cn(m),b=u?cn(v):w,R=cn(o.TABLE),P=w.top,O=w.left,D=this.wot.wtSettings.getSetting("rtlMode");let M=0,A=0;if(D){const Te=Yt(o.TABLE),$e=Yt(m),Et=l.innerWidth-R.left-Te;A=O+$e-b.left,M=l.innerWidth-O-$e-Et-1}else A=b.left+Yt(v)-O,M=O-R.left-1;if(this.isEntireColumnSelected(n,i)){const Te=n,$e=this.getDimensionsFromHeader("columns",r,s,Te,R);let Et=null;$e&&([Et,M,A]=$e),Et&&(m=Et)}let j=P-R.top-1,X=b.top+kt(v)-P;if(this.isEntireRowSelected(r,s)){const Te=r,$e=this.getDimensionsFromHeader("rows",n,i,Te,R);let Et=null;$e&&([Et,j,X]=$e),Et&&(m=Et)}const U=l.getComputedStyle(m);parseInt(U.borderTopWidth,10)>0&&(j+=1,X=X>0?X-1:0),parseInt(U[D?"borderRightWidth":"borderLeftWidth"],10)>0&&(M+=1,A=A>0?A-1:0);const Z=D?"right":"left";this.topStyle.top=`${j}px`,this.topStyle[Z]=`${M}px`,this.topStyle.width=`${A}px`,this.topStyle.display="block",this.startStyle.top=`${j}px`,this.startStyle[Z]=`${M}px`,this.startStyle.height=`${X}px`,this.startStyle.display="block";const J=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${j+X-J}px`,this.bottomStyle[Z]=`${M}px`,this.bottomStyle.width=`${A}px`,this.bottomStyle.display="block",this.endStyle.top=`${j}px`,this.endStyle[Z]=`${M+A-J}px`,this.endStyle.height=`${X+1}px`,this.endStyle.display="block";let ae=this.settings.border.cornerVisible;ae=typeof ae=="function"?ae(this.settings.layerLevel):ae;const ne=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[fe,mt]=[i,s];if(ne&&Array.isArray(ne)&&([,,fe,mt]=ne),Us()||!ae||this.isPartRange(fe,mt))this.cornerStyle.display="none";else{this.cornerStyle.top=`${j+X+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Z]=`${M+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Te=il(o.TABLE);const $e=Te===l;$e&&(Te=a.documentElement);const Et=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,en=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),g=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const p=$e?v.getBoundingClientRect().left:v.offsetLeft;let y=!1,E=0;D?(E=p-parseInt(this.cornerDefaultStyle.width,10)/2,y=E<0):(E=p+Yt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,y=E>=xR(Te)),y&&(this.cornerStyle[Z]=`${Math.floor(M+A+this.cornerCenterPointOffset-en-Et)}px`,this.cornerStyle[D?"borderLeftWidth":"borderRightWidth"]=0)}i===this.wot.getSetting("totalRows")-1&&($e?v.getBoundingClientRect().top:v.offsetTop)+kt(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=bu(Te)&&(this.cornerStyle.top=`${Math.floor(j+X+this.cornerCenterPointOffset-g-Et)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Us()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,j,M,A,X)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,v=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return kt(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return Yt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const w=this.wot.getSetting("columnHeaders").length;if(m=l(n,w-i),v=l(r,w-i),!m||!v)return!1;const b=cn(m),R=cn(v);return m&&v&&(h=b[f]-s[f]-1,d=R[f]+u(v)-b[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?Y(this[e],"hidden"):(ye(this[e],"hidden")&&Ce(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?Y(this[e],"hidden"):Ce(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Us()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function p2(t,e){nD(t,e),e.add(t)}function Ml(t,e,n){nD(t,e),e.set(t,n)}function nD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(t,e){return t.get(iE(t,e))}function vO(t,e,n){return t.set(iE(t,e),n),n}function iE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xn=new WeakMap,or=new WeakMap,Fv=new WeakMap,ih=new WeakMap,$v=new WeakMap,aa=new WeakMap,yO=new WeakSet;class w2{constructor(e){p2(this,yO),Ml(this,xn,void 0),Ml(this,or,void 0),Ml(this,Fv,new g2),Ml(this,ih,new WeakMap),Ml(this,$v,new WeakSet),Ml(this,aa,new Map),vO(or,this,e)}setActiveOverlay(e){return vO(xn,this,e),De(Fv,this).setActiveOverlay(De(xn,this)),De(ih,this).has(De(xn,this))||De(ih,this).set(De(xn,this),new Set),this}getFocusSelection(){return De(or,this)!==null?De(or,this).getFocus():null}getAreaSelection(){return De(or,this)!==null?De(or,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(De(aa,this).has(e)){const r=De(aa,this).get(e);if(r.has(De(xn,this)))return r.get(De(xn,this));const i=new CO(De(xn,this),e.settings);return r.set(De(xn,this),i),i}const n=new CO(De(xn,this),e.settings);return De(aa,this).set(e,new Map([[De(xn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=De(aa,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){De(aa,this).get(e).forEach(n=>n.destroy()),De(aa,this).delete(e)}render(e){if(De(or,this)===null)return;e&&iE(yO,this,C2).call(this);const n=Array.from(De(or,this)),r=new Map,i=new Map;for(let s=0;s<n.length;s++){const o=n[s],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=o.settings;De($v,this).has(o)||(De($v,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&De(Fv,this).setActiveSelection(o).scan().forEach(m=>{if(r.has(m)){const v=r.get(m);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=o.getCorners();De(xn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>De(ih,this).get(De(xn,this)).add(u)),Y(o,l),o.nodeName==="TD"&&Array.isArray((a=De(or,this).options)===null||a===void 0?void 0:a.cellAttributes)&&be(o,De(or,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{be(s,[...i.get(s)])})}}function C2(){const t=De(ih,this).get(De(xn,this)),e=De(xn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const s=De(xn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let o=[];Array.isArray((r=De(or,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(o=De(or,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=De(or,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...De(or,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)Ce(s[a],n),wl(s[a],o)}),t.clear()}class v2 extends wd{constructor(e,n,r,i){super(e,n,al,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new eE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),ep(r,`${s}px`,"0px")):(s=this.getScrollPosition(),dd(r));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,PR(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<n;)s+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=yn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=Yt(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=rE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!ye(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=yn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,hN(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(OR(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),o=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";o?Ce(r,"emptyRows"):Y(r,"emptyRows");let l=!1;if(!a){if(s&&!i.length)Y(r,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=ye(r,"innerBorderInlineStart");e?(Y(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(Ce(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const y2="stickyRowsTop",sE={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};gs(sE,"MIXIN_NAME",y2,{writable:!1,enumerable:!1});class oE extends Gu{constructor(e,n,r,i){super(e,n,r,i,ll)}}st(oE,sE);st(oE,lp);function SO(t,e,n){return(e=S2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S2(t){var e=b2(t,"string");return typeof e=="symbol"?e:e+""}function b2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R2 extends wd{constructor(e,n,r,i,s,o){super(e,n,ll,r,i),SO(this,"topOverlay",void 0),SO(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new oE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();ep(e,`${i}px`,`${s}px`)}else dd(e);let n=kt(this.clone.wtTable.TABLE);const r=Yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class aE extends Gu{constructor(e,n,r,i){super(e,n,r,i,ol)}}st(aE,sE);st(aE,up);function E2(t,e,n){return(e=T2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T2(t){var e=_2(t,"string");return typeof e=="symbol"?e:e+""}function _2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M2 extends wd{constructor(e,n,r,i){super(e,n,ol,r,i),E2(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new aE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;s=u===c,i=this.getOverlayOffset(),ep(e,"0px",`${i}px`)}else i=this.getScrollPosition(),dd(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Qm(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,s=0;for(;i<n;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?r:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=yn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=kt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=rE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,o=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ye(o.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&o.offsetHeight!==o.clientHeight&&(h=yn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,cN(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Jm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,s=r.getSetting("totalColumns"),o=r.getSetting("preventOverflow")==="horizontal";s?Ce(i,"emptyColumns"):Y(i,"emptyColumns");let a=!1;if(!n&&!o){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ye(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(Y(i,"innerBorderTop"),a=!h):(Ce(i,"innerBorderTop"),a=h)}}return a}}function Yd(t,e,n){I2(t,e),e.set(t,n)}function I2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vs(t,e,n){return(e=P2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P2(t){var e=O2(t,"string");return typeof e=="symbol"?e:e+""}function O2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function la(t,e,n){return t.set(rD(t,e),n),n}function ys(t,e){return t.get(rD(t,e))}function rD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Il=new WeakMap,Gd=new WeakMap,Pl=new WeakMap,qd=new WeakMap;class x2{constructor(e,n,r,i,s,o){vs(this,"wot",null),Yd(this,Il,[]),vs(this,"topOverlay",null),vs(this,"bottomOverlay",null),vs(this,"inlineStartOverlay",null),vs(this,"topInlineStartCornerOverlay",null),vs(this,"bottomInlineStartCornerOverlay",null),vs(this,"browserLineHeight",void 0),vs(this,"wtSettings",null),Yd(this,Gd,!1),Yd(this,Pl,0),Yd(this,qd,null),vs(this,"resizeObserver",new ResizeObserver(c=>{$h(()=>{!Array.isArray(c)||!c.length||(la(Pl,this,ys(Pl,this)+1),ys(Pl,this)===100&&(tt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ys(qd,this)!==null&&clearTimeout(ys(qd,this)),la(qd,this,setTimeout(()=>{la(Pl,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=yn(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:kh(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...ys(Il,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),s=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new M2(...e),this.bottomOverlay=new s2(...e),this.inlineStartOverlay=new v2(...e),this.topInlineStartCornerOverlay=new R2(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new e2(...e,this.bottomOverlay,this.inlineStartOverlay),la(Il,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){la(Gd,this,ys(Il,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),ys(Il,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ys(Il,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=n.devicePixelRatio&&n.devicePixelRatio>1,o=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!FR())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{$h(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{la(Pl,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==n&&s!==n&&!e.target.contains(i)||r!==n&&s!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==r&&o!==r&&!o.contains(s),l=i!==r&&o!==r&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Yu(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),s=this.scrollHorizontally(r);return i||s}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!ys(Gd,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),la(Gd,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=kh(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,s),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),m=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),v=f()?1:0,w=m()?1:0;d.width=`${c+w}px`,d.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return _(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];_(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function bO(t,e,n){return(e=A2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A2(t){var e=H2(t,"string");return typeof e=="symbol"?e:e+""}function H2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N2{constructor(e){bO(this,"settings",{}),bO(this,"defaults",Object.freeze(this.getDefaults())),Ne(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);qo(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ne(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,s){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,s):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class lE extends Gu{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=il(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Fh(e,"height",n),s=Fh(e,"overflow",n),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),o.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=rl(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",s=e.getSetting("columnHeaders").length;if(s&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}st(lE,JR);st(lE,up);class D2{constructor(e,n,r,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new bY:new IY],["fullyVisible",()=>new dY],["partiallyVisible",()=>new UN]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new vY:new TY],["fullyVisible",()=>new uY],["partiallyVisible",()=>new jN]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=kt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return cn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=kt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=n.length;i<s;i++)r?(this.rowHeaderWidth+=Yt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=o),r.holder.clientHeight===r.holder.offsetHeight?s=0:s=yn(this.domBindings.rootDocument),new LY({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=n.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=yn(this.domBindings.rootDocument)),new HY({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const s=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!n.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s,rowStartOffset:o,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(o,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(o/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>s||r===s&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s,columnStartOffset:o,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(o,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(o/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>s||r===s&&r<l)}resetHasOversizedColumnHeadersMarked(){Ne(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function L2(t,e){iD(t,e),e.add(t)}function ua(t,e,n){iD(t,e),e.set(t,n)}function iD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yt(t,e){return t.get(fi(t,e))}function di(t,e,n){return t.set(fi(t,e),n),n}function fi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RO=23;var Gi=new WeakMap,Ws=new WeakMap,uE=new WeakMap,nb=new WeakMap,Eo=new WeakMap,sh=new WeakMap,Wh=new WeakMap,Xi=new WeakSet;class k2{constructor(e){L2(this,Xi),ua(this,Gi,void 0),ua(this,Ws,void 0),ua(this,uE,void 0),ua(this,nb,void 0),ua(this,Eo,!0),ua(this,sh,{}),ua(this,Wh,{}),di(Ws,this,e.rootTable.parentElement.parentElement),di(nb,this,e.rootDocument)}isClassicTheme(){return yt(Eo,this)}getCSSVariableValue(e){var n;if(yt(Eo,this))return null;if(yt(sh,this)[`--ht-${e}`])return yt(sh,this)[`--ht-${e}`];const r=(n=fi(Xi,this,W2).call(this,`--ht-${e}`))!==null&&n!==void 0?n:fi(Xi,this,sD).call(this,`--ht-${e}`);if(r!==null)return yt(sh,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=yt(Wh,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(yt(Eo,this))return RO;const e=fi(Xi,this,F2).call(this);return!e&&ye(yt(Ws,this),"ht-wrapper")?(tt(`The "${yt(Gi,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),di(Eo,this,!0),this.useTheme(),RO):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){fi(Xi,this,EO).call(this),di(Eo,this,!0),di(Gi,this,e||void 0);return}e&&e!==yt(Gi,this)&&(yt(Gi,this)&&fi(Xi,this,B2).call(this),di(Gi,this,e),di(Eo,this,!1),fi(Xi,this,$2).call(this),fi(Xi,this,EO).call(this))}getThemeName(){return yt(Gi,this)}removeClassNames(){ye(yt(Ws,this),yt(Gi,this))&&Ce(yt(Ws,this),yt(Gi,this))}}function F2(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function $2(){Ce(yt(Ws,this),/ht-theme-.*/g),Y(yt(Ws,this),yt(Gi,this))}function EO(){this.isClassicTheme()||di(uE,this,getComputedStyle(yt(Ws,this)));const t=fi(Xi,this,V2).call(this,["box-sizing","border-bottom-width"]);yt(Wh,this).td={...yt(Wh,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function V2(t){const e=yt(nb,this),n=yt(Ws,this),r=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),i.appendChild(s),i.appendChild(o),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function W2(t){const e=Math.ceil(parseFloat(fi(Xi,this,sD).call(this,t)));return Number.isNaN(e)?null:e}function sD(t){const e=yt(uE,this).getPropertyValue(t);return e===""?null:e}function B2(){di(Wh,this,{}),di(sh,this,{}),di(Eo,this,!0)}class j2 extends ZR{constructor(e,n){super(e,new N2(n)),this.stylesHandler=new k2(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new lE(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new D2(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new w2(this.wtSettings.getSetting("selections")),this.wtEvent=new KN(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new x2(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ne(e,(i,s)=>{this.wtSettings.getSetting(s).length&&r.push(i),n.push(i)}),Ce(this.wtTable.wtRootElement.parentNode,n),Y(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!QN.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class cE{constructor(e){e instanceof ZR?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new cE(n);return()=>r},this._wot=new j2(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,s){return this._wot.wtSettings.getSetting(e,n,r,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function TO(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function U2(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(s(u-1,n.col)):o&&!i.row?r.setRangeEnd(s(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const z2=new Map([["mousedown",TO],["mouseover",U2],["touchstart",TO]]);function _O(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:s}=e;z2.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:sp(t)||t.type==="touchstart",isRightClick:Ko(t)})}const oD=new WeakMap,hE=Symbol("rootInstance");function Y2(t){oD.set(t,!0)}function G2(t){return t===hE}function Sg(t){return oD.has(t)}function q2(t,e){aD(t,e),e.add(t)}function ca(t,e,n){aD(t,e),e.set(t,n)}function aD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lo(t,e,n){return(e=K2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K2(t){var e=X2(t,"string");return typeof e=="symbol"?e:e+""}function X2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pn(t,e){return t.get(Eu(t,e))}function Or(t,e,n){return t.set(Eu(t,e),n),n}function Eu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vv=new WeakMap,Kd=new WeakMap,Xd=new WeakMap,Ss=new WeakMap,Jr=new WeakMap,Wv=new WeakMap,Bv=new WeakMap,oh=new WeakSet;class Z2{constructor(e){q2(this,oh),lo(this,"hot",void 0),lo(this,"eventManager",void 0),lo(this,"settings",void 0),lo(this,"THEAD",void 0),lo(this,"TBODY",void 0),lo(this,"_wt",void 0),lo(this,"activeWt",void 0),ca(this,Vv,0),ca(this,Kd,0),lo(this,"postponedAdjustElementsSize",!1),ca(this,Xd,!1),ca(this,Ss,void 0),ca(this,Jr,void 0),ca(this,Wv,0),ca(this,Bv,0),this.hot=e,this.eventManager=new Ur(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),Eu(oh,this,J2).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Y(e,"handsontable"),Or(Jr,this,n.createElement("TABLE")),Y(pn(Jr,this),"htCore"),this.hot.getSettings().tableClassName&&Y(pn(Jr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(be(pn(Jr,this),[as()]),be(e,[oU(),JH(-1),Zm(this.hot.countCols()),yU()])),this.THEAD=n.createElement("THEAD"),pn(Jr,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),pn(Jr,this).appendChild(this.TBODY),this.hot.table=pn(Jr,this),this.hot.container.insertBefore(pn(Jr,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,s=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Or(Xd,this,!0),this.isTextSelectionAllowed(a.target)||(GS(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Or(Xd,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{pn(Xd,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&GS(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{r.isInProgress()&&sp(a)&&r.finish(),Or(Ss,this,!1);const l=tp(n.activeElement);gh(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Ko(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{r.isInProgress()&&Ko(a)&&(r.finish(),Or(Ss,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{r.isInProgress()&&r.finish(),Or(Ss,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(pn(Ss,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=yn(n);if(n.elementFromPoint(u+m,c)!==d||n.elementFromPoint(u,c+m)!==d)return}else for(;h!==s;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=nl(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=nl(o);this.eventManager.addEventListener(pn(Jr,this),"selectstart",a=>{this.settings.fragmentSelection||gh(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const s=r.getNearestNotHiddenIndex(e,n),o=r.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return n<0?a=o+1:n>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&Y(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&Ce(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:pn(Jr,this),isDataViewInstance:()=>Sg(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),Or(Kd,this,s.length),this.hot.getSettings().ariaTags&&Eu(oh,this,lD).call(this)===this.hot.countCols()&&Eu(oh,this,Q2).call(this,pn(Kd,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),Or(Vv,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,v,f),this.hot.runHooks("afterRenderer",a,l,u,m,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&rl(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Or(Ss,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,c),!xo(s)&&(_O(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,Or(Ss,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!xo(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!xo(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,c),!xo(s)&&(pn(Ss,this)&&_O(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt)},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(xo(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollVertically",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,c]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=o>=0?c.getVisualFromRenderableIndex(o):o,d=s>=0?u.getVisualFromRenderableIndex(s):s,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,v,w,b]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,-1)):w,b>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(b,-1)):b]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=o>=0?l.getVisualFromRenderableIndex(o):o,c=s>=0?a.getVisualFromRenderableIndex(s):s,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const c=Math.max(1,Math.ceil(u/a*12));s.startRow=Math.max(l-c,0),s.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const c=Math.max(1,Math.ceil(u/a*6));s.startColumn=Math.max(l-c,0),s.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new cE(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(gh(e))return!0;const n=jo(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return pn(Ss,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ye(r,"relative")){yi(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,s=r.createElement("div"),o=r.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),n.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(n.firstChild){const o=n.firstChild;ye(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,r,i),o.className="",Y(o,["relative",...s()])):(yi(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(be(a,...as()),be(l,...as())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=n;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ye(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(n):ye(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(n))),s>-1?Cl(e,r(n,i)):(qo(e,"Â "),Y(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Or(Wv,this,e),Or(Bv,this,n)}getLastSize(){return{width:pn(Wv,this),height:pn(Bv,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return pn(Vv,this)}getRowHeadersCount(){return pn(Kd,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function lD(){return parseInt(this.hot.rootElement.getAttribute(Zm()[0]),10)}function Q2(t){const e=Eu(oh,this,lD).call(this)+t;be(this.hot.rootElement,...Zm(e))}function J2(){const t=this.hot.rootElement;this.hasVerticalScroll()?Y(t,"htHasScrollY"):Ce(t,"htHasScrollY"),this.hasHorizontalScroll()?Y(t,"htHasScrollX"):Ce(t,"htHasScrollX")}var MO={},IO={},PO;function eq(){if(PO)return IO;PO=1;var t=gt(),e=Vu(),n=dr(),r=on(),i=hs();return t({target:"Iterator",proto:!0,real:!0},{every:function(o){r(this),n(o);var a=i(this),l=0;return!e(a,function(u,c){if(!o(u,l++))return c()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),IO}var OO;function tq(){return OO||(OO=1,eq()),MO}tq();const uD="ABCDEFGHIJKLMNOPQRSTUVWXYZ",rb=uD.length;function cp(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%rb,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/rb,10);return n}function nq(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=rb**r*(uD.indexOf(t[n])+1);return e-=1,e}function rq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const s=[];for(i=0;i<e;i++)s.push(cp(i)+(r+1));n.push(s)}return n}function iq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const s={};for(i=0;i<e;i++)s[`prop${i}`]=cp(i)+(r+1);n.push(s)}return n}function sq(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let s=0;s<e;s++)r.push("");n.push(r)}return n}function dE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{r.push([s+e,a,o])}):Object.keys(i).forEach(o=>{r.push([s+e,o,i[o]])})}),r}function fE(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&He(t[0])&&(e=ip(t[0]))),e}function cD(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function hD(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const oq=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:fE,createEmptySpreadsheetData:sq,createSpreadsheetData:rq,createSpreadsheetObjectData:iq,dataRowToChangesArray:dE,isArrayOfArrays:cD,isArrayOfObjects:hD,spreadsheetColumnIndex:nq,spreadsheetColumnLabel:cp},Symbol.toStringTag,{value:"Module"}));function vc(t,e,n){return(e=aq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aq(t){var e=lq(t,"string");return typeof e=="symbol"?e:e+""}function lq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uq{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];vc(this,"hot",void 0),vc(this,"data",void 0),vc(this,"dataType","array"),vc(this,"colToProp",()=>{}),vc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return _(this.data,(r,i)=>{const s=this.getAtCell(i,e);n.push(s)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=n===void 0&&r===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):me(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(He(a)||dt(a))if(i?l=[]:l={},!s||i){const c=this.countFirstRowKeys()-1;me(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):o?Cg(l,d,f):l[d]=f}})}else Ne(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);o?Cg(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=hr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:Cg(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?vN(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const s=hr(i);this.hot.runHooks("modifySourceData",e,n,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||n===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,n.row),o=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return me(s,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,o,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return fE(this.data)}destroy(){this.data=null,this.hot=null}}var xO={},AO={},HO;function cq(){if(HO)return AO;HO=1;var t=gt(),e=Vu(),n=dr(),r=on(),i=hs();return t({target:"Iterator",proto:!0,real:!0},{some:function(o){r(this),n(o);var a=i(this),l=0;return e(a,function(u,c){if(o(u,l++))return c()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),AO}var NO;function hq(){return NO||(NO=1,cq()),xO}hq();function DO(t,e,n){return(e=dq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dq(t){var e=fq(t,"string");return typeof e=="symbol"?e:e+""}function fq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;DO(this,"indexedValues",[]),DO(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,dt(this.initValueOrFn)?me(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}st(vl,Tn);function gE(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((s,o)=>dt(r)?r(s,o):r),...i===void 0?[]:t.slice(i)]}function mE(t,e){return Qs(t,(n,r)=>e.includes(r)===!1)}class ta extends vl{insert(e,n){this.indexedValues=gE(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=mE(this.indexedValues,e),super.remove(e)}}class hp extends ta{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Qt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function pE(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Bh(t,e){return Qs(t,n=>e.includes(n)===!1)}function wE(t,e){return Fe(t,n=>n-e.filter(r=>r<n).length)}function CE(t,e){const n=e[0],r=e.length;return Fe(t,i=>i>=n?i+r:i)}function gq(t,e,n){return(e=mq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mq(t){var e=pq(t,"string");return typeof e=="symbol"?e:e+""}function pq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dp extends vl{constructor(){super(...arguments),gq(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Bh(this.orderOfIndexes,[e]),dt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=gE(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=CE(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=mE(this.indexedValues,e),this.orderOfIndexes=Bh(this.orderOfIndexes,e),this.orderOfIndexes=wE(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Cd extends ta{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Qt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const LO=new Map([["indexesSequence",{getListWithInsertedItems:pE,getListWithRemovedItems:Bh}],["physicallyIndexed",{getListWithInsertedItems:gE,getListWithRemovedItems:mE}]]),dD=t=>{if(LO.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return LO.get(t)};class fD extends vl{constructor(){super(e=>e)}insert(e,n){const r=CE(this.indexedValues,n);this.indexedValues=pE(r,e,n),super.insert(e,n)}remove(e){const n=Bh(this.indexedValues,e);this.indexedValues=wE(n,e),super.remove(e)}}const kO=new Map([["hiding",hp],["index",vl],["linkedPhysicalIndexToValue",dp],["physicalIndexToValue",ta],["trimming",Cd]]);function wq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!kO.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(kO.get(t))(e)}function Cq(t,e,n){return(e=vq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vq(t){var e=yq(t,"string");return typeof e=="symbol"?e:e+""}function yq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let ib=0;class vE{constructor(){Cq(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),ib+=1)}unregister(e){const n=this.collection.get(e);ce(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),ib-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return St(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}st(vE,Tn);function Sq(){return ib}function jv(t,e,n){return(e=bq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bq(t){var e=Rq(t,"string");return typeof e=="symbol"?e:e+""}function Rq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FO extends vE{constructor(e,n){super(),jv(this,"mergedValuesCache",[]),jv(this,"aggregationFunction",void 0),jv(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Fe(this.get(),s=>s.getValues()),r=[],i=ce(n[0])&&n[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(n[a][s]);r.push(o)}return Fe(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ce(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Eq(t,e,n){Tq(t,e),e.set(t,n)}function Tq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _q(t,e,n){return t.set(gD(t,e),n),n}function Mq(t,e){return t.get(gD(t,e))}function gD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uv=new WeakMap;class mD{constructor(){Eq(this,Uv,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Mq(Uv,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){_q(Uv,this,e)}}st(mD,Tn);function $O(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function yc(t,e,n){Iq(t,e),e.set(t,n)}function Iq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xr(t,e){return t.get(pD(t,e))}function Zd(t,e,n){return t.set(pD(t,e),n),n}function pD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qd=new WeakMap,Sc=new WeakMap,Jd=new WeakMap,ef=new WeakMap,tf=new WeakMap;class Pq{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};yc(this,Qd,new Set),yc(this,Sc,[]),yc(this,Jd,[]),yc(this,ef,!1),yc(this,tf,!1),Zd(tf,this,e??!1)}createObserver(){const e=new mD;return xr(Qd,this).add(e),e.addLocalHook("unsubscribe",()=>{xr(Qd,this).delete(e)}),e._writeInitialChanges($O(xr(Sc,this),xr(Jd,this))),e}emit(e){let n=xr(Jd,this);(!xr(ef,this)||xr(Sc,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(xr(tf,this)):Zd(Sc,this,new Array(e.length).fill(xr(tf,this))),xr(ef,this)||(Zd(ef,this,!0),n=xr(Sc,this)));const r=$O(n,e);xr(Qd,this).forEach(i=>i._write(r)),Zd(Jd,this,e)}}function Wn(t,e,n){return(e=Oq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oq(t){var e=xq(t,"string");return typeof e=="symbol"?e:e+""}function xq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sb{constructor(){Wn(this,"indexesSequence",new fD),Wn(this,"trimmingMapsCollection",new FO(e=>e.some(n=>n===!0),!1)),Wn(this,"hidingMapsCollection",new FO(e=>e.some(n=>n===!0),!1)),Wn(this,"variousMapsCollection",new vE),Wn(this,"hidingChangesObservable",new Pq({initialIndexValue:!1})),Wn(this,"notTrimmedIndexesCache",[]),Wn(this,"notHiddenIndexesCache",[]),Wn(this,"isBatched",!1),Wn(this,"indexesSequenceChanged",!1),Wn(this,"indexesChangeSource",void 0),Wn(this,"trimmedIndexesChanged",!1),Wn(this,"hiddenIndexesChanged",!1),Wn(this,"renderablePhysicalIndexesCache",[]),Wn(this,"fromPhysicalToVisualIndexesCache",new Map),Wn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,wq(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Cd?this.trimmingMapsCollection.register(e,n):n instanceof hp?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ce(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ce(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ce(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ce(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return n>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Fe(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=Bh(this.getIndexesSequence(),r),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(n+s<i){const u=a[n];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(pE(o,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ce(r)?r:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),o=Fe(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}st(sb,Tn);function Aq(t,e){return Ne(e,(n,r)=>{St(t[r])&&(t[r]=n)}),t}function wD(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function CD(t){ce(t)&&jR(it`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Hq(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Nq,getValues:Dq}=_i("phraseFormatters");function Lq(t,e){Nq(t,e)}function kq(){return Dq()}Lq("pluralize",Hq);const vD="ContextMenu:items",Pe=vD,yE=`${Pe}.noItems`,SE=`${Pe}.insertRowAbove`,bE=`${Pe}.insertRowBelow`,RE=`${Pe}.insertColumnOnTheLeft`,EE=`${Pe}.insertColumnOnTheRight`,TE=`${Pe}.removeRow`,_E=`${Pe}.removeColumn`,ME=`${Pe}.undo`,IE=`${Pe}.redo`,Zg=`${Pe}.readOnly`,PE=`${Pe}.clearColumn`,OE=`${Pe}.copy`,xE=`${Pe}.copyWithHeaders`,AE=`${Pe}.copyWithGroupHeaders`,HE=`${Pe}.copyHeadersOnly`,NE=`${Pe}.cut`,DE=`${Pe}.freezeColumn`,LE=`${Pe}.unfreezeColumn`,kE=`${Pe}.mergeCells`,FE=`${Pe}.unmergeCells`,$E=`${Pe}.addComment`,VE=`${Pe}.editComment`,WE=`${Pe}.removeComment`,BE=`${Pe}.readOnlyComment`,jE=`${Pe}.align`,UE=`${Pe}.align.left`,zE=`${Pe}.align.center`,YE=`${Pe}.align.right`,GE=`${Pe}.align.justify`,qE=`${Pe}.align.top`,KE=`${Pe}.align.middle`,XE=`${Pe}.align.bottom`,ZE=`${Pe}.borders`,QE=`${Pe}.borders.top`,JE=`${Pe}.borders.right`,eT=`${Pe}.borders.bottom`,tT=`${Pe}.borders.left`,nT=`${Pe}.borders.remove`,rT=`${Pe}.nestedHeaders.insertChildRow`,iT=`${Pe}.nestedHeaders.detachFromParent`,sT=`${Pe}.hideColumn`,oT=`${Pe}.showColumn`,aT=`${Pe}.hideRow`,lT=`${Pe}.showRow`,Xn="Filters:",Ft=`${Xn}conditions`,fp=`${Ft}.none`,uT=`${Ft}.isEmpty`,cT=`${Ft}.isNotEmpty`,hT=`${Ft}.isEqualTo`,dT=`${Ft}.isNotEqualTo`,fT=`${Ft}.beginsWith`,gT=`${Ft}.endsWith`,mT=`${Ft}.contains`,pT=`${Ft}.doesNotContain`,Fq=`${Ft}.byValue`,wT=`${Ft}.greaterThan`,CT=`${Ft}.greaterThanOrEqualTo`,vT=`${Ft}.lessThan`,yT=`${Ft}.lessThanOrEqualTo`,ST=`${Ft}.isBetween`,bT=`${Ft}.isNotBetween`,RT=`${Ft}.after`,ET=`${Ft}.before`,TT=`${Ft}.today`,_T=`${Ft}.tomorrow`,MT=`${Ft}.yesterday`,IT=`${Xn}labels.filterByCondition`,PT=`${Xn}labels.filterByValue`,OT=`${Xn}labels.conjunction`,gp=`${Xn}labels.disjunction`,Qg=`${Xn}values.blankCells`,xT=`${Xn}buttons.selectAll`,AT=`${Xn}buttons.clear`,HT=`${Xn}buttons.ok`,NT=`${Xn}buttons.cancel`,DT=`${Xn}buttons.placeholder.search`,LT=`${Xn}buttons.placeholder.value`,kT=`${Xn}buttons.placeholder.secondValue`,FT="CheckboxRenderer:",$T=`${FT}checked`,VT=`${FT}unchecked`,$q=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:$T,CHECKBOX_RENDERER_NAMESPACE:FT,CHECKBOX_UNCHECKED:VT,CONTEXTMENU_ITEMS_ADD_COMMENT:$E,CONTEXTMENU_ITEMS_ALIGNMENT:jE,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:XE,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:zE,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:GE,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:UE,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:KE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:YE,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:qE,CONTEXTMENU_ITEMS_BORDERS:ZE,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:eT,CONTEXTMENU_ITEMS_BORDERS_LEFT:tT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:JE,CONTEXTMENU_ITEMS_BORDERS_TOP:QE,CONTEXTMENU_ITEMS_CLEAR_COLUMN:PE,CONTEXTMENU_ITEMS_COPY:OE,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:HE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:AE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:xE,CONTEXTMENU_ITEMS_CUT:NE,CONTEXTMENU_ITEMS_EDIT_COMMENT:VE,CONTEXTMENU_ITEMS_FREEZE_COLUMN:DE,CONTEXTMENU_ITEMS_HIDE_COLUMN:sT,CONTEXTMENU_ITEMS_HIDE_ROW:aT,CONTEXTMENU_ITEMS_INSERT_LEFT:RE,CONTEXTMENU_ITEMS_INSERT_RIGHT:EE,CONTEXTMENU_ITEMS_MERGE_CELLS:kE,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:iT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:rT,CONTEXTMENU_ITEMS_NO_ITEMS:yE,CONTEXTMENU_ITEMS_READ_ONLY:Zg,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:BE,CONTEXTMENU_ITEMS_REDO:IE,CONTEXTMENU_ITEMS_REMOVE_BORDERS:nT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:_E,CONTEXTMENU_ITEMS_REMOVE_COMMENT:WE,CONTEXTMENU_ITEMS_REMOVE_ROW:TE,CONTEXTMENU_ITEMS_ROW_ABOVE:SE,CONTEXTMENU_ITEMS_ROW_BELOW:bE,CONTEXTMENU_ITEMS_SHOW_COLUMN:oT,CONTEXTMENU_ITEMS_SHOW_ROW:lT,CONTEXTMENU_ITEMS_UNDO:ME,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:LE,CONTEXTMENU_ITEMS_UNMERGE_CELLS:FE,CONTEXT_MENU_ITEMS_NAMESPACE:vD,FILTERS_BUTTONS_CANCEL:NT,FILTERS_BUTTONS_CLEAR:AT,FILTERS_BUTTONS_OK:HT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:DT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:kT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:LT,FILTERS_BUTTONS_SELECT_ALL:xT,FILTERS_CONDITIONS_AFTER:RT,FILTERS_CONDITIONS_BEFORE:ET,FILTERS_CONDITIONS_BEGINS_WITH:fT,FILTERS_CONDITIONS_BETWEEN:ST,FILTERS_CONDITIONS_BY_VALUE:Fq,FILTERS_CONDITIONS_CONTAINS:mT,FILTERS_CONDITIONS_EMPTY:uT,FILTERS_CONDITIONS_ENDS_WITH:gT,FILTERS_CONDITIONS_EQUAL:hT,FILTERS_CONDITIONS_GREATER_THAN:wT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:CT,FILTERS_CONDITIONS_LESS_THAN:vT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:yT,FILTERS_CONDITIONS_NAMESPACE:Ft,FILTERS_CONDITIONS_NONE:fp,FILTERS_CONDITIONS_NOT_BETWEEN:bT,FILTERS_CONDITIONS_NOT_CONTAIN:pT,FILTERS_CONDITIONS_NOT_EMPTY:cT,FILTERS_CONDITIONS_NOT_EQUAL:dT,FILTERS_CONDITIONS_TODAY:TT,FILTERS_CONDITIONS_TOMORROW:_T,FILTERS_CONDITIONS_YESTERDAY:MT,FILTERS_DIVS_FILTER_BY_CONDITION:IT,FILTERS_DIVS_FILTER_BY_VALUE:PT,FILTERS_LABELS_CONJUNCTION:OT,FILTERS_LABELS_DISJUNCTION:gp,FILTERS_NAMESPACE:Xn,FILTERS_VALUES_BLANK_CELLS:Qg},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const yD={languageCode:"en-US",[yE]:"No available options",[SE]:"Insert row above",[bE]:"Insert row below",[RE]:"Insert column left",[EE]:"Insert column right",[TE]:["Remove row","Remove rows"],[_E]:["Remove column","Remove columns"],[ME]:"Undo",[IE]:"Redo",[Zg]:"Read only",[PE]:"Clear column",[jE]:"Alignment",[UE]:"Left",[zE]:"Center",[YE]:"Right",[GE]:"Justify",[qE]:"Top",[KE]:"Middle",[XE]:"Bottom",[DE]:"Freeze column",[LE]:"Unfreeze column",[ZE]:"Borders",[QE]:"Top",[JE]:"Right",[eT]:"Bottom",[tT]:"Left",[nT]:"Remove border(s)",[$E]:"Add comment",[VE]:"Edit comment",[WE]:"Delete comment",[BE]:"Read-only comment",[kE]:"Merge cells",[FE]:"Unmerge cells",[OE]:"Copy",[xE]:["Copy with header","Copy with headers"],[AE]:["Copy with group header","Copy with group headers"],[HE]:["Copy header only","Copy headers only"],[NE]:"Cut",[rT]:"Insert child row",[iT]:"Detach from parent",[sT]:["Hide column","Hide columns"],[oT]:["Show column","Show columns"],[aT]:["Hide row","Hide rows"],[lT]:["Show row","Show rows"],[fp]:"None",[uT]:"Is empty",[cT]:"Is not empty",[hT]:"Is equal to",[dT]:"Is not equal to",[fT]:"Begins with",[gT]:"Ends with",[mT]:"Contains",[pT]:"Does not contain",[wT]:"Greater than",[CT]:"Greater than or equal to",[vT]:"Less than",[yT]:"Less than or equal to",[ST]:"Is between",[bT]:"Is not between",[RT]:"After",[ET]:"Before",[TT]:"Today",[_T]:"Tomorrow",[MT]:"Yesterday",[Qg]:"Blank cells",[IT]:"Filter by condition",[PT]:"Filter by value",[OT]:"And",[gp]:"Or",[xT]:"Select all",[AT]:"Clear",[HT]:"OK",[NT]:"Cancel",[DT]:"Search",[LT]:"Value",[kT]:"Second value",[$T]:"Checked",[VT]:"Unchecked"},Vq=$q,ob=yD.languageCode,{register:Wq,getItem:SD,hasItem:Bq,getValues:jq}=_i("languagesDictionaries");bD(yD);function bD(t,e){let n=t,r=e;return He(t)&&(r=t,n=r.languageCode),Uq(n,r),Wq(n,kn(r)),kn(r)}function Uq(t,e){t!==ob&&Aq(e,SD(ob))}function RD(t){return WT(t)?kn(SD(t)):null}function WT(t){return Bq(t)}function zq(){return jq()}function ED(t,e,n){const r=RD(t);if(r===null)return null;const i=r[e];if(St(i))return null;const s=Yq(i,n);return Array.isArray(s)?s[0]:s}function Yq(t,e){let n=t;return _(kq(),r=>{n=r(t,e)}),n}function Gq(t){let e=wD(t);return WT(e)||(e=ob,CD(t)),e}function qq(t,e,n){return(e=Kq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kq(t){var e=Xq(t,"string");return typeof e=="symbol"?e:e+""}function Xq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class so extends JN{constructor(e,n){super(e,null),qq(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),s=this.getNearestNotHiddenCoords(r,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=n,s=r),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(n,r,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function zv(t){let{activeHeaderClassName:e,...n}=t;return new so({className:e,...n,selectionType:eD})}function Zq(t){let{areaCornerVisible:e,...n}=t;return new so({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:nE})}function Qq(t){let{...e}=t;return new so({className:"highlight",...e,selectionType:nE})}function Jq(t){let{columnClassName:e,...n}=t;return new so({className:e,...n,selectionType:c2})}function eK(t){let{cellCornerVisible:e,...n}=t;return new so({className:"current",headerAttributes:[MR()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Xg})}function tK(t){let{border:e,visualCellRange:n,...r}=t;return new so({...e,...r,selectionType:h2},n)}function nK(t){let{...e}=t;return new so({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:l2})}function VO(t){let{headerClassName:e,...n}=t;return new so({className:e,...n,selectionType:tE})}function rK(t){let{rowClassName:e,...n}=t;return new so({className:e,...n,selectionType:u2})}function iK(t,e){sK(t,e),e.add(t)}function sK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jn(t,e,n){return(e=oK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oK(t){var e=aK(t,"string");return typeof e=="symbol"?e:e+""}function aK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hi=new WeakSet;class lK{constructor(e){iK(this,Hi),Jn(this,"options",void 0),Jn(this,"layerLevel",0),Jn(this,"focus",void 0),Jn(this,"fill",void 0),Jn(this,"layeredAreas",new Map),Jn(this,"areas",new Map),Jn(this,"rowHeaders",new Map),Jn(this,"columnHeaders",new Map),Jn(this,"activeRowHeaders",new Map),Jn(this,"activeColumnHeaders",new Map),Jn(this,"activeCornerHeaders",new Map),Jn(this,"rowHighlights",new Map),Jn(this,"columnHighlights",new Map),Jn(this,"customSelections",[]),this.options=e,this.focus=eK(e),this.fill=nK(e)}isEnabledFor(e,n){let r=e;e===Xg&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return bs(Hi,this,Rs).call(this,this.layeredAreas,Zq)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return bs(Hi,this,Rs).call(this,this.areas,Qq)}getAreas(){return[...this.areas.values()]}createRowHeader(){return bs(Hi,this,Rs).call(this,this.rowHeaders,VO)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return bs(Hi,this,Rs).call(this,this.columnHeaders,VO)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return bs(Hi,this,Rs).call(this,this.activeRowHeaders,zv)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return bs(Hi,this,Rs).call(this,this.activeColumnHeaders,zv)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return bs(Hi,this,Rs).call(this,this.activeCornerHeaders,zv)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return bs(Hi,this,Rs).call(this,this.rowHighlights,rK)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return bs(Hi,this,Rs).call(this,this.columnHighlights,Jq)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(tK({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),_(this.areas.values(),e=>void e.clear()),_(this.layeredAreas.values(),e=>void e.clear()),_(this.rowHeaders.values(),e=>void e.clear()),_(this.columnHeaders.values(),e=>void e.clear()),_(this.activeRowHeaders.values(),e=>void e.clear()),_(this.activeColumnHeaders.values(),e=>void e.clear()),_(this.activeCornerHeaders.values(),e=>void e.clear()),_(this.rowHighlights.values(),e=>void e.clear()),_(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Rs(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function WO(t,e,n){return(e=uK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:e+""}function cK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hK{constructor(e){WO(this,"ranges",[]),WO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function dK(t,e){TD(t,e),e.add(t)}function Yv(t,e,n){TD(t,e),e.set(t,n)}function TD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get(rn(t,e))}function nf(t,e,n){return t.set(rn(t,e),n),n}function rn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rf=new WeakMap,pt=new WeakMap,pi=new WeakMap,ln=new WeakSet;class ab{constructor(e,n){dK(this,ln),Yv(this,rf,void 0),Yv(this,pt,void 0),Yv(this,pi,{x:0,y:0}),nf(rf,this,e),nf(pt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=qe(pt,this).createCellCoords(e,n);let s=qe(rf,this).current().highlight;const o=qe(pt,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:u,height:c}=rn(ln,this,_D).call(this),{row:h,col:d}=rn(ln,this,jO).call(this,s),f=qe(pt,this).fixedRowsBottom(),m=qe(pt,this).minSpareRows(),v=qe(pt,this).minSpareCols(),w=qe(pt,this).autoWrapRow(),b=qe(pt,this).autoWrapCol(),R=qe(pt,this).createCellCoords(h+i.row,d+i.col);if(R.row>=c){const D=hr(r&&m>0&&f===0),M=R.col+1,A=qe(pt,this).createCellCoords(R.row-c,M>=u?M-u:M);this.runLocalHooks("beforeColumnWrap",D,rn(ln,this,Ol).call(this,A),M>=u),D.value?this.runLocalHooks("insertRowRequire",qe(pt,this).countRenderableRows()):b&&R.assign(A)}else if(R.row<0){const D=hr(b),M=R.col-1,A=qe(pt,this).createCellCoords(c+R.row,M<0?u+M:M);this.runLocalHooks("beforeColumnWrap",D,rn(ln,this,Ol).call(this,A),M<0),b&&R.assign(A)}if(R.col>=u){const D=hr(r&&v>0),M=R.row+1,A=qe(pt,this).createCellCoords(M>=c?M-c:M,R.col-u);this.runLocalHooks("beforeRowWrap",D,rn(ln,this,Ol).call(this,A),M>=c),D.value?this.runLocalHooks("insertColRequire",qe(pt,this).countRenderableColumns()):w&&R.assign(A)}else if(R.col<0){const D=hr(w),M=R.row-1,A=qe(pt,this).createCellCoords(M<0?c+M:M,u+R.col);this.runLocalHooks("beforeRowWrap",D,rn(ln,this,Ol).call(this,A),M<0),w&&R.assign(A)}const{rowDir:P,colDir:O}=rn(ln,this,BO).call(this,R);a=P,l=O,s=rn(ln,this,Ol).call(this,R)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,n){const r=qe(pt,this).createCellCoords(e,n),i=qe(rf,this).current(),s=qe(pt,this).visualToRenderableCoords(i.highlight),o=rn(ln,this,Gv).call(this,i.to.row,i.from.row),a=rn(ln,this,qv).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:d}=rn(ln,this,jO).call(this,i.highlight),f=qe(pt,this).createCellCoords(o+r.row,a+r.col),m=i.getTopStartCorner(),v=i.getTopEndCorner(),w=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const O=f.col-d;f.col=rn(ln,this,qv).call(this,m.col,v.col)+O}else if(r.col>0&&a<=d&&f.col>d){const O=rn(ln,this,qv).call(this,v.col,m.col),D=Math.max(f.col-O,1);f.col=O+D}if(r.row<0&&o>=h&&f.row<h){const O=f.row-h;f.row=rn(ln,this,Gv).call(this,m.row,w.row)+O}else if(r.row>0&&o<=h&&f.row>h){const O=rn(ln,this,Gv).call(this,w.row,m.row),D=Math.max(f.row-O,1);f.row=O+D}const{rowDir:b,colDir:R}=rn(ln,this,BO).call(this,f);u=b,c=R;const P=rn(ln,this,Ol).call(this,f);r.row===0&&r.col!==0?l.col=P.col:r.row!==0&&r.col===0?l.row=P.row:(l.row=P.row,l.col=P.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;nf(pi,this,{x:n,y:r})}resetOffsetSize(){nf(pi,this,{x:0,y:0})}}function BO(t){const{width:e,height:n}=rn(ln,this,_D).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function _D(){return{width:qe(pi,this).x+qe(pt,this).countRenderableColumns(),height:qe(pi,this).y+qe(pt,this).countRenderableRows()}}function Gv(t,e){const n=qe(pt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:qe(pi,this).y+n}function qv(t,e){const n=qe(pt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:qe(pi,this).x+n}function jO(t){const{row:e,col:n}=qe(pt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return qe(pt,this).createCellCoords(qe(pi,this).y+e,qe(pi,this).x+n)}function Ol(t){const e=t.clone();return e.col=t.col-qe(pi,this).x,e.row=t.row-qe(pi,this).y,qe(pt,this).renderableToVisualCoords(e)}st(ab,Tn);const mp=0,pp=1,MD=2,BT=3,fK=[BT,MD],gK=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Kv=Symbol("root"),UO=Symbol("child");function xu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kv;if(e!==Kv&&e!==UO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Kv;let i=mp;if(n){const s=t[0];t.length===0?i=pp:r&&s instanceof md?i=BT:r&&Array.isArray(s)?i=xu(s,UO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!gK[l].includes(typeof a))&&(i=MD)}return i}function jh(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!fK.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===BT;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],c=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),St(u)&&(u=a),St(c)&&(c=l),!r){const f=a,m=l,v=u,w=c;a=Math.min(f,v),l=Math.min(m,w),u=Math.max(f,v),c=Math.max(m,w)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function mK(t){const e=xu(t.getSelected());if(e===mp||e===pp)return[];const n=jh(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),o=>{const{from:a,to:l}=n(o),u=Math.max(a.col,0),c=l.col-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((o,a)=>o-a);return Qt(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function pK(t){const e=xu(t.getSelected());if(e===mp||e===pp)return[];const n=jh(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),o=>{const{from:a,to:l}=n(o),u=Math.max(a.row,0),c=l.row-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((o,a)=>o-a);return Qt(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function xl(t,e,n){wK(t,e),e.set(t,n)}function wK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ha(t,e,n){return(e=CK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CK(t){var e=vK(t,"string");return typeof e=="symbol"?e:e+""}function vK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ct(t,e){return t.get(ID(t,e))}function Ni(t,e,n){return t.set(ID(t,e),n),n}function ID(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mn=new WeakMap,da=new WeakMap,sf=new WeakMap,bc=new WeakMap,of=new WeakMap,Rc=new WeakMap;class PD{constructor(e,n){var r=this;ha(this,"settings",void 0),ha(this,"tableProps",void 0),ha(this,"inProgress",!1),ha(this,"selectedRange",new hK((i,s,o)=>this.tableProps.createCellRange(i,s,o))),ha(this,"highlight",void 0),xl(this,Mn,void 0),xl(this,da,void 0),ha(this,"selectedByRowHeader",new Set),ha(this,"selectedByColumnHeader",new Set),xl(this,sf,!1),xl(this,bc,!1),xl(this,of,"unknown"),xl(this,Rc,-1),this.settings=e,this.tableProps=n,this.highlight=new lK({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[MR()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),Ni(Mn,this,new ab(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ni(da,this,new ab(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ct(Mn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformStart",...s)}),Ct(Mn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformStart",...s)}),Ct(Mn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformEnd",...s)}),Ct(Mn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformEnd",...s)}),Ct(Mn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertRowRequire",...s)}),Ct(Mn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertColRequire",...s)}),Ct(Mn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeRowWrap",...s)}),Ct(Mn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeColumnWrap",...s)}),Ct(da,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformFocus",...s)}),Ct(da,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){Ni(of,this,e)}markEndSource(){Ni(of,this,"unknown")}getSelectionSource(){return Ct(of,this)}setExpectedLayers(e){Ni(Rc,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ni(Rc,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=St(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Ni(sf,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!s||s&&!o&&St(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!s||i===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),c=this.isMultiple();o.setTo(n),c&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),c&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Ct(Rc,this)===-1||this.selectedRange.size()===Ct(Rc,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(_(this.highlight.getAreas(),m=>void m.clear()),_(this.highlight.getLayeredAreas(),m=>void m.clear()),_(this.highlight.getRowHeaders(),m=>void m.clear()),_(this.highlight.getColumnHeaders(),m=>void m.clear()),_(this.highlight.getActiveRowHeaders(),m=>void m.clear()),_(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),_(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),_(this.highlight.getRowHighlights(),m=>void m.clear()),_(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(n);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(nE,e.highlight)&&(this.isMultiple()||n>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(tE,e.highlight)){if(!e.isSingleHeader()){const w=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),b=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),P=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(w).commit(),l.add(R).commit(),d.add(w).commit(),f.add(R).commit()):(a.add(w).add(b).commit(),l.add(R).add(P).commit(),d.add(w).add(b).commit(),f.add(R).add(P).commit())}const m=!Ct(bc,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!Ct(bc,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Xg,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(Ni(sf,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Ct(Mn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Ct(Mn,this).resetOffsetSize(),this.setRangeStart(Ct(Mn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?Ct(Mn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Ct(Mn,this).resetOffsetSize(),this.setRangeEnd(Ct(Mn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:s}=r.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?Ct(da,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):Ct(da,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=Ct(da,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(je(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(je(s.row+n,c,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(je(o.row+n,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,je(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(s.row,je(s.col+n,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,je(o.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=hr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Ct(sf,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(s===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Ni(bc,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(je(d.row,u,s-1),je(d.col,c,o-1)));const m=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),Ni(bc,this,!1)}selectCells(e){var n=this;const r=xu(e);if(r===pp)return!1;if(r===mp)throw new Error(it`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=jh(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(o);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),_(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof n=="string"?this.tableProps.propToCol(n):n,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=je(r.row,u,o-1),m=je(r.col,Math.min(i,s),Math.max(i,s))):(f=je(r,u,o-1),m=i);const v=this.tableProps.createCellCoords(f,m),w=l===0?0:je(v.row,u,-1),b=o-1,R=this.tableProps.createCellCoords(w,i),P=this.tableProps.createCellCoords(b,s);this.runLocalHooks("beforeSelectColumns",R,P,v),R.row=w,P.row=b,this.setRangeStartOnly(R,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(P),this.runLocalHooks("afterSelectColumns",R,P,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,s-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=je(r.row,Math.min(e,n),Math.max(e,n)),d=je(r.col,a,s-1)):(h=e,d=je(r,a,s-1));const f=this.tableProps.createCellCoords(h,d),m=o===0?0:je(f.col,a,-1),v=s-1,w=this.tableProps.createCellCoords(e,m),b=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",w,b,f),w.col=m,b.col=v,this.setRangeStartOnly(w,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(b),this.runLocalHooks("afterSelectRows",w,b,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:o}=r;this.clear(),o.assign({row:je(o.row,-1/0,e-1),col:je(o.col,-1/0,n-1)}),i.assign({row:je(i.row,-1/0,e-1),col:je(i.col,-1/0,n-1)}),s.assign({row:je(s.row,0,e-1),col:je(s.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(o).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(Xg,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}st(PD,Tn);const zO=/^(\r\n|\n\r|\r|\n)/,yK=/^[^\t\r\n]+/,YO=/^\t/;function SK(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(YO))t=t.replace(YO,""),n+=1,e[r][n]="";else if(t.match(zO))t=t.replace(zO,""),n=0,r+=1,e[r]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(yK);s=o?o[0]:"",t=t.slice(s.length)}e[r][n]=s}return e}function ph(t){let e,n,r,i,s="",o;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(s+="	"),o=t[e][r],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==n-1&&(s+=`
`)}return s}function fa(t,e,n){return(e=bK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bK(t){var e=RK(t,"string");return typeof e=="symbol"?e:e+""}function RK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){fa(this,"hot",void 0),fa(this,"metaManager",void 0),fa(this,"tableMeta",void 0),fa(this,"dataSource",void 0),fa(this,"duckSchema",void 0),fa(this,"colToPropCache",void 0),fa(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,s=0,o=!1;if(typeof n=="function"){const a=ip(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=o?n(r):n[r];if(He(a)){if(typeof a.data<"u"){const l=o?s:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return fE(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,s=r,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&Ne(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ce(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ce(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Pu(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&s+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=kn(this.getSchema()):(m=[],me(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},fd(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(o,n)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,m=c;i==="end"&&(m=Math.min(m+1,a));const v=m;for(;f<n&&d<o;){if(typeof l!="number"||l>=d)if(h>0)for(let b=0;b<h;b+=1)typeof s[b]>"u"&&(s[b]=[]),s[b].push(null);else s.push([null]);else for(let b=0;b<h;b++)s[b].splice(m,0,null);f+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(v,n));const w=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",w,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const s=this.visualRowsToPhysical(i,n),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,r)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const c=ce(this.tableMeta.columns)||ce(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,n),o=s.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,s,r)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(s[0],n),h===0&&this.metaManager.removeColumn(s[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,s,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),s=i.slice(n,n+r),o=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];WS(l,o);let c=0;for(;c<r;)l.push(null),c+=1;return zH(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),s}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),s=i.slice(n,n+r),o=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];WS(l,o);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),s}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const s=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>r.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Kt(i,n))a=i[n];else if(o&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=hr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let s=r,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=hr(s);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Kt(o,n))o[n]=s;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=o,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++)typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]];u[d[c]]=s}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],s):o[n]=s}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let s=(r+e)%r,o=n,a;for(;s<r&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let s=(r+e)%r,o=n;for(;s<r&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,gu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===gu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(s=Math.min(e.row,n.row);s<=h;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,n.col);o<=d&&f!==null;o++)a.push(c.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,n){return ph(this.getRange(e,n,gu.DESTINATION_RENDERER))}getCopyableText(e,n){return ph(this.getRange(e,n,gu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:EK,getItem:TK,hasItem:OD,getNames:_K,getValues:lae}=_i("cellTypes");function jT(t){if(!OD(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return TK(t)}function Ar(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&sr(t,n),r&&Cr(t,r),i&&Ga(t,i),EK(t,e)}function MK(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Kt(e,t)}function wp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?jT(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ne(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!He(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ne(r,(s,o)=>{if(MK(o,n)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),Xt(t,i)}function IK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Ti(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function bg(t){return Number.isInteger(t)&&t>=0}function Rg(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function af(t){return t==null}const xD=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Lt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Lt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),rp(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function GO(t,e,n){return(e=PK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PK(t){var e=OK(t,"string");return typeof e=="symbol"?e:e+""}function OK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xK(){return class{}}class AK{constructor(e){GO(this,"metaCtor",xK()),GO(this,"meta",void 0),this.meta=this.metaCtor.prototype,Xt(this.meta,xD()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Xt(this.meta,e),wp(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function HK(t,e,n){return(e=NK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NK(t){var e=DK(t,"string");return typeof e=="symbol"?e:e+""}function DK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LK{constructor(e){HK(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Xt(this.meta,e),wp(this.meta,e,e)}}function lf(t,e,n){return(e=kK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kK(t){var e=FK(t,"string");return typeof e=="symbol"?e:e+""}function FK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jg{constructor(e){lf(this,"valueFactory",void 0),lf(this,"data",[]),lf(this,"index",[]),lf(this,"holes",new Set),this.valueFactory=e}obtain(e){Rg(()=>bg(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Rg(()=>bg(e)||af(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let o=0;o<n;o++)r.push(i+o),this.data.push(void 0);const s=af(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...r,...this.index.slice(s)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Rg(()=>bg(e)||af(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(af(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const s=r[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return Qs(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function qO(t,e,n){return(e=$K(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $K(t){var e=VK(t,"string");return typeof e=="symbol"?e:e+""}function VK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const WK=["data","width"];class BK{constructor(e){qO(this,"globalMeta",void 0),qO(this,"metas",new Jg(()=>this._createMeta())),this.globalMeta=e,this.metas=new Jg(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Xt(r,n),wp(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return IK(this.globalMeta.getMetaConstructor(),WK).prototype}}function KO(t,e,n){return(e=jK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jK(t){var e=UK(t,"string");return typeof e=="symbol"?e:e+""}function UK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zK{constructor(e){KO(this,"columnMeta",void 0),KO(this,"metas",new Jg(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Xt(i,r),wp(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var s;const o=this.metas.obtain(e).obtain(n);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(r),o[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ce(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Rg(()=>bg(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Jg(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class AD{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new AK(e),this.tableMeta=new LK(this.globalMeta),this.columnMeta=new BK(this.globalMeta),this.cellMeta=new zK(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:s}=r;const o=this.cellMeta.getMeta(e,n);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=n,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}st(AD,Tn);function XO(t,e,n,r){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Ln(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":dt(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new gu(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let v,w=0,b=0;for(w=0,b=d.startRows;w<b;w++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=kn(m),t.push(v);else if(i.dataType==="array")v=kn(m[0]),t.push(v);else{v=[];for(let R=0,P=d.startCols;R<P;R++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&be(i.rootElement,[JH(-1),Zm(i.countCols()+(i.view?i.countRowHeaders():0))])}function ZO(t,e,n){return(e=YK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YK(t){var e=GK(t,"string");return typeof e=="symbol"?e:e+""}function GK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qK{constructor(e){ZO(this,"metaManager",void 0),ZO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),oe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=Kt(e,"type")?e.type:null;let c=dt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function KK(t,e,n){XK(t,e),e.set(t,n)}function XK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xv(t,e,n){return(e=ZK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZK(t){var e=QK(t,"string");return typeof e=="symbol"?e:e+""}function QK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JK(t,e){return t.get(e3(t,e))}function e3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var QO=new WeakMap;class t3{constructor(e){Xv(this,"metaManager",void 0),Xv(this,"usageTracker",new Set),Xv(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),KK(this,QO,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(n,l,s),o&&this.installPropWatcher(i,l,s)):r&&(this.installPropWatcher(n,l,JK(QO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,s,o),this[n]=s},enumerable:!0,configurable:!0})}}const HD="gridDefault",na="editorManager.handlingEditor",n3={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},r3="hooksRefRegisterer",ND={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){_(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ne(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};gs(ND,"MIXIN_NAME",r3,{writable:!1,enumerable:!1});function ei(t,e,n){return(e=i3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i3(t){var e=s3(t,"string");return typeof e=="symbol"?e:e+""}function s3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const o3="base",Ut=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class qu{static get EDITOR_TYPE(){return o3}constructor(e){ei(this,"hot",void 0),ei(this,"state",Ut.VIRGIN),ei(this,"_opened",!1),ei(this,"_fullEditMode",!1),ei(this,"_closeCallback",null),ei(this,"TD",null),ei(this,"row",null),ei(this,"col",null),ei(this,"prop",null),ei(this,"originalValue",null),ei(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,s,o){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:Ut.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,s,o;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[r,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,s,o,"edit")}beginEditing(e,n){if(this.state!==Ut.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=Ut.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Dt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),r.view.scrollViewport(r._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,n,r){let i;if(r){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),r(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Ut.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Ut.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=Ut.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Ut.FINISHED,this.discardEditor(o)}):(this.state=Ut.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Ut.FINISHED,this.discardEditor()}discardEditor(e){this.state===Ut.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ut.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ut.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Ut.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=cn(n),a=Yt(n),l=cn(this.hot.rootElement),u=Yt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==s?c.scrollTop:0,f=h!==s?h.scrollLeft:0,m=s.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,w=v.name,b=["master","inline_start"].includes(w)?d:0,R=["master","top","bottom"].includes(w)?f:0,P=o.top===l.top?0:1;let O=o.top-l.top-P-b,D=0;this.hot.isRtl()?D=s.innerWidth-o.left-a-m-1+R:D=o.left-l.left-1-R,["top","top_inline_start_corner"].includes(w)&&(O+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(w)&&(D+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const M=this.hot.hasColHeaders(),A=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),j=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),U=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(M&&A<=0||A===U)&&(O+=1),j<=0&&(D+=1);const Z=i.rowsRenderCalculator.startPosition,J=i.columnsRenderCalculator.startPosition,ae=Math.abs(r.inlineStartOverlay.getScrollPosition()),ne=r.topOverlay.getScrollPosition(),fe=yn(this.hot.rootDocument);let mt=n.offsetTop;if(["inline_start","master"].includes(w)&&(mt+=Z-ne),["bottom","bottom_inline_start_corner"].includes(w)){const{wtViewport:G,wtTable:le}=r.bottomOverlay.clone;mt+=G.getWorkspaceHeight()-le.getHeight()-fe}let Te=n.offsetLeft;this.hot.isRtl()?(Te>=0?Te=v.getWidth()-n.offsetLeft:Te=Math.abs(Te),Te+=J-ae-a):["top","master","bottom"].includes(w)&&(Te+=J-ae);const $e=s.getComputedStyle(this.TD),Et=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",en=parseInt($e[Et],10)>0?0:1,g=parseInt($e.borderTopWidth,10)>0?0:1,p=Yt(n)+en,y=kt(n)+g,E=fN(c)?fe:0,H=gN(h)?fe:0,W=this.hot.view.maximumVisibleElementWidth(Te)-E+en,q=Math.max(this.hot.view.maximumVisibleElementHeight(mt)-H+g,this.hot.view.getDefaultRowHeight());return{top:O,start:D,height:y,maxHeight:q,width:p,maxWidth:W}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}st(qu,ND);const a3={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Ut.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},l3={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},u3={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},c3={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},h3={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Kr(e))}};function d3(){return[n3,a3,l3,u3,c3,h3]}const f3={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},g3={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),s=e.row-t.getFirstFullyVisibleRow(),o=Math.min(i.row-s,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},m3={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},p3={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},w3={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e)}},C3={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast(),o=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},v3={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){const o=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(s.row,o))}}},y3={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&r.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},S3={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast(),o=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},b3={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast(),o=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},R3={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:s}=t.getSelectedRangeLast(),o=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},E3={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e)}},T3={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},_3={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),s=e.row-t.getFirstFullyVisibleRow(),o=Math.max(i.row-s,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function M3(){return[f3,g3,m3,p3,w3,C3,v3,y3,S3,b3,R3,E3,T3,_3]}const I3={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},P3={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},O3={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=t.getSelectedRangeLast(),i=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},x3={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=t.getSelectedRangeLast(),i=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},A3={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},H3={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},N3={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},D3={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,o))}},L3={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},k3={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,s))}},F3={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},$3={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},V3={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},W3={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(o,a))}},B3={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},j3={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function U3(){return[I3,P3,O3,x3,A3,H3,N3,D3,L3,k3,F3,$3,V3,W3,B3,j3]}const z3={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Y3={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(n,r),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},G3={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},q3={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},K3={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(s.values()))}},X3=[...d3(),...M3(),...U3(),z3,Y3,G3,q3,K3];function DD(t){const e={};return X3.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function Z3(t){const e=t.getShortcutManager().addContext("editor"),n=DD(t),r={group:na};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>n.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>n.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>n.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>n.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function Q3(t){const e=t.getShortcutManager().addContext("grid"),n=DD(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ce(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:HD};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>n.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:na,runOnlyIf:()=>ce(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function J3(t){[Q3,Z3].forEach(e=>e(t))}function eX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=JO(t),i=JO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function JO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&be(n,[as(),ea()]),n}function tX(t){const e=nX(t);let n;const{activate:r,deactivate:i}=eX(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:lb(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:ub(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,m,v)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,v.value=!0),o){var w;n=(w=t.getSelectedRangeLast())===null||w===void 0?void 0:w.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:HD,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,o=!0,!d||!t.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(n=h.shiftKey?lb(t):ub(t)),u(),!1;h.preventDefault()},position:"after"}])}function lb(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,s=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=n.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function ub(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let o=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function nX(t){return e=>{if(!e)return null;const n=lb(t),r=ub(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function rX(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}function iX(){return()=>{}}function sX(t){return e=>{t.scrollViewportTo(e.toObject())}}function oX(t){return e=>{t.scrollViewportTo(e.toObject())}}function aX(t){return e=>{t.scrollViewportTo(e.toObject())}}function lX(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}function uX(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e;if(r<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&r>=0)t.scrollViewportTo({row:r});else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i})}}}function cX(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var s;if(n||r){n=!1;return}let o;e.isFocusSelectionChanged()?o=sX(t):e.isSelectedByCorner()?o=iX():e.isSelectedByRowHeader()?o=lX(t):e.isSelectedByColumnHeader()?o=rX(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=oX(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=uX(t):e.getSelectedRange().size()>1&&(o=aX(t)),(s=o)===null||s===void 0||s(i)}}}const ex=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),uf=t=>t.map(e=>{const n=e.toLowerCase();return ex.has(n)?ex.get(n):n}).sort().join("+"),hX=t=>t.split("+"),tx=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Zv=t=>{let{which:e,key:n}=t;if(tx.has(e))return tx.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},LD=Symbol("shortcut-context");function kD(t){return He(t)&&t.__kindOf===LD}const dX=t=>{const e=ap({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:v,position:w,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(St(c))throw new Error("You need to define the shortcut's group.");if(dt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(it`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};ce(v)&&(R.relativeToGroup=v,R.position=w),kD(b)&&(R.forwardToContext=b),l.forEach(P=>{const O=uf(P);if(e.hasItem(O)){const M=e.getItem(O);let A=M.findIndex(j=>j.group===v);A!==-1?w==="before"?A-=1:A+=1:A=M.length,M.splice(A,0,R)}else e.addItem(O,[R])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ne(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=uf(l);e.removeItem(u)};return{__kindOf:LD,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=uf(l),c=e.getItem(u);return ce(c)?c.slice():[]},hasShortcut:l=>{const u=uf(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?i(hX(h)):(d.length=0,d.push(...f))})}}};function fX(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const gX=["meta","alt","shift","control"],Ec=fX(),Tc=[];let cf=0;function mX(t,e,n,r,i){const s=f=>gX.includes(f),o=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),m&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||xo(f))return;const v=Zv(f);let w=[];s(v)||(w=o(f));const b=[v].concat(w);!i(f,b)&&(Ug()&&w.includes("meta")||!Ug()&&w.includes("control"))&&i(f,[v].concat(o(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const m=Zv(f);s(m)&&Ec.press(m)}},u=f=>{if(typeof f.key=="string"){const m=Zv(f);s(m)&&Ec.release(m)}},c=()=>{Ec.releaseAll()};return{mount:()=>{let f=t;for(cf+=1;f;)cf===1&&(f.document.documentElement.addEventListener("keydown",l),Tc.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Tc.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=nl(f)},unmount:()=>{let f=t;for(cf-=1;f;){if(cf===0){for(let m=0;m<Tc.length;m++){const{event:v,listener:w}=Tc[m];f.document.documentElement.removeEventListener(v,w)}Tc.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=nl(f)}},isPressed:f=>Ec.isPressed(f),releasePressedKeys:()=>Ec.releaseAll()}}const pX=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const s=ap({errorIdExists:m=>`The "${m}" context name is already registered.`});let o="grid";const a=m=>{const v=dX(m);return s.addItem(m,v),v},l=()=>o,u=m=>s.getItem(m),c=m=>{if(!s.hasItem(m))throw new Error(it`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=m};let h=!1;const d=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=kD(w)?w:u(w);let R=!1;if(!b.hasShortcut(v))return R;const P=b.getShortcuts(v);for(let O=0;O<P.length;O++){const{callback:D,runOnlyIf:M,preventDefault:A,stopPropagation:j,captureCtrl:X,forwardToContext:U}=P[O];if(M(m)===!0){if(h=X,R=D(m,v)===!1,h=!1,A&&m.preventDefault(),j&&(Kr(m),m.stopPropagation()),R)break;U&&d(m,v,U)}}return R},f=mX(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function nx(t){const{classNames:e}=sN(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let Qv=null;const Jv=new Map;function FD(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new Ur(s);let a,l,u,c,h,d,f=!0;G2(i)&&Y2(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=Gq(e.language);const w=new AD(s,e,[qK,t3]),b=w.getTableMeta(),R=w.getGlobalMeta(),P=ap();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Sg(this)&&(KH(e.licenseKey,t),Y(t,"ht-wrapper")),this.guid=`ht_${RR()}`,Jv.set(this.guid,this),this.columnIndexMapper=new sb,this.rowIndexMapper=new sb,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),l=new uq(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const O=g=>{const{row:p,col:y}=g;return s._createCellCoords(p>=0?s.rowIndexMapper.getRenderableFromVisualIndex(p):p,y>=0?s.columnIndexMapper.getRenderableFromVisualIndex(y):y)},D=g=>{const{row:p,col:y}=g;return s._createCellCoords(p>=0?s.rowIndexMapper.getVisualFromRenderableIndex(p):p,y>=0?s.columnIndexMapper.getVisualFromRenderableIndex(y):y)},M=(g,p)=>{const y=p>g?1:-1,E=Math.min(g,p),H=Math.max(g,p),W=s.rowIndexMapper.getNearestNotHiddenIndex(g,y);return W===null||y===1&&W>H||y===-1&&W<E?null:W>=0?s.rowIndexMapper.getRenderableFromVisualIndex(W):W},A=(g,p)=>{const y=p>g?1:-1,E=Math.min(g,p),H=Math.max(g,p),W=s.columnIndexMapper.getNearestNotHiddenIndex(g,y);return W===null||y===1&&W>H||y===-1&&W<E?null:W>=0?s.columnIndexMapper.getRenderableFromVisualIndex(W):W};let j=new PD(b,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,p)=>s._createCellCoords(g,p),createCellRange:(g,p,y)=>s._createCellRange(g,p,y),visualToRenderableCoords:O,renderableToVisualCoords:D,findFirstNonHiddenRenderableRow:M,findFirstNonHiddenRenderableColumn:A,isDisabledCellSelection:(g,p)=>g<0||p<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,p).disableVisualSelection});this.selection=j;const X=g=>{let{hiddenIndexesChanged:p}=g;p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",X),this.rowIndexMapper.addLocalHook("cacheUpdated",X),this.selection.addLocalHook("afterSetRangeEnd",(g,p)=>{const y=hr(!1),E=this.selection.getSelectedRange(),{from:H,to:W}=E.current(),q=E.size()-1;this.runHooks("afterSelection",H.row,H.col,W.row,W.col,y,q),this.runHooks("afterSelectionByProp",H.row,s.colToProp(H.col),W.row,s.colToProp(W.col),y,q),p&&(!y.isTouched()||y.isTouched()&&!y.value)&&d.scrollTo(g);const G=j.isSelectedByRowHeader(),le=j.isSelectedByColumnHeader();G&&le?Y(this.rootElement,["ht__selection--rows","ht__selection--columns"]):G?(Ce(this.rootElement,"ht__selection--columns"),Y(this.rootElement,"ht__selection--rows")):le?(Ce(this.rootElement,"ht__selection--rows"),Y(this.rootElement,"ht__selection--columns")):Ce(this.rootElement,["ht__selection--rows","ht__selection--columns"]),j.getSelectionSource()!=="shift"&&c.closeEditor(null),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const p=hr(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(g),c.closeEditor(),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const p=g.length-1,{from:y,to:E}=g[p];this.runHooks("afterSelectionEnd",y.row,y.col,E.row,E.col,p),this.runHooks("afterSelectionEndByProp",y.row,s.colToProp(y.col),E.row,s.colToProp(E.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const p=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),s.view.render(),Ce(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),u={alter(g,p){var y,E;let H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,W=arguments.length>3?arguments[3]:void 0,q=arguments.length>4?arguments[4]:void 0;const G=le=>{if(le.length===0)return[];const C=[...le];return C.sort((T,F)=>{let[I]=T,[k]=F;return I===k?0:I>k?1:-1}),Qt(C,(T,F)=>{let[I,k]=F;const B=T[T.length-1],[x,L]=B,$=x+L;if(I<=$){const V=Math.max(k-($-I),0);B[1]+=V}else T.push([I,k]);return T},[C[0]])};switch(g){case"insert_row_below":case"insert_row_above":const le=s.countSourceRows();if(b.maxRows===le)return;const C=g==="insert_row_below"?"below":"above";p=(y=p)!==null&&y!==void 0?y:C==="below"?le:0;const{delta:S,startPhysicalIndex:T}=a.createRow(p,H,{source:W,mode:C});j.shiftRows(s.toVisualRow(T),S);break;case"insert_col_start":case"insert_col_end":const F=g==="insert_col_end"?"end":"start";p=(E=p)!==null&&E!==void 0?E:F==="end"?s.countSourceCols():0;const{delta:I,startPhysicalIndex:k}=a.createCol(p,H,{source:W,mode:F});if(I){if(Array.isArray(b.colHeaders)){const L=[s.toVisualColumn(k),0];L.length+=I,Array.prototype.splice.apply(b.colHeaders,L)}j.shiftColumns(s.toVisualColumn(k),I)}break;case"remove_row":const B=L=>{let $=0;_(L,V=>{let[z,se]=V;const ue=Lt(z)?s.countRows()-1:Math.max(z-$,0);if(Number.isInteger(z)&&(z=Math.max(z-$,0)),!a.removeRow(z,se,W))return;if(j.isSelected()){const{row:Oe}=s.getSelectedRangeLast().highlight;Oe>=z&&Oe<=z+se-1&&c.closeEditor(!0)}const Be=s.countRows();Be===0?j.deselect():W==="ContextMenu.removeRow"?j.refresh():j.shiftRows(z,-se);const Ge=b.fixedRowsTop;Ge>=ue+1&&(b.fixedRowsTop-=Math.min(se,Ge-ue));const Ee=b.fixedRowsBottom;Ee&&ue>=Be-Ee&&(b.fixedRowsBottom-=Math.min(se,Ee)),$+=se})};Array.isArray(p)?B(G(p)):B([[p,H]]);break;case"remove_col":const x=L=>{let $=0;_(L,V=>{let[z,se]=V;const ue=Lt(z)?s.countCols()-1:Math.max(z-$,0);let Re=s.toPhysicalColumn(ue);if(Number.isInteger(z)&&(z=Math.max(z-$,0)),!a.removeCol(z,se,W))return;if(j.isSelected()){const{col:Oe}=s.getSelectedRangeLast().highlight;Oe>=z&&Oe<=z+se-1&&c.closeEditor(!0)}s.countCols()===0?j.deselect():W==="ContextMenu.removeColumn"?j.refresh():j.shiftColumns(z,-se);const Ee=b.fixedColumnsStart;Ee>=ue+1&&(b.fixedColumnsStart-=Math.min(se,Ee-ue)),Array.isArray(b.colHeaders)&&(typeof Re>"u"&&(Re=-1),b.colHeaders.splice(Re,se)),$+=se})};Array.isArray(p)?x(G(p)):x([[p,H]]);break;default:throw new Error(`There is no such action "${g}"`)}s.view.render(),q||u.adjustRowsAndCols()},adjustRowsAndCols(){const g=b.minRows,p=b.minSpareRows,y=b.minCols,E=b.minSpareCols;if(g){const H=s.countRows();H<g&&a.createRow(H,g-H,{source:"auto"})}if(p){const H=s.countEmptyRows(!0);if(H<p){const W=p-H,q=Math.min(W,b.maxRows-s.countSourceRows());a.createRow(s.countRows(),q,{source:"auto"})}}{let H;(y||E)&&(H=s.countEmptyCols(!0));let W=s.countCols();if(y&&!b.columns&&W<y){const q=y-W;H+=q,a.createCol(W,q,{source:"auto"})}if(E&&!b.columns&&s.dataType==="array"&&H<E){W=s.countCols();const q=E-H,G=Math.min(q,b.maxCols-W);a.createCol(W,G,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(g,p,y,E,H){let W,q,G,le;const C=[],S={},T=[],F=g.row,I=g.col;if(q=p.length,q===0)return!1;let k=0,B=0;switch(He(y)&&(k=y.col-I+1,B=y.row-F+1),H){case"shift_down":const x=hh(p),L=x.length,$=Math.max(L,k),V=s.getData().slice(F),z=hh(V).slice(I,I+$);for(G=0;G<$;G+=1)if(G<L){for(W=0,q=x[G].length;W<B-q;W+=1)x[G].push(x[G][W%q]);G<z.length?T.push(x[G].concat(z[G])):T.push(x[G].concat(new Array(V.length).fill(null)))}else T.push(x[G%L].concat(z[G]));s.populateFromArray(F,I,hh(T));break;case"shift_right":const se=p.length,ue=Math.max(se,B),Re=s.getData().slice(F).map(fn=>fn.slice(I));for(W=0;W<ue;W+=1)if(W<se){for(G=0,le=p[W].length;G<k-le;G+=1)p[W].push(p[W][G%le]);if(W<Re.length)for(let fn=0;fn<Re[W].length;fn+=1)p[W].push(Re[W][fn]);else p[W].push(...new Array(Re[0].length).fill(null))}else p.push(p[W%q].slice(0,ue).concat(Re[W]));s.populateFromArray(F,I,p);break;case"overwrite":default:S.row=g.row,S.col=g.col;let Be=0,Ge=0,Ee=!0,Oe;const $t=function(tn){let Vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const wt=p[tn%p.length];return Vt!==null?wt[Vt%wt.length]:wt},Xr=p.length,Mi=y?y.row-g.row+1:0;for(y?q=Mi:q=Math.max(Xr,Mi),W=0;W<q&&!(y&&S.row>y.row&&Mi>Xr||!b.allowInsertRow&&S.row>s.countRows()-1||S.row>=b.maxRows);W++){const fn=W-Be,tn=$t(fn).length,Vt=y?y.col-g.col+1:0;if(y?le=Vt:le=Math.max(tn,Vt),S.col=g.col,Oe=s.getCellMeta(S.row,S.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&Oe.skipRowOnPaste){Be+=1,S.row+=1,q+=1;continue}for(Ge=0,G=0;G<le&&!(y&&S.col>y.col&&Vt>tn||!b.allowInsertColumn&&S.col>s.countCols()-1||S.col>=b.maxCols);G++){if(Oe=s.getCellMeta(S.row,S.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&Oe.skipColumnOnPaste){Ge+=1,S.col+=1,le+=1;continue}if(Oe.readOnly&&E!=="UndoRedo.undo"){S.col+=1;continue}const wt=G-Ge;let nt=$t(fn,wt),Ve=s.getDataAtCell(S.row,S.col);if(nt!==null&&typeof nt=="object")if(Array.isArray(nt)&&Ve===null&&(Ve=[]),Ve===null||typeof Ve!="object")Ee=!1;else{const Od=Pu(Array.isArray(Ve)?Ve:Ve[0]||Ve),ra=Pu(Array.isArray(nt)?nt:nt[0]||nt);rp(Od,ra)||Array.isArray(Od)&&Array.isArray(ra)?nt=kn(nt):Ee=!1}else Ve!==null&&typeof Ve=="object"&&(Ee=!1);Ee&&C.push([S.row,S.col,nt]),Ee=!0,S.col+=1}S.row+=1}s.setDataAtCell(C,null,null,E||"populateFromArray");break}}};function U(g){const p=wD(g);WT(p)?(s.runHooks("beforeLanguageChange",p),R.language=p,s.runHooks("afterLanguageChange",p)):CD(g)}function Z(g,p){const y=g==="className"?s.rootElement:s.table;if(f)Y(y,p);else{let E=[],H=[];R[g]&&(E=Array.isArray(R[g])?R[g]:jS(R[g])),p&&(H=Array.isArray(p)?p:jS(p));const W=BS(E,H),q=BS(H,E);W.length&&Ce(y,W),q.length&&Y(y,q)}R[g]=p}this.init=function(){l.setData(b.data),s.runHooks("beforeInit"),(Us()||WR())&&Y(s.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new Z2(this);const g=b.themeName||nx(s.rootElement);s.useTheme(g),s.view.addClassNameToLicenseElement(s.getCurrentThemeName()),c=XS.getInstance(s,b,j),d=cX(s),h=new Mz(s),Sg(this)&&tX(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&mN(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function J(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function ae(g){const p=g.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):g}function ne(g,p,y){if(!g.length){y();return}const E=s.getActiveEditor(),H=new J;let W=!0;H.onQueueEmpty=()=>{E&&W&&E.cancelChanges(),y()};for(let q=g.length-1;q>=0;q--){const[G,le,,C]=g[q],S=a.propToCol(le);let T;Number.isInteger(S)?T=s.getCellMeta(G,S):T={...Object.getPrototypeOf(b),...b},T.type==="numeric"&&typeof C=="string"&&FN(C)&&(g[q][3]=ae(C)),s.getCellValidator(T)&&(H.addValidatorToQueue(),s.validateCell(g[q][3],T,function(F,I){return function(k){if(typeof k!="boolean")throw new Error("Validation error: result is not boolean");k===!1&&I.allowInvalid===!1&&(W=!1,g.splice(F,1),I.valid=!0),H.removeValidatorFormQueue()}}(q,T),p))}H.checkIfQueueIsEmpty()}function fe(g,p){for(let E=g.length-1;E>=0;E--){let H=!1;if(g[E]===null){g.splice(E,1);continue}if(!((g[E][2]===null||g[E][2]===void 0)&&(g[E][3]===null||g[E][3]===void 0))){if(b.allowInsertRow)for(;g[E][0]>s.countRows()-1;){const{delta:W}=a.createRow(void 0,void 0,{source:p});if(W===0){H=!0;break}}if(s.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;a.propToCol(g[E][1])>s.countCols()-1;){const{delta:W}=a.createCol(void 0,void 0,{source:p});if(W===0){H=!0;break}}H||a.set(g[E][0],g[E][1],g[E][3])}}const y=g.length>0;if(s.forceFullRender=!0,y){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,p),c.closeEditor(),s.view.render(),c.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",g,p||"edit");const E=s.getActiveEditor();E&&ce(E.refreshValue)&&E.refreshValue()}else s.view.render()}this._createCellCoords=function(g,p){return s.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,y){return s.view._wt.createCellRange(g,p,y)},this.validateCell=function(g,p,y,E){let H=s.getCellValidator(p);function W(q){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){y(q);return}const le=p.visualCol,C=p.visualRow,S=s.getCell(C,le,!0);if(S&&S.nodeName!=="TH"){const T=s.rowIndexMapper.getRenderableFromVisualIndex(C),F=s.columnIndexMapper.getRenderableFromVisualIndex(le);s.view._wt.getSetting("cellRenderer",T,F,S)}y(q)}qH(H)&&(H=function(q){return function(G,le){le(q.test(G))}}(H)),dt(H)?(g=s.runHooks("beforeValidate",g,p.visualRow,p.prop,E),s._registerImmediate(()=>{H.call(p,g,q=>{s&&(q=s.runHooks("afterValidate",q,g,p.visualRow,p.prop,E),p.valid=q,W(q),s.runHooks("postAfterValidate",q,g,p.visualRow,p.prop,E))})})):s._registerImmediate(()=>{p.valid=!0,W(p.valid,!1)})};function mt(g,p,y){return Array.isArray(g)?g:[[g,p,y]]}function Te(g,p){const y=s.getActiveEditor(),E=s.runHooks("beforeChange",g,p||"edit"),H=g.filter(W=>W!==null);return E===!1||H.length===0?(y&&y.cancelChanges(),[]):H}this.setDataAtCell=function(g,p,y,E){const H=mt(g,p,y),W=[];let q=E,G,le,C;for(G=0,le=H.length;G<le;G++){if(typeof H[G]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof H[G][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");H[G][1]>=this.countCols()?C=H[G][1]:C=a.colToProp(H[G][1]),W.push([H[G][0],C,l.getAtCell(this.toPhysicalRow(H[G][0]),H[G][1]),H[G][2]])}!q&&typeof g=="object"&&(q=p);const S=Te(W,q);s.runHooks("afterSetDataAtCell",S,q),ne(S,q,()=>{fe(S,q)})},this.setDataAtRowProp=function(g,p,y,E){const H=mt(g,p,y),W=[];let q=E,G,le;for(G=0,le=H.length;G<le;G++)W.push([H[G][0],H[G][1],l.getAtCell(this.toPhysicalRow(H[G][0]),H[G][1]),H[G][2]]);!q&&typeof g=="object"&&(q=p);const C=Te(W,E);s.runHooks("afterSetDataAtRowProp",C,q),ne(C,q,()=>{fe(C,q)})},this.listen=function(){s&&!s.isListening()&&(Jv.forEach(g=>{s!==g&&g.unlisten()}),Qv=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Qv=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Qv===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(g),s.view.render(),p&&j.isSelected()&&c.prepareEditor()},this.populateFromArray=function(g,p,y,E,H,W,q){if(!(typeof y=="object"&&typeof y[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const G=typeof E=="number"?s._createCellCoords(E,H):null;return u.populateFromArray(s._createCellCoords(g,p),y,G,W,q)},this.spliceCol=function(g,p,y){for(var E=arguments.length,H=new Array(E>3?E-3:0),W=3;W<E;W++)H[W-3]=arguments[W];return a.spliceCol(g,p,y,...H)},this.spliceRow=function(g,p,y){for(var E=arguments.length,H=new Array(E>3?E-3:0),W=3;W<E;W++)H[W-3]=arguments[W];return a.spliceRow(g,p,y,...H)},this.getSelected=function(){if(j.isSelected())return Fe(j.getSelectedRange(),g=>{let{from:p,to:y}=g;return[p.row,p.col,y.row,y.col]})},this.getSelectedLast=function(){const g=this.getSelected();let p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRange=function(){if(j.isSelected())return Array.from(j.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let p;return g&&g.length>0&&(p=g[g.length-1]),p},this.emptySelectedCells=function(g){if(!j.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];_(j.getSelectedRange(),y=>{if(y.isSingleHeader())return;const E=y.getTopStartCorner(),H=y.getBottomEndCorner();me(E.row,H.row,W=>{me(E.col,H.col,q=>{this.getCellMeta(W,q).readOnly||p.push([W,q,null])})})}),p.length>0&&this.setDataAtCell(p,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(g){this.suspendRender();const p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const y=g();return this.resumeExecution(p),y},this.batch=function(g){this.suspendRender(),this.suspendExecution();const p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!s.view)return;const{width:g,height:p}=s.view.getLastSize(),{width:y,height:E}=s.rootElement.getBoundingClientRect(),H=y!==g||E!==p;s.runHooks("beforeRefreshDimensions",{width:g,height:p},{width:y,height:E},H)!==!1&&((H||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(y,E),s.render()),s.runHooks("afterRefreshDimensions",{width:g,height:p},{width:y,height:E},H))},this.updateData=function(g,p){XO(g,y=>{a=y},y=>{a=y,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),j.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:w,firstRun:f})},this.loadData=function(g,p){XO(g,y=>{a=y},()=>{w.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),j.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:w,firstRun:f})},this.getInitialColumnCount=function(){const g=b.columns;let p=0;if(Array.isArray(g))p=g.length;else if(dt(g))if(s.dataType==="array"){const y=this.countSourceCols();for(let E=0;E<y;E+=1)g(E)&&(p+=1)}else(s.dataType==="object"||s.dataType==="function")&&(p=a.colToPropCache.length);else if(ce(b.dataSchema)){const y=a.getSchema();p=Array.isArray(y)?y.length:ip(y)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,y,E){return St(g)?a.getAll():a.getRange(s._createCellCoords(g,p),s._createCellCoords(y,E),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,y,E){return a.getCopyableText(s._createCellCoords(g,p),s._createCellCoords(y,E))},this.getCopyableData=function(g,p){return a.getCopyable(g,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=(f?s.loadData:s.updateData).bind(this);let E=!1,H,W;if(ce(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ce(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ce(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(H in g)H==="data"||(H==="language"?U(g.language):H==="className"?Z("className",g.className):H==="tableClassName"&&s.table?(Z("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):oe.getSingleton().isRegistered(H)||oe.getSingleton().isDeprecated(H)?dt(g[H])?oe.getSingleton().addAsFixed(H,g[H],s):Array.isArray(g[H])&&oe.getSingleton().add(H,g[H],s):!p&&Kt(g,H)&&(R[H]=g[H]));g.data===void 0&&b.data===void 0?y(null,"updateSettings"):g.data!==void 0?y(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),s.initIndexMappers());const q=s.countCols(),G=b.columns;if(G&&dt(G)&&(E=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&w.clearCache(),q>0)for(H=0,W=0;H<q;H++){if(G){const S=E?G(H):G[W];S&&w.updateColumnMeta(W,S)}W+=1}ce(g.cell)&&Ne(g.cell,S=>{s.setCellMetaObject(S.row,S.col,S)}),s.runHooks("afterCellMetaReset");let le=s.rootElement.style.height;le!==""&&(le=parseInt(s.rootElement.style.height,10));let C=g.height;if(dt(C)&&(C=C()),p&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),C===null){const S=s.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",S):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else C!==void 0&&(s.rootElement.style.height=isNaN(C)?`${C}`:`${C}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let S=g.width;dt(S)&&(S=S()),s.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!p){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const S=s.getCurrentThemeName(),T=Kt(g,"themeName");S&&T&&(s.view.getStylesHandler().removeClassNames(),s.view.removeClassNameFromLicenseElement(S));const F=T&&g.themeName||nx(s.rootElement);s.useTheme(F),s.view.addClassNameToLicenseElement(s.getCurrentThemeName())}s.runHooks("afterUpdateSettings",g)}u.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!p&&s.view&&(le===""||C===""||C===void 0)&&le!==C&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedLast();if(b.getValue){if(dt(b.getValue))return b.getValue.call(s);if(g)return s.getData()[g[0][0]][b.getValue]}else if(g)return s.getDataAtCell(g[0],g[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,y,E,H){u.alter(g,p,y,E,H)},this.getCell=function(g,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=p,H=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;H=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return H===null||E===null||H===void 0||E===void 0?null:s.view.getCellAtCoords(s._createCellCoords(H,E),y)},this.getCoords=function(g){const p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;const{row:y,col:E}=p;let H=y,W=E;return y>=0&&(H=this.rowIndexMapper.getVisualFromRenderableIndex(y)),E>=0&&(W=this.columnIndexMapper.getVisualFromRenderableIndex(E)),s._createCellCoords(H,W)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,p){return a.get(g,a.colToProp(p))},this.getDataAtRowProp=function(g,p){return a.get(g,p)},this.getDataAtCol=function(g){const p=[],y=a.getRange(s._createCellCoords(0,g),s._createCellCoords(b.data.length-1,g),a.DESTINATION_RENDERER);for(let E=0;E<y.length;E+=1)for(let H=0;H<y[E].length;H+=1)p.push(y[E][H]);return p},this.getDataAtProp=function(g){const p=[],y=a.getRange(s._createCellCoords(0,a.propToCol(g)),s._createCellCoords(b.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let E=0;E<y.length;E+=1)for(let H=0;H<y[E].length;H+=1)p.push(y[E][H]);return p},this.getSourceData=function(g,p,y,E){let H;return g===void 0?H=l.getData():H=l.getByRange(s._createCellCoords(g,p),s._createCellCoords(y,E)),H},this.getSourceDataArray=function(g,p,y,E){let H;return g===void 0?H=l.getData(!0):H=l.getByRange(s._createCellCoords(g,p),s._createCellCoords(y,E),!0),H},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,y,E){const H=mt(g,p,y),W=this.hasHook("afterSetSourceDataAtCell"),q=[];W&&_(H,le=>{let[C,S,T]=le;q.push([C,S,l.getAtCell(C,S),T])}),_(H,le=>{let[C,S,T]=le;l.setAtCell(C,S,T)}),W&&this.runHooks("afterSetSourceDataAtCell",q,E),this.render();const G=s.getActiveEditor();G&&ce(G.refreshValue)&&G.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return l.getAtCell(g,p)},this.getDataAtRow=function(g){return a.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,p,y,E){const H=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,y,E],[W,q]=H;let[,,G,le]=H,C=null,S=null;G===void 0&&(G=W),le===void 0&&(le=q);let T="mixed";return me(Math.max(Math.min(W,G),0),Math.max(W,G),F=>{let I=!0;return me(Math.max(Math.min(q,le),0),Math.max(q,le),k=>(S=this.getCellMeta(F,k).type,C?I=C===S:C=S,I)),T=I?S:"mixed",I}),T},this.removeCellMeta=function(g,p,y){const[E,H]=[this.toPhysicalRow(g),this.toPhysicalColumn(p)];let W=w.getCellMetaKeyValue(E,H,y);s.runHooks("beforeRemoveCellMeta",g,p,y,W)!==!1&&(w.removeCellMeta(E,H,y),s.runHooks("afterRemoveCellMeta",g,p,y,W)),W=null},this.spliceCellsMeta=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var y=arguments.length,E=new Array(y>2?y-2:0),H=2;H<y;H++)E[H-2]=arguments[H];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&w.removeRow(this.toPhysicalRow(g),p),E.length>0&&_(E.reverse(),W=>{w.createRow(this.toPhysicalRow(g)),_(W,(q,G)=>this.setCellMetaObject(g,G,q))}),s.render()},this.setCellMetaObject=function(g,p,y){typeof y=="object"&&Ne(y,(E,H)=>{this.setCellMeta(g,p,H,E)})},this.setCellMeta=function(g,p,y,E){if(s.runHooks("beforeSetCellMeta",g,p,y,E)===!1)return;let W=g,q=p;g<this.countRows()&&(W=this.toPhysicalRow(g)),p<this.countCols()&&(q=this.toPhysicalColumn(p)),w.setCellMeta(W,q,y,E),s.runHooks("afterSetCellMeta",g,p,y,E)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(g,p){let y=this.toPhysicalRow(g),E=this.toPhysicalColumn(p);return y===null&&(y=g),E===null&&(E=p),w.getCellMeta(y,E,{visualRow:g,visualColumn:p})},this.getColumnMeta=function(g){return w.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return w.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||b.columns)},this.getCellRenderer=function(g,p){const y=typeof g=="number"?s.getCellMeta(g,p).renderer:g.renderer;return typeof y=="string"?Gg(y):St(y)?Gg("text"):y},this.getCellEditor=function(g,p){const y=typeof g=="number"?s.getCellMeta(g,p).editor:g.editor;return typeof y=="string"?Yg(y):St(y)?Yg("text"):y},this.getCellValidator=function(g,p){const y=typeof g=="number"?s.getCellMeta(g,p).validator:g.validator;return typeof y=="string"?qR(y):y},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,y){const E=new J;g&&(E.onQueueEmpty=g);let H=s.countRows()-1;for(;H>=0;){if(p!==void 0&&p.indexOf(H)===-1){H-=1;continue}let W=s.countCols()-1;for(;W>=0;){if(y!==void 0&&y.indexOf(W)===-1){W-=1;continue}E.addValidatorToQueue(),s.validateCell(s.getDataAtCell(H,W),s.getCellMeta(H,W),q=>{if(typeof q!="boolean")throw new Error("Validation error: result is not boolean");q===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),W-=1}H-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let p=b.rowHeaders,y=g;return y!==void 0&&(y=s.runHooks("modifyRowHeader",y)),y===void 0?(p=[],me(s.countRows()-1,E=>{p.push(s.getRowHeader(E))})):Array.isArray(p)&&p[y]!==void 0?p=p[y]:dt(p)?p=p(y):p&&typeof p!="string"&&typeof p!="number"&&(p=y+1),p},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let g=0,p=s.countCols();g<p;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const y=s.runHooks("modifyColHeader",g);if(y===void 0){const G=[],le=s.countCols();for(let C=0;C<le;C++)G.push(s.getColHeader(C));return G}let E=b.colHeaders;const H=function(G){const le=[],C=s.countCols();let S=0;for(;S<C;S++)dt(b.columns)&&b.columns(S)&&le.push(S);return le[G]},W=s.toPhysicalColumn(y),q=H(W);return b.colHeaders===!1?E=null:b.columns&&dt(b.columns)&&b.columns(q)&&b.columns(q).title?E=b.columns(q).title:b.columns&&b.columns[W]&&b.columns[W].title?E=b.columns[W].title:Array.isArray(b.colHeaders)&&b.colHeaders[W]!==void 0?E=b.colHeaders[W]:dt(b.colHeaders)?E=b.colHeaders(W):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(E=cp(y)),E=s.runHooks("modifyColumnHeaderValue",E,g,p),E},this._getColWidthFromSettings=function(g){let p;if(g>=0&&(p=s.getCellMeta(0,g).width),(p===void 0||p===b.width)&&(p=b.colWidths),p!=null){switch(typeof p){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g,p){let y=s._getColWidthFromSettings(g);return y=s.runHooks("modifyColWidth",y,g,p),y===void 0&&(y=Ou),y},this._getRowHeightFromSettings=function(g){let p=b.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(g,p){let y=s._getRowHeightFromSettings(g);return y=s.runHooks("modifyRowHeight",y,g,p),y},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=b.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return JS(s.countRows()-1,y=>{if(s.isEmptyRow(y))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return JS(s.countCols()-1,y=>{if(s.isEmptyCol(y))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return b.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return b.isEmptyCol.call(s,g)},this.selectCell=function(g,p,y,E){let H=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,W=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return St(g)||St(p)?!1:this.selectCells([[g,p,y,E]],H,W)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const E=j.selectCells(g);return E&&y&&s.listen(),d.resume(),E},this.selectColumns=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return j.selectColumns(g,p,y)},this.selectRows=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return j.selectRows(g,p,y)},this.deselectCell=function(){j.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),j.selectAll(g,p,y)};const $e=(g,p)=>g.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(g){var p;if(typeof g=="number"){var y;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(y=arguments[4])!==null&&y!==void 0?y:!0}}const{row:E,col:H,considerHiddenIndexes:W}=(p=g)!==null&&p!==void 0?p:{};let q=E,G=H;if(W===void 0||W){const S=Number.isInteger(E)&&E>=0,T=Number.isInteger(H)&&H>=0,F=S?$e(this.rowIndexMapper,E):void 0,I=T?$e(this.columnIndexMapper,H):void 0;if(F===null||I===null)return!1;q=S?s.rowIndexMapper.getRenderableFromVisualIndex(F):E,G=T?s.columnIndexMapper.getRenderableFromVisualIndex(I):H}const le=Number.isInteger(q),C=Number.isInteger(G);return le&&q>=0&&C&&G>=0?s.view.scrollViewport(s._createCellCoords(q,G),g.horizontalSnap,g.verticalSnap):le&&q>=0&&(C&&G<0||!C)?s.view.scrollViewportVertically(q,g.verticalSnap):C&&G>=0&&(le&&q<0||!le)?s.view.scrollViewportHorizontally(G,g.horizontalSnap):!1},this.scrollToFocusedCell=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",g);const{highlight:p}=this.getSelectedRangeLast();this.scrollViewportTo(p.toObject())?this.view.render():(this.removeHook("afterScroll",g),this._registerImmediate(()=>g()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),w.clearCache(),Jv.delete(this.guid),Sg(s)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}yi(s.rootElement),o.destroy(),c&&c.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),P.getItems().forEach(g=>{let[,p]=g;p.destroy()}),P.clear(),s.runHooks("afterDestroy")},!0),oe.getSingleton().destroy(s),Ne(s,(g,p,y)=>{dt(g)?y[p]=Et(p):p!=="guid"&&(y[p]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,j=null,c=null,s=null};function Et(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){const p=Ln(g);return p==="UndoRedo"?this.undoRedo:P.getItem(p)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:P.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,p,y){oe.getSingleton().add(g,p,s,y)},this.hasHook=function(g){return oe.getSingleton().has(g,s)||oe.getSingleton().has(g)},this.addHookOnce=function(g,p,y){oe.getSingleton().once(g,p,s,y)},this.removeHook=function(g,p){oe.getSingleton().remove(g,p,s)},this.runHooks=function(g,p,y,E,H,W,q){return oe.getSingleton().run(s,g,p,y,E,H,W,q)},this.getTranslatedPhrase=function(g,p){return ED(b.language,g,p)},this.toHTML=()=>ZS(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",ZS(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{this.view.getStylesHandler().useTheme(g),this.runHooks("afterSetTheme",g,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=g;typeof y=="function"&&(y=setTimeout(y,p)),this.timeouts.push(y)},this._clearTimeouts=function(){_(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){_(this.immediates,g=>{clearImmediate(g)})},this._getEditorManager=function(){return c},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const en=pX({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&en.releasePressedKeys()}),this.getShortcutManager=function(){return en},this.getFocusManager=function(){return h},GR().forEach(g=>{const p=gd(g);P.addItem(g,new p(this))}),J3(s),en.setActiveContextName("grid"),oe.getSingleton().run(s,"construct")}function rx(t,e,n){t.addEventListener(e,n,!1)}function ix(t,e,n){t.removeEventListener(e,n,!1)}function hf(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function $D(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),s=t.createElement("span");let o;function a(){var h,d;i.textContent=n.textContent(o),s.style.position="absolute",s.style.fontSize=hf(o).fontSize,s.style.fontFamily=hf(o).fontFamily,s.style.whiteSpace="pre",r.appendChild(s);const f=parseInt(((h=hf(o))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=hf(o))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=s.clientWidth+2+f+m;r.removeChild(s);const w=o.style;w.height=`${n.minHeight}px`,n.minWidth>v?w.width=`${n.minWidth}px`:v>n.maxWidth?w.width=`${n.maxWidth}px`:w.width=`${v}px`;const b=o.scrollHeight?o.scrollHeight-1:0;n.minHeight>b?w.height=`${n.minHeight}px`:n.maxHeight<b?(w.height=`${n.maxHeight}px`,w.overflowY="visible"):w.height=`${b}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=o.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=o.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=o.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=o.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=h,u(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${n.minHeight}px`,o.style.minWidth=`${n.minWidth}px`,o.style.maxWidth=`${n.maxWidth}px`,o.style.overflowY="hidden"),f&&(rx(o,"input",a),rx(o,"keydown",l)),a()}return{init:c,resize:a,unObserve(){ix(o,"input",a),ix(o,"keydown",l)}}}function sx(t,e){const n=AR(e),r=e.value.split(`
`);let i=n,s=0;for(let o=0;o<r.length;o++){const a=r[o];o!==0&&(s+=r[o-1].length+1);const l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),n<=l)break}hd(e,i)}function ga(t,e,n){return(e=wX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wX(t){var e=CX(t,"string");return typeof e=="symbol"?e:e+""}function CX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vX="ht_editor_visible",df="ht_editor_hidden",ox="textEditor",yX="text";class yl extends qu{static get EDITOR_TYPE(){return yX}constructor(e){super(e),ga(this,"eventManager",new Ur(this)),ga(this,"autoResize",$D(this.hot.rootDocument)),ga(this,"TEXTAREA",void 0),ga(this,"textareaStyle",void 0),ga(this,"TEXTAREA_PARENT",void 0),ga(this,"textareaParentStyle",void 0),ga(this,"layerClass",void 0),this.eventManager=new Ur(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),rN(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,s,o){const a=this.state;if(super.prepare(e,n,r,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Ut.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Ut.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),hd(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),be(this.TEXTAREA,[["data-hot-input",""],Uu(-1)]),Y(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Y(this.TEXTAREA_PARENT,"handsontableInputHolder"),ye(this.TEXTAREA_PARENT,this.layerClass)&&Ce(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,df),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){_N()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ce(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,df)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;me(e.length-1,r=>{const i=e[r];if(ye(i,"handsontableEditor"))return n=!0,!1}),ye(this.TEXTAREA_PARENT,df)&&Ce(this.TEXTAREA_PARENT,df),n?(this.layerClass=vX,Y(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Y(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Ut.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){VR()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Ut.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Ut.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ce(this.hot.getSelected()),group:ox},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;sx(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;sx(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ox)}}const SX="base";function vd(t,e,n,r,i,s,o){const a=o.ariaTags,l=[],u=[],c=[],h=[];o.className&&Y(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(CP())):a&&c.push(CP()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(vP())):(u.push(o.invalidCellClassName),a&&c.push(vP()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),Ce(e,u),Y(e,l),wl(e,c),be(e,h)}vd.RENDERER_TYPE=SX;const bX="text";function oo(t,e,n,r,i,s,o){vd.apply(this,[t,e,n,r,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=Dt(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){yi(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else qo(e,a)}oo.RENDERER_TYPE=bX;const RX="text",VD={CELL_TYPE:RX,editor:yl,renderer:oo};Ar(VD);_e.editors={BaseEditor:qu};function _e(t,e){const n=new FD(t,e||{},hE);return n.init(),n}_e.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new FD(t,e,hE)};_e.DefaultSettings=xD();_e.hooks=oe.getSingleton();_e.CellCoords=sl;_e.CellRange=md;_e.packageName="handsontable";_e.buildDate="16/12/2024 13:19:38";_e.version="15.0.0";_e.languages={dictionaryKeys:Vq,getLanguageDictionary:RD,getLanguagesDictionaries:zq,registerLanguageDictionary:bD,getTranslatedPhrase:ED};const ax="handsontableEditor",EX="handsontable";class UT extends yl{static get EDITOR_TYPE(){return EX}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),hd(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Xt(l,o.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.htEditor.useTheme(e)})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:ax,relativeToGroup:na,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),Kr(o),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ax)}}function TX(t,e,n){_X(t,e),e.set(t,n)}function _X(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ff(t,e,n){return(e=MX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MX(t){var e=IX(t,"string");return typeof e=="symbol"?e:e+""}function IX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lx(t,e){return t.get(PX(t,e))}function PX(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OX="autocomplete";var ey=new WeakMap;class zT extends UT{constructor(){super(...arguments),ff(this,"query",null),ff(this,"strippedChoices",[]),ff(this,"rawChoices",[]),TX(this,ey,this.hot.guid.slice(0,9)),ff(this,"sortByRelevance",function(e,n,r){const i=[],s=[],o=e.length;let a=n.length,l,u,c,h;if(o===0){for(c=0;c<a;c++)s.push(c);return s}for(c=0;c<a;c++){if(u=zS(Dt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-o,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)s.push(i[c].baseIndex);return s})}static get EDITOR_TYPE(){return OX}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ce(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Y(this.htContainer,"autocompleteEditor"),Y(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[CU(),fU(),QH("listbox"),bU()])}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[Br("false"),RU(`${lx(ey,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.updateSettings({colWidths:e?[Yt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(a,l,u,c,h,d,f)=>{oo(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:v,locale:w}=this.cellProperties,b=this.query;let R=Dt(d),P,O;R&&!v&&(P=m===!0?R.indexOf(b):R.toLocaleLowerCase(w).indexOf(b.toLocaleLowerCase(w)),P!==-1&&(O=R.substr(P,b.length),R=R.replace(O,`<strong>${O}</strong>`))),n&&be(l,[gU(),...r?[MU(i)]:[],...r?[IU(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=R},afterSelectionEnd:(a,l)=>{if(n){const u=this.htEditor.getCell(a,l,!0);be(u,[MR()]),be(this.TEXTAREA,...EU(u.id))}}}),n&&(be(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...as()),be(this.htEditor.rootElement,[ZH(),TU("polite"),_U("text"),["id",`${lx(ey,this)}-listbox-${s}-${o}`]]),be(this.TEXTAREA,...Br("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&be(this.TEXTAREA,[Br("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=AR(this.TEXTAREA),r=dN(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[o[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(hh([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),hd(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=il(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=cn(this.TEXTAREA),s=kt(this.TEXTAREA),o=this.getHeight(),a=e.scrollTop,l=kt(this.hot.view._wt.wtTable.THEAD),u=cn(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-s,d=o>h&&c>h;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,o),d}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=s,i+=1;while(r<e);o=r-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-s)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+yn(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(s,o)=>o).reduce((s,o)=>s+this.htEditor.getRowHeight(o),0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Fe(e,s=>Dt(s));return Fe(r,s=>n?s:zS(s))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===ge.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===ge.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(MN(e.keyCode)||e.keyCode===ge.BACKSPACE||e.keyCode===ge.DELETE||e.keyCode===ge.INSERT){let n=10;if(e.keyCode===ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const xX="checkbox";class WD extends qu{static get EDITOR_TYPE(){return xX}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ye(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Fo=()=>window,Fr=()=>window.document,cb=(t,e)=>window.setTimeout(t,e),qi=function(t,e,n,r){t.addEventListener(e,n,!!r)},Es=function(t,e,n,r){t.removeEventListener(e,n,!!r)},AX=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},wr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},ty=function(t,e){wr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},ny=function(t,e){t.className=AX((" "+t.className+" ").replace(" "+e+" "," "))},YT=function(t){return/Array/.test(Object.prototype.toString.call(t))},yr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},HX=function(t){let e=t.getDay();return e===0||e===6},NX=function(t){return t%4===0&&t%100!==0||t%400===0},ux=function(t,e){return[31,NX(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},gf=function(t){yr(t)&&t.setHours(0,0,0,0)},mf=function(t,e){return t.getTime()===e.getTime()},em=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?yr(e[r])?n&&(t[r]=new Date(e[r].getTime())):YT(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=em({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},cx=function(t,e,n){let r=Fr().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=em(r,n),t.dispatchEvent(r)},hx=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Di={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},dx=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},DX=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},LX=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,s=i-1,o=7,a=function(d){return(d+o-1)%o};t.setDate(n+s-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-s+a(l.getDay()))/o)},kX=function(t,e,n,r,i){let s=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():LX(s,i))+"</td>"},FX=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},$X=function(t){return"<tbody>"+t.join("")+"</tbody>"},VX=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+dx(t,e)+'">'+dx(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},WX=function(t,e,n,r,i,s){let o,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,m,v=!0,w=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(n===i?o-e:12+o-e)+'"'+(o===r?' selected="selected"':"")+(c&&o<u.minMonth||h&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",YT(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=n-u.yearRange,a=1+n+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===n?' selected="selected"':"")+">"+o+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(w=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(w?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},BX=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+VX(t)+$X(e)+"</table>"};function hb(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Fo().event;let s=i.target||i.srcElement;if(s)if(wr(s,"is-disabled")||(wr(s,"pika-button")&&!wr(s,"is-empty")&&!wr(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),n.bound&&cb(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):wr(s,"pika-prev")?e.prevMonth():wr(s,"pika-next")&&e.nextMonth()),wr(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Fo().event;let s=i.target||i.srcElement;s&&(wr(s,"pika-select-month")?e.gotoMonth(s.value):wr(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||Fo().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),yr(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Fr().activeElement;do if(wr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=cb(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Fo().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&wr(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),qi(s,"change",e._onChange)));do if(wr(o,"pika-single")||o===n.trigger)return;while(o=o.parentNode);e._v&&s!==n.trigger&&o!==n.trigger&&e.hide()}},e.el=Fr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),qi(e.el,"mousedown",e._onMouseDown,!0),qi(e.el,"touchend",e._onMouseDown,!0),qi(e.el,"change",e._onChange),n.keyboardInput&&qi(Fr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Fr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),qi(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;yr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",qi(n.trigger,"click",e._onInputClick),qi(n.trigger,"focus",e._onInputFocus),qi(n.trigger,"blur",e._onInputBlur)):this.show()}hb.prototype={config:function(t){this._o||(this._o=em({},Di,!0));let e=em(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,yr(e.minDate)||(e.minDate=!1),yr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),YT(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Di.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,yr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return yr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",cx(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!yr(t))return;let n=this._o.minDate,r=this._o.maxDate;yr(n)&&t<n?t=n:yr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),gf(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),cx(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(yr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=hx(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=hx({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(gf(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Di.minDate,this._o.minYear=Di.minYear,this._o.minMonth=Di.minMonth,this._o.startRange=Di.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(gf(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Di.maxDate,this._o.maxYear=Di.maxYear,this._o.maxMonth=Di.maxMonth,this._o.endRange=Di.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+WX(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&cb(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,s,o,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Fo().innerWidth||Fr().documentElement.clientWidth,i=Fo().innerHeight||Fr().documentElement.clientHeight,s=Fr().body.scrollTop||Fr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),o=l.left+Fo().pageXOffset,a=l.bottom+Fo().pageYOffset,(this._o.reposition&&o+e>r||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+s||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",ty(this.el,u?"left-aligned":"right-aligned"),ty(this.el,c?"bottom-aligned":"top-aligned"),ny(this.el,u?"right-aligned":"left-aligned"),ny(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,s=ux(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];gf(i),r.firstDay>0&&(o-=r.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=ux(h,u),m=s+o,v=m;for(;v>7;)v-=7;m+=7-v;let w=!1;for(let b=0,R=0;b<m;b++){let P=new Date(t,e,1+(b-o)),O=yr(this._d)?mf(P,this._d):!1,D=mf(P,i),M=r.events.indexOf(P.toDateString())!==-1,A=b<o||b>=s+o,j=1+(b-o),X=e,U=t,Z=r.startRange&&mf(r.startRange,P),J=r.endRange&&mf(r.endRange,P),ae=r.startRange&&r.endRange&&r.startRange<P&&P<r.endRange,ne=r.minDate&&P<r.minDate||r.maxDate&&P>r.maxDate||r.disableWeekends&&HX(P)||r.disableDayFn&&r.disableDayFn(P);A&&(b<o?(j=f+j,X=u,U=h):(j=j-s,X=c,U=d));let fe={day:j,month:X,year:U,hasEvent:M,isSelected:O,isToday:D,isDisabled:ne,isEmpty:A,isStartRange:Z,isEndRange:J,isInRange:ae,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&O&&(w=!0),l.push(DX(fe)),++R===7&&(r.showWeekNumber&&l.unshift(kX(this,b-o,e,t,r.firstWeekOfYearMinDays)),a.push(FX(l,r.isRTL,r.pickWholeWeek,w)),l=[],R=0,w=!1)}return BX(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),ny(this.el,"is-hidden"),this._o.bound&&(qi(Fr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Es(Fr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),ty(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Es(this.el,"mousedown",this._onMouseDown,!0),Es(this.el,"touchend",this._onMouseDown,!0),Es(this.el,"change",this._onChange),t.keyboardInput&&Es(Fr(),"keydown",this._onKeyChange),t.field&&(Es(t.field,"change",this._onInputChange),t.bound&&(Es(t.trigger,"click",this._onInputClick),Es(t.trigger,"focus",this._onInputFocus),Es(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function ry(t,e,n){return(e=jX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jX(t){var e=UX(t,"string");return typeof e=="symbol"?e:e+""}function UX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const BD="date",fx="dateEditor";class jD extends yl{constructor(){super(...arguments),ry(this,"defaultDateFormat","DD/MM/YYYY"),ry(this,"parentDestroyed",!1),ry(this,"$datePicker",null)}static get EDITOR_TYPE(){return BD}init(){if(typeof K!="function")throw new Error("You need to include moment.js to your project.");if(typeof hb!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(Ce(this.datePicker,/ht-theme-.*/g),Y(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Y(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();Ce(this.datePicker,/ht-theme-.*/g),Y(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{ye(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:fx})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(fx),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),i=e?BR(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new hb(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(K),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,K(s,n,!0).isValid()&&this.$datePicker.setMoment(K(s,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,K(s,n,!0).isValid()&&this.$datePicker.setMoment(K(s,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&fd(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=K(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Ut.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(n=s.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+kt(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Yt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const zX="dropdown";class GT extends zT{static get EDITOR_TYPE(){return zX}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}oe.getSingleton().add("beforeValidate",function(t,e,n){const r=this.propToCol(n);if(Number.isInteger(r)){const i=this.getCellMeta(e,r);i.editor===GT&&i.strict===void 0&&(i.filter=!1,i.strict=!0)}});const YX="numeric";class UD extends yl{static get EDITOR_TYPE(){return YX}}function GX(t,e,n){return(e=qX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qX(t){var e=KX(t,"string");return typeof e=="symbol"?e:e+""}function KX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XX="password";class zD extends yl{constructor(){super(...arguments),GX(this,"autoResize",$D(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return XX}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,yi(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const iy="ht_editor_visible",gx="selectEditor",ZX="select";class YD extends qu{static get EDITOR_TYPE(){return ZX}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...ea()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),Y(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ye(this.selectWrapper,iy)&&Ce(this.selectWrapper,iy),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),yi(this.select),Ne(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Cl(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Ut.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${i}px`,s.width=`${r}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${n}px`,s.margin="0px",Y(this.selectWrapper,iy)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:gx};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(gx)}}const QX="time";class GD extends yl{static get EDITOR_TYPE(){return QX}prepare(e,n,r,i,s,o){super.prepare(e,n,r,i,s,o),this.TEXTAREA.dir="ltr"}}function JX(){sr(qu),sr(zT),sr(WD),sr(jD),sr(GT),sr(UT),sr(UD),sr(zD),sr(YD),sr(yl),sr(GD)}const e4="html";function qT(t,e,n,r,i,s,o){vd.apply(this,[t,e,n,r,i,s,o]),Cl(e,s??"",!1)}qT.RENDERER_TYPE=e4;const t4="autocomplete";function Ku(t,e,n,r,i,s,o){const{rootDocument:a}=t,l=o.allowHtml?qT:oo,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...ea()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,r,i,s,o]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),Y(e,"htAutocomplete"),!t.acArrowListener){const h=new Ur(t);t.acArrowListener=function(d){ye(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Ku.RENDERER_TYPE=t4;const n4="dropdown";function KT(t,e,n,r,i,s,o){Ku.apply(this,[t,e,n,r,i,s,o])}KT.RENDERER_TYPE=n4;const mx=new WeakMap,px=new WeakMap,r4="htBadValue",Au="data-row",Hu="data-col",i4="checkboxRenderer",qD="checkbox";oe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:s,column:o,prop:a}=e;if(i===qD){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(s,o,a,n):l;else if(u){const h=this.getDataAtRowProp(s,u);c=h!==null?h:n}t=c}return t}});function XT(t,e,n,r,i,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;vd.apply(this,[t,e,n,r,i,s,o]),s4(t);let u=o4(a);const c=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),yi(e),s===o.checkedTemplate||Dt(s).toLocaleLowerCase(o.locale)===Dt(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||Dt(s).toLocaleLowerCase(o.locale)===Dt(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:Lt(s)?Y(u,"noValue"):(u.style.display="none",Y(u,r4),h=!0),be(u,[[Au,n],[Hu,r]]),l&&be(u,[Bg(u.checked?t.getTranslatedPhrase($T):t.getTranslatedPhrase(VT)),tN(u.checked),mU()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,s):c.value;else if(c.property){const b=t.getDataAtRowProp(n,c.property);v=b!==null?b:""}const w=a4(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(w),e.appendChild(u)):(w.appendChild(u),u=w):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(w)):(w.insertBefore(u,w.firstChild),u=w))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),mx.has(t)||(mx.set(t,!0),d());function d(){const w=t.getShortcutManager().getContext("grid"),b={group:i4,relativeToGroup:na,position:"before"};w.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var R;return(R=t.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const R=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(R==null?void 0:R.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var R;return(R=t.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}}],b)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=t.getSelectedRange(),b=[],R=new Map;let P=[],O=0;if(w){for(let D=0;D<w.length;D++){const{row:M,col:A}=w[D].getTopStartCorner(),{row:j,col:X}=w[D].getBottomEndCorner();for(let U=M;U<=j;U+=1)for(let Z=A;Z<=X;Z+=1){const J=t.getCellMeta(U,Z);if(J.hidden)continue;const ae={checkedTemplate:J.checkedTemplate,uncheckedTemplate:J.uncheckedTemplate};if(J.type!=="checkbox"){v===!0&&!J.readOnly&&(R.has(b.length)?R.set(b.length,[...R.get(b.length),[U,Z,null]]):R.set(b.length,[[U,Z,null]]));continue}if(J.readOnly===!0)continue;typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);const ne=t.getDataAtCell(U,Z);v===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ne)?P.push([U,Z,J.uncheckedTemplate,ae]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ne)&&P.push([U,Z,J.checkedTemplate,ae]):P.push([U,Z,J.uncheckedTemplate,ae]),O+=1}b.push(O),O=0}P.every(D=>{let[,,M]=D;return M===P[0][2]})?P=P.map(D=>{let[M,A,j]=D;return[M,A,j]}):P=P.map(D=>{let[M,A,,j]=D;return[M,A,j.checkedTemplate]}),P.length>0&&b.forEach((D,M)=>{let A=P.splice(0,D);R.size&&R.has(M)&&(A=[...A,...R.get(M)]),t.setDataAtCell(A)})}}function m(){const v=t.getSelectedRange();if(v){for(let w=0;w<v.length;w++){const b=v[w].getTopStartCorner(),R=v[w].getBottomEndCorner();for(let P=b.row;P<=R.row;P++)for(let O=b.col;O<=R.col;O++){if(t.getCellMeta(P,O).readOnly)continue;const M=t.getCell(P,O);if(M instanceof HTMLElement&&M.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}XT.RENDERER_TYPE=qD;function s4(t){let e=px.get(t);if(!e){const{rootElement:n}=t;e=new Ur(t),e.addEventListener(n,"click",r=>u4(r,t)),e.addEventListener(n,"mouseup",r=>l4(r,t)),e.addEventListener(n,"change",r=>c4(r,t)),px.set(t,e)}return e}function o4(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function a4(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function l4(t,e){const{target:n}=t;ZT(n)&&(!n.hasAttribute(Au)||!n.hasAttribute(Hu)||setTimeout(e.listen,10))}function u4(t,e){const{target:n}=t;if(!ZT(n)||!n.hasAttribute(Au)||!n.hasAttribute(Hu))return;const r=parseInt(n.getAttribute(Au),10),i=parseInt(n.getAttribute(Hu),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function c4(t,e){const{target:n}=t;if(!ZT(n)||!n.hasAttribute(Au)||!n.hasAttribute(Hu))return;const r=parseInt(n.getAttribute(Au),10),i=parseInt(n.getAttribute(Hu),10),s=e.getCellMeta(r,i);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(r,i,o)}}function ZT(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const h4="handsontable";function QT(t,e,n,r,i,s,o){Ku.apply(this,[t,e,n,r,i,s,o])}QT.RENDERER_TYPE=h4;var d4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function f4(t){return t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var sy,wx;function g4(){return wx||(wx=1,sy={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),sy}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var oy,Cx;function KD(){if(Cx)return oy;Cx=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let v="",w=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(w!==l)return-1*n(w,u,c,h,d,f);for(let M=0;M<t.length;M++){let A=t[M];if(v=l.replace(RegExp(`([0-9 ])(${A.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*A.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let b=parseFloat(l);if(isNaN(b))return;let R=h(b);if(R&&R!=="."&&(v=l.replace(new RegExp(`${e(R)}$`),""),v!==l))return n(v,u,c,h,d,f);let P={};Object.keys(f).forEach(M=>{P[f[M]]=M});let O=Object.keys(P).sort().reverse(),D=O.length;for(let M=0;M<D;M++){let A=O[M],j=P[A];if(v=l.replace(A,""),v!==l){let X;switch(j){case"thousand":X=Math.pow(10,3);break;case"million":X=Math.pow(10,6);break;case"billion":X=Math.pow(10,9);break;case"trillion":X=Math.pow(10,12);break}return n(v,u,c,h,d,f)*X}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let v=r(l,u,c);return n(v,u,c,h,d,f)}function s(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function o(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=t_();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),v=c.currentAbbreviations(),w;if(typeof l=="string")s(l,h)?w=o(l):w=i(l,h,d,f,m,v);else if(typeof l=="number")w=l;else return;if(w!==void 0)return w}return oy={unformat:a},oy}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ay,vx;function JT(){if(vx)return ay;vx=1;let t=KD();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(w,b)=>b.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:w=>w.output==="byte"},characteristic:{type:"number",restriction:w=>w>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(w,b)=>b.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:w=>w>=0,message:"value must be positive"},{restriction:(w,b)=>!b.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:w=>w>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(w,b)=>b.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:w=>w.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(w,b){let R=d(w),P=m(b);return R&&P}function d(w){return t.unformat(w)!==void 0}function f(w,b,R,P=!1){let O=Object.keys(w).map(D=>{if(!b[D])return console.error(`${R} Invalid key: ${D}`),!1;let M=w[D],A=b[D];if(typeof A=="string"&&(A={type:A}),A.type==="format"){if(!f(M,u,`[Validate ${D}]`,!0))return!1}else if(typeof M!==A.type)return console.error(`${R} ${D} type mismatched: "${A.type}" expected, "${typeof M}" provided`),!1;if(A.restrictions&&A.restrictions.length){let j=A.restrictions.length;for(let X=0;X<j;X++){let{restriction:U,message:Z}=A.restrictions[X];if(!U(M,w))return console.error(`${R} ${D} invalid value: ${Z}`),!1}}return A.restriction&&!A.restriction(M,w)?(console.error(`${R} ${D} invalid value: ${A.message}`),!1):A.validValues&&A.validValues.indexOf(M)===-1?(console.error(`${R} ${D} invalid value: must be among ${JSON.stringify(A.validValues)}, "${M}" provided`),!1):!(A.children&&!f(M,A.children,`[Validate ${D}]`))});return P||O.push(...Object.keys(b).map(D=>{let M=b[D];if(typeof M=="string"&&(M={type:M}),M.mandatory){let A=M.mandatory;if(typeof A=="function"&&(A=A(w)),A&&w[D]===void 0)return console.error(`${R} Missing mandatory key "${D}"`),!1}return!0})),O.reduce((D,M)=>D&&M,!0)}function m(w){return f(w,u,"[Validate format]")}function v(w){return f(w,c,"[Validate language]")}return ay={validate:h,validateFormat:m,validateInput:d,validateLanguage:v},ay}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function m4(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function p4(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function w4(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function C4(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function v4(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function y4(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function S4(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function b4(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function R4(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function E4(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function T4(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function _4(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function M4(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function I4(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function P4(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function O4(t,e={}){return typeof t!="string"?t:(t=m4(t,e),t=p4(t,e),w4(t,e),y4(t,e),S4(t,e),M4(t,e),E4(t,e),T4(t,e),b4(t,e),_4(t,e),R4(t,e),C4(t,e),v4(t,e),I4(t,e),P4(t,e),e)}var e_={parseFormat:O4};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ly,yx;function t_(){if(yx)return ly;yx=1;const t=g4(),e=JT(),n=e_;let r={},i,s={},o=null,a={};function l(c){i=c}function u(){return s[i]}return r.languages=()=>Object.assign({},s),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>o,r.setZeroFormat=c=>o=typeof c=="string"?c:null,r.hasZeroFormat=()=>o!==null,r.languageData=c=>{if(c){if(s[c])return s[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");s[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!s[c]){let d=c.split("-")[0],f=Object.keys(s).find(m=>m.split("-")[0]===d);if(!s[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,ly=r,ly}function x4(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function A4(t,e){t.forEach(n=>{let r;try{r=x4(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var H4=t=>({loadLanguagesInNode:e=>A4(e,t)}),XD={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(M){var A,j,X,U=E.prototype={constructor:E,toString:null,valueOf:null},Z=new E(1),J=20,ae=4,ne=-7,fe=21,mt=-1e7,Te=1e7,$e=!1,Et=1,en=0,g={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},p="0123456789abcdefghijklmnopqrstuvwxyz",y=!0;function E(C,S){var T,F,I,k,B,x,L,$,V=this;if(!(V instanceof E))return new E(C,S);if(S==null){if(C&&C._isBigNumber===!0){V.s=C.s,!C.c||C.e>Te?V.c=V.e=null:C.e<mt?V.c=[V.e=0]:(V.e=C.e,V.c=C.c.slice());return}if((x=typeof C=="number")&&C*0==0){if(V.s=1/C<0?(C=-C,-1):1,C===~~C){for(k=0,B=C;B>=10;B/=10,k++);k>Te?V.c=V.e=null:(V.e=k,V.c=[C]);return}$=String(C)}else{if(!r.test($=String(C)))return X(V,$,x);V.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}(k=$.indexOf("."))>-1&&($=$.replace(".","")),(B=$.search(/e/i))>0?(k<0&&(k=B),k+=+$.slice(B+1),$=$.substring(0,B)):k<0&&(k=$.length)}else{if(R(S,2,p.length,"Base"),S==10&&y)return V=new E(C),G(V,J+V.e+1,ae);if($=String(C),x=typeof C=="number"){if(C*0!=0)return X(V,$,x,S);if(V.s=1/C<0?($=$.slice(1),-1):1,E.DEBUG&&$.replace(/^0\.0*|\./,"").length>15)throw Error(a+C)}else V.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(T=p.slice(0,S),k=B=0,L=$.length;B<L;B++)if(T.indexOf(F=$.charAt(B))<0){if(F=="."){if(B>k){k=L;continue}}else if(!I&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){I=!0,B=-1,k=0;continue}return X(V,String(C),x,S)}x=!1,$=j($,S,10,V.s),(k=$.indexOf("."))>-1?$=$.replace(".",""):k=$.length}for(B=0;$.charCodeAt(B)===48;B++);for(L=$.length;$.charCodeAt(--L)===48;);if($=$.slice(B,++L)){if(L-=B,x&&E.DEBUG&&L>15&&(C>c||C!==s(C)))throw Error(a+V.s*C);if((k=k-B-1)>Te)V.c=V.e=null;else if(k<mt)V.c=[V.e=0];else{if(V.e=k,V.c=[],B=(k+1)%u,k<0&&(B+=u),B<L){for(B&&V.c.push(+$.slice(0,B)),L-=u;B<L;)V.c.push(+$.slice(B,B+=u));B=u-($=$.slice(B)).length}else B-=L;for(;B--;$+="0");V.c.push(+$)}}else V.c=[V.e=0]}E.clone=m,E.ROUND_UP=0,E.ROUND_DOWN=1,E.ROUND_CEIL=2,E.ROUND_FLOOR=3,E.ROUND_HALF_UP=4,E.ROUND_HALF_DOWN=5,E.ROUND_HALF_EVEN=6,E.ROUND_HALF_CEIL=7,E.ROUND_HALF_FLOOR=8,E.EUCLID=9,E.config=E.set=function(C){var S,T;if(C!=null)if(typeof C=="object"){if(C.hasOwnProperty(S="DECIMAL_PLACES")&&(T=C[S],R(T,0,f,S),J=T),C.hasOwnProperty(S="ROUNDING_MODE")&&(T=C[S],R(T,0,8,S),ae=T),C.hasOwnProperty(S="EXPONENTIAL_AT")&&(T=C[S],T&&T.pop?(R(T[0],-1e9,0,S),R(T[1],0,f,S),ne=T[0],fe=T[1]):(R(T,-1e9,f,S),ne=-(fe=T<0?-T:T))),C.hasOwnProperty(S="RANGE"))if(T=C[S],T&&T.pop)R(T[0],-1e9,-1,S),R(T[1],1,f,S),mt=T[0],Te=T[1];else if(R(T,-1e9,f,S),T)mt=-(Te=T<0?-T:T);else throw Error(o+S+" cannot be zero: "+T);if(C.hasOwnProperty(S="CRYPTO"))if(T=C[S],T===!!T)if(T)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))$e=T;else throw $e=!T,Error(o+"crypto unavailable");else $e=T;else throw Error(o+S+" not true or false: "+T);if(C.hasOwnProperty(S="MODULO_MODE")&&(T=C[S],R(T,0,9,S),Et=T),C.hasOwnProperty(S="POW_PRECISION")&&(T=C[S],R(T,0,f,S),en=T),C.hasOwnProperty(S="FORMAT"))if(T=C[S],typeof T=="object")g=T;else throw Error(o+S+" not an object: "+T);if(C.hasOwnProperty(S="ALPHABET"))if(T=C[S],typeof T=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(T))y=T.slice(0,10)=="0123456789",p=T;else throw Error(o+S+" invalid: "+T)}else throw Error(o+"Object expected: "+C);return{DECIMAL_PLACES:J,ROUNDING_MODE:ae,EXPONENTIAL_AT:[ne,fe],RANGE:[mt,Te],CRYPTO:$e,MODULO_MODE:Et,POW_PRECISION:en,FORMAT:g,ALPHABET:p}},E.isBigNumber=function(C){if(!C||C._isBigNumber!==!0)return!1;if(!E.DEBUG)return!0;var S,T,F=C.c,I=C.e,k=C.s;e:if({}.toString.call(F)=="[object Array]"){if((k===1||k===-1)&&I>=-1e9&&I<=f&&I===s(I)){if(F[0]===0){if(I===0&&F.length===1)return!0;break e}if(S=(I+1)%u,S<1&&(S+=u),String(F[0]).length==S){for(S=0;S<F.length;S++)if(T=F[S],T<0||T>=l||T!==s(T))break e;if(T!==0)return!0}}}else if(F===null&&I===null&&(k===null||k===1||k===-1))return!0;throw Error(o+"Invalid BigNumber: "+C)},E.maximum=E.max=function(){return W(arguments,-1)},E.minimum=E.min=function(){return W(arguments,1)},E.random=function(){var C=9007199254740992,S=Math.random()*C&2097151?function(){return s(Math.random()*C)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(T){var F,I,k,B,x,L=0,$=[],V=new E(Z);if(T==null?T=J:R(T,0,f),B=i(T/u),$e)if(crypto.getRandomValues){for(F=crypto.getRandomValues(new Uint32Array(B*=2));L<B;)x=F[L]*131072+(F[L+1]>>>11),x>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),F[L]=I[0],F[L+1]=I[1]):($.push(x%1e14),L+=2);L=B/2}else if(crypto.randomBytes){for(F=crypto.randomBytes(B*=7);L<B;)x=(F[L]&31)*281474976710656+F[L+1]*1099511627776+F[L+2]*4294967296+F[L+3]*16777216+(F[L+4]<<16)+(F[L+5]<<8)+F[L+6],x>=9e15?crypto.randomBytes(7).copy(F,L):($.push(x%1e14),L+=7);L=B/7}else throw $e=!1,Error(o+"crypto unavailable");if(!$e)for(;L<B;)x=S(),x<9e15&&($[L++]=x%1e14);for(B=$[--L],T%=u,B&&T&&(x=h[u-T],$[L]=s(B/x)*x);$[L]===0;$.pop(),L--);if(L<0)$=[k=0];else{for(k=-1;$[0]===0;$.splice(0,1),k-=u);for(L=1,x=$[0];x>=10;x/=10,L++);L<u&&(k-=u-L)}return V.e=k,V.c=$,V}}(),E.sum=function(){for(var C=1,S=arguments,T=new E(S[0]);C<S.length;)T=T.plus(S[C++]);return T},j=function(){var C="0123456789";function S(T,F,I,k){for(var B,x=[0],L,$=0,V=T.length;$<V;){for(L=x.length;L--;x[L]*=F);for(x[0]+=k.indexOf(T.charAt($++)),B=0;B<x.length;B++)x[B]>I-1&&(x[B+1]==null&&(x[B+1]=0),x[B+1]+=x[B]/I|0,x[B]%=I)}return x.reverse()}return function(T,F,I,k,B){var x,L,$,V,z,se,ue,Re,Be=T.indexOf("."),Ge=J,Ee=ae;for(Be>=0&&(V=en,en=0,T=T.replace(".",""),Re=new E(F),se=Re.pow(T.length-Be),en=V,Re.c=S(D(w(se.c),se.e,"0"),10,I,C),Re.e=Re.c.length),ue=S(T,F,I,B?(x=p,C):(x=C,p)),$=V=ue.length;ue[--V]==0;ue.pop());if(!ue[0])return x.charAt(0);if(Be<0?--$:(se.c=ue,se.e=$,se.s=k,se=A(se,Re,Ge,Ee,I),ue=se.c,z=se.r,$=se.e),L=$+Ge+1,Be=ue[L],V=I/2,z=z||L<0||ue[L+1]!=null,z=Ee<4?(Be!=null||z)&&(Ee==0||Ee==(se.s<0?3:2)):Be>V||Be==V&&(Ee==4||z||Ee==6&&ue[L-1]&1||Ee==(se.s<0?8:7)),L<1||!ue[0])T=z?D(x.charAt(1),-Ge,x.charAt(0)):x.charAt(0);else{if(ue.length=L,z)for(--I;++ue[--L]>I;)ue[L]=0,L||(++$,ue=[1].concat(ue));for(V=ue.length;!ue[--V];);for(Be=0,T="";Be<=V;T+=x.charAt(ue[Be++]));T=D(T,$,x.charAt(0))}return T}}(),A=function(){function C(F,I,k){var B,x,L,$,V=0,z=F.length,se=I%d,ue=I/d|0;for(F=F.slice();z--;)L=F[z]%d,$=F[z]/d|0,B=ue*L+$*se,x=se*L+B%d*d+V,V=(x/k|0)+(B/d|0)+ue*$,F[z]=x%k;return V&&(F=[V].concat(F)),F}function S(F,I,k,B){var x,L;if(k!=B)L=k>B?1:-1;else for(x=L=0;x<k;x++)if(F[x]!=I[x]){L=F[x]>I[x]?1:-1;break}return L}function T(F,I,k,B){for(var x=0;k--;)F[k]-=x,x=F[k]<I[k]?1:0,F[k]=x*B+F[k]-I[k];for(;!F[0]&&F.length>1;F.splice(0,1));}return function(F,I,k,B,x){var L,$,V,z,se,ue,Re,Be,Ge,Ee,Oe,$t,Xr,Mi,fn,tn,Vt,wt=F.s==I.s?1:-1,nt=F.c,Ve=I.c;if(!nt||!nt[0]||!Ve||!Ve[0])return new E(!F.s||!I.s||(nt?Ve&&nt[0]==Ve[0]:!Ve)?NaN:nt&&nt[0]==0||!Ve?wt*0:wt/0);for(Be=new E(wt),Ge=Be.c=[],$=F.e-I.e,wt=k+$+1,x||(x=l,$=v(F.e/u)-v(I.e/u),wt=wt/u|0),V=0;Ve[V]==(nt[V]||0);V++);if(Ve[V]>(nt[V]||0)&&$--,wt<0)Ge.push(1),z=!0;else{for(Mi=nt.length,tn=Ve.length,V=0,wt+=2,se=s(x/(Ve[0]+1)),se>1&&(Ve=C(Ve,se,x),nt=C(nt,se,x),tn=Ve.length,Mi=nt.length),Xr=tn,Ee=nt.slice(0,tn),Oe=Ee.length;Oe<tn;Ee[Oe++]=0);Vt=Ve.slice(),Vt=[0].concat(Vt),fn=Ve[0],Ve[1]>=x/2&&fn++;do{if(se=0,L=S(Ve,Ee,tn,Oe),L<0){if($t=Ee[0],tn!=Oe&&($t=$t*x+(Ee[1]||0)),se=s($t/fn),se>1)for(se>=x&&(se=x-1),ue=C(Ve,se,x),Re=ue.length,Oe=Ee.length;S(ue,Ee,Re,Oe)==1;)se--,T(ue,tn<Re?Vt:Ve,Re,x),Re=ue.length,L=1;else se==0&&(L=se=1),ue=Ve.slice(),Re=ue.length;if(Re<Oe&&(ue=[0].concat(ue)),T(Ee,ue,Oe,x),Oe=Ee.length,L==-1)for(;S(Ve,Ee,tn,Oe)<1;)se++,T(Ee,tn<Oe?Vt:Ve,Oe,x),Oe=Ee.length}else L===0&&(se++,Ee=[0]);Ge[V++]=se,Ee[0]?Ee[Oe++]=nt[Xr]||0:(Ee=[nt[Xr]],Oe=1)}while((Xr++<Mi||Ee[0]!=null)&&wt--);z=Ee[0]!=null,Ge[0]||Ge.splice(0,1)}if(x==l){for(V=1,wt=Ge[0];wt>=10;wt/=10,V++);G(Be,k+(Be.e=V+$*u-1)+1,B,z)}else Be.e=$,Be.r=+z;return Be}}();function H(C,S,T,F){var I,k,B,x,L;if(T==null?T=ae:R(T,0,8),!C.c)return C.toString();if(I=C.c[0],B=C.e,S==null)L=w(C.c),L=F==1||F==2&&(B<=ne||B>=fe)?O(L,B):D(L,B,"0");else if(C=G(new E(C),S,T),k=C.e,L=w(C.c),x=L.length,F==1||F==2&&(S<=k||k<=ne)){for(;x<S;L+="0",x++);L=O(L,k)}else if(S-=B,L=D(L,k,"0"),k+1>x){if(--S>0)for(L+=".";S--;L+="0");}else if(S+=k-x,S>0)for(k+1==x&&(L+=".");S--;L+="0");return C.s<0&&I?"-"+L:L}function W(C,S){for(var T,F,I=1,k=new E(C[0]);I<C.length;I++)F=new E(C[I]),(!F.s||(T=b(k,F))===S||T===0&&k.s===S)&&(k=F);return k}function q(C,S,T){for(var F=1,I=S.length;!S[--I];S.pop());for(I=S[0];I>=10;I/=10,F++);return(T=F+T*u-1)>Te?C.c=C.e=null:T<mt?C.c=[C.e=0]:(C.e=T,C.c=S),C}X=function(){var C=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,T=/^\.([^.]+)$/,F=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,B,x,L){var $,V=x?B:B.replace(I,"");if(F.test(V))k.s=isNaN(V)?null:V<0?-1:1;else{if(!x&&(V=V.replace(C,function(z,se,ue){return $=(ue=ue.toLowerCase())=="x"?16:ue=="b"?2:8,!L||L==$?se:z}),L&&($=L,V=V.replace(S,"$1").replace(T,"0.$1")),B!=V))return new E(V,$);if(E.DEBUG)throw Error(o+"Not a"+(L?" base "+L:"")+" number: "+B);k.s=null}k.c=k.e=null}}();function G(C,S,T,F){var I,k,B,x,L,$,V,z=C.c,se=h;if(z){e:{for(I=1,x=z[0];x>=10;x/=10,I++);if(k=S-I,k<0)k+=u,B=S,L=z[$=0],V=s(L/se[I-B-1]%10);else if($=i((k+1)/u),$>=z.length)if(F){for(;z.length<=$;z.push(0));L=V=0,I=1,k%=u,B=k-u+1}else break e;else{for(L=x=z[$],I=1;x>=10;x/=10,I++);k%=u,B=k-u+I,V=B<0?0:s(L/se[I-B-1]%10)}if(F=F||S<0||z[$+1]!=null||(B<0?L:L%se[I-B-1]),F=T<4?(V||F)&&(T==0||T==(C.s<0?3:2)):V>5||V==5&&(T==4||F||T==6&&(k>0?B>0?L/se[I-B]:0:z[$-1])%10&1||T==(C.s<0?8:7)),S<1||!z[0])return z.length=0,F?(S-=C.e+1,z[0]=se[(u-S%u)%u],C.e=-S||0):z[0]=C.e=0,C;if(k==0?(z.length=$,x=1,$--):(z.length=$+1,x=se[u-k],z[$]=B>0?s(L/se[I-B]%se[B])*x:0),F)for(;;)if($==0){for(k=1,B=z[0];B>=10;B/=10,k++);for(B=z[0]+=x,x=1;B>=10;B/=10,x++);k!=x&&(C.e++,z[0]==l&&(z[0]=1));break}else{if(z[$]+=x,z[$]!=l)break;z[$--]=0,x=1}for(k=z.length;z[--k]===0;z.pop());}C.e>Te?C.c=C.e=null:C.e<mt&&(C.c=[C.e=0])}return C}function le(C){var S,T=C.e;return T===null?C.toString():(S=w(C.c),S=T<=ne||T>=fe?O(S,T):D(S,T,"0"),C.s<0?"-"+S:S)}return U.absoluteValue=U.abs=function(){var C=new E(this);return C.s<0&&(C.s=1),C},U.comparedTo=function(C,S){return b(this,new E(C,S))},U.decimalPlaces=U.dp=function(C,S){var T,F,I,k=this;if(C!=null)return R(C,0,f),S==null?S=ae:R(S,0,8),G(new E(k),C+k.e+1,S);if(!(T=k.c))return null;if(F=((I=T.length-1)-v(this.e/u))*u,I=T[I])for(;I%10==0;I/=10,F--);return F<0&&(F=0),F},U.dividedBy=U.div=function(C,S){return A(this,new E(C,S),J,ae)},U.dividedToIntegerBy=U.idiv=function(C,S){return A(this,new E(C,S),0,1)},U.exponentiatedBy=U.pow=function(C,S){var T,F,I,k,B,x,L,$,V,z=this;if(C=new E(C),C.c&&!C.isInteger())throw Error(o+"Exponent not an integer: "+le(C));if(S!=null&&(S=new E(S)),x=C.e>14,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!C.c||!C.c[0])return V=new E(Math.pow(+le(z),x?C.s*(2-P(C)):+le(C))),S?V.mod(S):V;if(L=C.s<0,S){if(S.c?!S.c[0]:!S.s)return new E(NaN);F=!L&&z.isInteger()&&S.isInteger(),F&&(z=z.mod(S))}else{if(C.e>9&&(z.e>0||z.e<-1||(z.e==0?z.c[0]>1||x&&z.c[1]>=24e7:z.c[0]<8e13||x&&z.c[0]<=9999975e7)))return k=z.s<0&&P(C)?-0:0,z.e>-1&&(k=1/k),new E(L?1/k:k);en&&(k=i(en/u+2))}for(x?(T=new E(.5),L&&(C.s=1),$=P(C)):(I=Math.abs(+le(C)),$=I%2),V=new E(Z);;){if($){if(V=V.times(z),!V.c)break;k?V.c.length>k&&(V.c.length=k):F&&(V=V.mod(S))}if(I){if(I=s(I/2),I===0)break;$=I%2}else if(C=C.times(T),G(C,C.e+1,1),C.e>14)$=P(C);else{if(I=+le(C),I===0)break;$=I%2}z=z.times(z),k?z.c&&z.c.length>k&&(z.c.length=k):F&&(z=z.mod(S))}return F?V:(L&&(V=Z.div(V)),S?V.mod(S):k?G(V,en,ae,B):V)},U.integerValue=function(C){var S=new E(this);return C==null?C=ae:R(C,0,8),G(S,S.e+1,C)},U.isEqualTo=U.eq=function(C,S){return b(this,new E(C,S))===0},U.isFinite=function(){return!!this.c},U.isGreaterThan=U.gt=function(C,S){return b(this,new E(C,S))>0},U.isGreaterThanOrEqualTo=U.gte=function(C,S){return(S=b(this,new E(C,S)))===1||S===0},U.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},U.isLessThan=U.lt=function(C,S){return b(this,new E(C,S))<0},U.isLessThanOrEqualTo=U.lte=function(C,S){return(S=b(this,new E(C,S)))===-1||S===0},U.isNaN=function(){return!this.s},U.isNegative=function(){return this.s<0},U.isPositive=function(){return this.s>0},U.isZero=function(){return!!this.c&&this.c[0]==0},U.minus=function(C,S){var T,F,I,k,B=this,x=B.s;if(C=new E(C,S),S=C.s,!x||!S)return new E(NaN);if(x!=S)return C.s=-S,B.plus(C);var L=B.e/u,$=C.e/u,V=B.c,z=C.c;if(!L||!$){if(!V||!z)return V?(C.s=-S,C):new E(z?B:NaN);if(!V[0]||!z[0])return z[0]?(C.s=-S,C):new E(V[0]?B:ae==3?-0:0)}if(L=v(L),$=v($),V=V.slice(),x=L-$){for((k=x<0)?(x=-x,I=V):($=L,I=z),I.reverse(),S=x;S--;I.push(0));I.reverse()}else for(F=(k=(x=V.length)<(S=z.length))?x:S,x=S=0;S<F;S++)if(V[S]!=z[S]){k=V[S]<z[S];break}if(k&&(I=V,V=z,z=I,C.s=-C.s),S=(F=z.length)-(T=V.length),S>0)for(;S--;V[T++]=0);for(S=l-1;F>x;){if(V[--F]<z[F]){for(T=F;T&&!V[--T];V[T]=S);--V[T],V[F]+=l}V[F]-=z[F]}for(;V[0]==0;V.splice(0,1),--$);return V[0]?q(C,V,$):(C.s=ae==3?-1:1,C.c=[C.e=0],C)},U.modulo=U.mod=function(C,S){var T,F,I=this;return C=new E(C,S),!I.c||!C.s||C.c&&!C.c[0]?new E(NaN):!C.c||I.c&&!I.c[0]?new E(I):(Et==9?(F=C.s,C.s=1,T=A(I,C,0,3),C.s=F,T.s*=F):T=A(I,C,0,Et),C=I.minus(T.times(C)),!C.c[0]&&Et==1&&(C.s=I.s),C)},U.multipliedBy=U.times=function(C,S){var T,F,I,k,B,x,L,$,V,z,se,ue,Re,Be,Ge,Ee=this,Oe=Ee.c,$t=(C=new E(C,S)).c;if(!Oe||!$t||!Oe[0]||!$t[0])return!Ee.s||!C.s||Oe&&!Oe[0]&&!$t||$t&&!$t[0]&&!Oe?C.c=C.e=C.s=null:(C.s*=Ee.s,!Oe||!$t?C.c=C.e=null:(C.c=[0],C.e=0)),C;for(F=v(Ee.e/u)+v(C.e/u),C.s*=Ee.s,L=Oe.length,z=$t.length,L<z&&(Re=Oe,Oe=$t,$t=Re,I=L,L=z,z=I),I=L+z,Re=[];I--;Re.push(0));for(Be=l,Ge=d,I=z;--I>=0;){for(T=0,se=$t[I]%Ge,ue=$t[I]/Ge|0,B=L,k=I+B;k>I;)$=Oe[--B]%Ge,V=Oe[B]/Ge|0,x=ue*$+V*se,$=se*$+x%Ge*Ge+Re[k]+T,T=($/Be|0)+(x/Ge|0)+ue*V,Re[k--]=$%Be;Re[k]=T}return T?++F:Re.splice(0,1),q(C,Re,F)},U.negated=function(){var C=new E(this);return C.s=-C.s||null,C},U.plus=function(C,S){var T,F=this,I=F.s;if(C=new E(C,S),S=C.s,!I||!S)return new E(NaN);if(I!=S)return C.s=-S,F.minus(C);var k=F.e/u,B=C.e/u,x=F.c,L=C.c;if(!k||!B){if(!x||!L)return new E(I/0);if(!x[0]||!L[0])return L[0]?C:new E(x[0]?F:I*0)}if(k=v(k),B=v(B),x=x.slice(),I=k-B){for(I>0?(B=k,T=L):(I=-I,T=x),T.reverse();I--;T.push(0));T.reverse()}for(I=x.length,S=L.length,I-S<0&&(T=L,L=x,x=T,S=I),I=0;S;)I=(x[--S]=x[S]+L[S]+I)/l|0,x[S]=l===x[S]?0:x[S]%l;return I&&(x=[I].concat(x),++B),q(C,x,B)},U.precision=U.sd=function(C,S){var T,F,I,k=this;if(C!=null&&C!==!!C)return R(C,1,f),S==null?S=ae:R(S,0,8),G(new E(k),C,S);if(!(T=k.c))return null;if(I=T.length-1,F=I*u+1,I=T[I]){for(;I%10==0;I/=10,F--);for(I=T[0];I>=10;I/=10,F++);}return C&&k.e+1>F&&(F=k.e+1),F},U.shiftedBy=function(C){return R(C,-9007199254740991,c),this.times("1e"+C)},U.squareRoot=U.sqrt=function(){var C,S,T,F,I,k=this,B=k.c,x=k.s,L=k.e,$=J+4,V=new E("0.5");if(x!==1||!B||!B[0])return new E(!x||x<0&&(!B||B[0])?NaN:B?k:1/0);if(x=Math.sqrt(+le(k)),x==0||x==1/0?(S=w(B),(S.length+L)%2==0&&(S+="0"),x=Math.sqrt(+S),L=v((L+1)/2)-(L<0||L%2),x==1/0?S="5e"+L:(S=x.toExponential(),S=S.slice(0,S.indexOf("e")+1)+L),T=new E(S)):T=new E(x+""),T.c[0]){for(L=T.e,x=L+$,x<3&&(x=0);;)if(I=T,T=V.times(I.plus(A(k,I,$,1))),w(I.c).slice(0,x)===(S=w(T.c)).slice(0,x))if(T.e<L&&--x,S=S.slice(x-3,x+1),S=="9999"||!F&&S=="4999"){if(!F&&(G(I,I.e+J+2,0),I.times(I).eq(k))){T=I;break}$+=4,x+=4,F=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(G(T,T.e+J+2,1),C=!T.times(T).eq(k));break}}return G(T,T.e+J+1,ae,C)},U.toExponential=function(C,S){return C!=null&&(R(C,0,f),C++),H(this,C,S,1)},U.toFixed=function(C,S){return C!=null&&(R(C,0,f),C=C+this.e+1),H(this,C,S)},U.toFormat=function(C,S,T){var F,I=this;if(T==null)C!=null&&S&&typeof S=="object"?(T=S,S=null):C&&typeof C=="object"?(T=C,C=S=null):T=g;else if(typeof T!="object")throw Error(o+"Argument not an object: "+T);if(F=I.toFixed(C,S),I.c){var k,B=F.split("."),x=+T.groupSize,L=+T.secondaryGroupSize,$=T.groupSeparator||"",V=B[0],z=B[1],se=I.s<0,ue=se?V.slice(1):V,Re=ue.length;if(L&&(k=x,x=L,L=k,Re-=k),x>0&&Re>0){for(k=Re%x||x,V=ue.substr(0,k);k<Re;k+=x)V+=$+ue.substr(k,x);L>0&&(V+=$+ue.slice(k)),se&&(V="-"+V)}F=z?V+(T.decimalSeparator||"")+((L=+T.fractionGroupSize)?z.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(T.fractionGroupSeparator||"")):z):V}return(T.prefix||"")+F+(T.suffix||"")},U.toFraction=function(C){var S,T,F,I,k,B,x,L,$,V,z,se,ue=this,Re=ue.c;if(C!=null&&(x=new E(C),!x.isInteger()&&(x.c||x.s!==1)||x.lt(Z)))throw Error(o+"Argument "+(x.isInteger()?"out of range: ":"not an integer: ")+le(x));if(!Re)return new E(ue);for(S=new E(Z),$=T=new E(Z),F=L=new E(Z),se=w(Re),k=S.e=se.length-ue.e-1,S.c[0]=h[(B=k%u)<0?u+B:B],C=!C||x.comparedTo(S)>0?k>0?S:$:x,B=Te,Te=1/0,x=new E(se),L.c[0]=0;V=A(x,S,0,1),I=T.plus(V.times(F)),I.comparedTo(C)!=1;)T=F,F=I,$=L.plus(V.times(I=$)),L=I,S=x.minus(V.times(I=S)),x=I;return I=A(C.minus(T),F,0,1),L=L.plus(I.times($)),T=T.plus(I.times(F)),L.s=$.s=ue.s,k=k*2,z=A($,F,k,ae).minus(ue).abs().comparedTo(A(L,T,k,ae).minus(ue).abs())<1?[$,F]:[L,T],Te=B,z},U.toNumber=function(){return+le(this)},U.toPrecision=function(C,S){return C!=null&&R(C,1,f),H(this,C,S,2)},U.toString=function(C){var S,T=this,F=T.s,I=T.e;return I===null?F?(S="Infinity",F<0&&(S="-"+S)):S="NaN":(C==null?S=I<=ne||I>=fe?O(w(T.c),I):D(w(T.c),I,"0"):C===10&&y?(T=G(new E(T),J+I+1,ae),S=D(w(T.c),T.e,"0")):(R(C,2,p.length,"Base"),S=j(D(w(T.c),I,"0"),10,C,F,!0)),F<0&&T.c[0]&&(S="-"+S)),S},U.valueOf=U.toJSON=function(){return le(this)},U._isBigNumber=!0,M!=null&&E.set(M),E}function v(M){var A=M|0;return M>0||M===A?A:A-1}function w(M){for(var A,j,X=1,U=M.length,Z=M[0]+"";X<U;){for(A=M[X++]+"",j=u-A.length;j--;A="0"+A);Z+=A}for(U=Z.length;Z.charCodeAt(--U)===48;);return Z.slice(0,U+1||1)}function b(M,A){var j,X,U=M.c,Z=A.c,J=M.s,ae=A.s,ne=M.e,fe=A.e;if(!J||!ae)return null;if(j=U&&!U[0],X=Z&&!Z[0],j||X)return j?X?0:-ae:J;if(J!=ae)return J;if(j=J<0,X=ne==fe,!U||!Z)return X?0:!U^j?1:-1;if(!X)return ne>fe^j?1:-1;for(ae=(ne=U.length)<(fe=Z.length)?ne:fe,J=0;J<ae;J++)if(U[J]!=Z[J])return U[J]>Z[J]^j?1:-1;return ne==fe?0:ne>fe^j?1:-1}function R(M,A,j,X){if(M<A||M>j||M!==s(M))throw Error(o+(X||"Argument")+(typeof M=="number"?M<A||M>j?" out of range: ":" not an integer: ":" not a primitive number: ")+String(M))}function P(M){var A=M.c.length-1;return v(M.e/u)==A&&M.c[A]%2!=0}function O(M,A){return(M.length>1?M.charAt(0)+"."+M.slice(1):M)+(A<0?"e":"e+")+A}function D(M,A,j){var X,U;if(A<0){for(U=j+".";++A;U+=j);M=U+M}else if(X=M.length,++A>X){for(U=j,A-=X;--A;U+=j);M+=U}else A<X&&(M=M.slice(0,A)+"."+M.slice(A));return M}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(d4)})(XD);var ZD=XD.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const li=t_(),N4=JT(),D4=e_,L4=ZD,bn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},yd={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:QD,decimalSuffixes:tm}=li.currentBytes(),n_={general:{scale:1024,suffixes:tm,marker:"bd"},binary:{scale:1024,suffixes:QD,marker:"b"},decimal:{scale:1e3,suffixes:tm,marker:"d"}};function k4(t,e={},n){if(typeof e=="string"&&(e=D4.parseFormat(e)),!N4.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",s=e.postfix||"",o=F4(t,e,n);return o=r6(o,i),o=i6(o,s),o}function F4(t,e,n){switch(e.output){case"currency":return e=au(e,li.currentCurrencyDefaultFormat()),Y4(t,e,li);case"percent":return e=au(e,li.currentPercentageDefaultFormat()),z4(t,e,li,n);case"byte":return e=au(e,li.currentByteDefaultFormat()),B4(t,e,li,n);case"time":return e=au(e,li.currentTimeDefaultFormat()),U4(t);case"ordinal":return e=au(e,li.currentOrdinalDefaultFormat()),j4(t,e,li);case"number":default:return Sd({instance:t,providedFormat:e,numbro:n})}}function $4(t){let e=n_.decimal;return Cp(t._value,e.suffixes,e.scale).suffix}function V4(t){let e=n_.binary;return Cp(t._value,e.suffixes,e.scale).suffix}function W4(t){let e=n_.general;return Cp(t._value,e.suffixes,e.scale).suffix}function Cp(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let s=1;s<e.length;++s){let o=Math.pow(n,s),a=Math.pow(n,s+1);if(i>=o&&i<a){r=e[s],t=t/o;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function B4(t,e,n,r){let i=e.base||"binary",s=Object.assign({},yd,e);const{binarySuffixes:o,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||tm,marker:"bd"},binary:{scale:1024,suffixes:o||QD,marker:"b"},decimal:{scale:1e3,suffixes:a||tm,marker:"d"}}[i],{value:c,suffix:h}=Cp(t._value,u.suffixes,u.scale);return`${Sd({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${h}`}function j4(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},yd,e),s=Sd({instance:t,providedFormat:e,state:n}),o=r(t._value);return`${s}${i.spaceSeparated?" ":""}${o}`}function U4(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function z4(t,e,n,r){let i=e.prefixSymbol,s=Sd({instance:r(t._value*100),providedFormat:e,state:n}),o=Object.assign({},yd,e);return i?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function Y4(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),s=Object.assign({},yd,i),o,a="",l=!!s.totalLength||!!s.forceAverage||s.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(o=a+c+a);let d=Sd({instance:t,providedFormat:i,state:n,decimalSeparator:o});return u==="prefix"&&(t._value<0&&s.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&s.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function G4({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&bn[e]?(a=r[e],t=t/bn[e]):l>=bn.trillion||n&&o(l/bn.trillion)===1?(a=r.trillion,t=t/bn.trillion):l<bn.trillion&&l>=bn.billion||n&&o(l/bn.billion)===1?(a=r.billion,t=t/bn.billion):l<bn.billion&&l>=bn.million||n&&o(l/bn.million)===1?(a=r.million,t=t/bn.million):(l<bn.million&&l>=bn.thousand||n&&o(l/bn.thousand)===1)&&(a=r.thousand,t=t/bn.thousand),a&&(a=(i?" ":"")+a),s){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(s-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function q4({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let s=1;return s<e&&(i=i*Math.pow(10,e-s),r=+r-(e-s),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function pf(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function K4(t,e){let n=t.toString(),[r,i]=n.split("e"),[s,o=""]=r.split(".");if(+i>0)n=s+o+pf(i-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let l=(pf(-i-1)+Math.abs(s)+o).substr(0,e);l.length<e&&(l+=pf(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${pf(e)}`),n}function X4(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?K4(t,e):new L4(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function Z4(t,e,n,r,i,s){if(r===-1)return t;let o=X4(e,r,s),[a,l=""]=o.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:o.toString()}function Q4(t,e,n,r){let i=t,[s,o]=i.toString().split(".");if(s.match(/^-?0$/)&&n)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),i=i.slice(1)),s.length<r){let l=r-s.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function J4(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function e6(t,e,n,r,i){let s=r.currentDelimiters(),o=s.thousands;i=i||s.decimal;let a=s.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),J4(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+o+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function t6(t,e){return t+e}function n6(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function r6(t,e){return e+t}function i6(t,e){return t+e}function Sd({instance:t,providedFormat:e,state:n=li,decimalSeparator:r,defaults:i=n.currentDefaults()}){let s=t._value;if(s===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},yd,i,e),a=o.totalLength,l=a?0:o.characteristic,u=o.optionalCharacteristic,c=o.forceAverage,h=o.lowPrecision,d=!!a||!!c||o.average,f=a?-1:d&&e.mantissa===void 0?0:o.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:o.optionalMantissa,v=o.trimMantissa,w=o.thousandSeparated,b=o.spaceSeparated,R=o.negative,P=o.forceSign,O=o.exponential,D=o.roundingFunction,M="";if(d){let j=G4({value:s,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:b,roundingFunction:D,totalLength:a});s=j.value,M+=j.abbreviation,a&&(f=j.mantissaPrecision)}if(O){let j=q4({value:s,characteristicPrecision:l});s=j.value,M=j.abbreviation+M}let A=Z4(s.toString(),s,m,f,v,D);return A=Q4(A,s,u,l),A=e6(A,s,w,n,r),(d||O)&&(A=t6(A,M)),(P||s<0)&&(A=n6(A,s,R)),A}function au(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var s6=t=>({format:(...e)=>k4(...e,t),getByteUnit:(...e)=>W4(...e,t),getBinaryByteUnit:(...e)=>V4(...e,t),getDecimalByteUnit:(...e)=>$4(...e,t),formatOrDefault:au});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Js=ZD;function o6(t,e,n){let r=new Js(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Js(i),t._value=r.plus(i).toNumber(),t}function JD(t,e,n){let r=new Js(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Js(i),t._value=r.minus(i).toNumber(),t}function a6(t,e,n){let r=new Js(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Js(i),t._value=r.times(i).toNumber(),t}function l6(t,e,n){let r=new Js(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Js(i),t._value=r.dividedBy(i).toNumber(),t}function u6(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function c6(t,e,n){let r=n(t._value);return JD(r,e,n),Math.abs(r._value)}var h6=t=>({add:(e,n)=>o6(e,n,t),subtract:(e,n)=>JD(e,n,t),multiply:(e,n)=>a6(e,n,t),divide:(e,n)=>l6(e,n,t),set:(e,n)=>u6(e,n,t),difference:(e,n)=>c6(e,n,t),BigNumber:Js});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const d6="2.5.0",ms=t_(),f6=JT(),g6=H4(Gt),m6=KD();let ma=s6(Gt),ja=h6(Gt);const p6=e_;class eL{constructor(e){this._value=e}clone(){return Gt(this._value)}format(e={}){return ma.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=p6.parseFormat(e)),e=ma.formatOrDefault(e,ms.currentCurrencyDefaultFormat()),e.output="currency",ma.format(this,e)}formatTime(e={}){return e.output="time",ma.format(this,e)}binaryByteUnits(){return ma.getBinaryByteUnit(this)}decimalByteUnits(){return ma.getDecimalByteUnit(this)}byteUnits(){return ma.getByteUnit(this)}difference(e){return ja.difference(this,e)}add(e){return ja.add(this,e)}subtract(e){return ja.subtract(this,e)}multiply(e){return ja.multiply(this,e)}divide(e){return ja.divide(this,e)}set(e){return ja.set(this,tL(e))}value(){return this._value}valueOf(){return this._value}}function tL(t){let e=t;return Gt.isNumbro(t)?e=t._value:typeof t=="string"?e=Gt.unformat(t):isNaN(t)&&(e=NaN),e}function Gt(t){return new eL(tL(t))}Gt.version=d6;Gt.isNumbro=function(t){return t instanceof eL};Gt.language=ms.currentLanguage;Gt.registerLanguage=ms.registerLanguage;Gt.setLanguage=ms.setLanguage;Gt.languages=ms.languages;Gt.languageData=ms.languageData;Gt.zeroFormat=ms.setZeroFormat;Gt.defaultFormat=ms.currentDefaults;Gt.setDefaults=ms.setDefaults;Gt.defaultCurrencyFormat=ms.currentCurrencyDefaultFormat;Gt.validate=f6.validate;Gt.loadLanguagesInNode=g6.loadLanguagesInNode;Gt.unformat=m6.unformat;Gt.BigNumber=ja.BigNumber;var w6=Gt,pa=f4(w6);const C6="numeric";function nL(t,e){if(Hn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!pa.languages()[r]){const s=r.replace("-",""),o=pa.allLanguages?pa.allLanguages[r]:pa[s];o&&pa.registerLanguage(o)}pa.setLanguage(r),t=pa(t).format(i||"0")}return t}function r_(t,e,n,r,i,s,o){let a=s;if(Hn(a)){const l=o.className||"",u=l.length?l.split(" "):[];a=nL(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}oo(t,e,n,r,i,a,o)}r_.RENDERER_TYPE=C6;const v6="password";function i_(t,e,n,r,i,s,o){oo.apply(this,[t,e,n,r,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";me(a-1,()=>{u+=l}),Cl(e,u)}i_.RENDERER_TYPE=v6;const y6="select";function s_(t,e,n,r,i,s,o){oo.apply(this,[t,e,n,r,i,s,o])}s_.RENDERER_TYPE=y6;const S6="time";function o_(t,e,n,r,i,s,o){oo.apply(this,[t,e,n,r,i,s,o]),e.dir="ltr"}o_.RENDERER_TYPE=S6;function b6(){Cr(Ku),Cr(vd),Cr(XT),Cr(KT),Cr(QT),Cr(qT),Cr(r_),Cr(i_),Cr(s_),Cr(oo),Cr(o_)}const R6="autocomplete";function vp(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,Sx(n,e)):Sx(n,e)(this.source):e(!0)}vp.VALIDATOR_TYPE=R6;function Sx(t,e){const n=t;return function(r){let i=!1;for(let s=0,o=r.length;s<o;s++)if(n===r[s]){i=!0;break}e(i)}}function rL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const E6=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:rL},Symbol.toStringTag,{value:"Module"})),T6="date";function a_(t,e){const n=NN(BD,this.instance);let r=t,i=!0;r==null&&(r="");let s=K(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),o=K(new Date(r)).isValid()||s;if(this.allowEmpty&&r===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=_6(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}a_.VALIDATOR_TYPE=T6;function _6(t,e){const n=K(rL(t)),r=K(t,e),i=t.search(/[A-z]/g)>-1;let s;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?s=n:s=r,s.format(e)}const M6="dropdown";function l_(t,e){vp.apply(this,[t,e])}l_.VALIDATOR_TYPE=M6;const I6="numeric";function u_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Hn(t))}u_.VALIDATOR_TYPE=I6;const P6=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],O6="time";function c_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=K(i,P6,!0).isValid()?K(i):K(i,n);let a=o.isValid(),l=K(i,n,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}c_.VALIDATOR_TYPE=O6;function x6(){Ga(vp),Ga(l_),Ga(a_),Ga(u_),Ga(c_)}const A6="autocomplete",H6={CELL_TYPE:A6,editor:zT,renderer:Ku,validator:vp},N6="checkbox",D6={CELL_TYPE:N6,editor:WD,renderer:XT},L6="date";function iL(t,e,n,r,i,s,o){Ku.apply(this,[t,e,n,r,i,s,o])}iL.RENDERER_TYPE=L6;const k6="date",F6={CELL_TYPE:k6,editor:jD,renderer:iL,validator:a_},$6="dropdown",V6={CELL_TYPE:$6,editor:GT,renderer:KT,validator:l_},W6="handsontable",B6={CELL_TYPE:W6,editor:UT,renderer:QT},j6="numeric",U6={CELL_TYPE:j6,editor:UD,renderer:r_,validator:u_,dataType:"number"},z6="password",Y6={CELL_TYPE:z6,editor:zD,renderer:i_,copyable:!1},G6="select",q6={CELL_TYPE:G6,editor:YD,renderer:s_},K6="time",X6={CELL_TYPE:K6,editor:GD,renderer:o_,validator:c_};function Z6(){Ar(H6),Ar(D6),Ar(F6),Ar(V6),Ar(B6),Ar(U6),Ar(Y6),Ar(q6),Ar(VD),Ar(X6)}function Q6(t,e){sL(t,e),e.add(t)}function J6(t,e,n){sL(t,e),e.set(t,n)}function sL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(t,e,n){return(e=e9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e9(t){var e=t9(t,"string");return typeof e=="symbol"?e:e+""}function t9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hl(t,e){return t.get(oL(t,e))}function oL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bx=new Map([["plugin",Xz],["cell-type",OD],["editor",HN],["renderer",WN],["validator",BN]]),aL=Symbol("mainSetting"),n9="base",wf=[];let Li=null;var wa=new WeakMap,Rx=new WeakSet;class Ke{static get PLUGIN_KEY(){return n9}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){Q6(this,Rx),Al(this,"eventManager",new Ur(this)),Al(this,"pluginName",null),Al(this,"pluginsInitializedCallbacks",[]),Al(this,"isPluginsReady",!1),Al(this,"enabled",!1),Al(this,"initialized",!1),J6(this,wa,{}),gs(this,"hot",e,{writable:!1}),Li=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(s=>{const[o,a]=s.split(":");if(!bx.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);bx.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");wf.push(s)}}if(Li||(Li=GR()),Li.indexOf("UndoRedo")>=0&&Li.splice(Li.indexOf("UndoRedo"),1),Li.indexOf(this.pluginName)>=0&&Li.splice(Li.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Li.length===0){if(wf.length>0){const i=[`${wf.join(`
`)}
`,"You have to import and register them manually."].join("");throw wf.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||He(n))&&r[aL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(He(n)){var s;return(s=n[e])!==null&&s!==void 0?s:r[e]}return r[e]}addHook(e,n,r){Hl(wa,this)[e]=Hl(wa,this)[e]||[];const i=Hl(wa,this)[e];this.hot.addHook(e,n,r),i.push(n),Hl(wa,this)[e]=i}removeHooks(e){_(Hl(wa,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Hl(wa,this);Ne(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){_(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=oL(Rx,this,r9).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ne(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function r9(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ca(t,e,n){return(e=i9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i9(t){var e=s9(t,"string");return typeof e=="symbol"?e:e+""}function s9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let h_=class{constructor(e){Ca(this,"hot",null),Ca(this,"container",null),Ca(this,"injected",!1),Ca(this,"rows",[]),Ca(this,"columns",[]),Ca(this,"samples",null),Ca(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),_(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),_(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{_(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(s=>{_(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),o.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{_(i.strings,s=>{const o=s.col,a=e.createElement("th");r.push([o,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),_(r,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{_(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return r.style.width=`${s}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),s=n.createElement("thead"),o=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),Y(i,e),r.appendChild(i),{fragment:r,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return Y(i,s),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Cf(t,e,n){return(e=o9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o9(t){var e=a9(t,"string");return typeof e=="symbol"?e:e+""}function a9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yp{static get SAMPLE_COUNT(){return 3}constructor(e){Cf(this,"samples",null),Cf(this,"dataFactory",null),Cf(this,"customSampleCount",null),Cf(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:yp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:s,to:o}=typeof r=="number"?{from:r,to:r}:r;return me(s,o,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return me(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:He(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Dt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),i}}function l9(t,e){lL(t,e),e.add(t)}function Ex(t,e,n){lL(t,e),e.set(t,n)}function lL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _c(t,e,n){return(e=u9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u9(t){var e=c9(t,"string");return typeof e=="symbol"?e:e+""}function c9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ka(t,e){return t.get(es(t,e))}function d_(t,e,n){return t.set(es(t,e),n),n}function es(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutoColumnSizeSeed");const uy="autoColumnSize",h9=10,d9="autoColumnSize";var lu=new WeakMap,Nu=new WeakMap,Os=new WeakSet;class wh extends Ke{static get PLUGIN_KEY(){return uy}static get PLUGIN_PRIORITY(){return h9}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),l9(this,Os),_c(this,"ghostTable",new h_(this.hot)),_c(this,"samplesGenerator",new yp((n,r)=>{const i=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(n,r);let a="";o.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),_c(this,"inProgress",!1),_c(this,"measuredColumns",0),_c(this,"columnWidthsMap",new ta),Ex(this,lu,[]),Ex(this,Nu,[]),this.hot.columnIndexMapper.registerMap(d9,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>es(Os,this,Tx).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[uy]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return es(Os,e,m9).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return es(Os,e,p9).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return es(Os,e,C9).call(e,...i)}),this.addHook("beforeRender",()=>es(Os,this,g9).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>es(Os,this,w9).call(this)),super.enablePlugin()}updatePlugin(){d_(Nu,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>es(Os,this,Tx).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;me(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(o,s).forEach((u,c)=>this.ghostTable.addColumn(c,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Vh(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+wh.CALCULATION_STEP,i)},e,n),r=r+wh.CALCULATION_STEP+1,r<i?s=$h(o):(Vh(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[uy];let n=wh.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return He(e)&&(n=e.syncLimit,ER(n)?n=zR(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Ou))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,s)=>{const o=Ka(lu,this).length;return(o-1<s||Ka(lu,this)[s]!==i)&&r.push(this.hot.toVisualColumn(s)),o-1<s?Ka(lu,this).push(i):Ka(lu,this)[s]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function f9(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||this.samplesGenerator.generateColumnSamples(n,e).forEach((s,o)=>this.ghostTable.addColumn(o,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,r)=>{const i=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function g9(){this.calculateVisibleColumnsWidth(),this.inProgress||(es(Os,this,f9).call(this,Ka(Nu,this)),d_(Nu,this,[]))}function m9(t,e){e||this.recalculateAllColumnsWidth()}function p9(t){const e=t.reduce((n,r)=>{let[,i]=r;const s=this.hot.propToCol(i);return Number.isInteger(s)&&n.indexOf(s)===-1&&n.push(s),n},[]);Ka(Nu,this).push(...e)}function Tx(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function w9(){d_(lu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function C9(t){const e=t.reduce((n,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);Ka(Nu,this).push(...e)}const Xa={horizontal:"horizontal",vertical:"vertical"};function v9(t,e,n){let r,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:r,endOfDragCoords:i}}function y9(t){const e={};return t===!0?(e.directions=Object.keys(Xa),e.autoInsertRow=!0):He(t)?(ce(t.autoInsertRow)?t.direction===Xa.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ce(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Xa)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function S9(t,e){b9(t,e),e.add(t)}function b9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nl(t,e,n){return(e=R9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R9(t){var e=E9(t,"string");return typeof e=="symbol"?e:e+""}function E9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutofillRange");oe.getSingleton().register("beforeAutofill");oe.getSingleton().register("afterAutofill");const _x="autofill",T9=20,_9=["fillHandle"],M9="insert_row_below",I9=200;var Dl=new WeakSet;class P9 extends Ke{constructor(){super(...arguments),S9(this,Dl),Nl(this,"addingStarted",!1),Nl(this,"mouseDownOnCellCorner",!1),Nl(this,"mouseDragOutside",!1),Nl(this,"handleDraggedCells",0),Nl(this,"directions",[]),Nl(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return _x}static get PLUGIN_PRIORITY(){return T9}static get SETTING_KEYS(){return[_x,..._9]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Mc(Dl,this,x9).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Mc(Dl,this,O9).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Mc(Dl,this,A9).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:s}]),a=[],l=[],u=[];return _(o,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),_(a,c=>{const h=[];_(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=v9(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=s.clone(),v=this.hot._createCellRange(h,h,d),w=this.hot.runHooks("beforeAutofill",f,m,v,c);if(w===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=w;const R=w;if(["up","left"].indexOf(c)>-1&&!(R.length===1&&R[0].length===0))if(b=[],c==="up"){const P=d.row-h.row+1,O=P%R.length;for(let D=0;D<P;D++)b.push(R[(D+(R.length-O))%R.length])}else{const P=d.col-h.col+1,O=P%R[0].length;for(let D=0;D<R.length;D++){b.push([]);for(let M=0;M<P;M++)b[D].push(R[D][(M+(R[D].length-O))%R[D].length])}}this.hot.populateFromArray(h.row,h.col,b,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",b,m,v,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Xa.vertical)&&this.directions.includes(Xa.horizontal)){const s=n.getTopStartCorner();(r.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Xa.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Xa.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(M9,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},I9)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let s=e[2]+1;s<r;s++){for(let l=e[1];l<=e[3];l++){const u=n[s][l];if(!Lt(u))return-1}const o=n[s][e[1]-1],a=n[s][e[3]+1];(!Lt(o)||!Lt(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Fe(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=cn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+kt(this.hot.table),i=cn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Yt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Mc(Dl,this,H9).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Mc(Dl,this,N9).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=y9(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function O9(){this.selectAdjacent()&&this.fillIn()}function x9(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function A9(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function H9(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function N9(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function D9(t,e){uL(t,e),e.add(t)}function L9(t,e,n){uL(t,e),e.set(t,n)}function uL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ll(t,e,n){return(e=k9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k9(t){var e=F9(t,"string");return typeof e=="symbol"?e:e+""}function F9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $9(t,e,n){return t.set(ts(t,e),n),n}function f_(t,e){return t.get(ts(t,e))}function ts(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cy="autoRowSize",V9=40,W9="autoRowSize";var Uh=new WeakMap,xs=new WeakSet;class Ch extends Ke{static get PLUGIN_KEY(){return cy}static get PLUGIN_PRIORITY(){return V9}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),D9(this,xs),Ll(this,"headerHeight",null),Ll(this,"ghostTable",new h_(this.hot)),Ll(this,"samplesGenerator",new yp((n,r)=>{const i=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,r):n===-1&&(o=this.hot.getColHeader(r)),{value:o}})),Ll(this,"inProgress",!1),Ll(this,"measuredRows",0),Ll(this,"rowHeightsMap",new ta),L9(this,Uh,[]),this.hot.rowIndexMapper.registerMap(W9,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>ts(xs,this,Mx).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[cy];return e===!0||He(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ts(xs,e,U9).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ts(xs,e,z9).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ts(xs,e,G9).call(e,...i)}),this.addHook("beforeRender",()=>ts(xs,this,j9).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>ts(xs,this,Y9).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>ts(xs,this,Mx).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.renderCall;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}me(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Vh(s),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Ch.CALCULATION_STEP,i)},e,n),r=r+Ch.CALCULATION_STEP+1,r<i?s=$h(o):(Vh(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[cy];let n=Ch.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return He(e)&&(n=e.syncLimit,ER(n)?n=zR(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function B9(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function j9(){this.calculateVisibleRowsHeight(),this.inProgress||(ts(xs,this,B9).call(this,f_(Uh,this)),$9(Uh,this,[]))}function Mx(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function U9(t,e){e||this.recalculateAllRowsHeight()}function z9(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);f_(Uh,this).push(...e)}function Y9(){this.recalculateAllRowsHeight()}function G9(t){const e=t.reduce((n,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);f_(Uh,this).push(...e)}const{getListWithInsertedItems:q9,getListWithRemovedItems:K9}=dD("physicallyIndexed");class X9 extends vl{constructor(){super(e=>e)}insert(e,n){const r=CE(this.indexedValues,n);this.indexedValues=q9(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=K9(this.indexedValues,e);this.indexedValues=wE(n,e),super.remove(e)}}const{getListWithInsertedItems:Z9,getListWithRemovedItems:Q9}=dD("physicallyIndexed");class J9 extends vl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Z9(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=Q9(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function e8(t,e){t8(t,e),e.add(t)}function t8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function n8(t,e,n){return(e=r8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r8(t){var e=i8(t,"string");return typeof e=="symbol"?e:e+""}function i8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ix="bindRowsWithHeaders",o8=210,a8="loose",Px=new Map([["loose",X9],["strict",J9]]);var Ox=new WeakSet;class l8 extends Ke{constructor(){super(...arguments),e8(this,Ox),n8(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Ix}static get PLUGIN_PRIORITY(){return o8}isEnabled(){return!!this.hot.getSettings()[Ix]}enablePlugin(){var e;if(this.enabled)return;const n=(e=Px.get(this.getSetting()))!==null&&e!==void 0?e:Px.get(a8);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>s8(Ox,this,u8).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function u8(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function c8(t,e){cL(t,e),e.add(t)}function h8(t,e,n){cL(t,e),e.set(t,n)}function cL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xx(t,e,n){return(e=d8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d8(t){var e=f8(t,"string");return typeof e=="symbol"?e:e+""}function f8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ax(t,e){return t.get(mu(t,e))}function hy(t,e,n){return t.set(mu(t,e),n),n}function mu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Eg="collapsibleColumns",g8=290,m8=["nestedHeaders"],Tu="collapsibleIndicator",Hx=Eg,Nx=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var kl=new WeakMap,Ic=new WeakSet;class p8 extends Ke{constructor(){super(...arguments),c8(this,Ic),xx(this,"nestedHeadersPlugin",null),xx(this,"headerStateManager",null),h8(this,kl,null)}static get PLUGIN_KEY(){return Eg}static get PLUGIN_PRIORITY(){return g8}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Eg,...m8]}isEnabled(){return!!this.hot.getSettings()[Eg]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||tt("You need to configure the Nested Headers plugin in order to use collapsible headers."),hy(kl,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>mu(Ic,this,v8).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return mu(Ic,e,y8).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return mu(Ic,e,w8).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,s)=>mu(Ic,this,C8).call(this,r,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),hy(kl,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:n,col:o}):this.collapseSection({row:n,col:o}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:Hx,relativeToGroup:na,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Hx)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};me(0,e-1,o=>{const a=n.childNodes[o],l=r.childNodes[o],u=i?i.childNodes[o]:null;me(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Tu}`);s(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Tu}`),s(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Tu}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=r;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!Nx.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Qs(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;_(r,f=>{var m;let{row:v,col:w}=f;const{collapsible:b,isCollapsed:R}=(m=this.headerStateManager.getHeaderSettings(v,w))!==null&&m!==void 0?m:{};if(!b||R&&n==="collapse"||!R&&n==="expand")return i=!1,!1});const s=[],o=[];i&&_(r,f=>{let{row:m,col:v}=f;const{colspanCompensation:w,affectedColumns:b,rollbackModification:R}=this.headerStateManager.triggerNodeModification(n,m,v);w>0&&(o.push(...b),s.push(R))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=bR([...a,...o]):n==="expand"&&(l=Qs(a,f=>!o.includes(f)));const u=Nx.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){_(s,f=>{f()});return}this.hot.batchExecution(()=>{_(o,f=>{Ax(kl,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&o.includes(m)){const w=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,b=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;w!==null&&b!==null&&this.hot.selectCell(w,b)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return Ax(kl,this).getHiddenIndexes()}destroy(){hy(kl,this,null),super.destroy()}}function w8(t,e,n){var r;const{collapsible:i,origColspan:s,isCollapsed:o}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Tu}`);if(wl(e,[Br("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),Y(u,Tu),e.querySelector("div:first-child").appendChild(u)),Ce(u,["collapsed","expanded"]),o?(Y(u,"collapsed"),qo(u,"+"),l&&be(e,...Br(!1))):(Y(u,"expanded"),qo(u,"-"),l&&be(e,...Br(!0))),l&&be(u,...ea());else{var c;(c=u)===null||c===void 0||c.remove()}}function C8(t,e){ye(t.target,Tu)&&(ye(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ye(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Kr(t))}function v8(){this.updatePlugin()}function y8(t,e){e||this.updatePlugin()}function va(t,e,n){return(e=S8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S8(t){var e=b8(t,"string");return typeof e=="symbol"?e:e+""}function b8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const R8=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],E8=!1,T8=!0,_8=!0;class M8{constructor(e,n){va(this,"hot",void 0),va(this,"sortingStates",new dp),va(this,"sortEmptyCells",E8),va(this,"indicator",T8),va(this,"headerAction",_8),va(this,"compareFunctionFactory",void 0),va(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){He(e)&&Ne(e,(n,r)=>{R8.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return He(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ce(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function hL(t,e,n){const r=e.locale;return function(i,s){const{sortEmptyCells:o}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof s=="string"&&(s=s.toLocaleLowerCase(r)),i===s?ls:Lt(i)?Lt(s)?ls:o&&t==="asc"?Ht:Nt:Lt(s)?o&&t==="asc"?Nt:Ht:isNaN(i)&&!isNaN(s)?t==="asc"?Nt:Ht:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?Ht:Nt:i>s?t==="asc"?Nt:Ht:ls}}const dL="default";function I8(t,e,n){return function(r,i){const s=parseFloat(r),o=parseFloat(i),{sortEmptyCells:a}=n;if(s===o||isNaN(s)&&isNaN(o))return ls;if(a){if(Lt(r))return t==="asc"?Ht:Nt;if(Lt(i))return t==="asc"?Nt:Ht}return isNaN(s)?Nt:isNaN(o)?Ht:s<o?t==="asc"?Ht:Nt:s>o?t==="asc"?Nt:Ht:ls}}const P8="numeric";function O8(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=n;return function(o,a){const l=Lt(o),u=Lt(a),c=l?i:o,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(s===!1){if(l&&u===!1)return Nt;if(l===!1&&u)return Ht}return d===!1&&f?t==="asc"?Ht:Nt:d&&f===!1?t==="asc"?Nt:Ht:d===!1&&f===!1?hL(t,e,n)(o,a):c===i&&h===r?t==="asc"?Ht:Nt:c===r&&h===i?t==="asc"?Nt:Ht:ls}}const x8="checkbox";function A8(t,e,n){return CL(t,e.dateFormat,n)}const H8="date";function N8(t,e,n){return CL(t,e.timeFormat,n)}const D8="time",{register:bd,getItem:Dx,hasItem:L8}=_i("sorting.compareFunctionFactory"),{register:fL,getItem:k8}=_i("sorting.mainSortComparator");function gL(t){return L8(t)?Dx(t):Dx(dL)}bd(x8,O8);bd(H8,A8);bd(dL,hL);bd(P8,I8);bd(D8,N8);const ls=0,Ht=-1,Nt=1;function F8(t,e){const n=k8(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t.sort(n(...i))}const nm="asc",rm="desc",mL="colHeader";function $8(t){if(He(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[nm,rm].includes(n)}function V8(t){if(t.some(n=>$8(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function Lx(t){if(t!==rm)return t===nm?rm:nm}function pL(t){return t.querySelector(`.${mL}`)}function wL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function g_(t,e,n){return t===-1&&e>=0&&Ko(n)===!1}function CL(t,e,n){return function(r,i){const{sortEmptyCells:s}=n;if(r===i)return ls;if(Lt(r))return Lt(i)?ls:s&&t==="asc"?Ht:Nt;if(Lt(i))return s&&t==="asc"?Nt:Ht;const o=K(r,e),a=K(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?Ht:Nt:a.isBefore(o)?t==="asc"?Nt:Ht:ls:Ht:Nt}}const W8="ascending",B8="descending",vL="indicatorDisabled",yL="columnSorting",SL="sortAction",bL=new Map([[nm,W8],[rm,B8]]);function j8(t,e,n,r){const i=[yL];if(r&&i.push(SL),n===!1)return i.push(vL),i;const s=t.getSortOrderOfColumn(e);return ce(s)&&i.push(bL.get(s)),i}function U8(){return Array.from(bL.values()).concat(SL,vL,yL)}function z8(t,e){return function(n,r){const[,...i]=n,[,...s]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:gL(u.type))(l,u,d)(c,h)}(0)}}function Y8(t,e){G8(t,e),e.add(t)}function G8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vf(t,e,n){return(e=q8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q8(t){var e=K8(t,"string");return typeof e=="symbol"?e:e+""}function K8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const im="columnSorting",X8=50,sm="append",Z8="replace",kx=im;fL(im,z8);oe.getSingleton().register("beforeColumnSort");oe.getSingleton().register("afterColumnSort");var Ua=new WeakSet;class RL extends Ke{constructor(){super(...arguments),Y8(this,Ua),vf(this,"columnStatesManager",null),vf(this,"columnMetaCache",null),vf(this,"pluginKey",im),vf(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return im}static get PLUGIN_PRIORITY(){return X8}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new M8(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ta(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>uu(Ua,this,Q8).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return uu(Ua,e,e7).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>uu(Ua,this,db).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return uu(Ua,e,J8).call(e,...r)}),this.hot.view&&uu(Ua,this,db).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=pL(r);wL(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:na,position:"before",group:kx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kx)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new fD),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ce(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return V8(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};n.initialConfig=Fe(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return ce(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Fe(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ce(n)){const i=Lx(n);return ce(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:Lx()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sm;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(St(o))return[...s.slice(0,r),...s.slice(r+1)];if(n===sm)return[...s.slice(0,r),...s.slice(r+1),o];if(n===Z8)return[...s.slice(0,r),o,...s.slice(r+1)]}return ce(o)?s.concat(o):s}getPluginColumnConfig(e){if(He(e)){const n=e[this.pluginKey];if(He(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(r,n,this.getPluginColumnConfig(s.columns[e])):dt(s.columns)?Object.assign(r,n,this.getPluginColumnConfig(s.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Fe(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=Fe(n,u=>u[0]);F8(n,this.pluginKey,Fe(e,u=>u.sortOrder),Fe(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const o=Fe(n,u=>u[0]),a=new Map(Fe(s,(u,c)=>[u,o[c]])),l=Fe(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(He(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||He(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Ce(e,U8()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Y(e,j8(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ce(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ye(e.target,mL)}onAfterOnCellMouseDown(e,n){if(g_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function db(){const t=this.getAllSavedSortSettings();if(He(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Q8(t,e){const n=pL(e);if(wL(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,s=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);be(e,...SU(o?`${o}ending`:"none"))}}function J8(t){t===!0&&this.hot.view&&uu(Ua,this,db).call(this)}function e7(t,e,n,r){g_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function ya(t,e,n){return(e=t7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t7(t){var e=n7(t,"string");return typeof e=="symbol"?e:e+""}function n7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r7{constructor(e,n){ya(this,"plugin",void 0),ya(this,"hot",void 0),ya(this,"endpoints",[]),ya(this,"settings",void 0),ya(this,"settingsType","array"),ya(this,"currentEndpoint",null),ya(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),_(r,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),n.push(s)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();_(s,o=>{i==="row"&&o.destinationRow>=n&&(e==="insert_row"?o.alterRowOffset=r:e==="remove_row"&&(o.alterRowOffset=-1*r)),i==="col"&&o.destinationColumn>=n&&(e==="insert_col"?o.alterColumnOffset=r:e==="remove_col"&&(o.alterColumnOffset=-1*r))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,n,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;_(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?_(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):_(u,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){_(e.ranges,s=>{s[1]&&(n>=s[0]&&n<=s[1]?r>s[1]?s[1]+=i:r<s[0]&&(s[0]-=i):r>=s[0]&&r<=s[1]&&(s[1]-=i,n<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];_(n,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),_(i,s=>{let o=[];_(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),r.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),r.push(o))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,_(e.ranges,r=>{_(r,(i,s)=>{i>=n&&(r[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],_(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],_(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],_(e,(r,i,s)=>{`${r[2]||""}`!=`${r[3]}`&&_(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),_(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(n==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){tt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function dy(t){return t==null||isNaN(t)}function i7(t,e){s7(t,e),e.add(t)}function s7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o7(t,e,n){return(e=a7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a7(t){var e=l7(t,"string");return typeof e=="symbol"?e:e+""}function l7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fy="columnSummary",u7=220;var Pc=new WeakSet;class c7 extends Ke{constructor(){super(...arguments),i7(this,Pc),o7(this,"endpoints",null)}static get PLUGIN_KEY(){return fy}static get PLUGIN_PRIORITY(){return u7}isEnabled(){return!!this.hot.getSettings()[fy]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[fy],this.endpoints=new r7(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yf(Pc,e,h7).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yf(Pc,e,f7).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yf(Pc,e,d7).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yf(Pc,e,g7).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ne(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,n),s=dy(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}r+=s||0,i-=1}while(i>=e[0]);return Math.round(r*10**o)/10**o}calculateMinMax(e,n){let r=null;return Ne(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&s!==null&&(r=s),s!==null)switch(n){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,n),o=dy(o)?null:o,i===null)i=o;else if(o!==null)switch(r){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,n){let r,i=0,s=e[1]||e[0];do r=this.getCellValue(s,n),r=dy(r)?null:r,r===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ne(r,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);n+=s,n-=o}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let s=this.hot.getSourceDataAtCell(e,n),o="";if(r!==null&&i!==null&&(o=this.hot.getCellMeta(r,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(it`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function h7(){this.endpoints.initEndpoints()}function d7(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function f7(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function g7(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function m7(t,e){EL(t,e),e.add(t)}function gy(t,e,n){EL(t,e),e.set(t,n)}function EL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cu(t,e){return t.get(m_(t,e))}function fb(t,e,n){return t.set(m_(t,e),n),n}function m_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var om=new WeakMap,Sf=new WeakMap,bf=new WeakMap,Fx=new WeakSet;class TL{constructor(){m7(this,Fx),gy(this,om,!0),gy(this,Sf,null),gy(this,bf,new ResizeObserver(e=>m_(Fx,this,p7).call(this,e)))}setObservedElement(e){fb(Sf,this,e)}unobserve(){cu(bf,this).unobserve(cu(Sf,this))}observe(){fb(om,this,!0),cu(bf,this).observe(cu(Sf,this))}destroy(){cu(bf,this).disconnect()}}function p7(t){if(cu(om,this)||!Array.isArray(t)||!t.length){fb(om,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}st(TL,Tn);function Sa(t,e,n){w7(t,e),e.set(t,n)}function w7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ot(t,e){return t.get(_L(t,e))}function Ts(t,e,n){return t.set(_L(t,e),n),n}function _L(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ba=new WeakMap,my=new WeakMap,_s=new WeakMap,uo=new WeakMap,co=new WeakMap,Rf=new WeakMap,Fl=new WeakMap;class Za{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;Sa(this,ba,void 0),Sa(this,my,!1),Sa(this,_s,null),Sa(this,uo,void 0),Sa(this,co,void 0),Sa(this,Rf,!0),Sa(this,Fl,new TL),Ts(ba,this,e),Ts(my,this,n),Ts(uo,this,this.createEditor()),Ts(co,this,ot(uo,this).style),ot(Fl,this).setObservedElement(this.getInputElement()),ot(Fl,this).addLocalHook("resize",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){ot(co,this).left=`${e}px`,ot(co,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Yt(this.getInputElement()),height:kt(this.getInputElement())}}observeSize(){ot(Fl,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){ot(co,this).display="block",Ts(Rf,this,!1)}hide(){ot(Fl,this).unobserve(),ot(Rf,this)||(ot(co,this).display="none"),Ts(Rf,this,!0)}isVisible(){return ot(co,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return ot(ba,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=ot(ba,this).createElement("div"),n=ot(ba,this).createElement("textarea");return e.style.display="none",Ts(_s,this,ot(ba,this).createElement("div")),ot(_s,this).setAttribute("dir",ot(my,this)?"rtl":"ltr"),Y(ot(_s,this),Za.CLASS_EDITOR_CONTAINER),ot(ba,this).body.appendChild(ot(_s,this)),Y(e,Za.CLASS_EDITOR),Y(n,Za.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),ot(_s,this).appendChild(e),e}getInputElement(){return ot(uo,this).querySelector(`.${Za.CLASS_INPUT}`)}getEditorElement(){return ot(uo,this)}destroy(){const e=ot(_s,this)?ot(_s,this).parentNode:null;ot(uo,this).parentNode.removeChild(ot(uo,this)),Ts(uo,this,null),Ts(co,this,null),ot(Fl,this).destroy(),e&&e.removeChild(ot(_s,this))}}st(Za,Tn);function py(t,e,n){return(e=C7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C7(t){var e=v7(t,"string");return typeof e=="symbol"?e:e+""}function v7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const y7=250,S7=250;class ML{constructor(e){py(this,"wasLastActionShow",!0),py(this,"showDebounced",null),py(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},S7)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y7;this.showDebounced=np(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}st(ML,Tn);function b7(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function R7(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ra(t,e){const n={};return _(t,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&(n[i]||(n[i]=[]),n[i][s]=e(i,s))})}),n}function To(t,e,n,r,i){_(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&E7(o,a,e,n,r,i)})})}function E7(t,e,n,r,i,s){const o=i(t,e);let a=r;o.className&&(n==="vertical"?a=b7(o.className,r):a=R7(o.className,r)),s(t,e,"className",a)}function IL(t){return`<span class="selected">â</span>${t}`}function Tg(t,e){let n=!1;return Array.isArray(t)&&_(t,r=>(r.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return n=!0,!1}),n)),n}function Sp(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:s}=r.getBoundingClientRect();n.top=i,n.left=s}return n}const Ae="---------";function T7(){return{name:Ae}}const Lr="alignment";function _7(){return{key:Lr,name(){return this.getTranslatedPhrase(jE)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Lr}:left`,name(){return this.getTranslatedPhrase(UE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,s)=>this.getCellMeta(i,s).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Lr}:center`,name(){return this.getTranslatedPhrase(zE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,s)=>this.getCellMeta(i,s).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Lr}:right`,name(){return this.getTranslatedPhrase(YE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,s)=>this.getCellMeta(i,s).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Lr}:justify`,name(){return this.getTranslatedPhrase(GE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,s)=>this.getCellMeta(i,s).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:Ae},{key:`${Lr}:top`,name(){return this.getTranslatedPhrase(qE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,s)=>this.getCellMeta(i,s).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Lr}:middle`,name(){return this.getTranslatedPhrase(KE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,s)=>this.getCellMeta(i,s).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Lr}:bottom`,name(){return this.getTranslatedPhrase(XE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,s)=>this.getCellMeta(i,s).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const bp="clear_column";function M7(){return{key:bp,name(){return this.getTranslatedPhrase(PE)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Rd="col_left";function I7(){return{key:Rd,name(){return this.getTranslatedPhrase(RE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Ed="col_right";function P7(){return{key:Ed,name(){return this.getTranslatedPhrase(EE)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Td="make_read_only";function O7(){return{key:Td,checkable:!0,ariaChecked(){return Tg(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Zg)},name(){let t=this.getTranslatedPhrase(Zg);return Tg(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=IL(t)),t},callback(){const t=this.getSelectedRange(),e=Tg(t,(n,r)=>this.getCellMeta(n,r).readOnly);_(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Rp="redo";function x7(){return{key:Rp,name(){return this.getTranslatedPhrase(IE)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const _d="remove_col";function A7(){return{key:_d,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(_E,e)},callback(){this.alter("remove_col",mK(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Ep="remove_row";function H7(){return{key:Ep,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(TE,e)},callback(){this.alter("remove_row",pK(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Tp="row_above";function N7(){return{key:Tp,name(){return this.getTranslatedPhrase(SE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const _p="row_below";function D7(){return{key:_p,name(){return this.getTranslatedPhrase(bE)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const zh="no_items";function L7(){return{key:zh,name(){return this.getTranslatedPhrase(yE)},disabled:!0,isCommand:!1}}const Mp="undo";function k7(){return{key:Mp,name(){return this.getTranslatedPhrase(ME)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const F7=[Tp,_p,Rd,Ed,bp,Ep,_d,Mp,Rp,Td,Lr,Ae,zh],$7={[Ae]:T7,[zh]:L7,[Tp]:N7,[_p]:D7,[Rd]:I7,[Ed]:P7,[bp]:M7,[Ep]:H7,[_d]:A7,[Mp]:k7,[Rp]:x7,[Td]:O7,[Lr]:_7};function PL(){const t={};return Ne($7,(e,n)=>{t[n]=e()}),t}function V7(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(VE):this.getTranslatedPhrase($E)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function W7(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(WE)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function B7(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(BE);return Tg(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,_g))?IL(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,_g);t.updateCommentMeta(n,r,{[_g]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function j7(t,e){OL(t,e),e.add(t)}function $l(t,e,n){OL(t,e),e.set(t,n)}function OL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U7(t,e,n){return(e=z7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z7(t){var e=Y7(t,"string");return typeof e=="symbol"?e:e+""}function Y7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $o(t,e,n){return t.set(Hr(t,e),n),n}function ke(t,e){return t.get(Hr(t,e))}function Hr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const am="comments",G7=60,Ls="comment",ah="value",xL="style",_g="readOnly",Ef=am,gb=`plugin:${am}`;var ct=new WeakMap,Zi=new WeakMap,Ip=new WeakMap,Mg=new WeakMap,mb=new WeakMap,lm=new WeakMap,ti=new WeakSet;class q7 extends Ke{constructor(){super(...arguments),j7(this,ti),U7(this,"range",{}),$l(this,ct,null),$l(this,Zi,null),$l(this,Ip,!1),$l(this,Mg,!1),$l(this,mb,null),$l(this,lm,"")}static get PLUGIN_KEY(){return am}static get PLUGIN_PRIORITY(){return G7}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[am]}enablePlugin(){var e=this;this.enabled||(ke(ct,this)||($o(ct,this,new Za(this.hot.rootDocument,this.hot.isRtl())),ke(ct,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hr(ti,e,t5).call(e,...r)})),ke(Zi,this)||$o(Zi,this,new ML(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,s,o,a)=>Hr(ti,this,Q7).call(this,n,a)),this.addHook("afterScroll",()=>Hr(ti,this,r5).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Hr(ti,this,n5).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hr(ti,e,i5).call(e,...r)}),ke(Zi,this).addLocalHook("hide",()=>this.hide()),ke(Zi,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){ke(Zi,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(gb);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();$o(Mg,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(gb),this.hot._registerTimeout(()=>{$o(Mg,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:Ef}),r.addShortcut({keys:[["Escape"]],callback:()=>{ke(ct,this).setValue(ke(lm,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>ke(ct,this).isVisible()&&ke(ct,this).isFocused(),group:Ef}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>ke(ct,this).isVisible()&&ke(ct,this).isFocused(),group:Ef})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Ef)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Hr(ti,this,X7).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Hr(ti,this,K7).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Hr(ti,this,Z7).call(this)),this.eventManager.addEventListener(n,"focus",()=>Hr(ti,this,e5).call(this)),this.eventManager.addEventListener(n,"blur",()=>Hr(ti,this,J7).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Go(e.target,"TD","TBODY");return!!(n&&ye(n,"htCommentCell")&&Go(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=ke(ct,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[ah]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ls),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,ah)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,ah)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return ke(Zi,this).cancelHiding(),ke(ct,this).setValue((e=i[Ls]?i[Ls][ah]:null)!==null&&e!==void 0?e:""),ke(ct,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){ke(ct,this).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!ke(ct,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),u=s.getRenderableFromVisualIndex(a);const c=l===null;ke(ct,this).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:v}=m,w=m.getCell({row:l,col:u},!0),b=this.getCommentMeta(o,a,xL);b?ke(ct,this).setSize(b.width,b.height):ke(ct,this).resetSize();const R=d?0:v.getColumnWidth(u),P=c&&!h?kt(w):0,{left:O,top:D,width:M,height:A}=w.getBoundingClientRect(),{width:j,height:X}=ke(ct,this).getSize(),{innerWidth:U,innerHeight:Z}=this.hot.rootWindow,J=this.hot.rootDocument.documentElement;let ae=O+f.scrollX+R,ne=D+f.scrollY+P;this.hot.isRtl()&&(ae-=j+R),this.hot.isLtr()&&O+M+j>U?ae=O+f.scrollX-j-1:this.hot.isRtl()&&ae<-(J.scrollWidth-J.clientWidth)&&(ae=O+f.scrollX+R+1),D+X>Z&&(ne-=X-A+1),ke(ct,this).setPosition(ae,ne),ke(ct,this).setReadOnlyState(this.getCommentMeta(o,a,_g)),ke(ct,this).observeSize()}focusEditor(){ke(ct,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Ls];let s;i?(s=kn(i),fd(s,r)):s=r,this.hot.setCellMeta(e,n,Ls,s)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Ls])return i[Ls][r]}addToContextMenu(e){e.items.push({name:Ae},V7(this),W7(this),B7(this))}getEditorInputElement(){return ke(ct,this).getInputElement()}destroy(){var e,n;(e=ke(ct,this))===null||e===void 0||e.destroy(),(n=ke(Zi,this))===null||n===void 0||n.destroy(),super.destroy()}}function K7(t){if(!(!this.hot.view||!this.hot.view._wt)&&!ke(Ip,this)&&!this.targetIsCommentTextArea(t)){const e=Go(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function X7(t){const{rootDocument:e}=this.hot;if(!(ke(Ip,this)||ke(ct,this).isFocused()||ye(t.target,"wtBorder")||ke(mb,this)===t.target||!ke(ct,this)))if($o(mb,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));ke(Zi,this).show(n)}else jo(t.target,e)&&!this.targetIsCommentTextArea(t)&&ke(Zi,this).hide()}function Z7(){$o(Ip,this,!1)}function Q7(t,e){e[Ls]&&e[Ls][ah]&&Y(t,e.commentedCellClassName)}function J7(){$o(lm,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function e5(){$o(lm,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(gb)}function t5(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[xL]:{width:t,height:e}})}function n5(t){ke(ct,this).isFocused()&&Kr(t)}function r5(){ke(Mg,this)||this.hide()}function i5(){const t=ke(ct,this).getEditorElement();Ce(t,/ht-theme-.*/g),Y(t,this.hot.getCurrentThemeName())}var $x={},wy,Vx;function s5(){if(Vx)return wy;Vx=1;var t=Lm(),e=TypeError;return wy=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},wy}var Wx;function o5(){if(Wx)return $x;Wx=1;var t=gt(),e=Lu(),n=Fu(),r=k1(),i=s5(),s=F1(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){s(d+f);for(var m=d;m--;){var v=m+f;m in h?h[v]=h[m]:i(h,v)}for(var w=0;w<f;w++)h[w]=arguments[w]}return r(h,d+f)}}),$x}o5();function Cy(t,e,n){return(e=a5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a5(t){var e=l5(t,"string");return typeof e=="symbol"?e:e+""}function l5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AL{constructor(e){Cy(this,"hot",void 0),Cy(this,"commands",{}),Cy(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=u5(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Kt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(s.join(":")),_(u,c=>c.apply(this.hot,r))}}function u5(t,e){let n;return _(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function vy(t,e,n){return(e=c5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c5(t){var e=h5(t,"string");return typeof e=="symbol"?e:e+""}function h5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;vy(this,"hot",void 0),vy(this,"predefinedItems",PL()),vy(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ne(e,(r,i)=>{let s="";r.name===Ae?(n[Ae]=r,s=Ae):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,s=r.key):(n[r.key]=r,s=r.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return d5(e,this.defaultOrderPattern,this.predefinedItems)}}function d5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),He(i)?Ne(i,(s,o)=>{let a=n[typeof s=="string"?s:o];a||(a=s),He(s)?Xt(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),r.push(a)}):_(i,(s,o)=>{let a=n[s];!a&&F7.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),He(s)&&Xt(a,s),a.key===void 0&&(a.key=o),r.push(a))}),r}function ho(t,e,n){return(e=f5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f5(t){var e=g5(t,"string");return typeof e=="symbol"?e:e+""}function g5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m5{constructor(e,n){ho(this,"top",void 0),ho(this,"topRelative",void 0),ho(this,"left",void 0),ho(this,"leftRelative",void 0),ho(this,"scrollTop",void 0),ho(this,"scrollLeft",void 0),ho(this,"cellHeight",void 0),ho(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let s,o,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,o=s,l=a,s+=r,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,o=s-r,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Oc(t,e,n){p5(t,e),e.set(t,n)}function p5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Le(t,e){return t.get(NL(t,e))}function Tf(t,e,n){return t.set(NL(t,e),n),n}function NL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap,ki=new WeakMap,er=new WeakMap,yy=new WeakMap,Vl=new WeakMap;class w5{constructor(e){Oc(this,Bn,void 0),Oc(this,ki,void 0),Oc(this,er,void 0),Oc(this,yy,!1),Oc(this,Vl,{above:0,below:0,left:0,right:0}),Tf(yy,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Le(Vl,this)[e]=n,this}setElement(e){return Tf(Bn,this,e),this}setParentElement(e){return Tf(ki,this,e),this}updatePosition(e){Tf(er,this,new m5(e,Le(Bn,this).ownerDocument.defaultView)),Le(yy,this)?(Le(er,this).fitsBelow(Le(Bn,this))?this.setPositionBelowCursor():Le(er,this).fitsAbove(Le(Bn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Le(Bn,this).dir==="rtl"?Le(er,this).fitsOnLeft(Le(Bn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Le(er,this).fitsOnRight(Le(Bn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Le(Vl,this).above+Le(er,this).top-Le(Bn,this).offsetHeight;Le(ki,this)&&(e=Le(er,this).top+Le(er,this).cellHeight-Le(Bn,this).offsetHeight+3),Le(Bn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Le(Vl,this).below+Le(er,this).top+1;Le(ki,this)&&(e=Le(er,this).top-1),Le(Bn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Le(er,this).left;if(Le(ki,this)){const n=Le(ki,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Le(ki,this).querySelector(".htCore")).borderRightWidth,10);e+=Le(er,this).cellWidth+r}else e+=Le(Vl,this).right;Le(Bn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Le(Vl,this).left+Le(er,this).left-Le(Bn,this).offsetWidth;if(Le(ki,this)){const n=Le(ki,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Le(ki,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Le(Bn,this).style.left=`${e}px`}}function DL(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const s=new Set;let o=je(e,-1,m()-1);function a(w,b){const R=m()-1;return w<0&&(w=R),w>R&&(w=0),s.has(w)?-1:(s.add(w),r(w,!1)===!1&&(w=a(b===1?++w:--w,b)),w)}function l(w){w>-1&&w<m()&&r(w,!0)!==!1&&(o=w)}function u(){return o}function c(){m()>0&&(s.clear(),o=a(0,1))}function h(){m()>0&&(s.clear(),o=a(m()-1,-1))}function d(){m()>0&&(s.clear(),o=a(++o,1))}function f(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(n(),0)}function v(){s.clear(),o=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:m,clear:v}}function C5(t){return Fe(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function pb(t){return Kt(t,"submenu")}function wb(t){return new RegExp(Ae,"i").test(t.name)}function Ig(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function Bx(t){return Kt(t,"disableSelection")}function v5(t){return ye(t,"htSeparator")}function y5(t){return ye(t,"htSubmenu")}function S5(t){return ye(t,"htDisabled")}function b5(t){return ye(t,"htSelectionDisabled")}function R5(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function LL(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function E5(t,e){let n=t.slice(0);return n.reverse(),n=LL(n,e),n.reverse(),n}function T5(t){const e=[];return _(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function _5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ae,n=t.slice(0);return n=LL(n,e),n=E5(n,e),n=T5(n),n}function M5(t){return t.checkable===!0}function I5(t){return DL({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||v5(r)||S5(r)||b5(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function P5(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(r):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const kL="menu",jx=kL;function O5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(P5(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:kL})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function s(){return[...n]}function o(u){return u?`${jx}:${u}`:jx}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=o(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function x5(t){return(e,n,r,i,s,o)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof o=="function"?o.call(t):o,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(yi(n),Y(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Ig(a,t)&&!Bx(a)&&!wb(a);be(n,[...M5(a)?[dU(),Bg(c),tN(h)]:[hU(),Bg(u)],...d?[Uu(-1)]:[],...Ig(a,t)?[vU()]:[],...pb(a)?[Br(!1)]:[]])}n.className="",n.appendChild(l),wb(a)?Y(n,"htSeparator"):typeof a.renderer=="function"?(Y(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,s,u))):Cl(l,u),Ig(a,t)?Y(n,"htDisabled"):Bx(a)?Y(n,"htSelectionDisabled"):pb(a)&&Y(n,"htSubmenu")}}function Sy(t,e,n){A5(t,e),e.set(t,n)}function A5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fi(t,e,n){return(e=H5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H5(t){var e=N5(t,"string");return typeof e=="symbol"?e:e+""}function N5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function by(t,e,n){return t.set(FL(t,e),n),n}function Ea(t,e){return t.get(FL(t,e))}function FL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ux=215;var xc=new WeakMap,_f=new WeakMap,Mf=new WeakMap;class Xu{get tableBorderWidth(){return Ea(Mf,this)===void 0&&this.hotMenu&&by(Mf,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ea(Mf,this)}constructor(e,n){var r=this;Fi(this,"hot",void 0),Fi(this,"options",void 0),Fi(this,"eventManager",new Ur(this)),Fi(this,"container",void 0),Fi(this,"positioner",void 0),Fi(this,"hotMenu",null),Fi(this,"hotSubMenus",{}),Fi(this,"parentMenu",void 0),Fi(this,"menuItems",null),Fi(this,"origOutsideClickDeselects",null),Sy(this,xc,void 0),Sy(this,_f,void 0),Sy(this,Mf,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Ux,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new w5(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(i,s)=>{if(!s){var o;(o=this.hotMenu)===null||o===void 0||o.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=nl(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ea(xc,this)}getKeyboardShortcutsCtrl(){return Ea(_f,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=np(a=>this.openSubMenu(a),300),n=this.options.minWidth||Ux;let r=!1,i=Qs(this.menuItems,a=>(a.key===zh&&(r=!0),R5(a,this.hot)));if(i.length<1&&!r)i.push(PL()[zh]);else if(i.length===0)return;i=_5(i,Ae);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ce(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:x5(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(a,l)=>{Ea(xc,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===Ae?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),qS()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!qS()||!Ko(a))&&s&&this.hasSelectedItem()&&(Us()||WR()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),by(xc,this,I5(this.hotMenu)),by(_f,this,O5(this)),Ea(_f,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ea(xc,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);be(r,[Br(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!y5(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Xu(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&be(n,[Br(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&be(i,[Br(!1)])}}closeAllSubMenus(){_(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?C5(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||wb(e)||Ig(e,this.hot)||pb(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,s=parseInt(r.width,10),o=Qt(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?kt(this.hotMenu.getCell(u,0)):0;return a+(l.name===Ae?1:h)},0);i.width=`${s}px`,i.height=`${o}px`,r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(dt(r)&&(r=r.call(this.hot),r===null||St(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),Y(i,`htMenu ${this.options.className}`),r&&Y(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&be(this.hotMenu.rootElement,[cU(),Uu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!jo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!jo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ye(e.target,"htCore")&&jo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}st(Xu,Tn);function D5(t,e){L5(t,e),e.add(t)}function L5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ry(t,e,n){return(e=k5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k5(t){var e=F5(t,"string");return typeof e=="symbol"?e:e+""}function F5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function If(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lh="contextMenu",$5=70,zx=lh;oe.getSingleton().register("afterContextMenuDefaultOptions");oe.getSingleton().register("beforeContextMenuShow");oe.getSingleton().register("afterContextMenuShow");oe.getSingleton().register("afterContextMenuHide");oe.getSingleton().register("afterContextMenuExecute");var Ac=new WeakSet;class Pp extends Ke{constructor(){super(...arguments),D5(this,Ac),Ry(this,"commandExecutor",new AL(this.hot)),Ry(this,"itemsFactory",null),Ry(this,"menu",null)}static get PLUGIN_KEY(){return lh}static get PLUGIN_PRIORITY(){return $5}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Tp,_p,Ae,Rd,Ed,Ae,Ep,_d,Ae,Mp,Rp,Ae,Td,Ae,Lr]}isEnabled(){return!!this.hot.getSettings()[lh]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[lh];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Xu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>If(Ac,this,W5).call(this)),this.menu.addLocalHook("afterOpen",()=>If(Ac,this,B5).call(this)),this.menu.addLocalHook("afterClose",()=>If(Ac,this,j5).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>If(Ac,this,V5).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Sp(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:zx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zx)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(r.below+=1,r.right+=1,r.above-=1,r.left-=1),Ne(r,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new HL(this.hot,Pp.DEFAULT_ITEMS);const e=this.hot.getSettings()[lh],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),_(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function V5(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),ye(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(s)&&!(ye(s,"current")&&ye(s,"wtBorder"))))return;const o=Sp(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function W5(){this.hot.runHooks("beforeContextMenuShow",this)}function B5(){this.hot.runHooks("afterContextMenuShow",this)}function j5(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Pp.SEPARATOR={name:Ae};function U5(t){return{key:"copy",name(){return this.getTranslatedPhrase(OE)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function z5(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(HE,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Y5(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(AE,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function G5(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?je(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(xE,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function q5(t){return{key:"cut",name(){return this.getTranslatedPhrase(NE)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class K5{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class X5{constructor(){this.clipboardData=new K5}preventDefault(){}}function Z5(t,e){$L(t,e),e.add(t)}function Wl(t,e,n){$L(t,e),e.set(t,n)}function $L(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zn(t,e){return t.get(pu(t,e))}function Bl(t,e,n){return t.set(pu(t,e),n),n}function pu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fo=new WeakMap,Ey=new WeakMap,Hc=new WeakMap,Cb=new WeakMap,vb=new WeakMap,Nc=new WeakMap,Dc=new WeakSet;class Q5{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;Z5(this,Dc),Wl(this,fo,void 0),Wl(this,Ey,void 0),Wl(this,Hc,void 0),Wl(this,Cb,void 0),Wl(this,vb,void 0),Wl(this,Nc,void 0),Bl(Ey,this,n),Bl(Hc,this,r),Bl(Cb,this,i),Bl(vb,this,s),Bl(Nc,this,o)}setSelectedRange(e){Bl(fo,this,e)}getCellsRange(){if(zn(Ey,this).call(this)===0||zn(Hc,this).call(this)===0)return null;const{row:e,col:n}=zn(fo,this).getTopStartCorner(),{row:r,col:i}=zn(fo,this).getBottomEndCorner(),s=pu(Dc,this,J5).call(this,e,r),o=pu(Dc,this,Ty).call(this,n,i);return{isRangeTrimmed:r!==s||i!==o,startRow:e,startCol:n,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(zn(Hc,this).call(this)===0||zn(Nc,this).call(this)===0)return null;const{col:e}=zn(fo,this).getTopStartCorner(),{col:n}=zn(fo,this).getBottomEndCorner(),r=pu(Dc,this,Ty).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(zn(Hc,this).call(this)===0||zn(Nc,this).call(this)===0)return null;const{col:e}=zn(fo,this).getTopStartCorner(),{col:n}=zn(fo,this).getBottomEndCorner(),r=pu(Dc,this,Ty).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-zn(Nc,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Ty(t,e){return Math.min(e,Math.max(t+zn(vb,this).call(this)-1,t))}function J5(t,e){return Math.min(e,Math.max(t+zn(Cb,this).call(this)-1,t))}function VL(t){const e=[],n=[];return _(t,r=>{const i=Math.min(r.startRow,r.endRow),s=Math.max(r.startRow,r.endRow);me(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);me(o,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function eZ(t,e){WL(t,e),e.add(t)}function go(t,e,n){WL(t,e),e.set(t,n)}function WL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lc(t,e,n){return(e=tZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:e+""}function nZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ar(t,e){return t.get(lr(t,e))}function oi(t,e,n){return t.set(lr(t,e),n),n}function lr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterCopyLimit");oe.getSingleton().register("modifyCopyableRange");oe.getSingleton().register("beforeCut");oe.getSingleton().register("afterCut");oe.getSingleton().register("beforePaste");oe.getSingleton().register("afterPaste");oe.getSingleton().register("beforeCopy");oe.getSingleton().register("afterCopy");const _y="copyPaste",rZ=80,iZ=["fragmentSelection"],Yx=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var yb=new WeakMap,Sb=new WeakMap,bb=new WeakMap,jl=new WeakMap,Pf=new WeakMap,Of=new WeakMap,Ul=new WeakMap,um=new WeakMap,vr=new WeakSet;class sZ extends Ke{constructor(){super(...arguments),eZ(this,vr),Lc(this,"columnsLimit",1/0),Lc(this,"rowsLimit",1/0),Lc(this,"pasteMode","overwrite"),Lc(this,"uiContainer",this.hot.rootDocument.body),go(this,yb,!1),go(this,Sb,!1),go(this,bb,!1),go(this,jl,"cells-only"),go(this,Pf,!1),go(this,Of,!1),go(this,Ul,new Q5({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),go(this,um,!1),Lc(this,"copyableRanges",[])}static get PLUGIN_KEY(){return _y}static get SETTING_KEYS(){return[_y,...iZ]}static get PLUGIN_PRIORITY(){return rZ}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[_y]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),oi(yb,this,this.getSetting("copyColumnHeaders")),oi(Sb,this,this.getSetting("copyColumnGroupHeaders")),oi(bb,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>lr(vr,this,lZ).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return lr(vr,r,uZ).call(r,...s)}),this.addHook("afterSelectionEnd",()=>lr(vr,this,cZ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),$R()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return lr(vr,r,hZ).call(r,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return lr(vr,r,dZ).call(r,...s)}),this.addHook("afterSelection",()=>lr(vr,this,fZ).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";oi(jl,this,e),oi(Pf,this,!0),lr(vr,this,Gx).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){oi(Of,this,!0),lr(vr,this,Gx).call(this,"cut")}getRangedCopyableData(e){return ph(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=VL(e);return _(r,s=>{const o=[];_(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),n.push(o)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new X5;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ar(Ul,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);ar(jl,this)==="column-headers-only"?n.set("headers",ar(Ul,this).getMostBottomColumnHeadersRange()):(ar(jl,this)==="with-column-headers"?n.set("headers",ar(Ul,this).getMostBottomColumnHeadersRange()):ar(jl,this)==="with-column-group-headers"&&n.set("headers",ar(Ul,this).getAllColumnHeadersRange()),n.set("cells",ar(Ul,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=r;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,s=[],{row:o,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=o,h=a,d=o,f=a;for(;s.length<r||c<=l;){const{skipRowOnPaste:m,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,m===!0)continue;d=v,h=a;const w=[],b=s.length%r;for(;w.length<i||h<=u;){const{skipColumnOnPaste:R,visualCol:P}=this.hot.getCellMeta(o,h);if(h=P+1,R===!0)continue;f=P;const O=w.length%i;w.push(e[b][O])}s.push(w)}return oi(um,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){var n;const r=this.hot.getFocusManager().getRefocusElement(),i=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ar(Pf,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),oi(Pf,this,!1);const s=this.getRangedData(this.copyableRanges),o=lr(vr,this,oZ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,o)){const l=ph(s);if(e&&e.clipboardData){const u=QS(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[Yx,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",s,this.copyableRanges,o)}oi(jl,this,"cells-only")}onCut(e){var n;const r=this.hot.getFocusManager().getRefocusElement(),i=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ar(Of,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),oi(Of,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const a=ph(s);if(e&&e.clipboardData){const l=QS(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[Yx,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){var n;const r=this.hot.getFocusManager().getRefocusElement(),i=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const c=Xm(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?s=kN(c,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=SK(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[o,a,l,u]=this.populateValues(s);this.hot.selectCell(o,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function Gx(t){if($R()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&pN(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function oZ(t){const{rows:e}=VL(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function aZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&NR(r)}}}function BL(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&DR(r)}}}function lZ(t){t.items.push({name:"---------"},U5(this)),ar(yb,this)&&t.items.push(G5(this)),ar(Sb,this)&&t.items.push(Y5(this)),ar(bb,this)&&t.items.push(z5(this)),t.items.push(q5(this))}function uZ(t,e,n,r,i){ar(um,this)&&(i.value=!0),oi(um,this,!1)}function cZ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function hZ(){lr(vr,this,BL).call(this)}function dZ(){lr(vr,this,aZ).call(this)}function fZ(){lr(vr,this,BL).call(this)}function jL(t,e){return`border_row${t}col${e}`}function uh(){return{width:1,color:"#000"}}function zs(){return{hide:!0}}function gZ(){return{width:1,color:"#000",cornerVisible:!1}}function My(t){if(ce(t.start)||ce(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ce(t.end)||ce(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function kc(t){return ce(t.start)&&(t.left=t.start),ce(t.end)&&(t.right=t.end),t}function Iy(t,e){return{id:jL(t,e),border:gZ(),row:t,col:e,top:zs(),bottom:zs(),start:zs(),end:zs()}}function mZ(t,e){return Kt(e,"border")&&e.border&&(t.border=e.border),Kt(e,"top")&&ce(e.top)&&(e.top?(He(e.top)||(e.top=uh()),t.top=e.top):(e.top=zs(),t.top=e.top)),Kt(e,"bottom")&&ce(e.bottom)&&(e.bottom?(He(e.bottom)||(e.bottom=uh()),t.bottom=e.bottom):(e.bottom=zs(),t.bottom=e.bottom)),Kt(e,"start")&&ce(e.start)&&(e.start?(He(e.start)||(e.start=uh()),t.start=e.start):(e.start=zs(),t.start=e.start)),Kt(e,"end")&&ce(e.end)&&(e.end?(He(e.end)||(e.end=uh()),t.end=e.end):(e.end=zs(),t.end=e.end)),t}function eo(t,e){let n=!1;return _(t.getSelectedRange(),r=>{r.forAll((i,s)=>{if(i<0||s<0)return;const o=t.getCellMeta(i,s).borders;if(o)if(e){if(!Kt(o[e],"hide")||o[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Op(t){return`<span class="selected">â</span>${t}`}function pZ(t){return t.some(e=>ce(e.left)||ce(e.right))}function wZ(t){return t.some(e=>ce(e.start)||ce(e.end))}const CZ=new Map([["left","start"],["right","end"]]);function vZ(t){var e;return(e=CZ.get(t))!==null&&e!==void 0?e:t}function yZ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(eT);return eo(this,"bottom")&&(e=Op(e)),e},callback(e,n){const r=eo(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function SZ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(tT);return eo(this,e)&&(n=Op(n)),n},callback(n,r){const i=eo(this,e);t.prepareBorder(r,e,i)}}}function bZ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(nT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!eo(this)}}}function RZ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(JE);return eo(this,e)&&(n=Op(n)),n},callback(n,r){const i=eo(this,e);t.prepareBorder(r,e,i)}}}function EZ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(QE);return eo(this,"top")&&(e=Op(e)),e},callback(e,n){const r=eo(this,"top");t.prepareBorder(n,"top",r)}}}function TZ(t,e){_Z(t,e),e.add(t)}function _Z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MZ(t,e,n){return(e=IZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IZ(t){var e=PZ(t,"string");return typeof e=="symbol"?e:e+""}function PZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Pg="customBorders",OZ=90;var Py=new WeakSet;class xZ extends Ke{constructor(){super(...arguments),TZ(this,Py),MZ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Pg}static get PLUGIN_PRIORITY(){return OZ}isEnabled(){return!!this.hot.getSettings()[Pg]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>qx(Py,this,AZ).call(this,e)),this.addHook("init",()=>qx(Py,this,HZ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=My(n));const s=xu(e),o=jh(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});_(e,a=>{o(a).forAll((l,u)=>{_(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,vZ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=xu(e),r=jh(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return _(e,s=>{r(s).forAll((o,a)=>{_(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(kc(l))})})}),i}clearBorders(e){e?this.setBorders(e):(_(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||n>=o)return;let a=Iy(e,n);r&&(a=mZ(a,r),_(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",kc(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,r,s=>{me(e.from.col,i,o=>{const a=Iy(s,o);let l=0;s===e.from.row&&Kt(n,"top")&&(l+=1,a.top=n.top),s===e.to.row&&Kt(n,"bottom")&&(l+=1,a.bottom=n.bottom),o===e.from.col&&Kt(n,"start")&&(l+=1,a.start=n.start),o===e.to.col&&Kt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(s,o,"borders",kc(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=jL(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let s=this.hot.getCellMeta(e,n).borders;!s||s.border===void 0?s=Iy(e,n):s=My(s),i?(s[r]=zs(),this.countHide(s)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",kc(s)))):(s[r]=uh(),this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",kc(s)))}prepareBorder(e,n,r){_(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)n==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,n,r);else switch(n){case"noBorders":me(s.col,o.col,a=>{me(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(s.col,o.col,a=>{this.setBorder(s.row,a,n,r)});break;case"bottom":me(s.col,o.col,a=>{this.setBorder(o.row,a,n,r)});break;case"start":me(s.row,o.row,a=>{this.setBorder(a,s.col,n,r)});break;case"end":me(s.row,o.row,a=>{this.setBorder(a,o.col,n,r)});break}})}createCustomBorders(e){_(e,n=>{const r=My(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:s}=e;return Qt([n,r,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Fe(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){_(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){_(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Fe(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):_(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return _(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return _(o,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):_(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=n,o.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);_(a,l=>{l.changeBorderStyle(r,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[Pg];if(Array.isArray(e)){const n=kn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=pZ(e),r=wZ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function AZ(t){this.hot.getSettings()[Pg]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(ZE)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[EZ(this),RZ(this),yZ(this),SZ(this),bZ(this)]}})}function HZ(){this.changeBorderSettings()}function NZ(t,e){DZ(t,e),e.add(t)}function DZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oy(t,e,n){return(e=LZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LZ(t){var e=kZ(t,"string");return typeof e=="symbol"?e:e+""}function kZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xx="dragToScroll",FZ=100;var xy=new WeakSet;class $Z extends Ke{constructor(){super(...arguments),NZ(this,xy),Oy(this,"boundaries",null),Oy(this,"callback",null),Oy(this,"listening",!1)}static get PLUGIN_KEY(){return Xx}static get PLUGIN_PRIORITY(){return FZ}isEnabled(){return!!this.hot.getSettings()[Xx]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>Kx(xy,this,Zx).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>Kx(xy,this,Zx).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=nl(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function Zx(t){if(Ko(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function VZ(t,e){UL(t,e),e.add(t)}function WZ(t,e,n){UL(t,e),e.set(t,n)}function UL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ay(t,e,n){return(e=BZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:e+""}function jZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UZ(t,e){return t.get(kr(t,e))}function zL(t,e,n){return t.set(kr(t,e),n),n}function kr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterDropdownMenuDefaultOptions");oe.getSingleton().register("beforeDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuHide");oe.getSingleton().register("afterDropdownMenuExecute");const Og="dropdownMenu",zZ=230,Yh="changeType",Hy=Og;var xp=new WeakMap,ui=new WeakSet;class Ap extends Ke{static get PLUGIN_KEY(){return Og}static get PLUGIN_PRIORITY(){return zZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Rd,Ed,Ae,_d,Ae,bp,Ae,Td,Ae,Lr]}constructor(e){super(e),VZ(this,ui),Ay(this,"commandExecutor",new AL(this.hot)),Ay(this,"itemsFactory",null),Ay(this,"menu",null),WZ(this,xp,!1),this.hot.addHook("afterGetColHeader",(n,r)=>kr(ui,this,GZ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Og]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new HL(this.hot,Ap.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return kr(ui,e,JZ).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return kr(ui,e,QZ).call(e,...s)});const n=this.hot.getSettings()[Og],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Xu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>kr(ui,this,qZ).call(this)),this.menu.addLocalHook("afterOpen",()=>kr(ui,this,KZ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>kr(ui,this,XZ).call(this,s)),this.menu.addLocalHook("afterClose",()=>kr(ui,this,ZZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),_(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=Sp(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${Yh}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Hy},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Hy}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Hy)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>kr(ui,this,YZ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ne(r,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function YL(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function YZ(t){if(ye(t.target,Yh)){const e=Sp(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),zL(xp,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function GZ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const s=e.querySelector(`.${Yh}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=Yh,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(be(o,[ea(),Bg(" ")]),be(e,[QH("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function qZ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function KZ(){this.hot.runHooks("afterDropdownMenuShow",this),kr(ui,this,YL).call(this,this.menu)}function XZ(t){kr(ui,this,YL).call(this,t)}function ZZ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function QZ(t){return UZ(xp,this)?null:t}function JZ(t){ye(t.target,Yh)&&zL(xp,this,!0)}Ap.SEPARATOR={name:Ae};function Qx(t,e,n){return(e=eQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eQ(t){var e=tQ(t,"string");return typeof e=="symbol"?e:e+""}function tQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nQ{constructor(e){Qx(this,"hot",void 0),Qx(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),s=this.options,o=[];return me(e,r,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(me(n,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();me(n,r,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();me(n,r,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,s=n,o=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),s=Math.min(s,n),o=Math.min(o,e),{startRow:r,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function Jx(t,e,n){return(e=rQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rQ(t){var e=iQ(t,"string");return typeof e=="symbol"?e:e+""}function iQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){Jx(this,"dataProvider",void 0),Jx(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Si(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Xt(Si(p_.DEFAULT_OPTIONS),n),n=Xt(n,e),n.filename=TR(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const sQ="\r",oQ='"',aQ=`
`;class lQ extends p_{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Fe(r,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),_(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Dt(e);return r!==""&&(n||r.indexOf(sQ)>=0||r.indexOf(oQ)>=0||r.indexOf(aQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const uQ="csv",Rb={[uQ]:lQ};function cQ(t,e,n){return typeof Rb[t]=="function"?new Rb[t](e,n):null}const hQ="exportFile",dQ=240;class fQ extends Ke{static get PLUGIN_KEY(){return hQ}static get PLUGIN_PRIORITY(){return dQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,n),o=this._createBlob(s),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Rb[e])throw new Error(`Export format type "${e}" is not supported.`);return cQ(e,new nQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function zl(t,e,n){return(e=gQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gQ(t){var e=mQ(t,"string");return typeof e=="symbol"?e:e+""}function mQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Md{constructor(e,n){let{id:r,stateless:i=!0}=n;zl(this,"hot",void 0),zl(this,"id",void 0),zl(this,"elements",[]),zl(this,"hidden",!1),zl(this,"stateId",""),zl(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new dp)}getElements(){return this.elements}reset(){_(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),_(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}st(Md,Tn);const Gh={};function Xo(t,e){if(!Gh[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Gh[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(s){return n.apply(s.meta.instance,[].concat([s],[i]))}}function Qa(t){if(!Gh[t])throw Error(`Filter condition "${t}" does not exist.`);return Gh[t].descriptor}function Jt(t,e,n){n.key=t,Gh[t]={condition:e,descriptor:n}}const vn="none";function pQ(){return!0}Jt(vn,pQ,{name:fp,inputsCount:0,showOperators:!1});const vh="empty";function wQ(t){return Lt(t.value)}Jt(vh,wQ,{name:uT,inputsCount:0,showOperators:!0});const xg="not_empty";function CQ(t,e){return!Xo(vh,e)(t)}Jt(xg,CQ,{name:cT,inputsCount:0,showOperators:!0});const yh="eq";function vQ(t,e){let[n]=e;return Dt(t.value).toLocaleLowerCase(t.meta.locale)===Dt(n)}Jt(yh,vQ,{name:hT,inputsCount:1,showOperators:!0});const Ag="neq";function yQ(t,e){return!Xo(yh,e)(t)}Jt(Ag,yQ,{name:dT,inputsCount:1,showOperators:!0});const GL="gt";function SQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Jt(GL,SQ,{name:wT,inputsCount:1,showOperators:!0});const qL="gte";function bQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Jt(qL,bQ,{name:CT,inputsCount:1,showOperators:!0});const KL="lt";function RQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Jt(KL,RQ,{name:vT,inputsCount:1,showOperators:!0});const XL="lte";function EQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Jt(XL,EQ,{name:yT,inputsCount:1,showOperators:!0});const w_="date_after";function TQ(t,e){let[n]=e;const r=K(t.value,t.meta.dateFormat),i=K(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Jt(w_,TQ,{name:RT,inputsCount:1,showOperators:!0});const C_="date_before";function _Q(t,e){let[n]=e;const r=K(t.value,t.meta.dateFormat),i=K(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Jt(C_,_Q,{name:ET,inputsCount:1,showOperators:!0});const cm="between";function MQ(t,e){let[n,r]=e,i=n,s=r;if(t.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=Xo(C_,[s]),a=Xo(w_,[i]);return o(t)&&a(t)}return t.value>=i&&t.value<=s}Jt(cm,MQ,{name:ST,inputsCount:2,showOperators:!0});const ZL="not_between";function IQ(t,e){return!Xo(cm,e)(t)}Jt(ZL,IQ,{name:bT,inputsCount:2,showOperators:!0});const QL="begins_with";function PQ(t,e){let[n]=e;return Dt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Dt(n))}Jt(QL,PQ,{name:fT,inputsCount:1,showOperators:!0});const JL="ends_with";function OQ(t,e){let[n]=e;return Dt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Dt(n))}Jt(JL,OQ,{name:gT,inputsCount:1,showOperators:!0});const v_="contains";function xQ(t,e){let[n]=e;return Dt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Dt(n))>=0}Jt(v_,xQ,{name:mT,inputsCount:1,showOperators:!0});const ek="not_contains";function AQ(t,e){return!Xo(v_,e)(t)}Jt(ek,AQ,{name:pT,inputsCount:1,showOperators:!0});const tk="date_tomorrow";function HQ(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(-1,"days").startOf("day"),"d"):!1}Jt(tk,HQ,{name:_T,inputsCount:0});const nk="date_today";function NQ(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().startOf("day"),"d"):!1}Jt(nk,NQ,{name:TT,inputsCount:0});const rk="date_yesterday";function DQ(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(1,"days").startOf("day"),"d"):!1}Jt(rk,DQ,{name:MT,inputsCount:0});SN();function LQ(t,e){let n=t;return n===""&&(n=`(${e})`),n}const Eb=new Set([1]).has(1),kQ=Eb&&typeof Array.from=="function";function Id(t){let e=t;return Eb&&(e=new Set(e)),function(n){let r;return Eb?r=e.has(n):r=!!~e.indexOf(n),r}}function ik(t){return t??""}function Tb(t){let e=t;return kQ?e=Array.from(new Set(e)):e=bR(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function eA(t,e,n,r){const i=[],s=t===e;let o;return s||(o=Id(e)),_(t,a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:LQ(a,n)};r&&r(u),i.push(u)}),i}const Ja="by_value";function FQ(t,e){let[n]=e;return n(t.value)}Jt(Ja,FQ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Id(e)]},showOperators:!1});const qh={};function $Q(t){if(!qh[t])throw Error(`Operation with id "${t}" does not exist.`);const e=qh[t].func;return function(n,r){return e(n,r)}}function VQ(t){return qh[t].name}function y_(t,e,n){qh[t]={name:e,func:n}}const zo="conjunction",WQ=OT;function BQ(t,e){return t.every(n=>n.func(e))}y_(zo,WQ,BQ);const hm="disjunction",jQ=gp;function UQ(t,e){return t.some(n=>n.func(e))}y_(hm,jQ,UQ);const S_="disjunctionWithExtraCondition",zQ=gp;function YQ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}y_(S_,zQ,YQ);const GQ="numeric",sk="text",qQ="date",tA={[GQ]:[vn,Ae,vh,xg,Ae,yh,Ag,Ae,GL,qL,KL,XL,cm,ZL],[sk]:[vn,Ae,vh,xg,Ae,yh,Ag,Ae,QL,JL,Ae,v_,ek],[qQ]:[vn,Ae,vh,xg,Ae,yh,Ag,Ae,C_,w_,cm,Ae,tk,nk,rk]};function KQ(t){const e=[];let n=t;return tA[n]||(n=sk),_(tA[n],r=>{let i;r===Ae?i={name:Ae}:i=Si(Qa(r)),e.push(i)}),e}function Fc(t,e,n){return(e=XQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XQ(t){var e=ZQ(t,"string");return typeof e=="symbol"?e:e+""}function ZQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ny="built",Dy="building",nA=["click","input","keydown","keypress","keyup","focus","blur","change"];let wi=class ok{static get DEFAULTS(){return Si({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Fc(this,"hot",void 0),Fc(this,"eventManager",new Ur(this)),Fc(this,"options",void 0),Fc(this,"_element",void 0),Fc(this,"buildState",void 0),this.hot=e,this.options=Xt(ok.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Dy?this._element:this.buildState===Ny?(this.update(),this._element):(this.buildState=Dy,this.build(),this.buildState=Ny,this._element)}isBuilt(){return this.buildState===Ny}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Xn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Dy),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Y(this._element,this.options.className),this.options.children.length)_(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ne(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),_(nA,r=>e(n,r))}else _(nA,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};st(wi,Tn);function QQ(t,e){ak(t,e),e.add(t)}function JQ(t,e,n){ak(t,e),e.set(t,n)}function ak(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xf(t,e){return t.get(b_(t,e))}function eJ(t,e,n){return t.set(b_(t,e),n),n}function b_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yl=new WeakMap,rA=new WeakSet;class Yo extends wi{static get DEFAULTS(){return Si({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Xt(Yo.DEFAULTS,n)),QQ(this,rA),JQ(this,Yl,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>b_(rA,this,tJ).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");eJ(Yl,this,this._element.firstChild),Y(this._element,"htUIInput"),Y(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(xf(Yl,this).type=this.options.type,xf(Yl,this).placeholder=this.translateIfPossible(this.options.placeholder),xf(Yl,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&xf(Yl,this).focus()}}function tJ(t){this.options.value=t.target.value}function nJ(t,e){lk(t,e),e.add(t)}function $c(t,e,n){lk(t,e),e.set(t,n)}function lk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gl(t,e,n){return t.set(Sh(t,e),n),n}function It(t,e){return t.get(Sh(t,e))}function Sh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var an=new WeakMap,Af=new WeakMap,Hf=new WeakMap,Ly=new WeakMap,Nf=new WeakMap,Df=new WeakSet;class Kh extends wi{static get DEFAULTS(){return Si({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Xt(Kh.DEFAULTS,n)),nJ(this,Df),$c(this,an,null),$c(this,Af,[]),$c(this,Hf,void 0),$c(this,Ly,void 0),$c(this,Nf,void 0),this.registerHooks()}getMenu(){return It(an,this)}registerHooks(){this.addLocalHook("click",()=>Sh(Df,this,sJ).call(this))}setItems(e){Gl(Af,this,this.translateNames(e)),It(an,this)&&It(an,this).setMenuItems(It(Af,this))}translateNames(e){return _(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Gl(an,this,new Xu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),It(an,this).setMenuItems(It(Af,this));const e=new wi(this.hot,{className:"htUISelectCaption"}),n=new wi(this.hot,{className:"htUISelectDropdown"});Gl(Hf,this,e),Gl(Ly,this,e.element),Gl(Nf,this,n),this.hot.getSettings().ariaTags&&(be(n.element,[ea()]),be(this._element,[ZH()])),_([e,n],r=>this._element.appendChild(r.element)),It(an,this).addLocalHook("select",r=>Sh(Df,this,rJ).call(this,r)),It(an,this).addLocalHook("afterClose",()=>Sh(Df,this,iJ).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=It(an,this).hot.getTranslatedPhrase(fp),It(Ly,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();It(an,this)&&(It(an,this).open(),It(an,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),It(an,this).getNavigator().toFirstItem(),It(an,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){It(an,this)&&It(an,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){It(an,this)&&(It(an,this).destroy(),Gl(an,this,null)),It(Hf,this)&&It(Hf,this).destroy(),It(Nf,this)&&It(Nf,this).destroy(),super.destroy()}}function rJ(t){t.name!==Ae&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function iJ(){this.runLocalHooks("afterClose")}function sJ(){this.openOptions()}function oJ(t,e){aJ(t,e),e.add(t)}function aJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iA(t,e,n){return(e=lJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lJ(t){var e=uJ(t,"string");return typeof e=="symbol"?e:e+""}function uJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ky=new WeakSet;class _b extends Md{constructor(e,n){super(e,{id:n.id,stateless:!1}),oJ(this,ky),iA(this,"name",""),iA(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Kh(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Yo(this.hot,{placeholder:LT})),this.elements.push(new Yo(this.hot,{placeholder:kT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>sA(ky,this,cJ).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),_(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>sA(ky,this,hJ).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Si(e.command);n.name.startsWith(Ft)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),_(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(r),s[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Qa(vn),n=[];return _(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Qa(e?e.name:vn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||_(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Kh)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Yo)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,s,o)=>{Y(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Y(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Qa(vn)];if(e!==null){const{visualIndex:r}=e;n=KQ(this.hot.getDataType(0,r,this.hot.countRows(),r))}_(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function cJ(t){_(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function hJ(t){Yu(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Kr(t))}function oA(t,e,n){dJ(t,e),e.set(t,n)}function dJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vc(t,e){return t.get(uk(t,e))}function aA(t,e,n){return t.set(uk(t,e),n),n}function uk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ql=new WeakMap,Fy=new WeakMap;class dm extends wi{static get DEFAULTS(){return Si({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Xt(dm.DEFAULTS,n)),oA(this,ql,void 0),oA(this,Fy,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),aA(Fy,this,e),aA(ql,this,this._element.firstChild),Vc(ql,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Vc(Fy,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Vc(ql,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Vc(ql,this).checked=e)}focus(){this.isBuilt()&&Vc(ql,this).focus()}}function fJ(t,e){gJ(t,e),e.add(t)}function gJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mJ(t,e,n){return(e=pJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pJ(t){var e=wJ(t,"string");return typeof e=="symbol"?e:e+""}function wJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CJ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lA=0;var uA=new WeakSet;class vJ extends Md{constructor(e,n){super(e,{id:n.id,stateless:!1}),fJ(this,uA),mJ(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuOperators"),_(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[zo,hm];_(e,n=>{const r=new dm(this.hot,{name:"operator",label:{htmlFor:n,textContent:VQ(n)},value:n,checked:n===e[lA],id:n});r.addLocalHook("change",i=>CJ(uA,this,yJ).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(it`Radio button with index ${e} doesn't exist.`);_(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof dm&&n.isChecked());return e?e.getValue():zo}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&_(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zo,n=arguments.length>1?arguments[1]:void 0,r=e;r===S_&&(r=hm),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(lA)}}function yJ(t){this.setState(t.target.value)}function SJ(t,e,n){bJ(t,e),e.set(t,n)}function bJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $y(t,e){return t.get(ck(t,e))}function RJ(t,e,n){return t.set(ck(t,e),n),n}function ck(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wc=new WeakMap;class Xh extends wi{static get DEFAULTS(){return Si({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Xt(Xh.DEFAULTS,n)),SJ(this,Wc,void 0)}build(){super.build(),RJ(Wc,this,this._element.firstChild)}update(){this.isBuilt()&&($y(Wc,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&$y(Wc,this).focus()}activate(){$y(Wc,this).click()}}function EJ(t,e){hk(t,e),e.add(t)}function Kl(t,e,n){hk(t,e),e.set(t,n)}function hk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(wu(t,e))}function ni(t,e,n){return t.set(wu(t,e),n),n}function wu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cA="multipleSelect.itemBox";var ci=new WeakMap,jt=new WeakMap,Vy=new WeakMap,Ms=new WeakMap,mo=new WeakMap,po=new WeakMap,Bc=new WeakSet;class Zh extends wi{static get DEFAULTS(){return Si({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Xt(Zh.DEFAULTS,n)),EJ(this,Bc),Kl(this,ci,[]),Kl(this,jt,void 0),Kl(this,Vy,void 0),Kl(this,Ms,void 0),Kl(this,mo,void 0),Kl(this,po,void 0),ni(Ms,this,new Yo(this.hot,{placeholder:DT,className:"htUIMultipleSelectSearch"})),ni(mo,this,new Xh(this.hot,{textContent:xT,className:"htUISelectAll"})),ni(po,this,new Xh(this.hot,{textContent:AT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ie(jt,this)}registerHooks(){Ie(Ms,this).addLocalHook("keydown",e=>wu(Bc,this,_J).call(this,e)),Ie(Ms,this).addLocalHook("input",e=>wu(Bc,this,TJ).call(this,e)),Ie(mo,this).addLocalHook("click",e=>wu(Bc,this,MJ).call(this,e)),Ie(po,this).addLocalHook("click",e=>wu(Bc,this,IJ).call(this,e))}setItems(e){var n;ni(ci,this,e),(n=Ie(jt,this))===null||n===void 0||n.loadData(Ie(ci,this))}setLocale(e){ni(Vy,this,e)}getLocale(){return Ie(Vy,this)}getItems(){return[...Ie(ci,this)]}getValue(){return OJ(Ie(ci,this))}getSearchInputElement(){return Ie(Ms,this)}getSelectAllElement(){return Ie(mo,this)}getClearAllElement(){return Ie(po,this)}isSelectedAllValues(){return Ie(ci,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new wi(this.hot,{className:"htUISelectionControls",children:[Ie(mo,this),Ie(po,this)]});this._element.appendChild(Ie(Ms,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=s=>{var o;if(!this._element)return;(o=Ie(jt,this))===null||o===void 0||o.destroy(),Y(s,"htUIMultipleSelectHot"),ni(jt,this,new this.hot.constructor(s,{data:Ie(ci,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ie(jt,this).listen()},colWidths:()=>Ie(jt,this).container.scrollWidth-yn(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ie(jt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Ie(jt,this).useTheme(u)});const l=Ie(jt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:cA}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Ie(jt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:cA})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ie(jt,this).listen()}reset(){Ie(Ms,this).reset(),Ie(mo,this).reset(),Ie(po,this).reset()}update(){this.isBuilt()&&(Ie(jt,this).loadData(PJ(Ie(ci,this),this.options.value)),super.update())}destroy(){var e;(e=Ie(jt,this))===null||e===void 0||e.destroy(),Ie(Ms,this).destroy(),Ie(po,this).destroy(),Ie(mo,this).destroy(),ni(Ms,this,null),ni(po,this,null),ni(mo,this,null),ni(jt,this,null),ni(ci,this,null),super.destroy()}}function TJ(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ie(ci,this)]:n=Ie(ci,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ie(jt,this).loadData(n)}function _J(t){this.runLocalHooks("keydown",t,this),LR(Yu,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Kr(t),Ie(jt,this).listen(),Ie(jt,this).selectCell(0,0))}function MJ(t){const e=[];t.preventDefault(),Ie(jt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(dE(n,r)[0])}),Ie(jt,this).setSourceDataAtCell(e)}function IJ(t){const e=[];t.preventDefault(),Ie(jt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(dE(n,r)[0])}),Ie(jt,this).setSourceDataAtCell(e)}function PJ(t,e){const n=Id(e);return t.map(r=>(r.checked=n(r.value),r))}function OJ(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function xJ(t,e){AJ(t,e),e.add(t)}function AJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HJ(t,e,n){return(e=NJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NJ(t){var e=DJ(t,"string");return typeof e=="symbol"?e:e+""}function DJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jc=new WeakSet;class LJ extends Md{constructor(e,n){super(e,{id:n.id,stateless:!1}),xJ(this,jc),HJ(this,"name",""),this.name=n.name,this.elements.push(new Zh(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Lf(jc,this,kJ).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Lf(jc,this,FJ).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ja){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?vn:Ja},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,s,o,a)=>{const[l]=Qs(i,h=>h.name===Ja),u={},c=this.hot.getTranslatedPhrase(Qg);if(l){const h=o(r,a),d=Fe(h,R=>R.value),f=new Map(h.map(R=>[R.value,this.hot.getCellMeta(R.meta.visualRow,R.meta.visualCol)])),m=Tb(d);s&&(l.args[0]=s);const v=[],w=eA(m,l.args[0],c,R=>{R.checked&&v.push(R.value),Lf(jc,this,hA).call(this,R,f)}),b=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,b).locale,u.args=[v],u.command=Qa(Ja),u.itemsSnapshot=w}else u.args=[],u.command=Qa(vn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Zh)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,s,o)=>{Y(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Qg),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),s=Tb(r),o=eA(s,s,e,l=>{Lf(jc,this,hA).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Fe(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:ik(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function kJ(t){Yu(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Kr(t))}function hA(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function FJ(t,e){switch(e.type){case"numeric":return nL(t,e);default:return t}}var dk;function $J(t,e){VJ(t,e),e.add(t)}function VJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WJ(t,e,n){return(e=BJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BJ(t){var e=jJ(t,"string");return typeof e=="symbol"?e:e+""}function jJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UJ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dA=new WeakSet;class Qh extends Md{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),$J(this,dA),WJ(this,"name",""),this.name=n.name,this.elements.push(new Yo(this.hot,{type:"button",value:HT,className:"htUIButton htUIButtonOK",identifier:Qh.BUTTON_OK})),this.elements.push(new Yo(this.hot,{type:"button",value:NT,className:"htUIButton htUIButtonCancel",identifier:Qh.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){_(this.elements,e=>{e.addLocalHook("click",(n,r)=>UJ(dA,this,zJ).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuActionBar"),_(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}dk=Qh;function zJ(t,e){e.options.identifier===dk.BUTTON_OK?this.accept():this.cancel()}function kf(t,e,n){return(e=YJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YJ(t){var e=GJ(t,"string");return typeof e=="symbol"?e:e+""}function GJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fA="ConditionCollection.filteringStates";class R_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;kf(this,"hot",void 0),kf(this,"isMapRegistrable",void 0),kf(this,"filteringStates",new dp),kf(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(fA,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),s=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zo;return e.length?$Q(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zo,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=Fe(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(s):c),a=n.name||n.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(it`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(St(qh[r]))throw new Error(it`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:o,func:Xo(a,o)}]},i):u.push({name:a,args:o,func:Xo(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Qt(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:s}]=n;return e.push({column:r,operation:i,conditions:Fe(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),_(e,n=>{_(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(fA),this.filteringStates=null,this.clearLocalHooks()}}st(R_,Tn);function gA(t,e,n){return(e=qJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qJ(t){var e=KJ(t,"string");return typeof e=="symbol"?e:e+""}function KJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fk{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];gA(this,"conditionCollection",void 0),gA(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return _(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return _(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return _(n,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(r[s]=e[s])}),r}}function XJ(t,e){ZJ(t,e),e.add(t)}function ZJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ta(t,e,n){return(e=QJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QJ(t){var e=JJ(t,"string");return typeof e=="symbol"?e:e+""}function JJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ff=new WeakSet;class gk{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];XJ(this,Ff),Ta(this,"hot",void 0),Ta(this,"conditionCollection",void 0),Ta(this,"columnDataFactory",void 0),Ta(this,"changes",[]),Ta(this,"grouping",!1),Ta(this,"latestEditedColumnPosition",-1),Ta(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Wy(Ff,this,eee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Wy(Ff,this,tee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Wy(Ff,this,nee).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,_(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=CN(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new R_(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const v=r.columnDataFactory(h);let w;f.isEmpty()?w=v:w=new fk(f,R=>r.columnDataFactory(R)).filter(),w=Fe(w,R=>R.meta.visualRow);const b=Id(w);return f.destroy(),Qs(v,R=>b(R.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ne(this,(e,n)=>{this[n]=null})}}function eee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function tee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function nee(){_(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}st(gk,Tn);function ree(t){return DL({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Zh)return r;if(i.element&&!rl(i.element))return!1;i.focus()}})}const Uc="filters";function iee(t,e){let n=-1,r;const i=ree(e),s=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Uc),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof wi&&(h.addLocalHook("click",s(h)),h.addLocalHook("focus",s(h)),h.addLocalHook("afterClose",s(h)))}),l(t);function o(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Uc),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Uc)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const v=r.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),m.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const v=e[i.getCurrentPage()];v instanceof Kh&&(v.openOptions(),m.preventDefault()),v instanceof Xh&&(v.activate(),m.preventDefault()),v instanceof wi||m.preventDefault()}}],Uc)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Uc)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",o),h.addLocalHook("afterOpen",o),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function see(t,e){mk(t,e),e.add(t)}function mA(t,e,n){mk(t,e),e.set(t,n)}function mk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zc(t,e,n){return(e=oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=aee(t,"string");return typeof e=="symbol"?e:e+""}function aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lee(t,e,n){return t.set(rr(t,e),n),n}function $s(t,e){return t.get(rr(t,e))}function rr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Mb="filters",uee=250,pA=Mb;var As=new WeakMap,Ib=new WeakMap,fr=new WeakSet;class cee extends Ke{static get PLUGIN_KEY(){return Mb}static get PLUGIN_PRIORITY(){return uee}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),see(this,fr),zc(this,"dropdownMenuPlugin",null),zc(this,"conditionCollection",null),zc(this,"conditionUpdateObserver",null),zc(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),zc(this,"filtersRowsMap",null),mA(this,As,void 0),mA(this,Ib,new WeakSet),this.hot.addHook("afterGetColHeader",(n,r)=>rr(fr,this,wee).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[Mb]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Cd),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>rr(fr,this,wA).call(this,"accept")),a.addLocalHook("cancel",()=>rr(fr,this,wA).call(this,"cancel")),a.addLocalHook("change",l=>rr(fr,this,pee).call(this,a,l)),a),s=()=>`${this.hot.getTranslatedPhrase(IT)}:`,o=()=>`${this.hot.getTranslatedPhrase(PT)}:`;if(!this.components.get("filter_by_condition")){const a=new _b(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>rr(fr,this,CA).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new vJ(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new _b(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>rr(fr,this,CA).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new LJ(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Qh(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new R_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new gk(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>rr(fr,this,Cee).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return rr(fr,e,mee).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>rr(fr,this,gee).call(this)),this.addHook("afterDropdownMenuShow",()=>rr(fr,this,dee).call(this)),this.addHook("afterDropdownMenuHide",()=>rr(fr,this,fee).call(this)),this.addHook("afterChange",a=>rr(fr,this,hee).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!$s(As,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=$s(As,this).getMenu(),c=u.getNavigator(),h=$s(As,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];lee(As,this,iee(this.dropdownMenuPlugin.menu,a));const l=u=>{$s(As,this).listen(),u.preventDefault(),Yu(u.keyCode,"TAB")&&(u.shiftKey?$s(As,this).toPreviousItem():$s(As,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:pA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pA)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:zo;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Fe(n.filter(),u=>u.meta.visualRow);const l=Id(i);me(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),_(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return _(this.hot.getSourceDataAtCol(n),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,n),v=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),n))!==null&&o!==void 0?o:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:ik(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=Tb(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let s=e;return s===hm&&n.command.key!==vn&&r.command.key!==vn&&i.command.key!==vn?s=S_:i.command.key!==vn&&(n.command.key===vn||r.command.key===vn)&&(s=zo),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new fk(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return _(i,o=>{_(n.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function hee(t){t&&_(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function dee(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function fee(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function gee(){const t=this.dropdownMenuPlugin.menu;$s(Ib,this).has(t)||$s(As,this).setMenu(t),$s(Ib,this).add(t)}function mee(t){t.items.push({name:Ae}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function wA(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==vn&&(this.conditionCollection.addCondition(i,s,l,u),o.command.key!==vn&&this.conditionCollection.addCondition(i,o,l,u)),a.command.key!==vn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function pee(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===_b&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function CA(){this.setListeningDropdownMenu()}function wee(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Y(e,"htFiltersActive"):Ce(e,"htFiltersActive")}function Cee(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(o=>o.name===Ja),s=n.filter(o=>o.name!==Ja);if(i.length>=2||s.length>=3)tt(it`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(o,r),this.components.get("filter_by_value").updateState(t)}}const pk="internal-use-in-handsontable",Pb={licenseKey:pk,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function wk(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Nn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function Ck(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function vee(t){var e;const n=t[Nn],r=Ck(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=wk(t);return{...Pb,...r,...i}}function yee(t){var e;const n=t[Nn],r=Ck(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=wk(t);return{...r,...i}}function See(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Hp(){const t="engine_relationship",e=_i(Nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function E_(){const t="shared_engine_usage",e=_i(Nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function bee(t){const e=t.getSettings(),n=e[Nn],r=n==null?void 0:n.engine;if(n===!0||St(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Ree((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&St(r.hyperformula)){const s=Hp(),o=E_().get(r);return s.has(r)||s.set(r,[]),s.get(r).push(t),o&&o.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:pk}),(r.getConfig().leapYear1900!==Pb.leapYear1900||rp(r.getConfig().nullDate,Pb.nullDate)===!1)&&tt(it`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Ree(t,e,n){const r=e[Nn],i=vee(e),s=Hp(),o=E_();Eee(t,r.functions),Tee(t,r.language);const a=t.buildEmpty(i);return s.set(a,[n]),o.set(a,[n.guid]),_ee(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function vA(t){var e;const n=Hp(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function yA(t,e){if(t){const n=Hp(),r=n.get(t),i=E_(),s=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function Eee(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:s}=n;try{t.registerFunction(r,i,s)}catch(o){tt(o.message)}})}function Tee(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){tt(r.message)}}}function _ee(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:s,options:o}=n;try{t.addNamedExpression(r,i,s,o)}catch(a){tt(a.message)}}),t.resumeEvaluation())}function Mee(t,e){return(St(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const vk="DD/MM/YYYY";function yk(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Iee(t){return yk(t)?t.substr(1):t}function Pee(t){return typeof t=="string"&&t.startsWith("=")}function T_(t,e){return typeof t=="string"&&e==="date"}function Sk(t,e){return K(t,e,!0).isValid()}function bk(t,e){return K(t,e,!0).format(vk)}function Oee(t,e){return K(t,vk,!0).format(e)}function Rk(t,e){const r=new Date(Date.UTC(0,0,t+-1));return K(r).format(e)}function xee(t,e,n){const r=Array.from(Array(n).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Aee(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Hee(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function __(t,e,n){const r=Aee(t,xee(t,e,n));return Hee(r)}function _a(t,e,n){Nee(t,e),e.set(t,n)}function Nee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(Ek(t,e))}function wo(t,e,n){return t.set(Ek(t,e),n),n}function Ek(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yc=new WeakMap,Co=new WeakMap,gr=new WeakMap,$f=new WeakMap,By=new WeakMap,jy=new WeakMap,Vf=new WeakMap;class SA{constructor(e,n,r){_a(this,Yc,void 0),_a(this,Co,void 0),_a(this,gr,void 0),_a(this,$f,[]),_a(this,By,[]),_a(this,jy,void 0),_a(this,Vf,[]),wo(Yc,this,e),wo(Co,this,n),wo(gr,this,r)}setRemovedHfIndexes(e){return wo(Vf,this,e.map(n=>{const r=vt(Co,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),vt(Vf,this)}getRemovedHfIndexes(){return vt(Vf,this)}getHfIndexFromVisualIndex(e){const n=vt(Co,this).getIndexesSequence(),r=vt(Co,this).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${Ln(vt(Yc,this))}s`;vt(gr,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&vt(gr,this).getEngine()[r](vt(gr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(wo(By,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),wo(jy,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(vt(gr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=__(vt(By,this),vt(jy,this),vt(Co,this).getNumberOfIndexes());vt(gr,this).getSheetId()===null?vt(gr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Ln(vt(Yc,this))}Order`;return n=>{if(vt(gr,this).isPerformingUndoRedo())return;const r=vt(Co,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=vt($f,this).map(l=>r.indexOf(l)),s=vt(gr,this).getEngine().getSheetDimensions(vt(gr,this).getSheetId());let o;vt(Yc,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);vt(gr,this).getEngine()[e](vt(gr,this).getSheetId(),i)}wo($f,this,r)}}init(){wo($f,this,vt(Co,this).getIndexesSequence())}}function Ma(t,e,n){Dee(t,e),e.set(t,n)}function Dee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Is(t,e){return t.get(Tk(t,e))}function Ia(t,e,n){return t.set(Tk(t,e),n),n}function Tk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wf=new WeakMap,Bf=new WeakMap,Uy=new WeakMap,zy=new WeakMap,Yy=new WeakMap,Gy=new WeakMap,qy=new WeakMap;class Lee{constructor(e,n,r){Ma(this,Wf,void 0),Ma(this,Bf,void 0),Ma(this,Uy,void 0),Ma(this,zy,!1),Ma(this,Yy,!1),Ma(this,Gy,null),Ma(this,qy,null),Ia(Wf,this,new SA("row",e,this)),Ia(Bf,this,new SA("column",n,this)),Ia(Uy,this,r)}getForAxis(e){return e==="row"?Is(Wf,this):Is(Bf,this)}setPerformUndo(e){Ia(zy,this,e)}setPerformRedo(e){Ia(Yy,this,e)}isPerformingUndoRedo(){return Is(zy,this)||Is(Yy,this)}getSheetId(){return Is(qy,this)}getEngine(){return Is(Gy,this)}getPostponeAction(){return Is(Uy,this)}setupSyncEndpoint(e,n){Ia(Gy,this,e),Ia(qy,this,n),Is(Wf,this).init(),Is(Bf,this).init()}}function kee(t,e){_k(t,e),e.add(t)}function Xl(t,e,n){return(e=Fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fee(t){var e=$ee(t,"string");return typeof e=="symbol"?e:e+""}function $ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ky(t,e,n){_k(t,e),e.set(t,n)}function _k(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zo(t,e,n){return t.set(at(t,e),n),n}function _u(t,e){return t.get(at(t,e))}function at(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Nn="formulas",Vee=["maxRows","maxColumns","language"],Wee=260;oe.getSingleton().register("afterNamedExpressionAdded");oe.getSingleton().register("afterNamedExpressionRemoved");oe.getSingleton().register("afterSheetAdded");oe.getSingleton().register("afterSheetRemoved");oe.getSingleton().register("afterSheetRenamed");oe.getSingleton().register("afterFormulasValuesUpdate");const Zu=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var to=new WeakMap,M_=new WeakMap,Gc=new WeakMap,ut=new WeakSet;class Bee extends Ke{constructor(){var e;super(...arguments),e=this,kee(this,ut),Ky(this,to,!1),Ky(this,M_,!1),Ky(this,Gc,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(ut,e,ite).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(ut,e,ste).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(ut,e,ote).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(ut,e,ate).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(ut,e,lte).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(ut,e,ute).call(e,...r)}]]),Xl(this,"staticRegister",_i("formulas")),Xl(this,"engine",null),Xl(this,"sheetName",null),Xl(this,"indexSyncer",null),Xl(this,"rowAxisSyncer",null),Xl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Nn}static get PLUGIN_PRIORITY(){return Wee}static get SETTING_KEYS(){return[Nn,...Vee]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Nn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=bee(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){tt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,bA).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,RA).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,bA).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,RA).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,Yee).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,Gee).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,jee).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,qee).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,EA).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,EA).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,Kee).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,Xee).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,Jee).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,ete).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,Zee).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,Qee).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,tte).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,nte).call(n,...i)}),this.indexSyncer=new Lee(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("beforeColumnMove",(r,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("afterRowMove",(r,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(r,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,zee).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,rte).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return at(ut,n,Uee).call(n,...i)}),_u(Gc,this).forEach(r=>{let[i,s]=r;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){_u(Gc,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),yA(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=yee(this.hot.getSettings());See(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Nn];if(ce(r)&&ce(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Nn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){_u(Gc,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Zo(Gc,this,null),yA(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ce(n)&&!cD(n))return tt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return tt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return tt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){jR(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Ln(Nn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(n);return i!==null&&s!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(r.has(o)||r.add(o))}),vA(this.engine).forEach((i,s)=>{if((n||s!==this.sheetId)&&r.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=s=>{var o;const{row:a,col:l,sheet:u}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return ce(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(s=>r(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(ce(l)===!1||ce(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=r(s);if(c!==void 0&&!i.has(h)){const d=vA(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){tt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,n);return T_(r,s.type)&&(Sk(r,s.dateFormat)?r=bk(r,s.dateFormat):Pee(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function jee(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},s=this.hot.getCellMeta(e,r);let o=this.engine.getCellValue(i);return s.type==="date"&&Hn(o)&&(o=Rk(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function Uee(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:v}=h.start,{row:w,col:b}=h.end,R=w-m+1,P=b-v+1;for(let O=0;O<f.length;O+=1)for(let D=0;D<f[O].length;D+=1){const M=f[O][D],A=m+O%R,j=v+D%P,X=this.hot.getCellMeta(A,j);T_(M,X.type)&&(M.startsWith("'")?f[O][D]=M.slice(1):this.isFormulaCellType(A,j,this.sheetId)===!1&&(f[O][D]=Oee(M,X.dateFormat)))}return f}function bA(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Ln(Nn))||Zo(M_,this,St(this.hot.getSettings().data))}function zee(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,s)=>{const o=this.hot.getCellMeta(r,s),a=o.dateFormat;T_(i,o.type)&&(e=!0,Sk(i,a)?t[r][s]=bk(i,a):this.isFormulaCellType(r,s)===!1&&(t[r][s]=`'${i}`))})}),e===!0&&(Zo(to,this,!0),this.engine.setSheetContent(this.sheetId,t),Zo(to,this,!1))}function RA(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Ln(Nn)))if(this.sheetName=Mee(this.engine,this.hot.getSettings()[Nn].sheetName),_u(M_,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Zo(to,this,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Zo(to,this,!1)}}}function Yee(t,e,n,r){if(r!=="get"||_u(to,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){yk(n.value)&&(n.value=Iee(n.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o),l=this.hot.getCellsMeta().find(c=>c.visualRow===i&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Hn(a)&&(a=Rk(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Gee(t,e,n,r){if(r!=="get"||_u(to,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function EA(t,e){if(Zu(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(o,u,l):n.push([o,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{n.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function qee(t,e){if(Zu(e))return;const n=[],r=[];t.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!Hn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){tt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Kee(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Xee(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Zee(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function Qee(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function Jee(t,e,n){if(Zu(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function ete(t,e,n){if(Zu(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function tte(t,e,n,r){if(Zu(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function nte(t,e,n,r){if(Zu(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function rte(t,e,n){var r;Zo(to,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Zo(to,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+o,sheet:this.sheetId},[[a]])})})}function ite(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function ste(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function ote(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function ate(t){this.hot.runHooks("afterSheetAdded",t)}function lte(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function ute(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function cte(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(sT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),s=[];for(let l=r;l<=i;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function hte(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(oT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const n=Fe(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,s=r.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return _(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function dte(t,e){Mk(t,e),e.add(t)}function fte(t,e,n){Mk(t,e),e.set(t,n)}function Mk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pa(t,e){return t.get(Mo(t,e))}function TA(t,e,n){return t.set(Mo(t,e),n),n}function Mo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideColumns");oe.getSingleton().register("afterHideColumns");oe.getSingleton().register("beforeUnhideColumns");oe.getSingleton().register("afterUnhideColumns");const _A="hiddenColumns",gte=310;var $i=new WeakMap,Oa=new WeakSet;class mte extends Ke{constructor(){super(...arguments),dte(this,Oa),fte(this,$i,null)}static get PLUGIN_KEY(){return _A}static get PLUGIN_PRIORITY(){return gte}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[_A]}enablePlugin(){var e=this;this.enabled||(TA($i,this,new hp),Pa($i,this).addLocalHook("init",()=>Mo(Oa,this,Ste).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Pa($i,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Mo(Oa,e,yte).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Mo(Oa,this,wte).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Mo(Oa,this,pte).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Mo(Oa,e,vte).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Mo(Oa,this,Cte).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const s=Pa($i,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));_(l,u=>{s[u]=!1}),i=Qt(s,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&o)!==!1&&(r&&o&&Pa($i,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&o,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,o=>{Pa($i,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Fe(Pa($i,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Pa($i,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){TA($i,this,null),super.destroy()}}function pte(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function wte(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Cte(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return _(t,r=>{let i=!0,s=0;me(r.startCol,r.endCol,o=>{this.isHidden(o)?(i||n(r.startRow,r.endRow,s,o-1),i=!0):(i&&(s=o),o===r.endCol&&n(r.startRow,r.endRow,s,o),i=!1)})}),e}function vte(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Y(e,n)}function yte(t){t.items.push({name:Ae},cte(this),hte(this))}function Ste(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function bte(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(aT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),s=[];for(let l=r;l<=i;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Rte(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(lT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const n=Fe(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,s=r.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return _(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Ete(t,e){Ik(t,e),e.add(t)}function Tte(t,e,n){Ik(t,e),e.set(t,n)}function Ik(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xa(t,e){return t.get(Io(t,e))}function MA(t,e,n){return t.set(Io(t,e),n),n}function Io(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideRows");oe.getSingleton().register("afterHideRows");oe.getSingleton().register("beforeUnhideRows");oe.getSingleton().register("afterUnhideRows");const IA="hiddenRows",_te=320;var Vi=new WeakMap,Aa=new WeakSet;class Mte extends Ke{constructor(){super(...arguments),Ete(this,Aa),Tte(this,Vi,null)}static get PLUGIN_KEY(){return IA}static get PLUGIN_PRIORITY(){return _te}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[IA]}enablePlugin(){var e=this;this.enabled||(MA(Vi,this,new hp),xa(Vi,this).addLocalHook("init",()=>Io(Aa,this,Hte).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,xa(Vi,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Io(Aa,e,Ate).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Io(Aa,this,Pte).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Io(Aa,this,Ite).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Io(Aa,e,xte).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Io(Aa,this,Ote).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const s=xa(Vi,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));_(l,u=>{s[u]=!1}),i=Qt(s,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&o)!==!1&&(r&&o&&xa(Vi,this).setValues(s),this.hot.runHooks("afterUnhideRows",n,i,r&&o,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,o=>{xa(Vi,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Fe(xa(Vi,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return xa(Vi,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){MA(Vi,this,null),super.destroy()}}function Ite(t,e){return this.isHidden(e)?0:t}function Pte(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Ote(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return _(t,r=>{let i=!0,s=0;me(r.startRow,r.endRow,o=>{this.isHidden(o)?(i||n(s,o-1,r.startCol,r.endCol),i=!0):(i&&(s=o),o===r.endRow&&n(s,o,r.startCol,r.endCol),i=!1)})}),e}function xte(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Y(e,n)}function Ate(t){t.items.push({name:Ae},bte(this),Rte(this))}function Hte(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Nte(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(DE)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Dte(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(LE)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Lte(t,e){Pk(t,e),e.add(t)}function kte(t,e,n){Pk(t,e),e.set(t,n)}function Pk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ob(t,e){return t.get(fm(t,e))}function Xy(t,e,n){return t.set(fm(t,e),n),n}function fm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnFreeze");oe.getSingleton().register("afterColumnFreeze");oe.getSingleton().register("beforeColumnUnfreeze");oe.getSingleton().register("afterColumnUnfreeze");const PA="manualColumnFreeze",Fte=110;var za=new WeakMap,Zy=new WeakSet;class $te extends Ke{constructor(){super(...arguments),Lte(this,Zy),kte(this,za,!1)}static get PLUGIN_KEY(){return PA}static get PLUGIN_PRIORITY(){return Fte}isEnabled(){return!!this.hot.getSettings()[PA]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>fm(Zy,this,Vte).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>fm(Zy,this,Wte).call(this,e,n)),super.enablePlugin())}disablePlugin(){Xy(za,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;Ob(za,this)||Xy(za,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;Ob(za,this)||Xy(za,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Vte(t){t.items.push({name:"---------"},Nte(this),Dte(this))}function Wte(t,e){if(Ob(za,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function jf(t,e,n){return(e=Bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bte(t){var e=jte(t,"string");return typeof e=="symbol"?e:e+""}function jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qy=0,OA=1,xA=2,Zl="px";let Ok=class{constructor(e){jf(this,"hot",void 0),jf(this,"_element",null),jf(this,"state",Qy),jf(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=xA}build(){this.state===Qy&&(this._element=this.hot.rootDocument.createElement("div"),this.state=OA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Qy}isAppended(){return this.state===xA}isBuilt(){return this.state>=OA}setPosition(e,n){Hn(e)&&(this._element.style.top=e+Zl),Hn(n)&&(this._element.style[this.inlineProperty]=n+Zl)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Hn(e)&&(this._element.style.width=e+Zl),Hn(n)&&(this._element.style.height=n+Zl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Hn(e)&&(this._element.style.marginTop=e+Zl),Hn(n)&&(this._element.style[`margin${Ln(this.inlineProperty)}`]=n+Zl)}getOffset(){const e=this._element.style,n=`margin${Ln(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Ute="ht__manualColumnMove--backlight";let zte=class extends Ok{build(){super.build(),Y(this._element,Ute)}};const Yte="ht__manualColumnMove--guideline";let Gte=class extends Ok{build(){super.build(),Y(this._element,Yte)}};function qte(t,e){xk(t,e),e.add(t)}function ri(t,e,n){xk(t,e),e.set(t,n)}function xk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ur(t,e,n){return t.set(Po(t,e),n),n}function de(t,e){return t.get(Po(t,e))}function Po(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnMove");oe.getSingleton().register("afterColumnMove");const Jy="manualColumnMove",Kte=120,AA="ht__manualColumnMove",gm="show-ui",xb="on-moving--columns",Ab="after-selection--columns";var Gn=new WeakMap,Ao=new WeakMap,Ys=new WeakMap,Hg=new WeakMap,Vo=new WeakMap,Yn=new WeakMap,Uf=new WeakMap,Nr=new WeakMap,hu=new WeakMap,mm=new WeakMap,bh=new WeakMap,Ha=new WeakSet;class Xte extends Ke{constructor(){super(...arguments),qte(this,Ha),ri(this,Gn,new zte(this.hot)),ri(this,Ao,new Gte(this.hot)),ri(this,Ys,[]),ri(this,Hg,0),ri(this,Vo,!1),ri(this,Yn,{}),ri(this,Uf,void 0),ri(this,Nr,void 0),ri(this,hu,void 0),ri(this,mm,void 0),ri(this,bh,void 0)}static get PLUGIN_KEY(){return Jy}static get PLUGIN_PRIORITY(){return Kte}isEnabled(){return!!this.hot.getSettings()[Jy]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Po(Ha,e,Zte).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Po(Ha,e,Jte).call(e,...r)}),this.addHook("afterScrollVertically",()=>Po(Ha,this,tne).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Po(Ha,e,nne).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,AA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ce(this.hot.rootElement,AA),this.unregisterEvents(),de(Gn,this).destroy(),de(Ao,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=de(Uf,this),i=this.isMovePossible(e,n),s=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(ur(Uf,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const o=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,o),o}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return ur(Uf,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Qt(e,(i,s)=>(s<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=n;s+=1){const o=r.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Jy];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return me(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(de(Nr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,de(Nr,this)-1);const o=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=de(Gn,this).getOffset().start,u=de(Gn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,v=Yt(this.hot.rootElement),w=m.innerWidth-de(hu,this)-v;h=m.innerWidth-de(Yn,this).eventPageX-w-(r.scrollX===void 0?i:0)}else h=de(Yn,this).eventPageX-(de(hu,this)-(r.scrollX===void 0?i:0));if(de(mm,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(de(Nr,this))&&(s+=i),s+=c,de(Nr,this)<0)de(bh,this)>0?de(Yn,this).col=0:de(Yn,this).col=e>0?e-1:e;else if(de(Yn,this).TD.offsetWidth/2+s<=h){const m=de(Nr,this)>=de(Hg,this)?de(Hg,this)-1:de(Nr,this);de(Yn,this).col=m+1,s+=de(Yn,this).TD.offsetWidth}else de(Yn,this).col=de(Nr,this);let d=h,f=s;h+u+l>=o?d=o-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:r.scrollX!==void 0&&de(Nr,this)<de(bh,this)&&(f-=de(hu,this)<=r.scrollX?de(hu,this):0),de(Gn,this).setPosition(null,d),de(Ao,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Po(Ha,this,Qte).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Po(Ha,this,ene).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){de(Gn,this).build(),de(Ao,this).build()}destroy(){de(Gn,this).destroy(),de(Ao,this).destroy(),super.destroy()}}function Zte(t,e,n,r){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=ye(t.target,"sortAction");if(!o||!s||de(Vo,this)||t.button!==0||a){ur(Vo,this,!1),de(Ys,this).length=0,Ce(this.hot.rootElement,[xb,gm]);return}const l=de(Ao,this).isBuilt()&&!de(Ao,this).isAppended(),u=de(Gn,this).isBuilt()&&!de(Gn,this).isAppended();l&&u&&(de(Ao,this).appendTo(i.hider),de(Gn,this).appendTo(i.hider));const{from:c,to:h}=o,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,ur(Vo,this,!0);const m=n.firstChild?ON(t,n.firstChild).x:t.offsetX;de(Yn,this).eventPageX=t.pageX,ur(Nr,this,e.col),de(Yn,this).TD=n,de(Yn,this).col=e.col,ur(Ys,this,this.prepareColumnsToMoving(d,f)),ur(mm,this,!!this.hot.getSettings().rowHeaders),ur(Hg,this,this.hot.countCols()),ur(bh,this,this.hot.getSettings().fixedColumnsStart),ur(hu,this,cn(this.hot.rootElement).left);const v=de(mm,this)?-1:0,w=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,b=e.col<de(bh,this),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),P=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),O=this.getColumnsWidth(d,e.col-1)+P,D=this.getColumnsWidth(v,d-1)+(b?R:0)+O;de(Gn,this).setPosition(w,D),de(Gn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-w),de(Gn,this).setOffset(null,-O),Y(this.hot.rootElement,xb)}else Ce(this.hot.rootElement,Ab),ur(Vo,this,!1),de(Ys,this).length=0}function Qte(t){de(Vo,this)&&(de(Yn,this).eventPageX=t.pageX,this.refreshPositions())}function Jte(t,e,n,r){!this.hot.getSelectedRangeLast()||!de(Vo,this)||(de(Ys,this).indexOf(e.col)>-1?Ce(this.hot.rootElement,gm):Y(this.hot.rootElement,gm),r.row=!0,r.column=!0,r.cell=!0,ur(Nr,this,e.col),de(Yn,this).TD=n)}function ene(){const t=de(Yn,this).col,e=de(Ys,this).length;if(ur(Nr,this,void 0),ur(Vo,this,!1),Ce(this.hot.rootElement,[xb,gm,Ab]),this.hot.selection.isSelectedByColumnHeader()&&Y(this.hot.rootElement,Ab),e<1||t===void 0)return;const n=de(Ys,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(de(Ys,this),t);if(de(Ys,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(r),o=s+e-1;this.hot.selectColumns(s,o)}}function tne(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;de(Gn,this).setPosition(r),de(Gn,this).setSize(null,t.hider.offsetHeight-r)}function nne(){this.moveBySettingsOrLoad()}function rne(t,e){Ak(t,e),e.add(t)}function In(t,e,n){Ak(t,e),e.set(t,n)}function Ak(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e,n){return t.set(hi(t,e),n),n}function ie(t,e){return t.get(hi(t,e))}function hi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pm="manualColumnResize",ine=130,HA="manualColumnWidths";var ks=new WeakMap,zf=new WeakMap,Sr=new WeakMap,wm=new WeakMap,ss=new WeakMap,sne=new WeakMap,Mu=new WeakMap,Yf=new WeakMap,nr=new WeakMap,Hs=new WeakMap,ul=new WeakMap,Cm=new WeakMap,Rh=new WeakMap,Eh=new WeakMap,Rr=new WeakMap,Th=new WeakMap,Wi=new WeakSet;class one extends Ke{static get PLUGIN_KEY(){return pm}static get PLUGIN_PRIORITY(){return ine}constructor(e){super(e),rne(this,Wi),In(this,ks,null),In(this,zf,null),In(this,Sr,[]),In(this,wm,null),In(this,ss,null),In(this,sne,null),In(this,Mu,null),In(this,Yf,null),In(this,nr,this.hot.rootDocument.createElement("DIV")),In(this,Hs,this.hot.rootDocument.createElement("DIV")),In(this,ul,null),In(this,Cm,!1),In(this,Rh,0),In(this,Eh,null),In(this,Rr,void 0),In(this,Th,void 0),Y(ie(nr,this),"manualColumnResizer"),Y(ie(Hs,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[pm]}enablePlugin(){var e=this;this.enabled||(zt(Rr,this,new ta),ie(Rr,this).addLocalHook("init",()=>hi(Wi,this,ane).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ie(Rr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hi(Wi,e,fne).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hi(Wi,e,gne).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hi(Wi,e,mne).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){zt(Th,this,ie(Rr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",HA,ie(Rr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",HA,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ie(Rr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ie(Rr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;zt(ks,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ie(ks,this)),i=r.col;if(i<0)return;const s=kt(ie(ks,this)),o=ie(ks,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(ks,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ie(ks,this),r.row,r.col)),zt(zf,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),zt(Sr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();_(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;me(d,f,m=>{ie(Sr,this).includes(m)||ie(Sr,this).push(m)})})}ie(Sr,this).includes(ie(zf,this))||zt(Sr,this,[ie(zf,this)]),zt(Yf,this,l.start-6),zt(Mu,this,parseInt(o.width,10)),ie(nr,this).style.top=`${l.top}px`,ie(nr,this).style[this.inlineDir]=`${ie(Yf,this)+ie(Mu,this)}px`,ie(nr,this).style.height=`${s}px`,this.hot.rootElement.appendChild(ie(nr,this))}refreshHandlePosition(){ie(nr,this).style[this.inlineDir]=`${ie(Yf,this)+ie(wm,this)}px`}setupGuidePosition(){const e=parseInt(kt(ie(nr,this)),10),n=parseInt(ie(nr,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Y(ie(nr,this),"active"),Y(ie(Hs,this),"active"),ie(Hs,this).style.top=`${n}px`,this.refreshGuidePosition(),ie(Hs,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ie(Hs,this))}refreshGuidePosition(){ie(Hs,this).style[this.inlineDir]=ie(nr,this).style[this.inlineDir]}hideHandleAndGuide(){Ce(ie(nr,this),"active"),Ce(ie(Hs,this),"active")}checkIfColumnHeader(e){const n=Go(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const s=this.hot.runHooks("beforeColumnResize",ie(ss,this),r,!0);s!==void 0&&zt(ss,this,s),this.setManualSize(r,ie(ss,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(ss,this),r,!0),i&&e()};ie(Rh,this)>=2&&(ie(Sr,this).length>1?(_(ie(Sr,this),i=>{n(i)}),e()):_(ie(Sr,this),i=>{n(i,!0)})),zt(Rh,this,0),zt(Eh,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>hi(Wi,this,lne).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>hi(Wi,this,une).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>hi(Wi,this,cne).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>hi(Wi,this,hne).call(this)),this.eventManager.addEventListener(ie(nr,this),"contextmenu",()=>hi(Wi,this,dne).call(this))}destroy(){super.destroy()}}function ane(){const t=this.hot.getSettings()[pm],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ie(Rr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ie(Rr,this).setValueAtIndex(r,n)})},!0),zt(Th,this,t)):t===!0&&Array.isArray(ie(Th,this))&&this.hot.batchExecution(()=>{ie(Th,this).forEach((n,r)=>{ie(Rr,this).setValueAtIndex(r,n)})},!0)}function lne(t){if(!HR(t.target)&&ie(Cm,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ie(ul,this)||this.setupHandlePosition(e))}}function une(t){t.target.parentNode===this.hot.rootElement&&ye(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ie(ks,this)),this.setupGuidePosition(),zt(ul,this,!0),ie(Eh,this)===null&&(zt(Eh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(Eh,this))),zt(Rh,this,ie(Rh,this)+1),this.startX=t.pageX,zt(ss,this,ie(Mu,this)))}function cne(t){if(ie(ul,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();zt(wm,this,ie(Mu,this)+e),_(ie(Sr,this),n=>{zt(ss,this,this.setManualSize(n,ie(wm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function hne(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ie(ss,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(ss,this),n,!1)};ie(ul,this)&&(this.hideHandleAndGuide(),zt(ul,this,!1),ie(ss,this)!==ie(Mu,this)&&(ie(Sr,this).length>1?(_(ie(Sr,this),r=>{e(r)}),t()):_(ie(Sr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(ks,this)))}function dne(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(nr,this)),this.hot.rootElement.removeChild(ie(Hs,this)),zt(ul,this,!1),zt(Cm,this,!0),this.hot._registerImmediate(()=>{zt(Cm,this,!1)})}function fne(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ie(Rr,this).getValueAtIndex(r);this.hot.getSettings()[pm]&&i&&(n=i)}return n}function gne(t,e){const n=ie(Rr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function mne(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function eS(t,e,n){return(e=pne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pne(t){var e=wne(t,"string");return typeof e=="symbol"?e:e+""}function wne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tS=0,NA=1,DA=2,Ql="px";let Hk=class{constructor(e){eS(this,"hot",void 0),eS(this,"_element",null),eS(this,"state",tS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=DA}build(){this.state===tS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=NA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=tS}isAppended(){return this.state===DA}isBuilt(){return this.state>=NA}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Ql),n!==void 0&&(this._element.style.left=n+Ql)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Ql),n&&(this._element.style.height=n+Ql)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Ql),n&&(this._element.style.marginLeft=n+Ql)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Cne="ht__manualRowMove--backlight";class vne extends Hk{build(){super.build(),Y(this._element,Cne)}}const yne="ht__manualRowMove--guideline";class Sne extends Hk{build(){super.build(),Y(this._element,yne)}}function bne(t,e){Nk(t,e),e.add(t)}function Jl(t,e,n){Nk(t,e),e.set(t,n)}function Nk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function el(t,e,n){return t.set(Oo(t,e),n),n}function Me(t,e){return t.get(Oo(t,e))}function Oo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeRowMove");oe.getSingleton().register("afterRowMove");const nS="manualRowMove",Rne=140,LA="ht__manualRowMove",vm="show-ui",Hb="on-moving--rows",Nb="after-selection--rows";var qn=new WeakMap,Ho=new WeakMap,Gs=new WeakMap,Wo=new WeakMap,cr=new WeakMap,Gf=new WeakMap,Na=new WeakSet;class Ene extends Ke{constructor(){super(...arguments),bne(this,Na),Jl(this,qn,new vne(this.hot)),Jl(this,Ho,new Sne(this.hot)),Jl(this,Gs,[]),Jl(this,Wo,void 0),Jl(this,cr,{}),Jl(this,Gf,void 0)}static get PLUGIN_KEY(){return nS}static get PLUGIN_PRIORITY(){return Rne}isEnabled(){return!!this.hot.getSettings()[nS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oo(Na,e,Tne).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oo(Na,e,Mne).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Oo(Na,this,Pne).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oo(Na,e,One).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,LA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ce(this.hot.rootElement,LA),this.unregisterEvents(),Me(qn,this).destroy(),Me(Ho,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Me(Gf,this),i=this.isMovePossible(e,n),s=this.hot.runHooks("beforeRowMove",e,n,r,i);if(el(Gf,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const o=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,o),o}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return el(Gf,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Qt(e,(i,s)=>(s<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=n;s++){const o=r.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[nS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,s=Math.min(r.row,i.row),o=Math.max(r.row,i.row);return me(s,o,a=>{n.push(a)}),n}refreshPositions(){const e=Me(cr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=Me(cr,this).TD,a=this.hot.rootElement,l=cn(a),u=il(a),c=s.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Me(cr,this).eventPageY-d+c,m=s.hider.offsetHeight,v=s.TBODY.offsetTop,w=Me(qn,this).getOffset().top,b=Me(qn,this).getSize().height,R=o.offsetHeight/2,P=o.offsetHeight;let O=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const D=f>=O+R;this.isFixedRowTop(e.row)&&(O+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Me(cr,this).row=n>0?n-1:n:D?(Me(cr,this).row=e.row+1,O+=e.row===0?P-1:P):Me(cr,this).row=e.row;let M=f,A=O;f+b+w>=m?M=m-b-w:f+w<v&&(M=v+Math.abs(w)),O>=m-1&&(A=m-1),Me(qn,this).setPosition(M),Me(Ho,this).setPosition(A)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Oo(Na,this,_ne).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Oo(Na,this,Ine).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Me(qn,this).build(),Me(Ho,this).build()}destroy(){Me(qn,this).destroy(),Me(Ho,this).destroy(),super.destroy()}}function Tne(t,e,n,r){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||Me(Wo,this)||t.button!==0){el(Wo,this,!1),Me(Gs,this).length=0,Ce(this.hot.rootElement,[Hb,vm]);return}const l=Me(Ho,this).isBuilt()&&!Me(Ho,this).isAppended(),u=Me(qn,this).isBuilt()&&!Me(qn,this).isAppended();l&&u&&(Me(Ho,this).appendTo(i.hider),Me(qn,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,el(Wo,this,!0),Me(cr,this).eventPageY=t.pageY,Me(cr,this).coords=e,Me(cr,this).TD=n,el(Gs,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+s.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+t.offsetY;Me(qn,this).setPosition(null,m),Me(qn,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),Me(qn,this).setOffset(-v,null),Y(this.hot.rootElement,Hb),this.refreshPositions()}else Ce(this.hot.rootElement,Nb),el(Wo,this,!1),Me(Gs,this).length=0}function _ne(t){Me(Wo,this)&&(Me(cr,this).eventPageY=t.pageY,this.refreshPositions())}function Mne(t,e,n,r){!this.hot.getSelectedRangeLast()||!Me(Wo,this)||(Me(Gs,this).indexOf(e.row)>-1?Ce(this.hot.rootElement,vm):Y(this.hot.rootElement,vm),r.row=!0,r.column=!0,r.cell=!0,Me(cr,this).coords=e,Me(cr,this).TD=n)}function Ine(){const t=Me(cr,this).row,e=Me(Gs,this).length;if(el(Wo,this,!1),Ce(this.hot.rootElement,[Hb,vm,Nb]),this.hot.selection.isSelectedByRowHeader()&&Y(this.hot.rootElement,Nb),e<1||t===void 0)return;const n=Me(Gs,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Me(Gs,this),t);if(Me(Gs,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(r),o=s+e-1;this.hot.selectRows(s,o)}}function Pne(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Me(qn,this).setPosition(null,r),Me(qn,this).setSize(t.hider.offsetWidth-r)}function One(){this.moveBySettingsOrLoad()}function xne(t,e){Dk(t,e),e.add(t)}function Pn(t,e,n){Dk(t,e),e.set(t,n)}function Dk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e,n){return t.set(Fs(t,e),n),n}function re(t,e){return t.get(Fs(t,e))}function Fs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ym="manualRowResize",Ane=30,kA="manualRowHeights";var Qi=new WeakMap,qf=new WeakMap,br=new WeakMap,_h=new WeakMap,No=new WeakMap,I_=new WeakMap,Iu=new WeakMap,Kf=new WeakMap,Un=new WeakMap,Ki=new WeakMap,cl=new WeakMap,Sm=new WeakMap,Mh=new WeakMap,Ih=new WeakMap,gi=new WeakMap,Ph=new WeakMap,vo=new WeakSet;class Hne extends Ke{static get PLUGIN_KEY(){return ym}static get PLUGIN_PRIORITY(){return Ane}constructor(e){super(e),xne(this,vo),Pn(this,Qi,null),Pn(this,qf,null),Pn(this,br,[]),Pn(this,_h,null),Pn(this,No,null),Pn(this,I_,null),Pn(this,Iu,null),Pn(this,Kf,null),Pn(this,Un,this.hot.rootDocument.createElement("DIV")),Pn(this,Ki,this.hot.rootDocument.createElement("DIV")),Pn(this,cl,!1),Pn(this,Sm,!1),Pn(this,Mh,0),Pn(this,Ih,null),Pn(this,gi,void 0),Pn(this,Ph,void 0),Y(re(Un,this),"manualRowResizer"),Y(re(Ki,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ym]}enablePlugin(){this.enabled||(At(gi,this,new ta),re(gi,this).addLocalHook("init",()=>Fs(vo,this,Vne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,re(gi,this)),this.addHook("modifyRowHeight",(e,n)=>Fs(vo,this,$ne).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){At(Ph,this,re(gi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",kA,re(gi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",kA,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return re(gi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return re(_h,this)}setupHandlePosition(e){At(Qi,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(re(Qi,this)),s=i.row;if(s<0)return;const o=Yt(re(Qi,this)),a=re(Qi,this).getBoundingClientRect(),l=s<r.getSetting("fixedRowsTop"),u=s>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(Qi,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(re(Qi,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(re(Qi,this),i.row,i.col)),At(qf,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),At(br,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();_(d,f=>{const m=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;me(m,v,w=>{re(br,this).includes(w)||re(br,this).push(w)})})}re(br,this).includes(re(qf,this))||At(br,this,[re(qf,this)]),At(Kf,this,c.top-6),At(Iu,this,parseInt(a.height,10)),re(Un,this).style.top=`${re(Kf,this)+re(Iu,this)}px`,re(Un,this).style[this.inlineDir]=`${c.start}px`,re(Un,this).style.width=`${o}px`,this.hot.rootElement.appendChild(re(Un,this))}refreshHandlePosition(){re(Un,this).style.top=`${re(Kf,this)+re(_h,this)}px`}setupGuidePosition(){const e=parseInt(Yt(re(Un,this)),10),n=parseInt(re(Un,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Y(re(Un,this),"active"),Y(re(Ki,this),"active"),re(Ki,this).style.top=re(Un,this).style.top,re(Ki,this).style[this.inlineDir]=`${n}px`,re(Ki,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(re(Ki,this))}refreshGuidePosition(){re(Ki,this).style.top=re(Un,this).style.top}hideHandleAndGuide(){Ce(re(Un,this),"active"),Ce(re(Ki,this),"active")}checkIfRowHeader(e){const n=Go(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&re(No,this)<n?n:re(No,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);s!==void 0&&At(No,this,s),this.setManualSize(r,re(No,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};re(Mh,this)>=2&&(re(br,this).length>1?(_(re(br,this),i=>{n(i)}),e()):_(re(br,this),i=>{n(i,!0)})),At(Mh,this,0),At(Ih,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Fs(vo,this,Nne).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Fs(vo,this,Dne).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Fs(vo,this,Lne).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Fs(vo,this,kne).call(this)),this.eventManager.addEventListener(re(Un,this),"contextmenu",()=>Fs(vo,this,Fne).call(this))}destroy(){super.destroy()}}function Nne(t){if(!HR(t.target)&&re(Sm,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(re(cl,this)||this.setupHandlePosition(e))}}function Dne(t){ye(t.target,"manualRowResizer")&&(this.setupHandlePosition(re(Qi,this)),this.setupGuidePosition(),At(cl,this,!0),re(Ih,this)===null&&(At(Ih,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(Ih,this))),At(Mh,this,re(Mh,this)+1),At(I_,this,t.pageY),At(No,this,re(Iu,this)))}function Lne(t){re(cl,this)&&(At(_h,this,re(Iu,this)+(t.pageY-re(I_,this))),_(re(br,this),e=>{At(No,this,this.setManualSize(e,re(_h,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function kne(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};re(cl,this)&&(this.hideHandleAndGuide(),At(cl,this,!1),re(No,this)!==re(Iu,this)&&(re(br,this).length>1?(_(re(br,this),r=>{e(r)}),t()):_(re(br,this),r=>{e(r,!0)})),this.setupHandlePosition(re(Qi,this)))}function Fne(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(Un,this)),this.hot.rootElement.removeChild(re(Ki,this)),At(cl,this,!1),At(Sm,this,!0),this.hot._registerImmediate(()=>{At(Sm,this,!1)})}function $ne(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=re(gi,this).getValueAtIndex(r);this.hot.getSettings()[ym]&&i&&(n=i)}return n}function Vne(){const t=this.hot.getSettings()[ym],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{re(gi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{re(gi,this).setValueAtIndex(r,n)}),At(Ph,this,t)):t===!0&&Array.isArray(re(Ph,this))&&re(Ph,this).forEach((n,r)=>{re(gi,this).setValueAtIndex(r,n)})},!0)}var FA={},$A;function Wne(){if($A)return FA;$A=1;var t=op();return t("flatMap"),FA}Wne();var VA={},WA={},rS,BA;function Bne(){if(BA)return rS;BA=1;var t=Fn(),e=on(),n=hs(),r=Qb();return rS=function(i,s){(!s||typeof i!="string")&&e(i);var o=r(i);return n(e(o!==void 0?t(o,i):i))},rS}var jA;function jne(){if(jA)return WA;jA=1;var t=gt(),e=Fn(),n=dr(),r=on(),i=hs(),s=Bne(),o=Zb(),a=$u(),l=Qo(),u=o(function(){for(var c=this.iterator,h=this.mapper,d,f;;){if(f=this.inner)try{if(d=r(e(f.next,f.iterator)),!d.done)return d.value;this.inner=null}catch(m){a(c,"throw",m)}if(d=r(e(this.next,c)),this.done=!!d.done)return;try{this.inner=s(h(d.value,this.counter++),!1)}catch(m){a(c,"throw",m)}}});return t({target:"Iterator",proto:!0,real:!0,forced:l},{flatMap:function(h){return r(this),n(h),new u(i(this),{mapper:h,inner:null})}}),WA}var UA;function Une(){return UA||(UA=1,jne()),VA}Une();function zne(t,e,n){Yne(t,e),e.set(t,n)}function Yne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Da(t,e,n){return(e=Gne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gne(t){var e=qne(t,"string");return typeof e=="symbol"?e:e+""}function qne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zA(t,e){return t.get(Lk(t,e))}function Xf(t,e,n){return t.set(Lk(t,e),n),n}function Lk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var La=new WeakMap;class Ji{constructor(e,n,r,i,s,o){Da(this,"row",void 0),Da(this,"col",void 0),Da(this,"rowspan",void 0),Da(this,"colspan",void 0),Da(this,"removed",!1),Da(this,"cellCoordsFactory",void 0),Da(this,"cellRangeFactory",void 0),zne(this,La,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:s}=e;return it`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:s}=e;return n<0||r<0||i<0||s<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),Xf(La,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[o],c=this[o]+this[s]-1;if(u>=n&&(this[o]+=r),r>0)n<=c&&n>u&&(this[s]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,Xf(La,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[o]-=d+r,this[s]-=h}else if(u<=a&&c>=l)this[s]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[s]-=h}}return Xf(La,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return zA(La,this)||Xf(La,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),zA(La,this)}}function Kne(t,e){Xne(t,e),e.add(t)}function Xne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zf(t,e,n){return(e=Zne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zne(t){var e=Qne(t,"string");return typeof e=="symbol"?e:e+""}function Qne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ka(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yo=new WeakSet;class bm{constructor(e){Kne(this,yo),Zf(this,"plugin",void 0),Zf(this,"mergedCells",[]),Zf(this,"mergedCellsMatrix",new Map),Zf(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){let n=!1;return _(this.mergedCells,r=>r.row<=e.from.row&&r.row+r.rowspan-1>=e.to.row&&r.col<=e.from.col&&r.col+r.colspan-1>=e.to.col?(n=r,n):!0),n}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let u=s;u<s+l;u++)for(let c=o;c<o+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=s;h<s+l;h++){for(let d=o;d<o+a;d++){const f=`r${h},c${d}`;if(n.has(f)){tt(bm.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=r;l<=s;l++)for(let u=i;u<=o;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new Ji(r,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),ka(yo,this,YA).call(this,a),a):(tt(bm.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),ka(yo,this,Jne).call(this,r),r):!1}clear(){_(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:s}=e;me(n,n+i,o=>{me(r,r+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:s,rowspan:o,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=je(u,i,i+o-1),d=je(c,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,n){const r=ka(yo,this,Qf).call(this,e,"col",-1);let i=n;for(let s=0;s<r.length;s++)if(r[s]<=n){i=r[s];break}return i}getEndMostColumnIndex(e,n){const r=ka(yo,this,Qf).call(this,e,"col",1);let i=n;for(let s=0;s<r.length;s++)if(r[s]>=n){i=r[s];break}return i}getTopMostRowIndex(e,n){const r=ka(yo,this,Qf).call(this,e,"row",-1);let i=n;for(let s=0;s<r.length;s++)if(r[s]<=n){i=r[s];break}return i}getBottomMostRowIndex(e,n){const r=ka(yo,this,Qf).call(this,e,"row",1);let i=n;for(let s=0;s<r.length;s++)if(r[s]>=n){i=r[s];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,n),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{ka(yo,this,YA).call(this,o)})}}function Qf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),s=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=i.row;n===1?o<=s.row:o>=s.row;o+=n)for(let a=i.col;n===1?a<=s.col:a>=s.col;a+=n){const l=e==="row"?o:a,u=this.get(o,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function YA(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Jne(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function iS(t,e,n){return(e=ere(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ere(t){var e=tre(t,"string");return typeof e=="symbol"?e:e+""}function tre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nre{constructor(e){iS(this,"plugin",void 0),iS(this,"mergedCellsCollection",void 0),iS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const s=n.slice(0),o=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(o/d)*d,m=o-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const w=v.row+v.rowspan-a-m;s[2]+w>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?w:0}else if(r==="right"){const w=v.col+v.colspan-l-m;s[3]+w>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?w:0}else if(r==="up"){const w=u-m-v.row+1;s[0]+w<0?s[0]+=m:s[0]-=m?w:0}else if(r==="left"){const w=c-m-v.col+1;s[1]+w<0?s[1]+=m:s[1]-=m?w:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Xt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,s,o,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-o;case"left":return s-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,s,o,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[o+1,s,c,a];case"left":return[l,u,o,s-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[s,o,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?s:o,d=this.getAutofillSize(e,n,r),f=u?a-s+1:l-o+1,m=Math.floor(d/f)*f,v=d-m;let w=null,b=null,R=null;switch(r){case"up":w="includesVertically",R=c-v+1;break;case"left":w="includesHorizontally",R=c-v+1;break;case"down":w="includesVertically",R=h+v-1;break;case"right":w="includesHorizontally",R=h+v-1;break}return _(i,P=>{P[w](R)&&P.isFarther(b,r)&&(b=P)}),b}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return _(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(n.min===null||s<n.min)&&(n.min=s),(n.max===null||s>n.max)&&(n.max=s),(r.min===null||o<r.min)&&(r.min=o),(r.max===null||o>r.max)&&(r.max=o)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return this.mergedCellsCollection.getWithinRange(h,!0).length>0}}function sS(t,e,n){return(e=rre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rre(t){var e=ire(t,"string");return typeof e=="symbol"?e:e+""}function ire(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sre{constructor(e){sS(this,"plugin",void 0),sS(this,"hot",void 0),sS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(s<=c.row&&o<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<r.length;i+=1){const s=[];for(let o=0;o<n.length;o+=1)s[o]=n[o].includes(r[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function ore(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(FE)}return this.getTranslatedPhrase(kE)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Ji.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Oh(t,e,n){return(e=are(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function are(t){var e=lre(t,"string");return typeof e=="symbol"?e:e+""}function lre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GA{constructor(e){Oh(this,"data",void 0),Oh(this,"next",null),Oh(this,"prev",null),this.data=e}}class Jf{constructor(){Oh(this,"first",null),Oh(this,"last",null)}push(e){const n=new GA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new GA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function ure(t,e){kk(t,e),e.add(t)}function Fa(t,e,n){kk(t,e),e.set(t,n)}function kk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(Rm(t,e))}function mr(t,e,n){return t.set(Rm(t,e),n),n}function Rm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bi=new WeakMap,ji=new WeakMap,Ui=new WeakMap,zi=new WeakMap,Db=new WeakMap,eg=new WeakMap,tg=new WeakMap,oS=new WeakSet;class cre{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;ure(this,oS),Fa(this,Bi,new Jf),Fa(this,ji,new Jf),Fa(this,Ui,null),Fa(this,zi,null),Fa(this,Db,null),Fa(this,eg,null),Fa(this,tg,null),mr(Db,this,n),mr(eg,this,r),mr(tg,this,i)}getCurrentVerticalNode(){return Je(zi,this).data}getFirstVerticalNode(){return Je(ji,this).first.data}getNextVerticalNode(){return Je(zi,this).next.data}getPrevVerticalNode(){return Je(zi,this).prev.data}getCurrentHorizontalNode(){return Je(Ui,this).data}getFirstHorizontalNode(){return Je(Bi,this).first.data}getNextHorizontalNode(){return Je(Ui,this).next.data}getPrevHorizontalNode(){return Je(Ui,this).prev.data}setPrevNodeAsActive(){mr(zi,this,Je(zi,this).prev),mr(Ui,this,Je(Ui,this).prev)}setNextNodeAsActive(){mr(zi,this,Je(zi,this).next),mr(Ui,this,Je(Ui,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;mr(Bi,this,new Jf);for(let o=n.row;o<=r.row;o++)if(!Je(eg,this).isHidden(o))for(let a=n.col;a<=r.col;a++){if(Je(tg,this).isHidden(a))continue;const l=Rm(oS,this,qA).call(this,e,Je(Bi,this),i,o,a);l&&mr(Ui,this,l)}Je(Bi,this).first&&(Je(Bi,this).first.prev=Je(Bi,this).last,Je(Bi,this).last.next=Je(Bi,this).first);const s=new WeakSet;mr(ji,this,new Jf);for(let o=n.col;o<=r.col;o++)if(!Je(tg,this).isHidden(o))for(let a=n.row;a<=r.row;a++){if(Je(eg,this).isHidden(a))continue;const l=Rm(oS,this,qA).call(this,e,Je(ji,this),s,a,o);l&&mr(zi,this,l)}Je(ji,this).first&&(Je(ji,this).first.prev=Je(ji,this).last,Je(ji,this).last.next=Je(ji,this).first)}setActiveNode(e,n){return Je(Bi,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&n>=o&&n<=a)return mr(Ui,this,r),!1}),Je(ji,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&n>=o&&n<=a)return mr(zi,this,r),!1}),this}}function qA(t,e,n,r,i){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=Je(Db,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function hre(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e;function i(){}function s(o,a,l){const u=t.mergedCellsCollection.get(a,l);if(!He(u)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:c,col:h,colspan:d,rowspan:f}=u,[m,v]=t.translateMergedCellToRenderable(c,f,h,d),w=t.getSetting("virtualized"),b=n.getRenderableFromVisualIndex(a),R=r.getRenderableFromVisualIndex(l),P=m-b+1,O=v-R+1;let D=n.getNearestNotHiddenIndex(c,1),M=r.getNearestNotHiddenIndex(h,1);if(w){const X=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(X)||(D=Math.max(D,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(X)||(M=Math.max(M,e.getFirstRenderedVisibleColumn()))}const A=Math.min(f,P),j=Math.min(d,O);D===a&&M===l?(o.setAttribute("rowspan",A),o.setAttribute("colspan",j)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:i,after:s}}function dre(t,e){Fk(t,e),e.add(t)}function ng(t,e,n){Fk(t,e),e.set(t,n)}function Fk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aS(t,e,n){return(e=fre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fre(t){var e=gre(t,"string");return typeof e=="symbol"?e:e+""}function gre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jh(t,e,n){return t.set(et(t,e),n),n}function ft(t,e){return t.get(et(t,e))}function et(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeMergeCells");oe.getSingleton().register("afterMergeCells");oe.getSingleton().register("beforeUnmergeCells");oe.getSingleton().register("afterUnmergeCells");const Lb="mergeCells",mre=150,KA=Lb;var Vr=new WeakMap,Wr=new WeakMap,os=new WeakMap,XA=new WeakMap,rt=new WeakSet;class pre extends Ke{constructor(){super(...arguments),dre(this,rt),aS(this,"mergedCellsCollection",null),aS(this,"autofillCalculations",null),aS(this,"selectionCalculations",null),ng(this,Vr,null),ng(this,Wr,{row:0,col:0}),ng(this,os,new cre({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),ng(this,XA,hre(this))}static get PLUGIN_KEY(){return Lb}static get PLUGIN_PRIORITY(){return mre}static get DEFAULT_SETTINGS(){return{[aL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[Lb]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new bm(this),this.autofillCalculations=new nre(this),this.selectionCalculations=new sre(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,wre).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,vre).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,yre).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Sre).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,bre).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,QA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,QA).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Ere).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Tre).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,_re).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,ZA).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,ZA).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Cre).call(e,...r)}),this.addHook("afterRenderer",function(){return ft(XA,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Rre).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Mre).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Ire).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Pre).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Ore).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,xre).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Are).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Hre).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Nre).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Dre).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Lre).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,kre).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Fre).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,$re).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return et(rt,e,Vre).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!FR())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:s}=r;for(let o=i+1;o<i+s;o++)n.push(o)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=Fh(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Fh(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Ji.containsNegativeValues(e)?(tt(Ji.NEGATIVE_VALUES_WARNING(e)),!1):Ji.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(tt(Ji.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Ji.isSingleCell(e)?(tt(Ji.IS_SINGLE_CELL(e)),!1):Ji.containsZeroSpan(e)?(tt(Ji.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:s,col:o,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(s,o),c=this.hot._createCellCoords(s+a-1,o+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=s;d<s+a;d++)for(let f=o;f<o+l;f++)(d!==s||f!==o)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,n)?(this.hot.runHooks("beforeMergeCells",e,n),me(0,o.rowspan-1,c=>{me(0,o.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+c,o.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,n)?(r?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),_(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),me(0,i.rowspan-1,s=>{me(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,n,r,i){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:KA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(KA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(i,s);if(He(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(i,s);if(He(o)){const a=o.row+o.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,i);if(He(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,i);if(He(o)){const a=o.col+o.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;n===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=o.getNearestNotHiddenIndex(r,1):l=o.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,c=r>=0?o.getRenderableFromVisualIndex(l):r;return[u,c]}}function wre(){this.generateFromSettings(),this.hot.render()}function Cre(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(r.row===e[s].row&&r.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function vre(t){ft(Wr,this).row=t.row,ft(Wr,this).col=t.col}function yre(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;ft(Vr,this)&&(i.getRenderableFromVisualIndex(ft(Vr,this).row)!==null&&(n.row=ft(Vr,this).row),r.getRenderableFromVisualIndex(ft(Vr,this).col)!==null&&(n.col=ft(Vr,this).col),Jh(Vr,this,null));const s=this.mergedCellsCollection.get(n.row,n.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const c=n.col>=o&&n.col<=a?o-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=o&&n.col<=a?a+1:o,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Sre(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;o(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;o(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;o(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;o(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function bre(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Jh(Vr,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Jh(Vr,this,e.clone()),n&&e.assign(n)}function ZA(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:s,col:o,colspan:a,rowspan:l}=i,u=s,c=o,h=s+l-1,d=o+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[je(m,u,h),je(v,c,d),je(this.hot.getLastRenderedVisibleRow(),u,h),je(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Rre(t){t.items.push({name:"---------"},ore(this))}function QA(){Jh(Vr,this,null)}function Ere(){if(ft(Vr,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=ft(Vr,this).clone().normalize();ft(os,this).setActiveNode(r.row,r.col),ft(Wr,this).row>0||ft(Wr,this).col>0?ft(os,this).setPrevNodeAsActive():(n==="E-W"&&ft(Wr,this).col<0||e==="S-N"&&ft(Wr,this).row<0)&&ft(os,this).setNextNodeAsActive()}function Tre(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let s=null,o=null;if(ft(Wr,this).col<0){const{rowEnd:a,colEnd:l}=ft(os,this).getPrevHorizontalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(ft(Wr,this).col>0){const{rowStart:a,colStart:l}=ft(os,this).getNextHorizontalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(ft(Wr,this).row<0){const{rowEnd:a,colEnd:l}=ft(os,this).getPrevVerticalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(ft(Wr,this).row>0){const{rowStart:a,colStart:l}=ft(os,this).getNextVerticalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}ft(os,this).setActiveNode(t,e),Jh(Wr,this,{row:0,col:0})}function _re(){this.hot.getSelectedRangeLast().isHeader()||ft(os,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Mre(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Ire(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Pre(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Ore(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,s),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0||(r=this.autofillCalculations.snapDragArea(e,r,n,a)),r}function xre(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Are(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Hre(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Nre(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Dre(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Lre(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);_(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function kre(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Fre(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function $re(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function Vre(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const o=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{var f;let{rowspan:m}=d,v=0;n==="top"||n==="top_inline_start_corner"?v=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):v=m-h,t=Math.max((f=t)!==null&&f!==void 0?f:0,et(rt,this,Wre).call(this,e,v))}),t}function Wre(t,e){const n=this.hot.view.getDefaultRowHeight(),r=this.hot.getPlugin("autoRowSize");let i=0;for(let o=t;o<t+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var s;i+=(s=r==null?void 0:r.getRowHeight(o))!==null&&s!==void 0?s:n}return i}function Bre(t,e){return function(n,r){const[,...i]=n,[,...s]=r;return function o(a){const l=t[a],u=e[a],c=i[a],h=s[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:gL(u.type))(l,u,d)(c,h);if(m===ls){const v=a+1;if(typeof e[v]<"u")return o(v)}return m}(0)}}function JA(){tt(it`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const $k="sort";function jre(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${$k}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Ure(t){const e=t.className.split(" "),n=new RegExp(`^${$k}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function zre(t,e,n){return(e=Yre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yre(t){var e=Gre(t,"string");return typeof e=="symbol"?e:e+""}function Gre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Em="multiColumnSorting",qre=170,lS="columnSorting",e1=Em;fL(Em,Bre);class Kre extends RL{constructor(){super(...arguments),zre(this,"pluginKey",Em)}static get PLUGIN_KEY(){return Em}static get PLUGIN_PRIORITY(){return qre}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[lS]&&(JA(),this.hot.getPlugin(lS).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,sm)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:na,position:"before",group:e1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(e1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Ce(e,Ure(e)),this.enabled!==!1&&Y(e,jre(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[lS]&&JA(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){g_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,sm))):this.sort(this.getColumnNextConfig(n.col)))}}function t1(t,e,n){return(e=Xre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xre(t){var e=Zre(t,"string");return typeof e=="symbol"?e:e+""}function Zre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qre="multipleSelectionHandles",Jre=160;class eie extends Ke{constructor(){super(...arguments),t1(this,"dragged",[]),t1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Qre}static get PLUGIN_PRIORITY(){return Jre}isEnabled(){return Us()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let s;if(ye(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(ye(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ye(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ye(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,c,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,o.col)};break;case"SE-NW":s==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":s==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":s==="top"?c={start:n,end:o}:c.end=n;break;case"SW-NE":s==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?c={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(o.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":s==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(o.row,n.col)};break;case"SE-NW":s==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(o.row,n.col)}:s==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(c.end=n);break;case"SE-NW":s==="top"?c.end=n:c={start:n,end:o};break}break}return c}isDragged(){return this.dragged.length>0}}function kb(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function Vk(){return{label:"",isPlaceholder:!0}}function tie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;_(t,i=>{const s=[];let o=0;n.push(s),_(i,a=>{const l=kb();if(He(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Dt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Dt(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)s.push(Vk());return!u})});const r=Math.max(...Fe(n,i=>i.length));return _(n,i=>{if(i.length<r){const s=Fe(new Array(r-i.length),()=>kb());i.splice(i.length,0,...s)}}),n}function uS(t,e,n){nie(t,e),e.set(t,n)}function nie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ii(t,e){return t.get(Wk(t,e))}function qc(t,e,n){return t.set(Wk(t,e),n),n}function Wk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const n1=["label","collapsible"];var Ps=new WeakMap,$a=new WeakMap,cS=new WeakMap;class rie{constructor(){uS(this,Ps,[]),uS(this,$a,0),uS(this,cS,1/0)}setColumnsLimit(e){qc(cS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];qc(Ps,this,tie(e,ii(cS,this))),qc($a,this,ii(Ps,this).length)}getData(){return ii(Ps,this)}mergeWith(e){_(e,n=>{let{row:r,col:i,...s}=n;const o=this.getHeaderSettings(r,i);o!==null&&Xt(o,s,n1)})}map(e){_(ii(Ps,this),n=>{_(n,r=>{const i=e({...r});He(i)&&Xt(r,i,n1)})})}getHeaderSettings(e,n){var r;if(e>=ii($a,this)||e<0)return null;const i=ii(Ps,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=ii($a,this)||e<0)return i;const s=ii(Ps,this)[e];let o=0;for(let a=n;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===r)break;if(o>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return ii($a,this)}getColumnsCount(){return ii($a,this)>0?ii(Ps,this)[0].length:0}clear(){qc(Ps,this,[]),qc($a,this,0)}}function hS(t,e,n){return(e=iie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iie(t){var e=sie(t,"string");return typeof e=="symbol"?e:e+""}function sie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Bk="DF-pre-order";function jk(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=jk.call(this.childs[r],t,e)}return n}const oie="DF-post-order";function Uk(t,e){for(let n=0;n<this.childs.length;n++)if(Uk.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const zk="BF";function aie(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const lie=zk,r1=new Map([[Bk,jk],[oie,Uk],[zk,aie]]);class Tm{constructor(e){hS(this,"data",{}),hS(this,"parent",null),hS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Tm({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lie;if(!r1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);r1.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function dS(t,e,n){uie(t,e),e.set(t,n)}function uie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(t,e){return t.get(Yk(t,e))}function cie(t,e,n){return t.set(Yk(t,e),n),n}function Yk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eu=new WeakMap,Va=new WeakMap,tu=new WeakMap;class hie{constructor(e){dS(this,eu,new Map),dS(this,Va,new Map),dS(this,tu,null),cie(tu,this,e)}getRoots(){return Array.from(jn(eu,this).values())}getRootByColumn(e){let n;return jn(Va,this).has(e)&&(n=jn(eu,this).get(jn(Va,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-jn(Va,this).get(n);let s=0,o;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=n===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;jn(Va,this).clear(),_(jn(eu,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)jn(Va,this).set(i,e);e+=r})}buildTree(){this.clear();const e=jn(tu,this).getColumnsCount();let n=0;for(;n<e;){const r=jn(tu,this).getHeaderSettings(0,n),i=new Tm;jn(eu,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=jn(tu,this).getHeadersSettings(r,n,i);r+=1,_(s,o=>{const a={...o,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Tm(a),e.addChild(l)),r<jn(tu,this).getLayersCount()&&this.buildLeaves(l,n,r,o.origColspan),n+=o.origColspan})}clear(){jn(eu,this).clear(),jn(Va,this).clear()}}function Gk(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let s=1;s<r.colspan;s++)e(r.columnIndex+s)})}function _m(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Mm(t){return _m(t,"origColspan")===t.data.origColspan}function P_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Mm(t))return P_(n[0]);e.isCollapsed=!1;const i=n.slice(1),s=new Set;let o=0;if(i.length>0)_(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,Gk(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let c=1;c<l;c++)s.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Mm(a)&&(l.isCollapsed=_m(a,"isCollapsed"))}),{rollbackModification:()=>O_(t),affectedColumns:Array.from(s),colspanCompensation:o}}function O_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Mm(t))return O_(r[0]);n.isCollapsed=!0;const s=r.slice(1),o=new Set;if(s.length>0)_(s,l=>{Gk(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;o.add(h)}}const a=n.colspan-((e=_m(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Mm(l)&&(u.isCollapsed=_m(l,"isCollapsed"))}),{rollbackModification:()=>P_(t),affectedColumns:Array.from(o),colspanCompensation:a}}function die(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function fie(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const i1=new Map([["collapse",O_],["expand",P_],["hide-column",die],["show-column",fie]]);function gie(t,e,n){if(!i1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return i1.get(t)(e,n)}function rg(t){const e=[];return _(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=pie(e,a);let c=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||c)u.push(Vk());else{const f=mie(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function mie(t){const{crossHiddenColumns:e,...n}=kb(t);return n}function pie(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function fS(t,e,n){wie(t,e),e.set(t,n)}function wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kc(t,e,n){return t.set(qk(t,e),n),n}function Pt(t,e){return t.get(qk(t,e))}function qk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yi=new WeakMap,tr=new WeakMap,Wa=new WeakMap;class Cie{constructor(){fS(this,Yi,new rie),fS(this,tr,new hie(Pt(Yi,this))),fS(this,Wa,[[]])}setState(e){Pt(Yi,this).setData(e);let n=!1;try{Pt(tr,this).buildTree()}catch{Pt(tr,this).clear(),Pt(Yi,this).clear(),n=!0}return Kc(Wa,this,rg(Pt(tr,this).getRoots())),n}setColumnsLimit(e){Pt(Yi,this).setColumnsLimit(e)}mergeStateWith(e){const n=Fe(e,r=>{let{row:i,...s}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});Pt(Yi,this).mergeWith(n),Pt(tr,this).buildTree(),Kc(Wa,this,rg(Pt(tr,this).getRoots()))}mapState(e){Pt(Yi,this).map(e),Pt(tr,this).buildTree(),Kc(Wa,this,rg(Pt(tr,this).getRoots()))}mapNodes(e){return Qt(Pt(tr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const s=e(i.data);s!==void 0&&n.push(s)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Pt(tr,this).getNode(n,r);let s;return i&&(s=gie(e,i,r),Kc(Wa,this,rg(Pt(tr,this).getRoots()))),s}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Pt(Wa,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Pt(tr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let s=!1,o=null;for(let a=e;a<=r;a++){const l=Pt(tr,this).getRootByColumn(a);if(!l)break;s=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:f}=u.data;f||d<=i&&c>=e&&c+d-1<=r&&(o===null||h<o)&&(o=h)},Bk)}return s&&o===null?-1:this.levelToRowCoords((n=o)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let s=n-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:s}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+s-1;let o=n+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return Pt(Yi,this).getLayersCount()}getColumnsCount(){return Pt(Yi,this).getColumnsCount()}clear(){Kc(Wa,this,[]),Pt(Yi,this).clear(),Pt(tr,this).clear()}}function Xc(t,e,n){return(e=vie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vie(t){var e=yie(t,"string");return typeof e=="symbol"?e:e+""}function yie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sie{constructor(e,n){Xc(this,"hot",void 0),Xc(this,"nestedHeaderSettingsGetter",void 0),Xc(this,"layersCount",0),Xc(this,"container",void 0),Xc(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),s=n.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),Cl(d,m),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function bie(t,e){Kk(t,e),e.add(t)}function s1(t,e,n){return(e=Rie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rie(t){var e=Eie(t,"string");return typeof e=="symbol"?e:e+""}function Eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zc(t,e,n){Kk(t,e),e.set(t,n)}function Kk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qs(t,e,n){return t.set(Ot(t,e),n),n}function Ue(t,e){return t.get(Ot(t,e))}function Ot(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const o1="nestedHeaders",Tie=280;var lt=new WeakMap,So=new WeakMap,xh=new WeakMap,Np=new WeakMap,Im=new WeakMap,Wt=new WeakSet;class _ie extends Ke{constructor(){super(...arguments),bie(this,Wt),Zc(this,lt,new Cie),Zc(this,So,null),Zc(this,xh,null),Zc(this,Np,!1),Zc(this,Im,null),s1(this,"ghostTable",new Sie(this.hot,(e,n)=>this.getHeaderSettings(e,n))),s1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return o1}static get PLUGIN_PRIORITY(){return Tie}isEnabled(){return!!this.hot.getSettings()[o1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&tt(it`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Ot(Wt,this,Bie).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,jie).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Oie).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,xie).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Aie).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Hie).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Nie).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Die).call(e,...i)}),this.addHook("afterSelection",()=>Ot(Wt,this,ig).call(this)),this.addHook("afterSelectionFocusSet",()=>Ot(Wt,this,ig).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Mie).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Ot(Wt,this,kie).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,$ie).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Vie).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Iie).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Pie).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Lie).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Fie).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ot(Wt,e,Wie).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Ot(Wt,this,ig).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Ot(Wt,this,ig).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ue(lt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ue(lt,this).setState(e)),this.detectedOverlappedHeaders&&tt(it`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Ue(lt,this).triggerColumnModification(i,r)}),!Ue(So,this)&&this.enabled&&qs(So,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:s,newValue:o}=r;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Ue(lt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ue(lt,this).clear(),Ue(So,this).unsubscribe(),qs(So,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ue(lt,this)}getLayersCount(){return Ue(lt,this).getLayersCount()}getHeaderSettings(e,n){return Ue(lt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<n;o++){const a=r.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),Ce(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Ce(l.childNodes[c],"hiddenHeader")),s&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Ce(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),Ce(s,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(o=Ue(lt,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{label:""};if(d||h)Y(s,"hiddenHeader");else if(c>1){var m,v;const{wtOverlays:w}=l._wt,b=(m=w.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),R=(v=w.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(s),P=b||R?Math.min(c,r-i):c;P>1&&s.setAttribute("colspan",P)}if(this.hot.view.appendColHeader(u,s,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const w=s.querySelector("div.relative");w&&f&&f.length>0&&(Ce(w,this.hot.getColumnMeta(u).headerClassName),Y(w,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:s}=(r=Ue(lt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return s||i?"":this.hot.getColHeader(e,n)}destroy(){qs(lt,this,null),Ue(So,this)!==null&&(Ue(So,this).unsubscribe(),qs(So,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ue(lt,this).getHeaderTreeNodeData(e.row,e.col)}}function ig(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=Ue(lt,this).findLeftMostColumnIndex(n.row,n.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function Mie(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?i.row:(n=Ue(Im,this))===null||n===void 0?void 0:n.row,l=o?t:i.col,u=a<0&&l>=0;if(qs(Im,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Ue(lt,this).findLeftMostColumnIndex(a,l),m=Ue(lt,this).findRightMostColumnIndex(a,l),v=m-f+1;if(f<c&&m>h)return f;if(o){let w=null;return f>=c&&m>h?v>d?(e.value="start",w=f):(e.value="end",w=m):f<c&&m<=h&&(v>d?(e.value="end",w=m):(e.value="start",w=f)),w}return f<=c?f:m}function Iie(t,e,n){const r=Ue(lt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:s,selectionWidth:o}=n,{isRoot:a,colspan:l}=Ue(lt,this).getHeaderSettings(e,t);if(s===tE){if(!a)return r.columnIndex}else if(s===eD&&(l>o-i||!a))return null;return t}function Pie(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],c=l-o+1,h=a-u+1;if(o>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var i;const m=c+f,v=d-a;if(v===0)continue;((i=Ue(lt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[m][v]="")}}}function Oie(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function xie(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;qs(xh,this,e.clone()),qs(Np,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(sp(t)||Ko(t)&&l||PN(t))&&s.push(o,o+a-1,e.row),r.selectColumns(...s)}function Aie(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=je(e.row,-1/0,-1);e.col<c.col?h.push(u.col,s,d):e.col>c.col?h.push(l.col,s+o-1,d):h.push(s,s+o-1,d),this.hot.selection.selectColumns(...h)}function Hie(){qs(Np,this,!1)}function Nie(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ue(Np,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Ue(lt,this).getHeaderTreeNodeData(Ue(xh,this).row,Ue(xh,this).col);if(e.setHighlight(Ue(xh,this)),s>e.getWidth()||i<n||i+s-1>r){const o=Ue(lt,this).findTopMostEntireHeaderLevel(je(n,i,i+s-1),je(r,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function Die(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Ue(lt,this).findLeftMostColumnIndex(n.row,n.col),s=Ue(lt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Lie(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});qs(Im,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function kie(t){t.length=0;for(let e=0;e<Ue(lt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Fie(t){const e=Ue(lt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const s=Ue(lt,this).findLeftMostColumnIndex(i,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(r=!1),Hn(o)&&o<t.startColumn){n=o;break}}t.startColumn=r?Ue(lt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function $ie(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Vie(t,e,n){var r;const{label:i}=(r=Ue(lt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Wie(t,e){if(t<0)return this.hot.getCell(t,Ue(lt,this).findLeftMostColumnIndex(t,e),!0)}function Bie(){this.updatePlugin()}function jie(t,e){e||this.updatePlugin()}function Qc(t,e,n){return(e=Uie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uie(t){var e=zie(t,"string");return typeof e=="symbol"?e:e+""}function zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yie{constructor(e,n){Qc(this,"hot",void 0),Qc(this,"data",null),Qc(this,"plugin",void 0),Qc(this,"parentReference",new WeakMap),Qc(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&_(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let s=!1,o=n;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),r!=null&&o===r?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&_(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,r,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ne(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(_(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),r||(r=this.mockNode()),s.__children.push(r),this.rewriteCache();const o=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[n]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),s=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(me(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),me(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const s=this.getRowIndex(r),o=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];_(r,s=>{i.push(this.getDataObject(s))}),_(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?r?s.__children.splice(o,n,...r):s.__children.splice(o,n):r?this.data.splice(o,n,...r):this.data.splice(o,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const s=n===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>n;let c=s?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=s||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=o===c;c.__children.splice(h,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function a1(t,e,n){return(e=Gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x_{constructor(e,n){a1(this,"hot",void 0),a1(this,"plugin",void 0),this.hot=n,this.plugin=e}}class ns extends x_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),s=this.dataManager.getDataObject(r),o=n.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(_(l,c=>{c&&o.removeChild(c)}),Y(n,ns.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);o.innerHTML="",me(0,i-1,()=>{const d=c.createElement("SPAN");Y(d,ns.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(h)}if(this.dataManager.hasChildren(s)){const c=this.hot.rootDocument.createElement("DIV");u&&be(c,[ea()]),Y(n,ns.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(Y(c,`${ns.CSS_CLASSES.button} ${ns.CSS_CLASSES.expandButton}`),u&&be(n,[Br(!1)])):(Y(c,`${ns.CSS_CLASSES.button} ${ns.CSS_CLASSES.collapseButton}`),u&&be(n,[Br(!0)])),o.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class Kie extends x_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),_(r.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(r.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,s)=>{me(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&_(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,s=>{i.push(s),n&&this.collapseChildRows(s,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,s=>{const o=this.dataManager.getRowIndex(s);n.push(o),this.collapseChildRows(o,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,s=>{i.push(s),n&&this.expandChildRows(s,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);n.push(o),this.expandChildRows(o,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&_(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&_(n.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ye(e.target,ns.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Kr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Xie(t,e,n){Zie(t,e),e.set(t,n)}function Zie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qie(t,e,n){return(e=Jie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jie(t){var e=ese(t,"string");return typeof e=="symbol"?e:e+""}function ese(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tse(t,e){return t.get(nse(t,e))}function nse(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var l1=new WeakMap;class rse extends x_{constructor(){super(...arguments),Qie(this,"dataManager",this.plugin.dataManager),Xie(this,l1,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(rT)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(iT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,r=>{if(r===0)return _(n,(i,s)=>{e.items.splice(r+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return me(0,e.items.length-1,n=>{const r=tse(l1,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function sg(t,e,n){return(e=ise(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ise(t){var e=sse(t,"string");return typeof e=="symbol"?e:e+""}function sse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ose{constructor(e){sg(this,"plugin",void 0),sg(this,"hot",void 0),sg(this,"dataManager",void 0),sg(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=r===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:s}=e;let o=!1;return St(i)&&(tt(it`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,s,!1),o=!0),o}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(s=>{r.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),s=i}else e[r-1]<n?(s=n-1,i=s-r+1):(i=n,s=i+r-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function ase(t,e){Xk(t,e),e.add(t)}function u1(t,e,n){Xk(t,e),e.set(t,n)}function Xk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gS(t,e,n){return(e=lse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lse(t){var e=use(t,"string");return typeof e=="symbol"?e:e+""}function use(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ng(t,e){return t.get(un(t,e))}function Pm(t,e,n){return t.set(un(t,e),n),n}function un(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Om="nestedRows",cse=300,c1=Om,hse="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Dp=new WeakMap,nu=new WeakMap,wn=new WeakSet;class dse extends Ke{constructor(){super(...arguments),ase(this,wn),gS(this,"dataManager",null),gS(this,"headersUI",null),gS(this,"collapsedRowsMap",null),u1(this,Dp,!1),u1(this,nu,!1)}static get PLUGIN_KEY(){return Om}static get PLUGIN_PRIORITY(){return cse}isEnabled(){return!!this.hot.getSettings()[Om]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Cd),this.dataManager=new Yie(this,this.hot),this.collapsingUI=new Kie(this,this.hot),this.headersUI=new ns(this,this.hot),this.contextMenuUI=new rse(this,this.hot),this.rowMoveController=new ose(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,_se).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,Mse).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,mse).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,pse).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,wse).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,gse).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,yse).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,vse).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,Sse).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,bse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,Rse).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,Ese).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,Cse).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,Tse).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return un(wn,e,fse).call(e,...r)}),this.addHook("beforeLoadData",n=>un(wn,this,h1).call(this,n)),this.addHook("beforeUpdateData",n=>un(wn,this,h1).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:c1,relativeToGroup:na,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(c1)}disableCoreAPIModifiers(){Pm(nu,this,!0)}enableCoreAPIModifiers(){Pm(nu,this,!1)}onModifyRowData(e){if(!Ng(nu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Ng(nu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Ng(nu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function fse(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function gse(t,e,n){this.collapsingUI.toggleState(t,e,n)}function mse(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Pm(Dp,this,!0),this.dataManager.getData().slice()}function pse(t){return this.contextMenuUI.appendOptions(t)}function wse(t,e){this.headersUI.appendLevelIndicators(t,e)}function Cse(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function vse(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Pm(Dp,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function yse(t,e,n){const r=Array.from(n.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));n.length=0,n.push(...r)}function Sse(){this.collapsingUI.collapsedRowsStash.stash()}function bse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Rse(){this.collapsingUI.collapsedRowsStash.stash()}function Ese(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Tse(){this.dataManager.rewriteCache()}function _se(){this.headersUI.updateRowHeaderWidth()}function Mse(t,e){Ng(Dp,this)&&(e.skipRender=!0)}function h1(t){if(!hD(t)){jR(hse),this.hot.getSettings()[Om]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function mS(t,e,n){return(e=Ise(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ise(t){var e=Pse(t,"string");return typeof e=="symbol"?e:e+""}function Pse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ose{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;mS(this,"rootWindow",void 0),mS(this,"prefix",void 0),mS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){_(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function xse(t,e,n){return(e=Ase(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ase(t){var e=Hse(t,"string");return typeof e=="symbol"?e:e+""}function Hse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}oe.getSingleton().register("persistentStateSave");oe.getSingleton().register("persistentStateLoad");oe.getSingleton().register("persistentStateReset");const d1="persistentState",Nse=0;class Dse extends Ke{constructor(){super(...arguments),xse(this,"storage",void 0)}static get PLUGIN_KEY(){return d1}static get PLUGIN_PRIORITY(){return Nse}isEnabled(){return!!this.hot.getSettings()[d1]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Ose(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Lse(t,e){kse(t,e),e.add(t)}function kse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pS(t,e,n){return(e=Fse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fse(t){var e=$se(t,"string");return typeof e=="symbol"?e:e+""}function $se(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wS="search",Vse=190,Wse="htSearchResult",Bse=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},jse=function(t,e,n){return St(t)||t===null||!t.toLocaleLowerCase||t.length===0||St(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var CS=new WeakSet;class Use extends Ke{constructor(){super(...arguments),Lse(this,CS),pS(this,"callback",Bse),pS(this,"queryMethod",jse),pS(this,"searchResultClass",Wse)}static get PLUGIN_KEY(){return wS}static get PLUGIN_PRIORITY(){return Vse}isEnabled(){return this.hot.getSettings()[wS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[wS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return f1(CS,e,g1).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return f1(CS,e,g1).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return me(0,i-1,l=>{me(0,s-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||r)(e,c,h);if(m){const v={row:l,col:u,data:c};o.push(v)}d&&d(a,l,u,c,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){He(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function g1(t,e,n,r,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function og(t,e,n){return(e=zse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zse(t){var e=Yse(t,"string");return typeof e=="symbol"?e:e+""}function Yse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zk{constructor(e){og(this,"viewportWidth",void 0),og(this,"overwriteColumnWidthFn",void 0),og(this,"baseWidths",new Map),og(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Gse extends Zk{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=Ou?(i.push([d,m]),a+=m):f!==m&&(i.push([d,m]),s.push(d),o-=m)}),o<=Ou){this.stretchedWidths.clear();return}const l=o/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,m]=h,v=m;s.includes(f)||(v=Math.round(m*l)),this.stretchedWidths.set(f,v),u=f,d<i.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function m1(t,e,n){qse(t,e),e.set(t,n)}function qse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vS(t,e){return t.get(Qk(t,e))}function ag(t,e,n){return t.set(Qk(t,e),n),n}function Qk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lg=new WeakMap,Jc=new WeakMap;class Kse extends Zk{constructor(){super(...arguments),m1(this,lg,0),m1(this,Jc,-1)}prepare(e){super.prepare(e),ag(lg,this,0),ag(Jc,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),ag(Jc,this,e),ag(lg,this,n)}calculate(){if(vS(Jc,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,s]=i;return r+s},0),n=Math.max(this.viewportWidth-e+vS(lg,this),0);this.stretchedWidths.set(vS(Jc,this),n)}}function Xse(t,e){Jk(t,e),e.add(t)}function ug(t,e,n){Jk(t,e),e.set(t,n)}function Jk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e){return t.get(Cu(t,e))}function yS(t,e,n){return t.set(Cu(t,e),n),n}function Cu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zse="stretchColumns";var An=new WeakMap,ru=new WeakMap,SS=new WeakMap,cg=new WeakMap,eh=new WeakSet;class Qse{constructor(e){Xse(this,eh),ug(this,An,void 0),ug(this,ru,void 0),ug(this,SS,new Map([["all",new Gse(Cu(eh,this,p1).bind(this))],["last",new Kse(Cu(eh,this,p1).bind(this))]])),ug(this,cg,"none"),yS(An,this,e),yS(ru,this,Bt(An,this).columnIndexMapper.createAndRegisterIndexMap(Zse,"physicalIndexToValue"))}useStrategy(e){yS(cg,this,Bt(SS,this).has(e)?e:"none")}refreshStretching(){if(Bt(cg,this)==="none"){Bt(ru,this).clear();return}Bt(An,this).batchExecution(()=>{Bt(ru,this).clear();const e=Bt(SS,this).get(Bt(cg,this));let r=Bt(An,this).view.getViewportWidth();Cu(eh,this,Jse).call(this)&&(r-=yn(Bt(An,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Bt(An,this).countCols();i++)Bt(An,this).columnIndexMapper.isHidden(Bt(An,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Cu(eh,this,eoe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[s,o]=i;Bt(ru,this).setValueAtIndex(Bt(An,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return Bt(ru,this).getValueAtIndex(Bt(An,this).toPhysicalColumn(e))}}function Jse(){const{view:t}=Bt(An,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Bt(An,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,s=!1;for(let a=0;a<n;a++){var o;if(i+=((o=Bt(An,this).getRowHeight(a))!==null&&o!==void 0?o:r)+(a===0?1:0),i>e){s=!0;break}}return s}function eoe(t){var e;return(e=Bt(An,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Ou}function p1(t,e){return Bt(An,this).runHooks("beforeStretchingColumnWidth",t,e)}function toe(t,e){eF(t,e),e.add(t)}function bS(t,e,n){eF(t,e),e.set(t,n)}function eF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RS(t,e,n){return t.set(xm(t,e),n),n}function Ns(t,e){return t.get(xm(t,e))}function xm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const noe="stretchColumns",roe=155;var du=new WeakMap,hg=new WeakMap,th=new WeakMap,ES=new WeakSet;class ioe extends Ke{constructor(){super(...arguments),toe(this,ES),bS(this,du,new Qse(this.hot)),bS(this,hg,null),bS(this,th,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Ns(hg,this)!==null&&Ns(hg,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),RS(hg,this,i.width)})})}))}static get PLUGIN_KEY(){return noe}static get PLUGIN_PRIORITY(){return roe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Ns(du,this).useStrategy(this.hot.getSettings().stretchH),Ns(th,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xm(ES,e,ooe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xm(ES,e,soe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Ns(du,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Ns(th,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Ns(du,this).getStretchedWidth(e)}destroy(){Ns(th,this).disconnect(),RS(th,this,null),RS(du,this,null),super.destroy()}}function soe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function ooe(t){t&&Ns(du,this).refreshStretching()}function aoe(t,e){loe(t,e),e.add(t)}function loe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dg(t,e,n){return(e=uoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uoe(t){var e=coe(t,"string");return typeof e=="symbol"?e:e+""}function coe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hoe="touchScroll",doe=200;var fg=new WeakSet;class foe extends Ke{constructor(){super(...arguments),aoe(this,fg),dg(this,"scrollbars",[]),dg(this,"clones",[]),dg(this,"lockedCollection",!1),dg(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return hoe}static get PLUGIN_PRIORITY(){return doe}static get SETTING_KEYS(){return!0}isEnabled(){return kR()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>TS(fg,this,goe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>TS(fg,this,moe).call(this)),this.addHook("afterMomentumScroll",()=>TS(fg,this,poe).call(this))}}function goe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function moe(){this.freezeOverlays=!0,_(this.clones,t=>{Y(t,"hide-tween")})}function poe(){this.freezeOverlays=!1,_(this.clones,t=>{Ce(t,"hide-tween"),Y(t,"show-tween")}),this.hot._registerTimeout(()=>{_(this.clones,t=>{Ce(t,"show-tween")})},400),_(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function woe(t,e){Coe(t,e),e.add(t)}function Coe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function voe(t,e,n){return(e=yoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yoe(t){var e=Soe(t,"string");return typeof e=="symbol"?e:e+""}function Soe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function boe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Dg="trimRows",Roe=330;var w1=new WeakSet;class Eoe extends Ke{constructor(){super(...arguments),woe(this,w1),voe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Dg}static get PLUGIN_PRIORITY(){return Roe}isEnabled(){return!!this.hot.getSettings()[Dg]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Cd),this.trimmedRowsMap.addLocalHook("init",()=>boe(w1,this,Toe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Dg];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),_(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;r&&o&&(_(e,l=>{s[l]=!1}),i=Qt(s,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&o)!==!1&&(r&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",n,i,r&&o,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Toe(){const t=this.hot.getSettings()[Dg];Array.isArray(t)&&this.hot.batchExecution(()=>{_(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var C1={},v1;function _oe(){if(v1)return C1;v1=1;var t=gt(),e=Vu(),n=V1();return t({target:"Object",stat:!0},{fromEntries:function(i){var s={};return e(i,function(o,a){n(s,o,a)},{AS_ENTRIES:!0}),s}}),C1}_oe();const tF="undoRedo",Moe="undoRedo";function te(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,i){const s=r&&r.length;if(!s||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);_(l,c=>{c[1]=t.propToCol(c[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new te.ChangeAction(l,u)};e.done(a,i)}),t.addHook("afterCreateRow",(r,i,s)=>{e.done(()=>new te.CreateRowAction(r,i),s)});const n=(r,i,s,o)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return me(s,o,c=>{me(r,i,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(m=>{let[v]=m;return a.includes(v)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};t.addHook("beforeRemoveRow",(r,i,s,o)=>{const a=()=>{const l=t.toPhysicalRow(r),u=l+i-1,c=kn(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new te.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(l,u,0,t.countCols()-1))};e.done(a,o)}),t.addHook("afterCreateCol",(r,i,s)=>{e.done(()=>new te.CreateColumnAction(r,i),s)}),t.addHook("beforeRemoveCol",(r,i,s,o)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=u+i-1,h=[],d=[],f=[];me(l.length-1,w=>{const b=[],R=l[w];me(u,c,P=>{b.push(R[t.toPhysicalColumn(P)])}),h.push(b)}),me(i-1,w=>{f.push(t.toPhysicalColumn(u+w))}),Array.isArray(t.getSettings().colHeaders)&&me(i-1,w=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+w)]||null)});const m=t.columnIndexMapper.getIndexesSequence(),v=t.rowIndexMapper.getIndexesSequence();return new te.RemoveColumnAction(u,f,h,d,m,v,t.getSettings().fixedColumnsStart,n(0,t.countRows(),u,c))};e.done(a,o)}),t.addHook("beforeCellAlignment",(r,i,s,o)=>{e.done(()=>new te.CellAlignmentAction(r,i,s,o))}),t.addHook("beforeFilter",(r,i)=>{e.done(()=>new te.FiltersAction(r,i))}),t.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new te.RowMoveAction(r,i))}),t.addHook("beforeColumnMove",(r,i)=>{r!==!1&&e.done(()=>new te.ColumnMoveAction(r,i))}),t.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new te.MergeCellsAction(t,r))}),t.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new te.UnmergeCellsAction(t,r))}),t.addHook("beforeColumnSort",(r,i,s)=>{s&&e.done(()=>new te.ColumnSortAction(r,i))}),t.addHook("afterInit",()=>{e.init()})}te.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const s=t(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};te.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=kn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};te.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=kn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};te.prototype.isUndoAvailable=function(){return this.doneActions.length>0};te.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};te.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};te.prototype.isEnabled=function(){return this.enabled};te.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Ooe(t),this.registerShortcuts(),t.addHook("afterChange",nF)};te.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,xoe(t),this.unregisterShortcuts(),t.removeHook("afterChange",nF)};te.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};te.Action=function(){};te.Action.prototype.undo=function(){};te.Action.prototype.redo=function(){};te.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Ti(te.ChangeAction,te.Action);te.ChangeAction.prototype.undo=function(t,e){const n=kn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,a=n.length;o<a;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,a=n.length;o<a;o++){const[l,u]=n[o];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const s=t.getSelectedLast();if(s!==void 0){const[o,a]=n[0],[l,u]=s,c=t.getFirstFullyVisibleRow(),h=t.getFirstFullyVisibleColumn(),d=o>=c,f=a>=h;if((d&&f)===!1&&(l!==o||u!==a)===!0){const w={row:o,col:a};d===!1&&(w.verticalSnap="top"),f===!1&&(w.horizontalSnap="start"),t.scrollViewportTo(w)}}t.selectCells(this.selected,!1,!1)};te.ChangeAction.prototype.redo=function(t,e){const n=kn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};te.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Ti(te.CreateRowAction,te.Action);te.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};te.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};te.RemoveRowAction=function(t,e,n,r,i,s){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=s};Ti(te.RemoveRowAction,te.Action);te.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);r.push([this.index+s,isNaN(a)?o:a,i[o]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[s,o,a]=i;t.setCellMetaObject(s,o,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};te.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};te.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Ti(te.CreateColumnAction,te.Action);te.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};te.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};te.RemoveColumnAction=function(t,e,n,r,i,s,o,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=a};Ti(te.RemoveColumnAction,te.Action);te.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],s=this.data.length,o=[];for(let u=0;u<s;u++)o.push(Fe(this.data[u],i));const a=Fe(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),_(t.getSourceDataArray(),(u,c)=>{_(r,(h,d)=>{u[h]=o[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&_(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};te.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};te.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};te.CellAlignmentAction.prototype.undo=function(t,e){_(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};te.CellAlignmentAction.prototype.redo=function(t,e){To(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,s)=>t.setCellMeta(n,r,i,s)),t.addHookOnce("afterViewRender",e),t.render()};te.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"};Ti(te.FiltersAction,te.Action);te.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&n.conditionCollection.importAllConditions(this.previousConditionsStack),n.filter()};te.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class Ioe extends te.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}te.MergeCellsAction=Ioe;class Poe extends te.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}te.UnmergeCellsAction=Poe;te.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Ti(te.RowMoveAction,te.Action);te.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),__(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),n.moveRow(o,s)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};te.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};te.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Ti(te.ColumnMoveAction,te.Action);te.ColumnMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),__(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),n.moveColumn(o,s)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};te.ColumnMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),n.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};te.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};Ti(te.ColumnSortAction,te.Action);te.ColumnSortAction.prototype.undo=function(t,e){const n=t.getPlugin("columnSorting"),r=t.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:n;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()};te.ColumnSortAction.prototype.redo=function(t,e){const n=t.getPlugin("columnSorting"),r=t.getPlugin("multiColumnSorting");(r.isEnabled()?r:n).sort(this.nextSortState),e()};te.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};te.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:tF};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};te.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(tF)};function nF(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function Ooe(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function xoe(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Pd=oe.getSingleton();Pd.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Pd.register("beforeUndo");Pd.register("afterUndo");Pd.register("beforeRedo");Pd.register("afterRedo");te.PLUGIN_KEY=Moe;te.SETTING_KEYS=!0;function Aoe(){Ye(wh),Ye(P9),Ye(Ch),Ye(l8),Ye(p8),Ye(RL),Ye(c7),Ye(q7),Ye(Pp),Ye(sZ),Ye(xZ),Ye($Z),Ye(Ap),Ye(fQ),Ye(cee),Ye(Bee),Ye(mte),Ye(Mte),Ye($te),Ye(Xte),Ye(one),Ye(Ene),Ye(Hne),Ye(pre),Ye(Kre),Ye(eie),Ye(_ie),Ye(dse),Ye(Dse),Ye(Use),Ye(ioe),Ye(foe),Ye(Eoe),Ye(te)}function Hoe(){JX(),b6(),x6(),Z6(),Aoe()}function Noe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let s;if(i)if(typeof i[n]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return s})}var _S,MS,IS,PS,OS;Hoe();Noe(_e);_e.__GhostTable=h_;_e._getListenersCounter=vz;_e._getRegisteredMapsCounter=Sq;_e.EventManager=Ur;const Doe=[Jj,qU,oq,E6,zU,WU,rU,Vz,UU,sU,ZU,$z],Loe=[kU,QU];_e.helper={};_e.dom={};_(Doe,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(_e.helper[e]=t[e])})});_(Loe,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(_e.dom[e]=t[e])})});_e.cellTypes=(_S=_e.cellTypes)!==null&&_S!==void 0?_S:{};_(_K(),t=>{_e.cellTypes[t]=jT(t)});_e.cellTypes.registerCellType=Ar;_e.cellTypes.getCellType=jT;_e.editors=(MS=_e.editors)!==null&&MS!==void 0?MS:{};_(fz(),t=>{_e.editors[`${Ln(t)}Editor`]=Yg(t)});_e.editors.registerEditor=sr;_e.editors.getEditor=Yg;_e.renderers=(IS=_e.renderers)!==null&&IS!==void 0?IS:{};_(tY(),t=>{const e=Gg(t);t==="base"&&(_e.renderers.cellDecorator=e),_e.renderers[`${Ln(t)}Renderer`]=e});_e.renderers.registerRenderer=Cr;_e.renderers.getRenderer=Gg;_e.validators=(PS=_e.validators)!==null&&PS!==void 0?PS:{};_(iY(),t=>{_e.validators[`${Ln(t)}Validator`]=qR(t)});_e.validators.registerValidator=Ga;_e.validators.getValidator=qR;_e.plugins=(OS=_e.plugins)!==null&&OS!==void 0?OS:{};_(GR(),t=>{_e.plugins[t]=gd(t)});_e.plugins[`${Ln(Ke.PLUGIN_KEY)}Plugin`]=Ke;_e.plugins.registerPlugin=Ye;_e.plugins.getPlugin=gd;const koe={props:{fetchData:{type:Function,required:!0},updateData:{type:Function,required:!0},tableTitle:{type:String,default:""},columnHeaders:{type:Array,default:()=>[]},rowHeaderLabel:{type:String,default:"Row"},rowHeaderWidth:{type:Number,default:200}},mounted(){this.loadTableData()},methods:{async loadTableData(){const{data:t,keys:e}=await this.fetchData(),n=this.$refs.hotTable;this.hot=new _e(n,{data:t,colHeaders:this.columnHeaders,rowHeaders:e,contextMenu:!0,afterChange:this.handleTableChange,licenseKey:"non-commercial-and-evaluation",manualColumnResize:!0,rowHeaderWidth:this.rowHeaderWidth})},async handleTableChange(t){if(t){const e=this.hot.getData();await this.updateFullTable(e)}},async updateFullTable(t){console.log("Updating full table:",t);try{await this.updateData(t),console.log("Full table update successful")}catch(e){console.error("Full table update failed:",e)}}}},Foe={key:0},$oe={ref:"hotTable",class:"hot-table"};function Voe(t,e,n,r,i,s){return Do(),Ah("div",null,[n.tableTitle?(Do(),Ah("h3",Foe,cF(n.tableTitle),1)):$b("",!0),bo("div",$oe,null,512)])}const rF=Fb(koe,[["render",Voe]]),Woe={components:{TableComponent:rF},computed:{...y1("experiment",["currentExperiment"])},methods:{...S1("experiment",["updateExperimentParameters"]),async handleInputChange(t,e){await this.updateExperimentParameters({experimentId:this.currentExperiment.id,parameters:{...this.currentExperiment.parameters,[t]:e}})},fetchCulturesData(){const t=this.currentExperiment.parameters.growth_parameters,e=Object.keys(t[1]),n=["initial_population","doubling_time_mins","carrying_capacity","mu_min","ic50_initial","ic10_ic50_ratio","dose_effective_slope_width_mins","time_lag_drug_effect_mins","adaptation_rate_max","adaptation_rate_ic10_ic50_ratio","drug_concentration","effective_dose"],i=(o=>{const a=new Set(n),l=n.filter(c=>o.includes(c)),u=o.filter(c=>!a.has(c)).sort();return[...l,...u]})(e);return{data:i.map(o=>Object.keys(t).map(a=>t[a][o])),keys:i}},async updateCulturesData(t){const e=this.fetchCulturesData().keys,n=Object.keys(this.currentExperiment.parameters.growth_parameters);for(let r=0;r<n.length;r++)for(let i=0;i<e.length;i++)this.currentExperiment.parameters.growth_parameters[n[r]][e[i]]=t[i][r];await this.updateExperimentParameters({experimentId:this.currentExperiment.id,parameters:this.currentExperiment.parameters})}}},Boe={key:0};function joe(t,e,n,r,i,s){var a,l;const o=iu("TableComponent");return Object.keys(((l=(a=t.currentExperiment)==null?void 0:a.parameters)==null?void 0:l.growth_parameters)||{}).length>0?(Do(),Ah("div",Boe,[(Do(),xS(o,{key:t.currentExperiment.id,fetchData:s.fetchCulturesData,updateData:s.updateCulturesData,tableTitle:"Culture Growth Parameters",columnHeaders:["Vial 1","Vial 2","Vial 3","Vial 4","Vial 5","Vial 6","Vial 7"],rowHeaderLabel:"Parameter",rowHeaderWidth:270},null,8,["fetchData","updateData"]))])):$b("",!0)}const Uoe=Fb(Woe,[["render",joe]]),zoe={components:{GrowthParameters:Uoe,TableComponent:rF,VialPlot:fF},data(){return{vials:Array.from({length:7},(t,e)=>e+1),selectedVial:1,errorMessage:"This is a test error message."}},computed:{...y1("experiment",["simulation_data","currentExperiment"])},methods:{...S1("experiment",["fetchSimulationPlot","updateExperimentParameters"]),fetchCulturesData(){const t=this.currentExperiment.parameters.cultures,e=Object.keys(t[1]),n=["name","description","volume_vial","pump1_stock_drug_concentration","pump2_stock_drug_concentration","dose_initialization","dilution_factor","od_dilution_threshold","delay_dilution_max_hours","dilution_number_first_drug_addition","dose_first_drug_addition","dose_increase_factor","dose_increase_amount","delay_stress_increase_min_generations","threshold_od_min_increase_stress","threshold_growth_rate_increase_stress","threshold_growth_rate_decrease_stress"],i=(o=>{const a=new Set(n),l=n.filter(c=>o.includes(c)),u=o.filter(c=>!a.has(c)).sort();return[...l,...u]})(e);return{data:i.map(o=>Object.keys(t).map(a=>t[a][o])),keys:i}},async updateCulturesData(t){const e=this.fetchCulturesData().keys,n=Object.keys(this.currentExperiment.parameters.cultures),r=e;for(let i=0;i<n.length;i++)for(let s=0;s<r.length;s++)this.currentExperiment.parameters.cultures[n[i]][r[s]]=t[s][i];await this.updateExperimentParameters({experimentId:this.currentExperiment.id,parameters:this.currentExperiment.parameters})},async plotSelectedVial(){!this.currentExperiment||!this.selectedVial||await this.fetchSimulationPlot(this.selectedVial)}}},Yoe={key:0},Goe={class:"container-wrapper"},qoe={class:"tables-container"},Koe={class:"table-wrapper"},Xoe={class:"table-wrapper"},Zoe={id:"SimulationPlot"},Qoe={class:"controls-container"},Joe={key:1,class:"no-experiment-selected"};function eae(t,e,n,r,i,s){const o=iu("TableComponent"),a=iu("GrowthParameters"),l=iu("v-btn"),u=iu("v-select"),c=iu("VialPlot");return t.currentExperiment.parameters?(Do(),Ah("div",Yoe,[bo("div",Goe,[bo("div",qoe,[bo("div",Koe,[(Do(),xS(o,{class:"control-parameters",key:t.currentExperiment.id,fetchData:s.fetchCulturesData,updateData:s.updateCulturesData,tableTitle:"Culture Control Parameters",columnHeaders:["Vial 1","Vial 2","Vial 3","Vial 4","Vial 5","Vial 6","Vial 7"],rowHeaderLabel:"Parameter",rowHeaderWidth:270},null,8,["fetchData","updateData"]))]),bo("div",Xoe,[Fp(a,{class:"growth-parameters"})])])]),bo("div",Zoe,[bo("div",Qoe,[Fp(l,{color:"info",class:"control-button",height:"60px",onClick:s.plotSelectedVial,style:{"align-self":"flex-start"}},{default:hF(()=>e[1]||(e[1]=[dF("Plot Predicted Experiment")])),_:1},8,["onClick"]),Fp(u,{modelValue:i.selectedVial,"onUpdate:modelValue":e[0]||(e[0]=h=>i.selectedVial=h),items:i.vials,class:"control-dropdown",label:"Vial",width:"70px",style:{"align-self":"flex-start"}},null,8,["modelValue","items"])]),i.selectedVial?(Do(),xS(c,{key:0,vial:i.selectedVial,data:t.simulation_data[i.selectedVial]},null,8,["vial","data"])):$b("",!0)])])):(Do(),Ah("div",Joe,e[2]||(e[2]=[bo("p",null,"No experiment selected",-1)])))}const pae=Fb(zoe,[["render",eae],["__scopeId","data-v-3a577cdc"]]);export{pae as default};
